<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>周记_1</title>
      <link href="/posts/e5147fe.html"/>
      <url>/posts/e5147fe.html</url>
      
        <content type="html"><![CDATA[<h1 id="RE（CPP）"><a href="#RE（CPP）" class="headerlink" title="RE（CPP）"></a>RE（CPP）</h1><p>之前做的cpp的题还是太少了，一遇到这种抽象的就看都看不懂，遂决定要多做一下这些题。写这一篇文章的目的在于想要提高自己对cpp中反编译的代码的理解程度。然后笔者感觉之前的文章好像都很省略，这次准备多写一点文字和图，来讲解清楚。</p><hr><p>那先用一道题引入吧。这道题是moectf2023年的</p><h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><p>先通过查找字符串找到主函数</p><p><img src="https://s2.loli.net/2024/03/11/y978CE6XWNuKbjZ.png" alt="image-20240311180850575"></p><p>主函数大致就是这样了</p><p>静态加动调两步法：</p><ol><li>静态分析发现：在<code>MessageBoxW(hWndParent, Text, L&quot;hint&quot;, 0);</code>的位置是正确位置，然后上面的比较是一个函数的返回值，传入了v7和v6，</li><li>不能通过直接的观察发现v7和v6的生成，但是通过动态调试可以发现v7在<code>sub_B00A0A((int)v7, (int)v8);</code>生成，v6在<code>same_op(a91);</code>生成，以及flag是在<code>GetWindowTextW(DlgItem, flag, 1024);</code>位置生成</li><li>通过观察函数名，发现flag传入了same_op,a91也传入了。</li></ol><p>那么看看a91，它是一个字符串，可以先提取出来，之后可能有用。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x000F</span>, <span class="number">0x003E</span>, <span class="number">0x0030</span>, <span class="number">0x0027</span>, <span class="number">0x0013</span>, <span class="number">0x0001</span>, <span class="number">0x007D</span>, <span class="number">0x0070</span>, <span class="number">0x0070</span>, <span class="number">0x0003</span>, <span class="number">0x007D</span>, <span class="number">0x0038</span>, <span class="number">0x000E</span>, <span class="number">0x007A</span>, <span class="number">0x0023</span>, <span class="number">0x007C</span>, <span class="number">0x000B</span>, <span class="number">0x001A</span>, <span class="number">0x003C</span>, <span class="number">0x007D</span>, <span class="number">0x0039</span>, <span class="number">0x007F</span>, <span class="number">0x003C</span>, <span class="number">0x004D</span>, <span class="number">0x004D</span>, <span class="number">0x004D</span>, <span class="number">0x0029</span>]</span><br></pre></td></tr></table></figure><p>然后程序肯定会读取flag，所以动态调试在same_op(flag)的位置下断点。</p><p>打开位置看一下，发现这个是在stack中。再尝试下断点。</p><p>[read and write]</p><p>然后放开程序，继续跑。</p><blockquote><p>如果断到断点了，不小心切出去了，可以在reg窗口eip的位置点箭头就会跳转回去。</p></blockquote><p>第一次断：</p><p><img src="https://s2.loli.net/2024/03/11/wMl21Gk4dS73icN.png" alt="image-20240311182131729"></p><p>根据这个函数名，很明显是在取len，第二次断到memmove函数，又是内部函数，然后再跑一次，出错了QAQ，这说明什么呢？</p><p>我猜想下面两种可能：</p><p>一个是用的二级指针，一个是copy的之后就没用了</p><p>所以就走不通了，那么这里就补充一手奇怪的cpp知识：</p><p>每个类实例化的时候都有一个构造函数&#x2F;赋值函数对其赋值，所以如果遇到两个本来是一样类型的值进了同一个函数，可以大胆假设它们变成了一个类型，而这个题a91和flag都是这样，同时a91经过函数后v6就被赋值了，可以猜测v6就是a91变成类之后的地址，而flag之后还进行了一次加密，最后的值应该是从v8到v7，只有进入这个函数查看的时候，会发现v4和v3的值的含义</p><p><img src="https://s2.loli.net/2024/03/13/gcHhy3RzL1DXMk4.png" alt="image-20240313203446714"></p><p>虽然不知道a2是什么，但是动调之后都会发现v4和v3是指针，v4指向字符串第一个，v3指向最后一个，那么后面的循环就是加密了。</p><p>具体加密语句是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">start = sub_180956(a2);</span><br><span class="line">end = sub_18017C(a2);</span><br><span class="line"><span class="keyword">while</span> ( start != end )</span><br><span class="line">  sub_1816B7((*start++ - <span class="number">5</span>) ^ <span class="number">0x51</span>);</span><br></pre></td></tr></table></figure><p>而最后翻看源代码就知道：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::wstring <span class="title">EncryptFlag</span><span class="params">(<span class="type">const</span> std::wstring&amp; input)</span> </span>&#123;</span><br><span class="line">    std::wstring encrypted;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">wchar_t</span> c : input) &#123;</span><br><span class="line">        <span class="type">wchar_t</span> encryptedChar = (c - <span class="number">5</span>) ^ <span class="number">0x51</span>;  <span class="comment">// 加一操作</span></span><br><span class="line">        encrypted += encryptedChar;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> encrypted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这表明了确实input是一个特殊类型，而源代码里的遍历被解释成两个指针的操作。</p><p>那么也可以确定最后的值就是a91，把它逆运算一下得到flag：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">b&#x27;\x39\x3b\x31\x0f\x3e\x30\x27\x13\x01\x7d\x70\x70\x03\x7d\x38\x0e\x7a\x23\x7c\x0b\x1a\x3c\x7d\x39\x7f\x3c\x4d\x4d\x4d\x29&#x27;</span></span><br><span class="line">decoded_s = s.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">ord_list = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> decoded_s]</span><br><span class="line">after = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> ord_list:</span><br><span class="line">    this_one = <span class="built_in">chr</span>((c^<span class="number">0x51</span>)+<span class="number">5</span>)</span><br><span class="line">    after += this_one</span><br><span class="line"><span class="built_in">print</span>(after)</span><br><span class="line"><span class="comment"># moectf&#123;GU1&amp;&amp;W1nd0w2_Pr1m3r!!!&#125;</span></span><br></pre></td></tr></table></figure><p>再次观察源代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> WM_COMMAND:</span><br><span class="line">    <span class="keyword">switch</span> (<span class="built_in">LOWORD</span>(wParam)) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        TCHAR buffer[<span class="number">512</span>];</span><br><span class="line">        <span class="built_in">GetWindowText</span>(<span class="built_in">GetDlgItem</span>(hWnd, <span class="number">2</span>), buffer, <span class="built_in">sizeof</span>(buffer));</span><br><span class="line">        std::wstring input = buffer;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对输入进行加密操作</span></span><br><span class="line">        std::wstring encryptedInput = <span class="built_in">EncryptFlag</span>(input);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 正确加密后的 flag</span></span><br><span class="line">        std::wstring correctEncryptedFlag = <span class="string">L&quot;\x39\x3b\x31\xf\x3e\x30\x27\x13\x1\x7d\x70\x70\x3\x7d\x38\xe\x7a\x23\x7c\xb\x1a\x3c\x7d\x39\x7f\x3c\x4d\x4d\x4d\x29&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (encryptedInput == correctEncryptedFlag) &#123;</span><br><span class="line">            <span class="built_in">MessageBox</span>(hWnd, <span class="built_in">TEXT</span>(<span class="string">&quot;Congratulations! flag is correct！&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;hint&quot;</span>), MB_OK);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">MessageBox</span>(hWnd, <span class="built_in">TEXT</span>(<span class="string">&quot;Sorry, flag error.&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;hint&quot;</span>), MB_OK);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里的&#x3D;&#x3D;由于类型不是原始类型，所以运算符被重载了</p><p>用ida进入这个函数查看：</p><p><img src="https://s2.loli.net/2024/03/13/qr52hv9nFy1udDI.png" alt="image-20240313204606697"></p><p>在第一个v6等于a2[5]的位置，进入a2看第6位是什么</p><p><img src="https://s2.loli.net/2024/03/13/OTvlDcA926toKIM.png" alt="image-20240313204701212"></p><p>进入分析后发现，第五个就是我们输入的字符串</p><p>而v5的位置是</p><p><img src="https://s2.loli.net/2024/03/13/jSg3KdxCYT4VXFR.png" alt="image-20240313204929328"></p><p>正确的加密之后的值，这里也能看出和a91一样</p><p>而v4我没有确定，v2是我输入的值的加密，那么最后的return就很明显是比较函数了，(函数名不一样是因为中间有跳转)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __cdecl <span class="title function_">sub_18A7B0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_258024);</span><br><span class="line">  <span class="keyword">return</span> a2 == a4 &amp;&amp; !sub_180654(a1, a3, a2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_18E010</span><span class="params">(<span class="type">unsigned</span> __int16 *a1, <span class="type">unsigned</span> __int16 *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_25801A);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !a3 )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *a1 != *a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++a1;</span><br><span class="line">    ++a2;</span><br><span class="line">    --a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 &gt;= (<span class="type">int</span>)*a2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么大概这个题的逻辑就是这样。</p><hr><p>搞完上面这个题，3天已经过去了QAQ，但是差不多理解的就是，cpp里面函数特别抽象，所以要是没有符号表，硬推超级难搞，还是猜吧…</p><h2 id="simpleCPP"><a href="#simpleCPP" class="headerlink" title="simpleCPP"></a>simpleCPP</h2><p>这道题有符号表，太好了，根据符号表就可以直接看出函数的作用</p><p>比如</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="built_in">sub_1400019C0</span>(std::cout, <span class="string">&quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;</span>, envp);</span><br><span class="line">std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, sub_140001B90);</span><br><span class="line"><span class="comment">//就是</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;&lt;&lt;endl;</span></span><br><span class="line"><span class="built_in">sub_1400019C0</span>(std::cout, <span class="string">&quot;Let&#x27;s start our game,Please input your flag:&quot;</span>, v5);</span><br><span class="line"><span class="built_in">sub_140001DE0</span>(std::cin, Block);</span><br><span class="line"><span class="comment">//就是</span></span><br><span class="line"><span class="comment">//cout &quot;Let&#x27;s start our game,Please input your flag:&quot;&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">// cin &lt;&lt; Block;</span></span><br></pre></td></tr></table></figure><p>十分方便</p><p>这种题就可以直接分析了。</p><p>mop好像会堆栈不平衡，于是用改标志位跳过。</p><p>分析一下：</p><p>先是对输入异或，然后每8位顺序读取合成一个变量，最后对4个变量执行方程上的操作</p><p>所以直接逆向，先z3，然后得结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r1 = BitVec(<span class="string">&#x27;r1&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">r2 = BitVec(<span class="string">&#x27;r2&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">r3 = BitVec(<span class="string">&#x27;r3&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">j = BitVec(<span class="string">&#x27;j&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v22 = r2 &amp; r1</span><br><span class="line">v23 = r3 &amp; ~r1</span><br><span class="line">v24 = ~r2</span><br><span class="line">v25 = r3 &amp; v24</span><br><span class="line">v26 = r1 &amp; v24</span><br><span class="line">v28 = r2</span><br><span class="line">v29 = r3</span><br><span class="line">flag = r3 &amp; v24 &amp; r1 | r3 &amp; (r2 &amp; r1 | r2 &amp; ~r1 | ~(r2 | r1))</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(r3 &amp; ~r1 == <span class="number">0x11204161012</span>)</span><br><span class="line">s.add(flag == <span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(r3 &amp; ~r1 | r2 &amp; r1 | r3 &amp; v24 | r1 &amp; v24 == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add(((r3 &amp; ~r1 | r2 &amp; r1 | r3 &amp; v24 | r1 &amp; ~r2) ^ j) == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line">s.add((r3 &amp; ~r1 | r2 &amp; r1 | r2 &amp; r3) == (~r1 &amp; r3 | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Solution found:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r1 = &quot;</span>, m[r1])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r2 = &quot;</span>, m[r2])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r3 = &quot;</span>, m[r3])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;j = &quot;</span>, m[j])</span><br><span class="line">    <span class="comment"># 添加新的约束条件来排除当前的解，一定要是Or,可能出现有一个值不完全约束的情况</span></span><br><span class="line">    s.add(Or(r1 != m[r1], r2 != m[r2], r3 != m[r3], j != m[j]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一开始我写的是s.add(And(r1 !&#x3D; m[r1], r2 !&#x3D; m[r2], r3 !&#x3D; m[r3], j !&#x3D; m[j]))，只有一个解但是怎么都出不来，最后发现原来是用Or,但是最后还是出不来，因为r2的情况太多了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x69</span>, <span class="number">0x5F</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x5F</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x62</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x5F</span>, <span class="number">0x6F</span>, <span class="number">0x72</span>, <span class="number">0x5F</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x3e3a460533286f0d</span>,<span class="number">0x0c00020130082c0c</span>,<span class="number">0x08020717153e3013</span>,<span class="number">0x32310600</span>]</span><br><span class="line">tryi = hextbyte(last,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">pl(pxor(tryi,key),<span class="string">&quot;NSSCTF&quot;</span>)</span><br><span class="line"><span class="comment"># NSSCTF&#123;We1l_D0ndeajoa_Slgebra_am_i&#125;</span></span><br></pre></td></tr></table></figure><p>这个还是不对，看了wp发现比赛中间给了hint把中间修改即可<code>e!P0or_a</code></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;We<span class="number">1</span>l_D<span class="number">0</span><span class="keyword">ne</span><span class="title">!P0or_algebra_am_i</span>&#125;</span><br></pre></td></tr></table></figure><hr><p>写了两道cpp，其实内核还是分析函数作用，然后进行算法逆向，下一周尝试写一点cpp代码然后看看反编译后的样子</p><h1 id="RE其它内容"><a href="#RE其它内容" class="headerlink" title="RE其它内容"></a>RE其它内容</h1><h2 id="EZ加密器"><a href="#EZ加密器" class="headerlink" title="EZ加密器"></a>EZ加密器</h2><p>这题超抽象，全是混淆，可以说根本不知道在干什么，但是由于输入的长度很少，基本上爆破就可以解决。</p><p>主函数是一个检查函数+base64加密函数+DES加密函数+最后的转hex字符</p><p>一个一个分析</p><p><img src="https://s2.loli.net/2024/03/13/dVw5meqJz9fX42a.png" alt="image-20240313215958869"></p><p>怕是分析不出来什么。。所以就进入了每个函数把所有逻辑复制下来然后爆破</p><p>第一个函数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//int len; // eax</span></span><br><span class="line"><span class="comment">//unsigned int v3; // r11d</span></span><br><span class="line"><span class="comment">//int v4; // edx</span></span><br><span class="line"><span class="comment">//int v5; // r8d</span></span><br><span class="line"><span class="comment">//int v6; // ecx</span></span><br><span class="line"><span class="comment">//int v7; // r8d</span></span><br><span class="line"><span class="comment">//int v8; // r9d</span></span><br><span class="line"><span class="comment">//int v9; // ecx</span></span><br><span class="line"><span class="comment">//char* p_code; // rcx</span></span><br><span class="line"><span class="comment">//unsigned int this_code; // r8d</span></span><br><span class="line"><span class="comment">//int v12; // eax</span></span><br><span class="line"><span class="comment">//int v13; // edx</span></span><br><span class="line"><span class="comment">//int v14; // r9d</span></span><br><span class="line"><span class="comment">//int v15; // edx</span></span><br><span class="line"><span class="comment">//int v16; // r10d</span></span><br><span class="line"><span class="comment">//unsigned int v17; // edx</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// len = strlen(code);</span></span><br><span class="line"><span class="comment">//for (int q = 0; q &lt;= 30; q++)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//len = q;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;this try: &quot; &lt;&lt; len;</span></span><br><span class="line"><span class="comment">//v4 = -7;</span></span><br><span class="line"><span class="comment">//v5 = 1;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v6 = v5;</span></span><br><span class="line"><span class="comment">//v7 = v4 &amp; v5;</span></span><br><span class="line"><span class="comment">//v8 = v4;</span></span><br><span class="line"><span class="comment">//v4 ^= v6;</span></span><br><span class="line"><span class="comment">//v5 = 2 * v7;</span></span><br><span class="line"><span class="comment">//&#125; while (v5);</span></span><br><span class="line"><span class="comment">//if (v6 != v8)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v9 = len;</span></span><br><span class="line"><span class="comment">//len ^= v4;</span></span><br><span class="line"><span class="comment">//v4 = 2 * (v4 &amp; v9);</span></span><br><span class="line"><span class="comment">//&#125; while (v4);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">///*code[6] = 0;</span></span><br><span class="line"><span class="comment">//p_code = code;*/</span></span><br><span class="line"><span class="comment">//v3 = len == 0;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;and result &quot; &lt;&lt; v3 &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>验证码是6位</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//void find_password() &#123;</span></span><br><span class="line"><span class="comment">//std::string chars = &quot;0123456789&quot;;</span></span><br><span class="line"><span class="comment">//int v12, v13, v14, v15, v16, v17;</span></span><br><span class="line"><span class="comment">//bool v3;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; chars.size(); ++i) &#123;</span></span><br><span class="line"><span class="comment">//for (int j = 0; j &lt; chars.size(); ++j) &#123;</span></span><br><span class="line"><span class="comment">//for (int k = 0; k &lt; chars.size(); ++k) &#123;</span></span><br><span class="line"><span class="comment">//for (int l = 0; l &lt; chars.size(); ++l) &#123;</span></span><br><span class="line"><span class="comment">//for (int m = 0; m &lt; chars.size(); ++m) &#123;</span></span><br><span class="line"><span class="comment">//for (int n = 0; n &lt; chars.size(); ++n) &#123;</span></span><br><span class="line"><span class="comment">//std::string password = &#123; chars[i], chars[j], chars[k], chars[l], chars[m], chars[n] &#125;;</span></span><br><span class="line"><span class="comment">//const char* p_code = password.c_str();</span></span><br><span class="line"><span class="comment">//v3 = true;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//int this_code = *p_code;</span></span><br><span class="line"><span class="comment">//v12 = -49;</span></span><br><span class="line"><span class="comment">//v13 = 1;</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//v14 = v13;</span></span><br><span class="line"><span class="comment">//v15 = v12 &amp; v13;</span></span><br><span class="line"><span class="comment">//v16 = v12;</span></span><br><span class="line"><span class="comment">//v12 ^= v14;</span></span><br><span class="line"><span class="comment">//v13 = 2 * v15;</span></span><br><span class="line"><span class="comment">//&#125; while (v13);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (v14 != v16) &#123;</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//v17 = this_code;</span></span><br><span class="line"><span class="comment">//this_code ^= v12;</span></span><br><span class="line"><span class="comment">//v12 = 2 * (v12 &amp; v17);</span></span><br><span class="line"><span class="comment">//&#125; while (v12);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (this_code &gt;= 0xA) &#123;</span></span><br><span class="line"><span class="comment">//v3 = false;</span></span><br><span class="line"><span class="comment">//break;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//++p_code;</span></span><br><span class="line"><span class="comment">//&#125; while (*p_code);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (v3) &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;Found a password: &quot; &lt;&lt; password &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//find_password();</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>验证码是数字</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int main(void) &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int len; // eax</span></span><br><span class="line"><span class="comment">//int v3; // edx</span></span><br><span class="line"><span class="comment">//int v4; // r8d</span></span><br><span class="line"><span class="comment">//int v5; // r9d</span></span><br><span class="line"><span class="comment">//int v6; // r8d</span></span><br><span class="line"><span class="comment">//int v7; // r10d</span></span><br><span class="line"><span class="comment">//int v8; // r8d</span></span><br><span class="line"><span class="comment">//unsigned int ans; // r11d</span></span><br><span class="line"><span class="comment">//__int64 v10; // r10</span></span><br><span class="line"><span class="comment">//int v11; // ecx</span></span><br><span class="line"><span class="comment">//int v12; // edx</span></span><br><span class="line"><span class="comment">//int v13; // eax</span></span><br><span class="line"><span class="comment">//int v14; // r8d</span></span><br><span class="line"><span class="comment">//int v15; // edx</span></span><br><span class="line"><span class="comment">//int v16; // r9d</span></span><br><span class="line"><span class="comment">//int v17; // edx</span></span><br><span class="line"><span class="comment">//char v19[42]; // [rsp+2Eh] [rbp-2Ah] BYREF</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//for (int p = 1; p &lt;= 100; p++)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//len = p;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;this try: &quot; &lt;&lt; len;</span></span><br><span class="line"><span class="comment">//v3 = -41;</span></span><br><span class="line"><span class="comment">//v4 = 1;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v5 = v4;</span></span><br><span class="line"><span class="comment">//v6 = v3 &amp; v4;</span></span><br><span class="line"><span class="comment">//v7 = v3;</span></span><br><span class="line"><span class="comment">//v3 ^= v5;</span></span><br><span class="line"><span class="comment">//v4 = 2 * v6;</span></span><br><span class="line"><span class="comment">//&#125; while (v4);</span></span><br><span class="line"><span class="comment">//if (v5 != v7)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v8 = len;</span></span><br><span class="line"><span class="comment">//len ^= v3;</span></span><br><span class="line"><span class="comment">//v3 = 2 * (v3 &amp; v8);</span></span><br><span class="line"><span class="comment">//&#125; while (v3);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//ans = 0;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;and result: &quot; &lt;&lt; len &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;cstring&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//__int64 check(__int64 a1) &#123;</span></span><br><span class="line"><span class="comment">//// Your function here</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//void find_flag() &#123;</span></span><br><span class="line"><span class="comment">//std::string flag(40, &#x27;0&#x27;);  // Initialize a flag string of length 40 with &#x27;0&#x27;</span></span><br><span class="line"><span class="comment">//int v12, v13, v14, v15, v16, v17;</span></span><br><span class="line"><span class="comment">//bool ans;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// Set the specific positions to &quot;DASCTF&#123;&#125;&quot;</span></span><br><span class="line"><span class="comment">//std::string initial = &quot;DASCTF&#123;&#125;&quot;;</span></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; 8; ++i) &#123;</span></span><br><span class="line"><span class="comment">//flag[i] = initial[i];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// Check the flag</span></span><br><span class="line"><span class="comment">//if (check((__int64)flag.c_str())) &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;The flag: &quot; &lt;&lt; flag &lt;&lt; &quot; satisfies the condition.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//else &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;The flag: &quot; &lt;&lt; flag &lt;&lt; &quot; does not satisfy the condition.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//find_flag();</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag的长度40和开头结尾要求</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">char</span>* p_lastflag; <span class="comment">// r8</span></span><br><span class="line"><span class="type">char</span>* p_str2; <span class="comment">// rcx</span></span><br><span class="line"><span class="type">char</span>* end; <span class="comment">// r9</span></span><br><span class="line"><span class="type">char</span> v6; <span class="comment">// si</span></span><br><span class="line"><span class="type">unsigned</span> __int8 left; <span class="comment">// di</span></span><br><span class="line"><span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v9; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v10; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v12; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v13; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">int</span> v14; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v15; <span class="comment">// r12d</span></span><br><span class="line"><span class="type">int</span> v16; <span class="comment">// edi</span></span><br><span class="line"><span class="type">char</span> v17; <span class="comment">// di</span></span><br><span class="line"><span class="type">int</span> v18; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v19; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v21; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v22; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v23; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v24; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v25; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v26; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">int</span> v27; <span class="comment">// esi</span></span><br><span class="line"><span class="type">char</span>* saved_flag; <span class="comment">// [rsp+20h] [rbp-D8h] BYREF</span></span><br><span class="line">__int64 slen; <span class="comment">// [rsp+28h] [rbp-D0h]</span></span><br><span class="line"><span class="type">char</span> afterbase[<span class="number">8</span>]; <span class="comment">// [rsp+38h] [rbp-C0h] BYREF</span></span><br><span class="line"><span class="type">char</span> Str2[<span class="number">184</span>]; <span class="comment">// [rsp+40h] [rbp-B8h] BYREF</span></span><br><span class="line">slen = <span class="number">1</span>;</span><br><span class="line">p_lastflag = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line">*p_lastflag = k;</span><br><span class="line"><span class="keyword">if</span> ((<span class="type">int</span>)slen &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">end = Str2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">p_str2 = Str2;</span><br><span class="line">end = &amp;Str2[<span class="number">2</span> * (<span class="type">int</span>)slen];</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v6 = *p_lastflag;</span><br><span class="line">left = (<span class="type">unsigned</span> __int8)*p_lastflag &gt;&gt; <span class="number">4</span>;</span><br><span class="line">v8 = left;</span><br><span class="line"><span class="keyword">if</span> (left &lt;= <span class="number">9u</span>)</span><br><span class="line">&#123;</span><br><span class="line">v9 = left ^ <span class="number">0x30</span>;</span><br><span class="line"><span class="keyword">if</span> (!left)</span><br><span class="line">v9 = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">v9 = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v10 = v9 &amp; v8;</span><br><span class="line">v9 ^= v8;</span><br><span class="line">v8 = <span class="number">2</span> * v10;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v10);</span><br><span class="line">v11 = <span class="number">-11</span>;</span><br><span class="line">v12 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v13 = v12;</span><br><span class="line">v14 = v11 &amp; v12;</span><br><span class="line">v15 = v11;</span><br><span class="line">v11 ^= v13;</span><br><span class="line">v12 = <span class="number">2</span> * v14;</span><br><span class="line">&#125; <span class="keyword">while</span> (v12);</span><br><span class="line"><span class="keyword">if</span> (v13 != v15)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v16 = v9 &amp; v11;</span><br><span class="line">v9 ^= v11;</span><br><span class="line">v11 = <span class="number">2</span> * v16;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v16);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">*p_str2 = v9;</span><br><span class="line">p_str2 += <span class="number">2</span>;</span><br><span class="line">v17 = v6 &amp; <span class="number">0xF</span>;</span><br><span class="line">v18 = v6 &amp; <span class="number">0xF</span>;</span><br><span class="line"><span class="keyword">if</span> ((v6 &amp; <span class="number">0xF</span>u) &gt; <span class="number">9</span>)</span><br><span class="line">&#123;</span><br><span class="line">v19 = <span class="number">65</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v21 = v19 &amp; v18;</span><br><span class="line">v19 ^= v18;</span><br><span class="line">v18 = <span class="number">2</span> * v21;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v21);</span><br><span class="line">v22 = <span class="number">-11</span>;</span><br><span class="line">v23 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v24 = v23;</span><br><span class="line">v25 = v22 &amp; v23;</span><br><span class="line">v26 = v22;</span><br><span class="line">v22 ^= v24;</span><br><span class="line">v23 = <span class="number">2</span> * v25;</span><br><span class="line">&#125; <span class="keyword">while</span> (v23);</span><br><span class="line"><span class="keyword">if</span> (v24 != v26)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v27 = v19;</span><br><span class="line">v19 ^= v22;</span><br><span class="line">v22 = <span class="number">2</span> * (v22 &amp; v27);</span><br><span class="line">&#125; <span class="keyword">while</span> (v22);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">v19 = v17 ^ <span class="number">0x30</span>;</span><br><span class="line"><span class="keyword">if</span> (!v17)</span><br><span class="line">v19 = <span class="number">48</span>;</span><br><span class="line">&#125;</span><br><span class="line">*(p_str2 - <span class="number">1</span>) = v19;</span><br><span class="line">++p_lastflag;</span><br><span class="line">&#125; <span class="keyword">while</span> (p_str2 != end);</span><br><span class="line">&#125;</span><br><span class="line">*end = <span class="number">0</span>;</span><br><span class="line">std::cout &lt;&lt; std::hex &lt;&lt; k &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; Str2[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; , &quot;</span> &lt;&lt; Str2[<span class="number">1</span>] &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后的逻辑是一位值转换为2位的hex字符串</p><p>然后base64那部分算是一眼叮，然后后面那个des没见过全靠signsrch直接分析出来，然后直接解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">raw_table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line">new_table = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/=&#x27;</span></span><br><span class="line">dictionary_decode = <span class="built_in">str</span>.maketrans(new_table, raw_table)</span><br><span class="line">dictionary_encode = <span class="built_in">dict</span>(<span class="built_in">zip</span>(dictionary_decode.values(),dictionary_decode.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的 DES 加密结果</span></span><br><span class="line">encrypted_text = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;0723105D5C12217DCDC3601F5ECB54DA9CCEC2279F1684A13A0D716D17217F4C9EA85FF1A42795731CA3C55D3A4D7BEA&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试所有可能的 6 位数字组合</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">10</span>), repeat=<span class="number">6</span>):</span><br><span class="line">    key = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, i))  </span><br><span class="line">    <span class="comment"># print(key)</span></span><br><span class="line">    keyt = base64.b64encode(key.encode()).decode() <span class="comment"># MTIzMTIzMTIz base64encode(v) 正常的123123进行base64以后的值</span></span><br><span class="line">    keytt = keyt.translate(dictionary_encode)</span><br><span class="line">    key = keytt.encode()</span><br><span class="line">    <span class="comment"># print(key)</span></span><br><span class="line">    <span class="comment"># 创建 DES 对象</span></span><br><span class="line">    des = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    <span class="comment"># 尝试解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decrypted_text = des.decrypt(encrypted_text)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> decrypted_text):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;找到了！密钥是：&#x27;</span>, key)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;明文是：&#x27;</span>, decrypted_text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span>  <span class="comment"># 如果解密失败，就尝试下一个密钥</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><p>先从简单的练起吧。</p><h2 id="bigRSA"><a href="#bigRSA" class="headerlink" title="bigRSA"></a>bigRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br></pre></td></tr></table></figure><p>它用了两个n，尝试莫不互素：gcd一下，出来了最大公倍数，那就直接解了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a = GCD(n1,n2)</span><br><span class="line"><span class="comment"># print(a)</span></span><br><span class="line"></span><br><span class="line">n1_ = n1 //a</span><br><span class="line">n2_ = n2 // a</span><br><span class="line"><span class="comment"># print(n1_)</span></span><br><span class="line"><span class="comment"># print(n2_)</span></span><br><span class="line"></span><br><span class="line">d1 = <span class="built_in">pow</span>(e,-<span class="number">1</span>,(a-<span class="number">1</span>)*(n2_-<span class="number">1</span>))</span><br><span class="line">c1 = <span class="built_in">pow</span>(c,d1,n2)</span><br><span class="line">d2 = <span class="built_in">pow</span>(e,-<span class="number">1</span>,(a-<span class="number">1</span>)*(n1_-<span class="number">1</span>))</span><br><span class="line">c2 = <span class="built_in">pow</span>(c1,d2,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c2))</span><br><span class="line"><span class="comment"># b&#x27;SangFor&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="bad-e"><a href="#bad-e" class="headerlink" title="bad_e"></a>bad_e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p) <span class="comment"># 6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span></span><br><span class="line"><span class="built_in">print</span>(q) <span class="comment"># 11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,p*q)</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment"># 63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span></span><br></pre></td></tr></table></figure><p>已知p，q，e，c，直接解</p><p>6,解不出来，说是e是phi的因子，不能得出m，那就分解一下phi</p><p>发现p-1是e的倍数，但是q-1不是，根据同余的消去律可消去两边的最大公因数</p><p>相当于mod((q-1)),就出来了</p><h2 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">p,q = getPrime(<span class="number">2048</span>),getPrime(<span class="number">2048</span>)</span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read().strip())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c =  147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span></span><br><span class="line"><span class="comment"># n =  553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span></span><br></pre></td></tr></table></figure><p>e很小</p><p>$c &#x3D; m^e + kn$</p><p>$m &#x3D; (c - kn)**(1&#x2F;7)$</p><p>尝试低加密指数攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = iroot(c+k*n,e)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>]))) <span class="comment">#转为字符串</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k=k+<span class="number">1</span></span><br><span class="line">    <span class="comment"># b&#x27;moectf&#123;SMaLL_3xPon3nt_Mak3_rSa_w3ak!_!lP0iYlJf!M3rux9G9Vf!JoxiMl903lllA&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="狂飙"><a href="#狂飙" class="headerlink" title="狂飙"></a>狂飙</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">flag = <span class="string">b&#x27;19209389120572313&#x27;</span></span><br><span class="line">m = <span class="number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span></span><br><span class="line">key = os.urandom(<span class="number">24</span>)</span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">n=m % key</span><br><span class="line">flag += (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">enc_flag = aes.encrypt(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(enc_flag)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#103560843006078708944833658339172896192389513625588</span></span><br><span class="line"><span class="comment">#b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br></pre></td></tr></table></figure><p>通过n &#x3D; m % key来求key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的值</span></span><br><span class="line">enc_flag = <span class="string">b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的因子</span></span><br><span class="line">factors = [<span class="number">3</span>,<span class="number">37</span>,<span class="number">439</span>,<span class="number">3939851</span>, <span class="number">265898280367</span>,<span class="number">5036645362649</span>,<span class="number">342291058100503482469327892079792475478873</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有可能的组合</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(factors) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> combinations(factors, r):</span><br><span class="line">        <span class="comment"># 计算可能的 key</span></span><br><span class="line">        possible_key = reduce(<span class="keyword">lambda</span> x, y: x*y, subset)</span><br><span class="line">        <span class="comment"># 检查 key 的长度是否为 24 字节</span></span><br><span class="line">        <span class="comment"># 使用找到的 key、iv 和 enc_flag 解密 flag</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            aes = AES.new(long_to_bytes(possible_key), AES.MODE_CBC, iv)</span><br><span class="line">            flag = aes.decrypt(enc_flag)</span><br><span class="line">            <span class="keyword">if</span> flag.startswith(<span class="string">b&#x27;flag&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Found possible flag:&#x27;</span>, flag)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 密码学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RE中的反调试</title>
      <link href="/posts/2af5212f.html"/>
      <url>/posts/2af5212f.html</url>
      
        <content type="html"><![CDATA[<h2 id="SEH"><a href="#SEH" class="headerlink" title="SEH"></a>SEH</h2><p>在python中，你是否见过以下语法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(factors) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> combinations(factors, r):</span><br><span class="line">        possible_key = reduce(<span class="keyword">lambda</span> x, y: x*y, subset)</span><br><span class="line">        <span class="keyword">try</span>:<span class="comment">#防止key的长度不对</span></span><br><span class="line">            aes = AES.new(long_to_bytes(possible_key), AES.MODE_CBC, iv)</span><br><span class="line">            flag = aes.decrypt(enc_flag)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Found possible flag:&#x27;</span>, flag)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>即</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line"><span class="keyword">except</span></span><br></pre></td></tr></table></figure><p>它的作用是尝试执行try块中的内容，如果出现异常，就执行except的内容。</p><p>在Windows中，也有类似的保护程序正常执行的机制，叫做SEH（Structured Exception Handling）</p><p>通过在源代码使用__try,__except,__finally来实现</p><p>使用时，except()中的值用来表示异常处理方法</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">__except()括号中表达式的取值范围:</span></span><br><span class="line"><span class="section">1:处理异常</span></span><br><span class="line"><span class="section">0:不处理异常交给下一个异常节点去处理</span></span><br><span class="line"><span class="section">-1:继续执行（程序直接寄掉）</span></span><br></pre></td></tr></table></figure><p>在程序中，可能故意使用SEH，刻意引发错误跳过执行一些指令</p><hr><p>施工中</p>]]></content>
      
      
      <categories>
          
          <category> 知识集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> 动调 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密03:AES</title>
      <link href="/posts/ca6bad6.html"/>
      <url>/posts/ca6bad6.html</url>
      
        <content type="html"><![CDATA[<h1 id="Advanced-Encryption-Standard"><a href="#Advanced-Encryption-Standard" class="headerlink" title="Advanced Encryption Standard"></a>Advanced Encryption Standard</h1><p>(高级加密标准)</p><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>对称加密，块加密，流加密<br>密钥长度固定为：128，192，256bit<br>加密模式分为：CBC,CFB,OFB,CTR,GCM,ECB</p><ul><li>对称加密：加密密钥和解密密钥相同</li></ul><blockquote><h2 id="分组密码和流密码"><a href="#分组密码和流密码" class="headerlink" title="分组密码和流密码"></a>分组密码和流密码</h2><p>分组密码是每次只能处理特定长度的一块数据的一类密码算法，这里的“一块”就称为分组。一个分组的比特数就称为分组长度。<br>流密码是对数据流进行连续处理的一类密码算法。流密码一般以1比特、8比特或32比特等为单位进行加密和解密。<br>分组密码算法只能加密固定长度的分组，但需要加密的明文长度可能会超过分组密码的分组长度，这就需要对分组密码算法进行迭代，以便将一段很长的明文全部加密。迭代的方法就被称为分组密码的模式。</p></blockquote><blockquote><ul><li>ECB模式：Electronic CodeBook mode（电子密码本模式）</li><li>CBC模式：Cipher Block Chaining mode（密码分组链接模式）</li><li>CFB模式：Cipher FeedBack mode（密文反馈模式）</li><li>OFB模式：Output FeedBack mode（输出反馈模式）</li><li>CTR模式：CounTeR mode（计数器模式）</li></ul></blockquote><table><thead><tr><th>模式</th><th>名称</th><th>优点</th><th>缺点</th><th>备注</th></tr></thead><tbody><tr><td>ECB模式</td><td>Electronic CodeBook mode（电子密码本模式）</td><td>简单、快速、支持并行运算（加密、解密）</td><td>明文中的重复排列会反映在密文中；通过删除、替换密文分组可以对明文进行操作；对包含某些比特错误的密文进行解密时，对应的分组会出错；不能低于重放攻击。</td><td>不应使用</td></tr><tr><td>CBC模式</td><td>Cipher Block Chaining mode（密码分组链接模式）</td><td>明文的重复排列不会反映在密文中；支持并行计算（仅解密）；能够解密任何密文分组</td><td>对包含某些错误比特的密文进行解密时，第一个分组的全部比特以及后一个分组的相应比特会出错；加密不支持并行计算</td><td>CRYPTREC推荐；《实用密码学》推荐</td></tr><tr><td>CFB模式</td><td>Cipher FeedBack mode（密文反馈模式）</td><td>不需要填充（padding）；支持并行计算（仅解密）；能够解密任意密文分组</td><td>加密不支持并行计算；对包含某些错误比特的密文进行解密时，第一个分组的全部比特以及后一个分组的相应比特会出错；不能低于重放攻击</td><td>CRYPTREC推荐</td></tr><tr><td>OFB模式</td><td>Output FeedBack mode（输出反馈模式）</td><td>不需要填充（padding）；可实现进行加密、解密的准备；解密解密使用相同结构；对包含某些错误比特密文解密时，只有明文中相应的比特会出错</td><td>不支持并行计算；主动攻击者反转密文分组中的某些比特时，明文分组中相应的比特也会被反转</td><td>CRYPTREC推荐</td></tr><tr><td>CTR模式</td><td>CounTeR mode（计数器模式）</td><td>不需要填充（padding）；可实现进行加密、解密的准备；解密解密使用相同结构；对包含某些错误比特密文解密时，只有明文中相应的比特会出错；支持并行计算（加密、解密)</td><td>主动攻击者反转密文分组中的某些比特时，明文分组中相应的比特也会被反转</td><td>CRYPTREC推荐；《实用密码学》推荐</td></tr></tbody></table><p>以上内容来自(<a href="https://blog.csdn.net/weixin_43946212/article/details/108116251">分组密码的模式——ECB、CBC、CFB、OFB、CTR_ofb是指分组密码的哪种工作模式-CSDN博客</a>)</p><hr><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h3 id="明文分块"><a href="#明文分块" class="headerlink" title="明文分块"></a>明文分块</h3><p>把所有明文分为n块，每块128bit。如果最后不足，需要填充：</p><ul><li><code>NoPadding</code>： 不做任何填充，但是要求明文必须是16字节的整数倍。<br><code>PKCS5Padding</code>（默认）： 如果明文块少于16个字节（<code>128bit</code>），在明文块末尾补足相应数量的字符，且每个字节的值等于缺少的字符数。 比如明文：{1,2,3,4,5,a,b,c,d,e},缺少6个字节，则补全为{1,2,3,4,5,a,b,c,d,e,6,6,6,6,6,6 }<br><code>ISO10126Padding</code>：如果明文块少于16个字节（<code>128bit</code>），在明文块末尾补足相应数量的字节，最后一个字符值等于缺少的字符数，其他字符填充随机数。比如明文：{1,2,3,4,5,a,b,c,d,e},缺少6个字节，则可能补全为{1,2,3,4,5,a,b,c,d,e,5,c,3,G,$,6}<br><code>PKCS7Padding</code>原理与<code>PKCS5Padding</code>相似，区别是<code>PKCS5Padding</code>的<code>blocksize</code>为8字节，而<code>PKCS7Padding</code>的<code>blocksize</code>可以为1到255字节</li><li>需要注意的是，如果在<code>AES</code>加密的时候使用了某一种填充方式，解密的时候也必须采用同样的填充方式。</li></ul><p>然后每一块按序排列成4x4矩阵</p><h3 id="S盒生成"><a href="#S盒生成" class="headerlink" title="S盒生成"></a>S盒生成</h3><p><img src="https://pic1.zhimg.com/80/v2-9c648584654f34c8eaddf0f57dde2ec3_1440w.webp?source=1def8aca" alt="img"></p><p>这个表是S盒，生成方法如下：</p><ol><li>对S盒初始化为00，01，02，03，…，FE，FF</li><li>用每一格的乘法逆元代替这一格，域是$GF(2^8)$</li><li>对每一格的bit位进行运算，令$b_i^，&#x3D;b_i\oplus b_{i+4 mod 8}\oplus b_{i+5 mod 8}\oplus b_{i+6 mod 8}\oplus b_{i+7 mod 8}\oplus c_i$，其中$c &#x3D; {01100011}$</li></ol><p>逆S盒：用于解密</p><h3 id="字节替代"><a href="#字节替代" class="headerlink" title="字节替代"></a>字节替代</h3><p>通过每一字节前4位和后四位分别作为S盒的行标和列标，替换为对应位置的值</p><h3 id="行移位"><a href="#行移位" class="headerlink" title="行移位"></a>行移位</h3><p>把上面已经分为4x4的矩阵中，第i行左移i位</p><h3 id="列混淆"><a href="#列混淆" class="headerlink" title="列混淆"></a>列混淆</h3><p>最矩阵经行矩阵乘法：<br>$$<br>\begin{bmatrix}<br>   2 &amp; 3 &amp; 1 &amp; 1 \<br>   1 &amp; 2 &amp; 3 &amp; 1 \<br>   1 &amp; 1 &amp; 2 &amp; 3 \<br>   3 &amp; 1 &amp; 1 &amp; 2<br>  \end{bmatrix} \tag{1}</p><ul><li>before &#x3D; after<br>$$</li></ul><h3 id="轮密钥加"><a href="#轮密钥加" class="headerlink" title="轮密钥加"></a>轮密钥加</h3><p>每一轮输入与轮密钥进行异或，该项一定出现在加密的首尾，保证安全性</p><p>轮密钥的生成是初始密钥和该轮子密钥异或的结果</p><h4 id="密钥扩展"><a href="#密钥扩展" class="headerlink" title="密钥扩展"></a>密钥扩展</h4><p>密钥扩展用于生成子密钥</p><p>现在假设已经有初始密钥的4x4矩阵</p><p>对它分列（以列为单位分成4个）为$W_0，W_1,W_2,W_3$。那么扩展密钥就是扩展出$W_4，W_5,W_6……$</p><p>具体公式是：<br>$$<br>\begin{equation}<br>\left{<br>\begin{aligned}<br>W_i &amp; &#x3D; W_{i-4} \oplus W_{i-1} \<br>W_i &amp; &#x3D; W_{i-4} \oplus T({W_{i-1}})<br>\end{aligned}<br>\right.<br>\end{equation}<br>$$<br>其中T是函数其作用是：</p><ol><li>假设输入的是$W_i$</li><li>对这一列循环左移一位（列移位），对于$W_i$这一列，就是上移一位</li><li>用S盒对2之后的$W_i$进行字节替代，规则同加密的字节替代</li><li>与给定的矩阵进行异或，矩阵是[RC[j],0,0,0]轮常量是RC &#x3D; {01, 02, 04, 08, 10, 20, 40, 80, 1B, 36}.j是该轮轮数</li></ol><p>然后每4列作为一组成为轮密钥</p><h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><blockquote><p><strong>1）为什么需要密钥扩展：</strong></p><p>不论密钥长度为多少，我们的明文分组始终为16字节（4字）。上文提到，在轮密钥加部分，我们需要为每一轮提供一个长度为4字的轮密钥。</p><p>对于AES-128（4字密钥），需要迭代10轮，加上第0轮，共需要进行11次轮密钥加，而每一次轮密钥加都需要一个长度为4字的轮密钥，因此所需要的扩展密钥长度为 次字字11次×4字&#x3D;44字 。</p><p>对于AES-192（6字密钥），需要迭代12轮，加上第0轮，共需要进行13次轮密钥加，所需要的扩展密钥长度为 次字字13次×4字&#x3D;52字 。</p><p>对于AES-256（8字密钥），需要迭代14轮，加上第0轮，共需要进行15次轮密钥加，所需要的扩展密钥长度为 次字字15次×4字&#x3D;60字 。</p><p>因此我们需要一定的方法用来将密钥扩展到一定的长度。</p></blockquote><blockquote><p><strong>（2）AES-192的密钥扩展方法：</strong></p><p>AES-192的密钥有6个字，其密钥扩展方法与AES-128完全类似。第一个for循环的填充变成了6个字；之后的判断整除条件变为了能否整除6。</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只是伪代码，不能运行</span></span><br><span class="line"><span class="title function_">KeyExpansion</span>(<span class="type">byte</span> <span class="built_in">key</span>[<span class="number">24</span>], word w[<span class="number">52</span>])</span><br><span class="line">&#123;</span><br><span class="line">    word temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)<span class="comment">//第一个for循环，填充w的前6个字</span></span><br><span class="line">        w[i] = &#123;<span class="built_in">key</span>[<span class="number">4</span>*i], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">1</span>], </span><br><span class="line">                <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">2</span>], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">3</span>]&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">6</span>; i &lt; <span class="number">52</span>; i++)<span class="comment">//第二个for循环，填充后面的内容</span></span><br><span class="line">    &#123;</span><br><span class="line">        temp = w[i<span class="number">-1</span>];<span class="comment">//保存上一个字</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">6</span> == <span class="number">0</span>)<span class="comment">//如果整除6</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (<span class="title function_">RotWord</span> (temp))</span><br><span class="line">                    xor Rcon[i/<span class="number">6</span>];<span class="comment">//对保存的上一个字进行复杂的处理</span></span><br><span class="line">        w[i] = w[i<span class="number">-6</span>] xor temp;<span class="comment">/*将上一个字（处理或没处理过）</span></span><br><span class="line"><span class="comment">                               与6个字之前的字进行异或，得到当前的字*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>（3）AES-256的密钥扩展方法：</strong></p><p>AES-256的密钥长度为8字。其密钥扩展与AES-128也基本相同，只是修改了填充的字数，值得注意的是：AES-256在第二个for循环里添加了判断条件，当i%&#x3D;&#x3D;4时，要对temp进行一次字代替。</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只是伪代码，不能运行</span></span><br><span class="line"><span class="title function_">KeyExpansion</span>(<span class="type">byte</span> <span class="built_in">key</span>[<span class="number">32</span>], word w[<span class="number">60</span>])</span><br><span class="line">&#123;</span><br><span class="line">    word temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)<span class="comment">//第一个for循环，填充w的前8个字</span></span><br><span class="line">        w[i] = &#123;<span class="built_in">key</span>[<span class="number">4</span>*i], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">1</span>], </span><br><span class="line">                <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">2</span>], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">3</span>]&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">8</span>; i &lt; <span class="number">60</span>; i++)<span class="comment">//第二个for循环，填充后面的内容</span></span><br><span class="line">    &#123;</span><br><span class="line">        temp = w[i<span class="number">-1</span>];<span class="comment">//保存上一个字</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">8</span> == <span class="number">0</span>)<span class="comment">//如果整除8</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (<span class="title function_">RotWord</span> (temp))</span><br><span class="line">                    xor Rcon[i/<span class="number">8</span>];<span class="comment">//对保存的上一个字进行复杂的处理</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i % <span class="number">8</span> == <span class="number">4</span>)<span class="comment">//如果除8余4</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (temp);</span><br><span class="line">        w[i] = w[i<span class="number">-8</span>] xor temp;<span class="comment">/*将上一个字（处理或没处理过）</span></span><br><span class="line"><span class="comment">                               与6个字之前的字进行异或，得到当前的字*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此段摘自zhuanlan.zhihu.com&#x2F;p&#x2F;360393988</p></blockquote><h3 id="总过程"><a href="#总过程" class="headerlink" title="总过程"></a>总过程</h3><p>加密时，执行：</p><ul><li>轮密钥加</li><li>（字节替代+行位移+列混淆+轮密钥加）*9</li><li>字节替代+行位移+轮密钥加</li></ul><p>以上过程是对于16字节密钥的</p>]]></content>
      
      
      <categories>
          
          <category> 密码学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 密码 </tag>
            
            <tag> 加密方法 </tag>
            
            <tag> 对称加密 </tag>
            
            <tag> 流加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-VM(2)</title>
      <link href="/posts/b22e135.html"/>
      <url>/posts/b22e135.html</url>
      
        <content type="html"><![CDATA[<p>尝试对虚拟机保护有更深的理解。</p><p>由于之前做vm题感觉完全不会，所以找了几道题试一试</p><p>由之前的vm简要介绍看到vm题总是给出opcode的运行方式，然后通过opcode还原出运行逻辑，最后求出flag</p><h2 id="EzADVM"><a href="#EzADVM" class="headerlink" title="EzADVM"></a>EzADVM</h2><p>这个是个安卓vm，jadx打开，然后打开main_activity,</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">CheckClick</span><span class="params">(View a)</span> &#123;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.sampleText;</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">flagText</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.flagtext;</span><br><span class="line">        <span class="type">String</span> <span class="variable">flagstring</span> <span class="operator">=</span> flagText.getText().toString();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Right!&quot;</span>.equals(stringFromJNI(flagstring))) &#123;</span><br><span class="line">            tv.setText(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">            tv.setTextColor(-<span class="number">16711936</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>看到有stringFromJNI(flagstring)，去找函数原型，没找到，应该在库里。</p><p>用apktool反编译出源代码。打开so文件</p><p>重点是这些：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">now_num = <span class="number">0</span>;</span><br><span class="line">  i = <span class="number">1</span>;</span><br><span class="line">  used_char = _JNIEnv::GetStringUTFChars(in, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !i++ )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_29:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string&lt;decltype(nullptr)&gt;(v14, <span class="string">&quot;Error!&quot;</span>);</span><br><span class="line">        v7 = (<span class="type">const</span> <span class="type">char</span> *)sub_20F50(v14);</span><br><span class="line">        v13 = _JNIEnv::NewStringUTF(in, v7);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v14);</span><br><span class="line">        <span class="keyword">return</span> v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( code[i] != <span class="number">0x21</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      __strcpy_chk(input, used_char, <span class="number">1024LL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0xFF</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0x88</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( code[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xA1</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = or_not_num &amp; or_num;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xC3</span>u:</span><br><span class="line">        or_num = b1 | b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB2</span>u:</span><br><span class="line">        not_1 = ~b1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xE5</span>u:</span><br><span class="line">        not_2 = ~b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xF1</span>u:</span><br><span class="line">        b1 = input[now_num];</span><br><span class="line">        b2 = input[++now_num];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xD4</span>u:</span><br><span class="line">        or_not_num = not_2 | not_1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBF</span>u:</span><br><span class="line">        i_form = now_num++;</span><br><span class="line">        save[<span class="number">0</span>] = s[i_form];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x99</span>u:</span><br><span class="line">        now_num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBB</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = now_num + save[<span class="number">0</span>] - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;last, s, <span class="number">0x20</span>uLL) )</span><br></pre></td></tr></table></figure><p>输入用来初始化input了，所以相当于是用指令码对input加密，最后得到last</p><p>以及一开始有一个循环只有当code[i]&#x3D;&#x3D;0先1时才会执行初始化，所以只需要匹配合理的指令即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, </span><br><span class="line">        <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, </span><br><span class="line">        <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x99</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x99</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x88</span>, <span class="number">0xFF</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> opcode:</span><br><span class="line">    <span class="keyword">match</span> code:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xa1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num - 1] = or_not_num &amp; or_num&quot;</span> )</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xc3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_num = b1 | b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xb2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_1 = ~b1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_2 = ~b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xf1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b1 = input[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num += 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b2 = input[now_num]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xd4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_not_num = not_2 | not_1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbf</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;save = last[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num+=1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x99</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num = 0&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbb</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num-1] = now_num + save - 1&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>大致是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0</span>]*<span class="number">100</span></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">now_num = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>然后化简逆向：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x42</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, </span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x31</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x67</span>, <span class="number">0x6E</span>, </span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x81</span>, </span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># last = [0]*100</span></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     b1 = input[now_num]</span></span><br><span class="line"><span class="comment">#     now_num += 1</span></span><br><span class="line"><span class="comment">#     b2 = input[now_num]</span></span><br><span class="line"><span class="comment">#     or_num = b1 | b2</span></span><br><span class="line"><span class="comment">#     not_1 = ~b1</span></span><br><span class="line"><span class="comment">#     not_2 = ~b2</span></span><br><span class="line"><span class="comment">#     or_not_num = not_2 | not_1</span></span><br><span class="line"><span class="comment">#     last[now_num - 1] = or_not_num &amp; or_num</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     save = last[now_num]</span></span><br><span class="line"><span class="comment">#     now_num+=1</span></span><br><span class="line"><span class="comment">#     last[now_num-1] = now_num + save - 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]-=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]^=last[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment">#NSSCTF&#123;H@ppy_Ch1ne5_NEwY3ar!1!1&#125;</span></span><br></pre></td></tr></table></figure><p>小结：这个题和之前遇到的jvm那道题一样，都要解析指令，还原流程</p><h2 id="羊城杯2021-babyvm"><a href="#羊城杯2021-babyvm" class="headerlink" title="羊城杯2021 babyvm"></a>羊城杯2021 babyvm</h2><p>这个题一样，只是在前面加了一个动态调试</p><p>指令码大概是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_80487A8</span><span class="params">(_DWORD *reg)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v1; <span class="comment">// [esp+18h] [ebp-20h]</span></span><br><span class="line"><span class="type">int</span> reg[<span class="number">999</span>];</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">113</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">6</span>] -= <span class="number">4</span>;</span><br><span class="line">      *(_DWORD *)reg[<span class="number">6</span>] = *(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">65</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] += reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">66</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] -= reg[<span class="number">4</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">67</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">55</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">56</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">57</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">53</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xF7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">68</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] /= reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0x80</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[sub_804875F(reg, <span class="number">1</span>)] = *(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">2</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">119</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">83</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(*(<span class="type">char</span> *)reg[<span class="number">3</span>]);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">34</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0x99</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">118</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">3</span>] = *(_DWORD *)reg[<span class="number">6</span>];</span><br><span class="line">      *(_DWORD *)reg[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">      reg[<span class="number">6</span>] += <span class="number">4</span>;</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">84</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = (_BYTE *)reg[<span class="number">3</span>];</span><br><span class="line">      *v1 = getchar();</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">48</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] |= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">49</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">50</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">3</span>] = *(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = <span class="number">1877735783</span>;</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">51</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">52</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">2</span>] = *(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xFE</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">17</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, reg[<span class="number">1</span>]);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( reg[<span class="number">1</span>] != <span class="number">1877735783</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      read(<span class="number">0</span>, s, <span class="number">0x2C</span>u);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) != <span class="number">44</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">0</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      fog[*(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>)] = reg[<span class="number">1</span>];</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">3</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = (<span class="type">unsigned</span> __int8)s[*(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>)];</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( exit_door[<span class="number">0</span>] != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( exit_door[<span class="number">1</span>] != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)*(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">1</span>) != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后转换写出来就好</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">flagafter = []</span><br><span class="line">fog = [<span class="number">0x0000007B</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000037</span>, <span class="number">0x000000E8</span>]</span><br><span class="line"></span><br><span class="line">exit_door = [<span class="number">0xCF1304DC</span>, <span class="number">0x283B8E84</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">opcode = [<span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x02</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDD</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x03</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x04</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x06</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x08</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x09</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0A</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x56</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0C</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x8E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0D</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0E</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0F</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x10</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x11</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x13</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x14</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x15</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x16</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x52</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x18</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x19</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xD9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1A</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1C</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1F</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x20</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x21</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0xF1</span>, <span class="number">0x98</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0xB9</span>, <span class="number">0xE4</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0xA0</span>, <span class="number">0xC1</span>, <span class="number">0x24</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x25</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x26</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x27</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0xC7</span>, <span class="number">0xC1</span>, <span class="number">0x28</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x29</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2A</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2B</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0xC8</span>, <span class="number">0x99</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_asm</span>(<span class="params">reg</span>):<span class="comment"># 这里写成python语法方便爆破</span></span><br><span class="line">    now = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        opcode = reg[now]</span><br><span class="line">        <span class="keyword">if</span> opcode == <span class="number">113</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;push <span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">2</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">3</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">4</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">65</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1+=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">66</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1-=reg4&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">67</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1*=reg3&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">55</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">56</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg4&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">57</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">53</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg5=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xF7</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9+=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">68</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1/=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x80</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>= <span class="subst">&#123;<span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(reg[now + <span class="number">2</span>:now + <span class="number">6</span>]), <span class="string">&#x27;little&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">6</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x77</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg9&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x53</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;pop [reg3]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x22</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&gt;&gt;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x23</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&lt;&lt;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x99</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x76</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;r3 = [r6]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[r6] = 0&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;r6 += 4&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x54</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;read [reg3]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x30</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1|=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x31</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&amp;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x32</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;r3 = <span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">9</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=1877735783&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x10</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x33</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg4=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x34</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg2=<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xFE</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=reg9&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x11</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;printf &#x27;%x\\n&#x27;, reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;cmp reg1=1877735783&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;read 0, s, 0x2Cu&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;cmp strlen(s), 44&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg9=<span class="subst">&#123;fog[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg9=<span class="subst">&#123;fog[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;fog[<span class="subst">&#123;now&#125;</span>]=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=fog[2]&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=fog[3]&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg1=s[<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC7</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;cmp <span class="subst">&#123;exit_door[<span class="number">0</span>]&#125;</span>, reg1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;cmp <span class="subst">&#123;exit_door[<span class="number">1</span>]&#125;</span>, reg1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;exit if now!=r1&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">print_asm(opcode)</span><br></pre></td></tr></table></figure><p>这个变量没有命好名。。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line">read 0, s, 0x2Cu</span><br><span class="line">cmp strlen(s), 44</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[0]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 74!=r1</span><br><span class="line">reg1=s[1]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[2]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 221!=r1</span><br><span class="line">reg1=s[3]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 15!=r1</span><br><span class="line">reg1=s[4]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 27!=r1</span><br><span class="line">reg1=s[5]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 137!=r1</span><br><span class="line">reg1=s[6]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[7]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 84!=r1</span><br><span class="line">reg1=s[8]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 79!=r1</span><br><span class="line">reg1=s[9]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 78!=r1</span><br><span class="line">reg1=s[10]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 85!=r1</span><br><span class="line">reg1=s[11]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 86!=r1</span><br><span class="line">reg1=s[12]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 142!=r1</span><br><span class="line">reg1=s[13]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 73!=r1</span><br><span class="line">reg1=s[14]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 14!=r1</span><br><span class="line">reg1=s[15]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 75!=r1</span><br><span class="line">reg1=s[16]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 6!=r1</span><br><span class="line">reg1=s[17]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 84!=r1</span><br><span class="line">reg1=s[18]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 26!=r1</span><br><span class="line">reg1=s[19]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 66!=r1</span><br><span class="line">reg1=s[20]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 83!=r1</span><br><span class="line">reg1=s[21]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 31!=r1</span><br><span class="line">reg1=s[22]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 82!=r1</span><br><span class="line">reg1=s[23]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 219!=r1</span><br><span class="line">reg1=s[24]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[25]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 217!=r1</span><br><span class="line">reg1=s[26]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[27]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 85!=r1</span><br><span class="line">reg1=s[28]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[29]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 0!=r1</span><br><span class="line">reg1=s[30]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 75!=r1</span><br><span class="line">reg1=s[31]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 30!=r1</span><br><span class="line">reg1=s[32]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[33]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[34]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[35]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">reg2= 5</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 7</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg2= 2565961507</span><br><span class="line">reg1&amp;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg2= 904182048</span><br><span class="line">reg1&amp;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 18</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">cmp reg1=1877735783</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[36]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[37]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[38]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[39]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">reg9=reg1</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">cmp 3474130140, reg1</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[40]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[41]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[42]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[43]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">reg9=reg1</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">cmp 674991748, reg1</span><br><span class="line">jne exit</span><br></pre></td></tr></table></figure><p>前面异或直接给ai破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">fog = [<span class="number">0x0000007B</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000037</span>, <span class="number">0x000000E8</span>]</span><br><span class="line">s = [<span class="literal">None</span>] * <span class="number">32</span>  <span class="comment"># 创建一个长度为 32 的列表来存储 s 的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于每个 i，x 和 y 的值</span></span><br><span class="line"><span class="keyword">for</span> i, x, y <span class="keyword">in</span> [</span><br><span class="line">    (<span class="number">0</span>, fog[<span class="number">0</span>], <span class="number">74</span>), </span><br><span class="line">    (<span class="number">1</span>, fog[<span class="number">1</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">2</span>, fog[<span class="number">3</span>], <span class="number">221</span>), </span><br><span class="line">    (<span class="number">3</span>, fog[<span class="number">2</span>], <span class="number">15</span>), </span><br><span class="line">    (<span class="number">4</span>, fog[<span class="number">1</span>], <span class="number">27</span>), </span><br><span class="line">    (<span class="number">5</span>, fog[<span class="number">3</span>], <span class="number">137</span>), </span><br><span class="line">    (<span class="number">6</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">7</span>, fog[<span class="number">2</span>], <span class="number">84</span>), </span><br><span class="line">    (<span class="number">8</span>, fog[<span class="number">0</span>], <span class="number">79</span>), </span><br><span class="line">    (<span class="number">9</span>, fog[<span class="number">0</span>], <span class="number">78</span>), </span><br><span class="line">    (<span class="number">10</span>, fog[<span class="number">2</span>], <span class="number">85</span>), </span><br><span class="line">    (<span class="number">11</span>, fog[<span class="number">2</span>], <span class="number">86</span>), </span><br><span class="line">    (<span class="number">12</span>, fog[<span class="number">3</span>], <span class="number">142</span>), </span><br><span class="line">    (<span class="number">13</span>, fog[<span class="number">1</span>], <span class="number">73</span>), </span><br><span class="line">    (<span class="number">14</span>, fog[<span class="number">2</span>], <span class="number">14</span>), </span><br><span class="line">    (<span class="number">15</span>, fog[<span class="number">0</span>], <span class="number">75</span>), </span><br><span class="line">    (<span class="number">16</span>, fog[<span class="number">2</span>], <span class="number">6</span>), </span><br><span class="line">    (<span class="number">17</span>, fog[<span class="number">2</span>], <span class="number">84</span>), </span><br><span class="line">    (<span class="number">18</span>, fog[<span class="number">1</span>], <span class="number">26</span>), </span><br><span class="line">    (<span class="number">19</span>, fog[<span class="number">0</span>], <span class="number">66</span>), </span><br><span class="line">    (<span class="number">20</span>, fog[<span class="number">2</span>], <span class="number">83</span>), </span><br><span class="line">    (<span class="number">21</span>, fog[<span class="number">0</span>], <span class="number">31</span>), </span><br><span class="line">    (<span class="number">22</span>, fog[<span class="number">2</span>], <span class="number">82</span>), </span><br><span class="line">    (<span class="number">23</span>, fog[<span class="number">3</span>], <span class="number">219</span>), </span><br><span class="line">    (<span class="number">24</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">25</span>, fog[<span class="number">3</span>], <span class="number">217</span>), </span><br><span class="line">    (<span class="number">26</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">27</span>, fog[<span class="number">2</span>], <span class="number">85</span>), </span><br><span class="line">    (<span class="number">28</span>, fog[<span class="number">1</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">29</span>, fog[<span class="number">2</span>], <span class="number">0</span>), </span><br><span class="line">    (<span class="number">30</span>, fog[<span class="number">0</span>], <span class="number">75</span>), </span><br><span class="line">    (<span class="number">31</span>, fog[<span class="number">1</span>], <span class="number">30</span>)</span><br><span class="line">]:  </span><br><span class="line"></span><br><span class="line">    s[i] = <span class="built_in">chr</span>(y ^ x)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#16584abc45baff901c59dde3b1bb6701</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">characters = string.ascii_letters + string.digits + string.punctuation + <span class="string">&#x27; &#x27;</span></span><br><span class="line">combinations = itertools.product(characters, repeat=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">对每个组合执行给定的操作</span><br><span class="line"><span class="keyword">for</span> combination <span class="keyword">in</span> combinations:</span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join(combination)</span><br><span class="line">    reg = [<span class="number">0</span>] * <span class="number">10</span>  </span><br><span class="line">    reg[<span class="number">9</span>] = <span class="built_in">int</span>.from_bytes(s.encode(), <span class="string">&#x27;big&#x27;</span>)  </span><br><span class="line">    <span class="comment"># 将字符串转换为整数,这里用big，存储就是正序，不然是小端序转换</span></span><br><span class="line"></span><br><span class="line">    reg[<span class="number">1</span>] = reg[<span class="number">9</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">7</span></span><br><span class="line">    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">2565961507</span></span><br><span class="line">    reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">904182048</span></span><br><span class="line">    reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">18</span></span><br><span class="line">    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查结果是否等于 1877735783</span></span><br><span class="line">    <span class="keyword">if</span> reg[<span class="number">1</span>] == <span class="number">1877735783</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;找到了满足条件的字符串：<span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># a245</span></span><br></pre></td></tr></table></figure><p>第二部分有与，不可能逆出来，干脆爆破</p><p>后面两次有左移，不好用python，就用c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">// 所有可能的字符</span></span><br><span class="line"><span class="type">char</span> characters[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化寄存器</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> reg[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对每一个组合进行检查</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(characters); i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(characters); j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(characters); k++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt; <span class="built_in">strlen</span>(characters); l++) &#123;</span><br><span class="line"><span class="type">char</span> s[<span class="number">40</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">s[<span class="number">36</span>] = characters[i];</span><br><span class="line">s[<span class="number">37</span>] = characters[j];</span><br><span class="line">s[<span class="number">38</span>] = characters[k];</span><br><span class="line">s[<span class="number">39</span>] = characters[l];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行给定的操作</span></span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">36</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">24</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">37</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">38</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">8</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">39</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查结果</span></span><br><span class="line"><span class="keyword">if</span> (reg[<span class="number">1</span>] == <span class="number">3474130140</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Found matching combination: %c%c%c%c\n&quot;</span>, s[<span class="number">36</span>], s[<span class="number">37</span>], s[<span class="number">38</span>], s[<span class="number">39</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No matching combination found.\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//b06c</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 所有可能的字符</span></span><br><span class="line">    <span class="type">char</span> characters[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化寄存器</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> reg[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对每一个组合进行检查</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(characters); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(characters); j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(characters); k++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt; <span class="built_in">strlen</span>(characters); l++) &#123;</span><br><span class="line">                    <span class="type">char</span> s[<span class="number">44</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">                    s[<span class="number">40</span>] = characters[i];</span><br><span class="line">                    s[<span class="number">41</span>] = characters[j];</span><br><span class="line">                    s[<span class="number">42</span>] = characters[k];</span><br><span class="line">                    s[<span class="number">43</span>] = characters[l];</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 执行给定的操作</span></span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">40</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">24</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">41</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">42</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">8</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">43</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">                    reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">                    reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 检查结果</span></span><br><span class="line">                    <span class="keyword">if</span> (reg[<span class="number">1</span>] == <span class="number">674991748</span>) &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;Found matching combination: %c%c%c%c\n&quot;</span>, s[<span class="number">40</span>], s[<span class="number">41</span>], s[<span class="number">42</span>], s[<span class="number">43</span>]);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;No matching combination found.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dc23</span></span><br></pre></td></tr></table></figure><p>最后合并一下flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;<span class="number">16584</span>abc45baff901c59dde3b1bb6701a254b06cdc23&#125;</span><br></pre></td></tr></table></figure><p>这个题最后很明显是不能直接逆向的，那就需要爆破，所以翻译opcode的时候写成python语法或者c语法就会更方便，然后注意一下爆破的时候的大端序和小端序就好了</p><h2 id="羊城杯2023-vm-wo"><a href="#羊城杯2023-vm-wo" class="headerlink" title="羊城杯2023 vm_wo"></a>羊城杯2023 vm_wo</h2><p>这道题是我第一次遇见mac的题</p><p>一开始用ida 8.3打开，但是不能反编译，去网上看wp发现好像都能反编译，于是试了试7.7结果就可以了&gt;_&lt;</p><p>打开之后直接去主函数，直接拿到了last</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0xDF</span>, <span class="number">0xD5</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0xDB</span>, <span class="number">0xA1</span>, <span class="number">0xA5</span>, <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0xE9</span>, <span class="number">0x95</span>, <span class="number">0xB3</span>, <span class="number">0x9D</span>, <span class="number">0xE9</span>, <span class="number">0xB3</span>, <span class="number">0x85</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0xE9</span>, <span class="number">0xB1</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, <span class="number">0x91</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0xAD</span>]</span><br></pre></td></tr></table></figure><p>在之前进行了myoperate这个函数，应该是encode<br>然后就是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">myoperate</span><span class="params">(<span class="type">char</span> *flag, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 i; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">15</span>]; <span class="comment">// [xsp+8h] [xbp-98h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">15</span>]; <span class="comment">// [xsp+18h] [xbp-88h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">15</span>]; <span class="comment">// [xsp+28h] [xbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> code[<span class="number">16</span>]; <span class="comment">// [xsp+38h] [xbp-68h] BYREF</span></span><br><span class="line">  __int64 v8; <span class="comment">// [xsp+48h] [xbp-58h]</span></span><br><span class="line"></span><br><span class="line">  LODWORD(i) = len;</span><br><span class="line">  v8 = <span class="number">0x100000CFEEDFA</span>LL;</span><br><span class="line">  dword_100008003 = <span class="number">0xBEEDBEEF</span>;</span><br><span class="line">  <span class="keyword">if</span> ( ptrace(<span class="number">0</span>, <span class="number">0</span>, (<span class="type">caddr_t</span>)<span class="number">1</span>, <span class="number">0</span>) == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    i = (<span class="type">unsigned</span> <span class="type">int</span>)i;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)code = <span class="number">0x20D01011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;code[<span class="number">7</span>] = <span class="number">0x300010201180702</span>LL;</span><br><span class="line">      code[<span class="number">2</span>] = *flag;</span><br><span class="line">      interpretBytecode(code, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v6 = <span class="number">0x20D02011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v6[<span class="number">7</span>] = <span class="number">0x400010201180602</span>LL;</span><br><span class="line">      v6[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v6, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v5 = <span class="number">0x20D03011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v5[<span class="number">7</span>] = <span class="number">0x500010201180502</span>LL;</span><br><span class="line">      v5[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v5, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v4 = <span class="number">0x20D04011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v4[<span class="number">7</span>] = <span class="number">0x600010201180402</span>LL;</span><br><span class="line">      v4[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v4, <span class="number">15</span>);</span><br><span class="line">      *flag++ = ((<span class="type">unsigned</span> __int8)vm.body[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) | (<span class="number">8</span> * vm.body[<span class="number">0</span>]);</span><br><span class="line">      --i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( i );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个是opcode生成的位置，注意一共有15位同时第二位被换成了flag的值<br>相当于每轮对一个字符加密<br>所以写解密函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">t = [[<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x1</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x7</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x3</span>],</span><br><span class="line">     [<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x6</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x4</span>],</span><br><span class="line">     [<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x3</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x5</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x5</span>],</span><br><span class="line">    [ <span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x4</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x6</span>]]</span><br><span class="line"><span class="comment"># 0xff用作标志,表明这里使用了上一次加密后的这一位flag</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> t:</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># this_code = b[i]</span></span><br><span class="line">            code0 = b[i]</span><br><span class="line">            code1 = b[i+<span class="number">1</span>]</span><br><span class="line">            code2 = b[i+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> code0 == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>], s[<span class="subst">&#123;code2&#125;</span>] = s[<span class="subst">&#123;code2&#125;</span>], s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] ^= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">2</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] += <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">3</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] += s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">4</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">5</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">6</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] *= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">7</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] *= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">8</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] //= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">9</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] //= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">10</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">11</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">12</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[<span class="subst">&#123;code1&#125;</span>] &lt;&lt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">13</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[0] &lt;&lt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">14</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">15</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;print(s[<span class="subst">&#123;code1&#125;</span>])&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">16</span>:</span><br><span class="line">                i -= <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i -= 1&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;print(s[<span class="subst">&#123;i + <span class="number">16</span>&#125;</span>])&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">17</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;code2&#125;</span> if not s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">18</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;code2&#125;</span> if s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="comment"># elif code0 == 19:</span></span><br><span class="line">            <span class="comment">#     # i = code1</span></span><br><span class="line">            <span class="comment"># elif code0 == 20:</span></span><br><span class="line">            <span class="comment">#     # s[code1] = s[code1]</span></span><br><span class="line">            <span class="comment"># elif code0 == 21:</span></span><br><span class="line">            <span class="comment">#     # i -= 1</span></span><br><span class="line">            <span class="comment">#     # s[0] = s[i + 16]</span></span><br><span class="line">            <span class="comment"># elif code0 == 22:</span></span><br><span class="line">            <span class="comment">#     # s[i + 16] = code1</span></span><br><span class="line">            <span class="comment"># elif code0 == 23:</span></span><br><span class="line">            <span class="comment">#     break</span></span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">24</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[0] = byte_100008002 | byte_100008001&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">25</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[0] &gt;&gt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">26</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            i += <span class="number">3</span></span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(b):</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>] = flag[i]</span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">1</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">7</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">3</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">2</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">6</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">4</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">3</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">5</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">5</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">4</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">4</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">6</span>]</span><br></pre></td></tr></table></figure><p>但是我不理解的是byte_100008002和byte_100008001的值，不然没法或。。<br>去网上看了wp,看到了它们的dword_100008003和这两个值是一样的<br>（然后才发现那四个值在一起是个数组，前面还有3个寄存器，就是上面代码的s0,s1,s2）<br>就是</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">arr</span> = <span class="number">0</span>xDEEDBEEF.to_bytes(<span class="number">4</span>,<span class="string">&#x27;little&#x27;</span>)</span><br></pre></td></tr></table></figure><p>相当于这个dword是s &#x3D; [0,0,0xEF,0xBE,0xED,0xDE]放在这四个位置上,因为deadbeef是第四个上面放着<br>写一下解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0xDF</span>, <span class="number">0xD5</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0xDB</span>, <span class="number">0xA1</span>, <span class="number">0xA5</span>, </span><br><span class="line">        <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0xE9</span>, <span class="number">0x95</span>, <span class="number">0xB3</span>, <span class="number">0x9D</span>, <span class="number">0xE9</span>, <span class="number">0xB3</span>, </span><br><span class="line">        <span class="number">0x85</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0xE9</span>, <span class="number">0xB1</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, </span><br><span class="line">        <span class="number">0x91</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0xAD</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back</span>(<span class="params">k</span>):</span><br><span class="line">    q = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)):</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">            t = (s &gt;&gt; <span class="number">1</span> | (s &lt;&lt; <span class="number">7</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xef</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">2</span> | (t &lt;&lt; <span class="number">6</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xbe</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">3</span> | (t &lt;&lt; <span class="number">5</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xed</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">4</span> | (t &lt;&lt; <span class="number">4</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xde</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">5</span> | (t &lt;&lt; <span class="number">3</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">            <span class="keyword">if</span> (t == k[i]):</span><br><span class="line">                q.append(s)</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line">pl(back(last))</span><br></pre></td></tr></table></figure><p>?为什么出不来，好好好，不是deadbeef是beedbeef是吧,,6,改好之后</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DASCTF</span><span class="template-variable">&#123;you_are_right_so_cool&#125;</span></span><br></pre></td></tr></table></figure><hr><p>做完这几道题，感觉vm主要考把opcode转汇编，再把汇编转可读代码的静态分析能力，这里要分析出reg，stack的实现是哪些代码，如果能拿到opcode，就能分析出其中可能不用的case，省去一些时间</p><p>而且一般是用单字节加密，所以后面可以爆破答案，</p><p>如果用python写脚本，要注意左移时要限定范围不然会得不到正确结果</p><p>最后在第三道题，ida版本能直接影响到反编译的结果，最后用7.5版本才能正确反编译出来</p>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> VM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>polar_re部分wp</title>
      <link href="/posts/5a6db6c8.html"/>
      <url>/posts/5a6db6c8.html</url>
      
        <content type="html"><![CDATA[<p>这个polar的re感觉质量好低，不是太简单就是太恶心，写了5道不想写了QAQ</p><h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><p>用apktool解包，在assets文件中把zip文件名改成png得到flag</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;money<span class="number">_</span><span class="keyword">is</span><span class="number">_n</span>othing&#125;</span><br></pre></td></tr></table></figure><p>这题被坑了一个晚上，因为一开始尝试静态分析一关一关过，结果解包之后flag在图片里面，之后看到这种可以逆出资源的可以先尝试把资源找出来，说不定就是flag，<del>建议把这道题放到misc</del></p><h3 id="老八小冒险"><a href="#老八小冒险" class="headerlink" title="老八小冒险"></a>老八小冒险</h3><p>这个题挺简单的，甚至都是原始工程文件，没有打包也不用解包</p><p>直接用rpgmaker vx ace打开，直接看事件就好了</p><p>jbkjckjsdsfdsfjbkjckj的md5</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">60</span>b<span class="number">6</span>cd<span class="number">0848639100</span><span class="keyword">c</span><span class="number">68</span><span class="keyword">c</span><span class="number">04</span>d<span class="number">4884</span>db<span class="number">1e8</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="逢七必变"><a href="#逢七必变" class="headerlink" title="逢七必变"></a>逢七必变</h3><p>第一次见到aspack壳，尝试搜索工具脱壳,找到了，那么就直接使用，结果工具有问题，看来还是要一步一步调</p><p>打开之后，里面的代码好像很奇怪，代码看不懂，一开始call然后又返回，不理解，esp定律一开始也不好使&#x2F;</p><p>好吧，因为这个特征不一样，这个aspack壳的特点是一开始popad，然后call，最后popad，然后ret，在popad完对esp下断点然后点击运行，可以直接到ret的位置，之后f7一下，应该可以到一个call加jmp的位置，这里就是oep</p><p><img src="https://s2.loli.net/2024/03/04/6QyLedptHSumvg7.png" alt="image-20240304193949183"></p><p>在这个位置dump，然后打开dump的文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> len; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+14h] [ebp-110h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">256</span>]; <span class="comment">// [esp+20h] [ebp-104h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;akf`|7fda1005c?1b253bc17346b5c77bab?0z&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v6[<span class="number">39</span>], <span class="number">0</span>, <span class="number">0xD9</span>u);</span><br><span class="line">  len = <span class="built_in">strlen</span>(v6);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i )</span><br><span class="line">    v6[i] ^= <span class="number">7u</span>;</span><br><span class="line">  sub_5F1040(<span class="string">&quot;You got it!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后有手就行了</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">0</span>acf6772d86e524ed60431e2d00efe87&#125;</span><br></pre></td></tr></table></figure><h3 id="高卢战记"><a href="#高卢战记" class="headerlink" title="高卢战记"></a>高卢战记</h3><p>直接ida打开obj文件，看main函数</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">6f759f8f7</span>:deg::<span class="number">796486</span>&lt;<span class="number">8</span>&lt;<span class="number">8</span>edf9:<span class="number">73</span></span><br></pre></td></tr></table></figure><p>只有一个这个然后就输出了这个</p><p>一开始看不懂</p><p>结果。。因为《高卢战记》是凯撒写的，书里面用的3的位移，所以要用-3</p><p>这样接出来就是flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">3</span><span class="keyword">c</span><span class="number">426</span><span class="keyword">c</span><span class="number">5</span><span class="keyword">c</span><span class="number">47</span>abd<span class="number">774631539595</span>bac<span class="number">6740</span>&#125;</span><br></pre></td></tr></table></figure><p>真恶心，为什么不是misc</p><h3 id="最短路"><a href="#最短路" class="headerlink" title="最短路"></a>最短路</h3><p>直接得到最短26</p><p>画图或者ai（比ai还快）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">from</span> <span class="string">prism</span> <span class="string">import</span> <span class="string">*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">import</span> <span class="string">heapq</span></span><br><span class="line"></span><br><span class="line"><span class="string">def</span> <span class="string">dijkstra(graph,</span> <span class="string">start,</span> <span class="string">end):</span></span><br><span class="line">    <span class="string">heap</span> <span class="string">=</span> [<span class="string">(0</span>, <span class="string">start)</span>]</span><br><span class="line">    <span class="string">distances</span> <span class="string">=</span> &#123;<span class="attr">node:</span> <span class="string">float(&#x27;infinity&#x27;)</span> <span class="string">for</span> <span class="string">node</span> <span class="string">in</span> <span class="string">graph</span>&#125;</span><br><span class="line">    <span class="string">distances[start]</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line">    <span class="string">paths</span> <span class="string">=</span> &#123;<span class="attr">start:</span> []&#125;</span><br><span class="line"></span><br><span class="line">    <span class="attr">while heap:</span></span><br><span class="line">        <span class="string">(dist,</span> <span class="string">current)</span> <span class="string">=</span> <span class="string">heapq.heappop(heap)</span></span><br><span class="line">        <span class="string">if</span> <span class="string">dist</span> <span class="string">&gt;</span> <span class="string">distances[current]:</span></span><br><span class="line">            <span class="string">continue</span></span><br><span class="line">        <span class="string">for</span> <span class="string">neighbor,</span> <span class="string">neighbor_dist</span> <span class="string">in</span> <span class="string">graph[current].items():</span></span><br><span class="line">            <span class="string">old_dist</span> <span class="string">=</span> <span class="string">distances[neighbor]</span></span><br><span class="line">            <span class="string">new_dist</span> <span class="string">=</span> <span class="string">dist</span> <span class="string">+</span> <span class="string">neighbor_dist</span></span><br><span class="line">            <span class="string">if</span> <span class="string">new_dist</span> <span class="string">&lt;</span> <span class="attr">old_dist:</span></span><br><span class="line">                <span class="string">distances[neighbor]</span> <span class="string">=</span> <span class="string">new_dist</span></span><br><span class="line">                <span class="string">paths[neighbor]</span> <span class="string">=</span> <span class="string">paths[current]</span> <span class="string">+</span> [<span class="string">neighbor</span>]</span><br><span class="line">                <span class="string">heapq.heappush(heap,</span> <span class="string">(new_dist,</span> <span class="string">neighbor))</span></span><br><span class="line">    <span class="string">return</span> <span class="string">distances[end],</span> <span class="string">paths[end]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义图的边和权重</span></span><br><span class="line"><span class="string">graph</span> <span class="string">=</span> &#123;</span><br><span class="line">    <span class="attr">1:</span> &#123;<span class="attr">2:</span> <span class="number">2</span>, <span class="attr">3:</span> <span class="number">3</span>&#125;,</span><br><span class="line">    <span class="attr">2:</span> &#123;<span class="attr">3:</span> <span class="number">5</span>, <span class="attr">4:</span> <span class="number">3</span>, <span class="attr">10:</span> <span class="number">20</span>&#125;,</span><br><span class="line">    <span class="attr">3:</span> &#123;<span class="attr">5:</span> <span class="number">6</span>, <span class="attr">8:</span> <span class="number">5</span>&#125;,</span><br><span class="line">    <span class="attr">4:</span> &#123;<span class="attr">5:</span> <span class="number">7</span>&#125;,</span><br><span class="line">    <span class="attr">5:</span> &#123;<span class="attr">9:</span> <span class="number">4</span>, <span class="attr">8:</span> <span class="number">1</span>&#125;,</span><br><span class="line">    <span class="attr">6:</span> &#123;<span class="attr">7:</span> <span class="number">3</span>&#125;,</span><br><span class="line">    <span class="attr">7:</span> &#123;<span class="attr">14:</span> <span class="number">6</span>&#125;,</span><br><span class="line">    <span class="attr">8:</span> &#123;<span class="attr">11:</span> <span class="number">5</span>, <span class="attr">15:</span> <span class="number">21</span>&#125;,</span><br><span class="line">    <span class="attr">9:</span> &#123;<span class="attr">12:</span> <span class="number">5</span>&#125;,</span><br><span class="line">    <span class="attr">10:</span> &#123;&#125;,</span><br><span class="line">    <span class="attr">11:</span> &#123;<span class="attr">15:</span> <span class="number">13</span>&#125;,</span><br><span class="line">    <span class="attr">12:</span> &#123;<span class="attr">15:</span> <span class="number">9</span>&#125;,</span><br><span class="line">    <span class="attr">14:</span> &#123;<span class="attr">15:</span> <span class="number">7</span>&#125;,</span><br><span class="line">    <span class="attr">15:</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行Dijkstra算法</span></span><br><span class="line"><span class="string">distance,</span> <span class="string">path</span> <span class="string">=</span> <span class="string">dijkstra(graph,</span> <span class="number">1</span><span class="string">,</span> <span class="number">15</span><span class="string">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="string">print(f&quot;最短距离:</span> &#123;<span class="string">distance</span>&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">print(f&quot;</span><span class="string">路径:</span> &#123;<span class="string">&#x27; -&gt; &#x27;</span><span class="string">.join(map(str</span>, <span class="string">path))</span>&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">pmd5(&quot;</span><span class="number">1381115</span><span class="string">&quot;)</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">4991</span>ce1781b53409a7a84e2baf9431d6&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>青少年ctf#1 wp</title>
      <link href="/posts/c4803d60.html"/>
      <url>/posts/c4803d60.html</url>
      
        <content type="html"><![CDATA[<p>不知为何，密码比逆向做的多，但是不会密码也不会逆向</p><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="解个方程"><a href="#解个方程" class="headerlink" title="解个方程"></a>解个方程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line">p = <span class="number">88405749077010121197972538332505989817</span></span><br><span class="line">q = <span class="number">314336612126421969080144444342415739457</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><p>这个是动态flag</p><h3 id="ez-log"><a href="#ez-log" class="headerlink" title="ez_log"></a>ez_log</h3><p>这个题是求离散对数，g&#x3D;3，直接用函数求</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line">p=<span class="number">3006156660704242356836102321001016782090189571028526298055526061772989406357037170723984497344618257575827271367883545096587962708266010793826346841303043716776726799898939374985320242033037</span></span><br><span class="line">g = <span class="number">3</span></span><br><span class="line">c=<span class="number">2637361207438328172880452774725735558448205624296999428196250415451022718950315626464793126507500112508727744681450551541566511482157902377105193512791814667446983536196889757495426692091900</span></span><br><span class="line"></span><br><span class="line">m = discrete_log(p, c, g)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>也是动态flag</p><h3 id="四重加密"><a href="#四重加密" class="headerlink" title="四重加密"></a>四重加密</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">base32:</span></span><br><span class="line"><span class="language-xml">qsnctf</span></span><br><span class="line"><span class="language-xml">ascii code:</span></span><br><span class="line"><span class="language-xml">zcye</span><span class="template-variable">&#123;mxmemtxrzt_lzbha_kwmqzec&#125;</span><span class="language-xml">|key=hello</span></span><br><span class="line"><span class="language-xml">维吉尼亚：</span></span><br><span class="line"><span class="language-xml">synt</span><span class="template-variable">&#123;yqitbfqnoi_xsxwp_wpifoqv&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">凯撒:</span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;ldvgosdabv_kfkjc_jcvsbdi&#125;</span></span><br></pre></td></tr></table></figure><p>把flag改成qsnctf就好</p><h3 id="ez-rsa"><a href="#ez-rsa" class="headerlink" title="ez_rsa"></a>ez_rsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;qsnctf&#123;xxx-xxxx-xxxx-xxxx-xxxxxxxxx&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line">leak = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak = <span class="subst">&#123;leak&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>相当于已知r,e,c求m</p><p>我们知道<br>$$<br>c &#x3D; m^e \mod pqr\iff\<br>c &#x3D; m^e + kpqr\iff\<br>c &#x3D; m^e + (kpq)r\iff\<br>c &#x3D; m^e \mod r<br>$$<br>那么就可以解出来了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gy</span><br><span class="line"></span><br><span class="line">c = <span class="number">173595148273920891298949441727054328036798235134009407863895058729356993814829340513336567479145746034781201823694596731886346933549577879568197521436900228804336056005940048086898794965549472641334237175801757569154295743915744875800647234151498117718087319013271748204766997008772782882813572814296213516343420236873651060868227487925491016675461540894535563805130406391144077296854410932791530755245514034242725719196949258860635915202993968073392778882692892</span></span><br><span class="line">n = <span class="number">1396260492498511956349135417172451037537784979103780135274615061278987700332528182553755818089525730969834188061440258058608031560916760566772742776224528590152873339613356858551518007022519033843622680128062108378429621960808412913676262141139805667510615660359775475558729686515755127570976326233255349428771437052206564497930971797497510539724340471032433502724390526210100979700467607197448780324427953582222885828678441579349835574787605145514115368144031247</span></span><br><span class="line">leak = <span class="number">152254254502019783796170793516692965417859793325424454902983763285830332059600151137162944897787532369961875766745853731769162511788354655291037150251085942093411304833287510644995339391240164033052417935316876168953838783742499485868268986832640692657031861629721225482114382472324320636566226653243762620647</span></span><br><span class="line">r = n // leak</span><br><span class="line">phi = r-<span class="number">1</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = gy.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,r)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#qsnctf&#123;12ff81e0-7646-4a96-a7eb-6a509ec01c9e&#125;</span></span><br></pre></td></tr></table></figure><p>根据这道题可以知道：已知c,e,和n的任意一个因子（如果这个因子可以求phi）那就可以直接解</p><h3 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h3><p>这个题是第一次见</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">d = getPrime(<span class="number">256</span>)</span><br><span class="line">e = gmpy2.invert(d, (p**<span class="number">2</span> - <span class="number">1</span>) * (q**<span class="number">2</span> - <span class="number">1</span>))</span><br><span class="line">flag = <span class="string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(p+q).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span></span><br><span class="line"><span class="comment"># 78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到这个题很神奇的地方在于(p<em>*2 - 1) * (q</em>*2 - 1),所以我去搜了一下，就搜到攻击脚本了</p><p><a href="https://www.cnblogs.com/tr0uble/p/17106202.html#/c/subject/p/17106202.html">Cryptanalysis of RSA Variants with Primes Sharing Most Significant Bits - tr0uble - 博客园 (cnblogs.com)</a></p><p>好像叫LUC，用连分数方法攻击，但是看不懂，有机会之后看看</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">N, e</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors of a modulus and the private exponent if two prime factors share most significant bits</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param e: the public exponent</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors and the private exponent, or None if the private exponent was not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    PR = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = PR.gen()</span><br><span class="line">    convergents = continued_fraction(ZZ(e) / ZZ((N-<span class="number">1</span>)**<span class="number">2</span>)).convergents()</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> convergents:</span><br><span class="line">        k = c.numerator()</span><br><span class="line">        d = c.denominator()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = x**<span class="number">2</span> - x*(N**<span class="number">2</span> + <span class="number">1</span> - <span class="built_in">int</span>((e*d-<span class="number">1</span>)/k)) + N**<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> f.discriminant() &gt; <span class="number">0</span>:</span><br><span class="line">                root = f.roots()</span><br><span class="line">                p2 = root[<span class="number">0</span>][<span class="number">0</span>]; q2 = root[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> is_square(p2) <span class="keyword">and</span> is_square(q2):</span><br><span class="line">                    p = isqrt(p2); q = isqrt(q2)</span><br><span class="line">                    <span class="keyword">if</span> p*q == N:</span><br><span class="line">                        <span class="keyword">return</span> p, q, d</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span></span><br><span class="line">n = <span class="number">78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span></span><br><span class="line">p=q=d=<span class="number">0</span></span><br><span class="line">p,q,d = attack(n,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(p + q))</span><br></pre></td></tr></table></figure><p>这个是sage</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">17842948407837550252915901438494310860377505026658598797918460167146832545038336985103505761787935094014130901091944301325113646047622033244783641463109866</span>\</span><br><span class="line"><span class="attribute">qsnctf</span>&#123;<span class="number">8072</span>e8b2982bc729cc74ef58f1abc862&#125;</span><br></pre></td></tr></table></figure><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><p>那个txt一打开，好像看不出来是什么，到最后发现504d0304那就是压缩包了，写个脚本生成文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_bin</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f_in, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">        <span class="keyword">for</span> i, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(f_in):</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:  <span class="comment"># 每隔一行处理一次</span></span><br><span class="line">                hex_str = line[<span class="number">10</span>:<span class="number">57</span>].replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 从第11个字符开始，读取到第57个字符</span></span><br><span class="line">                bin_data = <span class="built_in">bytes</span>.fromhex(hex_str)</span><br><span class="line">                f_out.write(bin_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hex_to_bin(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;output.zip&#x27;</span>)</span><br><span class="line"><span class="comment">#这边事先处理成正的了</span></span><br></pre></td></tr></table></figure><p>output.zip直接爆破，因为说了是小写和数字</p><p>z12345，得到flag图片拼接即可</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">qsnctf</span><span class="template-variable">&#123;b414e3e3a6449ddba0997db259203eb7&#125;</span></span><br></pre></td></tr></table></figure><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="来打cs咯"><a href="#来打cs咯" class="headerlink" title="来打cs咯"></a>来打cs咯</h3><p>文件描述不要在实体机打开</p><p>于是在win10虚拟机中sandboxie中尝试用ida调试</p><p>但是打开后函数很杂，看不出来在干什么</p><p>网上查查这种题该怎么做，看到要放到在线沙箱中分析一下</p><p>直接拿到</p><p>10.0.80.253:8118</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">qsnctf</span>&#123;<span class="number">10.0.80.253:8118</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2024 week4 RE wp</title>
      <link href="/posts/f5113ec1.html"/>
      <url>/posts/f5113ec1.html</url>
      
        <content type="html"><![CDATA[<p>这次re至少能看懂</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="again"><a href="#again" class="headerlink" title="again!"></a>again!</h3><p>打开后发现一个py打包的exe和bin2.pyc</p><p>反编译一下第一个文件,说是要用这个文件去解密bin2,但是看不懂QAQ</p><p>但是二进制形式打开bin2，观察可以发现出现大量一样的</p><p>a405b5d321e446459d8f9169d027bd92</p><p>怀疑是异或，所以</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_with_key</span>(<span class="params">input_file, key, output_file</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fin, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fout:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            chunk = fin.read(<span class="number">32</span>)  </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(chunk) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            data = <span class="built_in">bytearray</span>(<span class="built_in">len</span>(chunk))</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chunk)):</span><br><span class="line">                data[i] = chunk[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])  </span><br><span class="line">            fout.write(data)  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;a405b5d321e446459d8f9169d027bd92&quot;</span>  </span><br><span class="line">xor_with_key(<span class="string">&#x27;bin2&#x27;</span>, key, <span class="string">&#x27;output.bin&#x27;</span>)</span><br></pre></td></tr></table></figure><p>然后得到的文件再二进制打开一下，是winPE，就ida打开</p><p>主函数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> key[<span class="number">6</span>]; <span class="comment">// [rsp+20h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_140001020(<span class="string">&quot;plz input your flag:&quot;</span>);</span><br><span class="line">  sub_140001080(<span class="string">&quot;%32s&quot;</span>,flag);</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x1234</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x2341</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x3412</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x4123</span>;</span><br><span class="line">  encode(key);</span><br><span class="line">  i = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( flag[i] == *(_DWORD *)((<span class="type">char</span> *)&amp;check + i * <span class="number">4</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt;= <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140001020(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001020(<span class="string">&quot;Wrong!try again...&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看起来就是flag以dword来加密然后比较,encode里面是一个TEA变体，直接逆就好了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s6;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> delta;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s5;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s4; <span class="comment">// r15d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s3; <span class="comment">// r14d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s2; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s1; <span class="comment">// esi</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s0; <span class="comment">// r11d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// ebx</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s7; <span class="comment">// [rsp+40h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flag[<span class="number">8</span>] = &#123; <span class="number">0x506FB5C3</span>, <span class="number">0xB9358F45</span>, <span class="number">0xC91AE8C7</span>, <span class="number">0x3820E280</span>, <span class="number">0xD13ABA83</span>, <span class="number">0x975CF554</span>, <span class="number">0x4352036B</span>, <span class="number">0x1CD20447</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00001234</span>, <span class="number">0x00002341</span>, <span class="number">0x00003412</span>, <span class="number">0x00004123</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key_[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00001234</span>, <span class="number">0x00002341</span>, <span class="number">0x00003412</span>, <span class="number">0x00004123</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">s7 = flag[<span class="number">7</span>];</span><br><span class="line">s1 = flag[<span class="number">1</span>];</span><br><span class="line">s2 = flag[<span class="number">2</span>];</span><br><span class="line">s3 = flag[<span class="number">3</span>];</span><br><span class="line">s4 = flag[<span class="number">4</span>];</span><br><span class="line">s5 = flag[<span class="number">5</span>];</span><br><span class="line">s6 = flag[<span class="number">6</span>];</span><br><span class="line">s0 = flag[<span class="number">0</span>];</span><br><span class="line">delta = <span class="number">0</span>;</span><br><span class="line">delta += <span class="number">0x7937B99E</span> * <span class="number">12</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++) &#123;</span><br><span class="line">v11 = key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">s7 -= (((s6 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">3</span>]) + (delta ^ flag[<span class="number">0</span>])) ^ (((<span class="number">16</span> * s6) ^ (flag[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>)) + ((s6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * flag[<span class="number">0</span>]))));</span><br><span class="line">s6 -= ((s5 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">2</span>]) + (delta ^ s7)) ^ (((<span class="number">16</span> * s5) ^ (s7 &gt;&gt; <span class="number">3</span>)) + ((s5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s7)));</span><br><span class="line">s5 -= ((delta ^ s6) + (s4 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">1</span>])) ^ (((<span class="number">16</span> * s4) ^ (s6 &gt;&gt; <span class="number">3</span>)) + ((s4 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s6)));</span><br><span class="line"><span class="comment">//flag[0] = s0;</span></span><br><span class="line">s4 -= ((delta ^ s5) + (s3 ^ v11)) ^ (((<span class="number">16</span> * s3) ^ (s5 &gt;&gt; <span class="number">3</span>)) + ((s3 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s5)));</span><br><span class="line">s3 -= ((delta ^ s4) + (s2 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">3</span>])) ^ (((<span class="number">16</span> * s2) ^ (s4 &gt;&gt; <span class="number">3</span>)) + ((s2 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s4)));</span><br><span class="line">s2 -= ((delta ^ s3) + (s1 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">2</span>])) ^ (((<span class="number">16</span> * s1) ^ (s3 &gt;&gt; <span class="number">3</span>)) + ((s1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s3)));</span><br><span class="line">s1 -= ((delta ^ s2) + (flag[<span class="number">0</span>] ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">1</span>])) ^ (((<span class="number">16</span> * flag[<span class="number">0</span>]) ^ (s2 &gt;&gt; <span class="number">3</span>)) + ((flag[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s2)));</span><br><span class="line"><span class="comment">//s0 = flag[0] - (((delta ^ s1) + (s7 ^ v11)) ^ (((16 * s7) ^ (s1 &gt;&gt; 3)) + ((s7 &gt;&gt; 5) ^ (4 * s1))));</span></span><br><span class="line">flag[<span class="number">0</span>] -= (((delta ^ s1) + (s7 ^ v11)) ^ (((<span class="number">16</span> * s7) ^ (s1 &gt;&gt; <span class="number">3</span>)) + ((s7 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s1))));</span><br><span class="line">delta -= <span class="number">0x7937B99E</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag[0] = s0;</span></span><br><span class="line">flag[<span class="number">7</span>] = s7;</span><br><span class="line">flag[<span class="number">1</span>] = s1;</span><br><span class="line">flag[<span class="number">2</span>] = s2;</span><br><span class="line">flag[<span class="number">3</span>] = s3;</span><br><span class="line">flag[<span class="number">4</span>] = s4;</span><br><span class="line">flag[<span class="number">5</span>] = s5;</span><br><span class="line">flag[<span class="number">6</span>] = s6;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">cout &lt;&lt; hex &lt;&lt; flag[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//6d616768</span></span><br><span class="line"><span class="comment">//74627b65</span></span><br><span class="line"><span class="comment">//695f6165</span></span><br><span class="line"><span class="comment">//5f615f73</span></span><br><span class="line"><span class="comment">//64726168</span></span><br><span class="line"><span class="comment">//636e655f</span></span><br><span class="line"><span class="comment">//74707972</span></span><br><span class="line"><span class="comment">//7d6e6f69</span></span><br><span class="line"><span class="comment">//hgame&#123;btea_is_a_hard_encryption&#125;</span></span><br></pre></td></tr></table></figure><h3 id="change"><a href="#change" class="headerlink" title="change"></a>change</h3><p>直接ida打开<br>主函数如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF787FD21E0(v10, <span class="string">&quot;am2qasl&quot;</span>, envp);</span><br><span class="line">  v6 = <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;__ExceptionPtr&gt;::operator=((__int64)v7, v10);</span><br><span class="line">  sub_7FF787FD2280(a, v6);</span><br><span class="line">  sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;plz input your flag:&quot;</span>);</span><br><span class="line">  sub_7FF787FD10F0(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;flag);</span><br><span class="line">  sub_7FF787FD29A0((__int64)a, (__int64)b, (__int64)&amp;flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    last = byte_7FF787FD8000[i];</span><br><span class="line">    <span class="keyword">if</span> ( last != *(<span class="type">char</span> *)sub_7FF787FD2960((__int64)b, i) )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;sry,try again...&quot;</span>);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(b);</span><br><span class="line">      sub_7FF787FD2780(a);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v10);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(b);</span><br><span class="line">  sub_7FF787FD2780(a);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v10);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>化简一下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF787FD10F0(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;flag);</span><br><span class="line">  sub_7FF787FD29A0((__int64)a, (__int64)b, (__int64)&amp;flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    last = byte_7FF787FD8000[i];</span><br><span class="line">    <span class="keyword">if</span> ( last != *(<span class="type">char</span> *)sub_7FF787FD2960((__int64)b, i) )</span><br></pre></td></tr></table></figure><p>那就完了，sub_7FF787FD29A0肯定是加密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_7FF787FD29A0</span><span class="params">(_QWORD *a, _QWORD *b, _QWORD *flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-58h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> Duration; <span class="comment">// [rsp+28h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+30h] [rbp-48h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+48h] [rbp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// [rsp+58h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;__ExceptionPtr&gt;::operator=((__int64)b, flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="type">unsigned</span> __int64)unknown_libname_20(b); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i % <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD2D20(sub_7FF787FD3670);</span><br><span class="line">      v11 = unknown_libname_20(a);</span><br><span class="line">      v9 = *(<span class="type">char</span> *)sub_7FF787FD2960(a, i % v11);</span><br><span class="line">      v5 = (<span class="type">char</span> *)sub_7FF787FD2960(b, i);</span><br><span class="line">      beep(*v5, v9);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD2D20(sub_7FF787FD3650);</span><br><span class="line">      v10 = unknown_libname_20(a);</span><br><span class="line">      Duration = *(<span class="type">char</span> *)sub_7FF787FD2960(a, i % v10);</span><br><span class="line">      v3 = (<span class="type">char</span> *)sub_7FF787FD2960(b, i);</span><br><span class="line">      beep(*v3, Duration);</span><br><span class="line">    &#125;</span><br><span class="line">    *(_BYTE *)sub_7FF787FD2960(b, i) = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据奇数位和偶数位来分别加密：</p><p>奇数位直接和key异或<br>偶数位异或完加10</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">last = cal([<span class="number">0x13</span>, <span class="number">0x0A</span>, <span class="number">0x5D</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0x08</span>, <span class="number">0x23</span>, <span class="number">0x06</span>, </span><br><span class="line">        <span class="number">0x0B</span>, <span class="number">0x4B</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x0D</span>, <span class="number">0x1C</span>, <span class="number">0x48</span>, <span class="number">0x0C</span>, </span><br><span class="line">        <span class="number">0x66</span>, <span class="number">0x15</span>, <span class="number">0x48</span>, <span class="number">0x1B</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x10</span>, <span class="number">0x4F</span>, </span><br><span class="line">        ])</span><br><span class="line">a = cal([<span class="number">0x61</span>, <span class="number">0x6D</span>, <span class="number">0x32</span>, <span class="number">0x71</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x6C</span>])</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">        <span class="keyword">if</span> (i%<span class="number">2</span>):</span><br><span class="line">                c += <span class="built_in">chr</span>(last[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                c += <span class="built_in">chr</span>(last[i]-<span class="number">10</span>)</span><br><span class="line">pxor(c,a)</span><br><span class="line"><span class="comment">#hgame&#123;ugly_Cpp_and_hook&#125;</span></span><br></pre></td></tr></table></figure><h3 id="crackme2"><a href="#crackme2" class="headerlink" title="crackme2"></a>crackme2</h3><p>这个题把我坑惨了……</p><p>ida打开之后反编译有标红，对应位置的指令是：mov     byte ptr ds:0, 1<br>于是准备先不管，去看主体逻辑</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sub_1400035C4(<span class="string">&quot;%50s&quot;</span>, v6);</span><br><span class="line">MEMORY[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">v3 = sub_14000105C(v6);</span><br><span class="line">v4 = <span class="string">&quot;right flag!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> ( !v3 )</span><br><span class="line">  v4 = <span class="string">&quot;wrong flag!&quot;</span>;</span><br><span class="line"><span class="built_in">puts</span>(v4);</span><br></pre></td></tr></table></figure><p>很明显v6是flag，v3是最后的校验信息1或0</p><p>sub_14000105C打开后是换表base64</p><p>解密后发现是hgame{th1s_i5_fake_fl4g}假的，那哪里有问题呢</p><p>既然不能正确反编译主函数，那就尝试直接读汇编指令</p><p><img src="https://s2.loli.net/2024/02/26/uNo8mcwDzBqjpRF.png" alt="image-20240226194726601"></p><p>在这一段发现了virtalprotect函数，好家伙！原来是加密了。</p><p>阅读后可知，是把加密函数和一个位置异或加密了，运行解密脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">start = 0x14000105C</span><br><span class="line">loop = 0x246a</span><br><span class="line">j = 0</span><br><span class="line">for i in range(start,loop+start):</span><br><span class="line">    patch_byte(i,get_wide_byte(i)^get_wide_byte(0x140006000+j))</span><br><span class="line">    j += 1</span><br></pre></td></tr></table></figure><p>在用u+c+p组合拳然后tab反汇编后是多项式方程，用z3求解即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1 = [BitVec(<span class="string">&#x27;a1[%i]&#x27;</span> % i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">v1 = a1[<span class="number">25</span>]</span><br><span class="line">v2 = a1[<span class="number">21</span>]</span><br><span class="line">v3 = a1[<span class="number">31</span>]</span><br><span class="line">v4 = a1[<span class="number">29</span>]</span><br><span class="line">v5 = a1[<span class="number">0</span>]</span><br><span class="line">v6 = a1[<span class="number">23</span>]</span><br><span class="line">v7 = a1[<span class="number">8</span>]</span><br><span class="line">v8 = a1[<span class="number">28</span>]</span><br><span class="line">v9 = a1[<span class="number">12</span>]</span><br><span class="line">v10 = a1[<span class="number">3</span>]</span><br><span class="line">v11 = a1[<span class="number">2</span>]</span><br><span class="line">v19 = a1[<span class="number">30</span>]</span><br><span class="line">v15 = a1[<span class="number">18</span>]</span><br><span class="line">v16 = a1[<span class="number">24</span>]</span><br><span class="line">v27 = a1[<span class="number">11</span>]</span><br><span class="line">v17 = a1[<span class="number">26</span>]</span><br><span class="line">v30 = a1[<span class="number">14</span>]</span><br><span class="line">v40 = a1[<span class="number">7</span>]</span><br><span class="line">v26 = a1[<span class="number">20</span>]</span><br><span class="line">v37 = <span class="number">2</span> * v26</span><br><span class="line">v42 = a1[<span class="number">22</span>]</span><br><span class="line">v28 = a1[<span class="number">1</span>]</span><br><span class="line">v25 = a1[<span class="number">27</span>]</span><br><span class="line">v21 = a1[<span class="number">19</span>]</span><br><span class="line">v23 = a1[<span class="number">16</span>]</span><br><span class="line">v31 = a1[<span class="number">13</span>]</span><br><span class="line">v29 = a1[<span class="number">10</span>]</span><br><span class="line">v41 = a1[<span class="number">5</span>]</span><br><span class="line">v24 = a1[<span class="number">4</span>]</span><br><span class="line">v20 = a1[<span class="number">15</span>]</span><br><span class="line">v39 = a1[<span class="number">17</span>]</span><br><span class="line">v22 = a1[<span class="number">6</span>]</span><br><span class="line">v18 = a1[<span class="number">9</span>]</span><br><span class="line">v33 = <span class="number">2</span> * v41</span><br><span class="line">v38 = <span class="number">2</span> * v16</span><br><span class="line">v32 = <span class="number">2</span> * v18</span><br><span class="line">v35 = v25 + v30</span><br><span class="line">v34 = <span class="number">2</span> * v31</span><br><span class="line">v12 = v10 + <span class="number">2</span> * (v31 + <span class="number">4</span> * (v29 + v17)) + v31 + <span class="number">4</span> * (v29 + v17)</span><br><span class="line">v36 = <span class="number">3</span> * v21</span><br><span class="line">v13 = v6 + v1 + <span class="number">8</span> * v6 + <span class="number">4</span> * (v8 + <span class="number">2</span> * v27)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> a1:</span><br><span class="line">    s.add(a &gt;= <span class="number">32</span>, a &lt;= <span class="number">126</span>)</span><br><span class="line">s.add(a1[<span class="number">0</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">2</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">3</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">4</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">5</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">31</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">s.add(v18 +  <span class="number">201</span> * v24 +  <span class="number">194</span> * v10 +  <span class="number">142</span> * v20 +  <span class="number">114</span> * v39 +  <span class="number">103</span> * v11 +  <span class="number">52</span> * (v17 + v31) +  ((v9 + v23) &lt;&lt; <span class="number">6</span>) +  <span class="number">14</span> * (v21 + <span class="number">4</span> * v25 + v25) +  <span class="number">9</span> * (v40 + <span class="number">23</span> * v27 + v2 + <span class="number">3</span> * v1 + <span class="number">4</span> * v2 + <span class="number">4</span> * v6) +  <span class="number">5</span> * (v16 + <span class="number">23</span> * v30 + <span class="number">2</span> * (v3 + <span class="number">2</span> * v19) + <span class="number">5</span> * v5 + <span class="number">39</span> * v15 + <span class="number">51</span> * v4) +  <span class="number">24</span> * (v8 + <span class="number">10</span> * v28 + <span class="number">4</span> * (v42 + v7 + <span class="number">2</span> * v26)) +  <span class="number">62</span> * v22 +  <span class="number">211</span> * v41 +  <span class="number">212</span> * v29 == <span class="number">296473</span>)</span><br><span class="line">s.add(<span class="number">207</span> * v41 +  <span class="number">195</span> * v22 +  <span class="number">151</span> * v40 +  <span class="number">57</span> * v5 +  <span class="number">118</span> * v6 +  <span class="number">222</span> * v42 +  <span class="number">103</span> * v7 +  <span class="number">181</span> * v8 +  <span class="number">229</span> * v9 +  <span class="number">142</span> * v31 +  <span class="number">51</span> * v29 +  <span class="number">122</span> * (v26 + v20) +  <span class="number">91</span> * (v2 + <span class="number">2</span> * v16) +  <span class="number">107</span> * (v27 + v25) +  <span class="number">81</span> * (v17 + <span class="number">2</span> * v18 + v18) +  <span class="number">45</span> * (v19 + <span class="number">2</span> * (v11 + v24) + v11 + v24) +  <span class="number">4</span> * (<span class="number">3</span> * (v23 + a1[<span class="number">19</span>] + <span class="number">2</span> * v23 + <span class="number">5</span> * v4) + v39 + <span class="number">29</span> * (v10 + v1) + <span class="number">25</span> * v15) +  <span class="number">26</span> * v28 +  <span class="number">101</span> * v30 +  <span class="number">154</span> * v3 == <span class="number">354358</span>)</span><br><span class="line"></span><br><span class="line">s.add(And((<span class="number">177</span> * v40 +  <span class="number">129</span> * v26 +  <span class="number">117</span> * v42 +  <span class="number">143</span> * v28 +  <span class="number">65</span> * v8 +  <span class="number">137</span> * v25 +  <span class="number">215</span> * v21 +  <span class="number">93</span> * v31 +  <span class="number">235</span> * v39 +  <span class="number">203</span> * v11 +  <span class="number">15</span> * (v7 + <span class="number">17</span> * v30) +  <span class="number">2</span>* (v24 +  <span class="number">91</span> * v9 +  <span class="number">95</span> * v29 +  <span class="number">51</span> * v41 +  <span class="number">81</span> * v20 +  <span class="number">92</span> * v18 +  <span class="number">112</span> * (v10 + v6) +  <span class="number">32</span> * (v22 + <span class="number">2</span> * (v1 + v23)) +  <span class="number">6</span> * (v2 + <span class="number">14</span> * v16 + <span class="number">19</span> * v15) +  <span class="number">83</span> * v5 +  <span class="number">53</span> * v4 +  <span class="number">123</span> * v19) +  v17 +  <span class="number">175</span> * v27 +  <span class="number">183</span> * v3 == <span class="number">448573</span>)</span><br><span class="line">    ,  (<span class="number">113</span> * v19 +  <span class="number">74</span> * v3 +  <span class="number">238</span> * v6 +  <span class="number">140</span> * v2 +  <span class="number">214</span> * v26 +  <span class="number">242</span> * v8 +  <span class="number">160</span> * v21 +  <span class="number">136</span> * v23 +  <span class="number">209</span> * v9 +  <span class="number">220</span> * v31 +  <span class="number">50</span> * v24 +  <span class="number">125</span> * v10 +  <span class="number">175</span> * v20 +  <span class="number">23</span> * v39 +  <span class="number">137</span> * v22 +  <span class="number">149</span> * v18 +  <span class="number">83</span> * (v4 + <span class="number">2</span> * v30) +  <span class="number">21</span> * (<span class="number">9</span> * v29 + v16) +  <span class="number">59</span> * (<span class="number">4</span> * v27 + v17) +  <span class="number">41</span> * (v1 + v41) +  <span class="number">13</span> * (v7 + <span class="number">11</span> * (v40 + v15) + <span class="number">6</span> * v42 + <span class="number">4</span> * (v28 + <span class="number">2</span> * v11) + v28 + <span class="number">2</span> * v11 + <span class="number">17</span> * v5) +  <span class="number">36</span> * v25 == <span class="number">384306</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v21 +  <span class="number">78</span> * v1 +  v2 +  v9 +  <span class="number">133</span> * v27 +  <span class="number">74</span> * v6 +  <span class="number">69</span> * v26 +  <span class="number">243</span> * v7 +  <span class="number">98</span> * v28 +  <span class="number">253</span> * v8 +  <span class="number">142</span> * v25 +  <span class="number">175</span> * v31 +  <span class="number">105</span> * v41 +  <span class="number">221</span> * v10 +  <span class="number">121</span> * v39 +  <span class="number">218</span> * (v19 + v29) +  <span class="number">199</span> * (v24 + v30) +  <span class="number">33</span> * (v40 + <span class="number">7</span> * v17) +  <span class="number">4</span> * (<span class="number">27</span> * v20 + <span class="number">50</span> * v11 + <span class="number">45</span> * v18 + <span class="number">19</span> * (v3 + v42) + v16 + <span class="number">16</span> * v23 + <span class="number">52</span> * v4) +  <span class="number">195</span> * v22 +  <span class="number">211</span> * v5 +  <span class="number">153</span> * v15 == <span class="number">424240</span>)</span><br><span class="line">    ,  (<span class="number">181</span> * v25 +  <span class="number">61</span> * v2 +  <span class="number">65</span> * v21 +  <span class="number">58</span> * v31 +  <span class="number">170</span> * v29 +  <span class="number">143</span> * v24 +  <span class="number">185</span> * v10 +  <span class="number">86</span> * v11 +  <span class="number">97</span> * v22 +  <span class="number">235</span> * (v23 + v27) +  <span class="number">3</span>* (<span class="number">53</span> * v41 +  <span class="number">74</span> * (v8 + v3) +  <span class="number">13</span> * (v42 + <span class="number">6</span> * v9) +  <span class="number">11</span> * (v39 + <span class="number">7</span> * v20) +  <span class="number">15</span> * (v18 + <span class="number">4</span> * v17) +  v7 +  <span class="number">35</span> * v1 +  <span class="number">29</span> * v15) +  <span class="number">4</span> * (<span class="number">57</span> * v6 + <span class="number">18</span> * (v5 + v37) + v28 + <span class="number">17</span> * v16 + <span class="number">55</span> * v30) +  <span class="number">151</span> * v40 +  <span class="number">230</span> * v4 +  <span class="number">197</span> * v19 == <span class="number">421974</span>)</span><br><span class="line">    ,  (<span class="number">209</span> * v21 +  <span class="number">249</span> * v30 +  <span class="number">195</span> * v2 +  <span class="number">219</span> * v25 +  <span class="number">201</span> * v39 +  <span class="number">85</span> * v18 +  <span class="number">213</span> * (v17 + v31) +  <span class="number">119</span> * (v11 + <span class="number">2</span> * v41) +  <span class="number">29</span> * (<span class="number">8</span> * v24 + v40 + <span class="number">4</span> * v27 + v27) +  <span class="number">2</span>* (v8 +  <span class="number">55</span> * (<span class="number">2</span> * v29 + v19) +  <span class="number">3</span> * (v10 + <span class="number">39</span> * v9 + <span class="number">2</span> * (v6 + <span class="number">20</span> * v20) + <span class="number">35</span> * v7) +  <span class="number">4</span> * (v5 + <span class="number">31</span> * v42 + <span class="number">28</span> * v3) +  <span class="number">26</span> * v28 +  <span class="number">46</span> * (v37 + v16) +  <span class="number">98</span> * v1) +  <span class="number">53</span> * v23 +  <span class="number">171</span> * v15 +  <span class="number">123</span> * v4 == <span class="number">442074</span>)</span><br><span class="line">    ,  ( <span class="number">162</span> * v19 +  <span class="number">74</span> * v5 +  <span class="number">28</span> * v27 +  <span class="number">243</span> * v42 +  <span class="number">123</span> * v28 +  <span class="number">73</span> * v8 +  <span class="number">166</span> * v23 +  <span class="number">94</span> * v24 +  <span class="number">113</span> * v11 +  <span class="number">193</span> * v22 +  <span class="number">122</span> * (v6 + <span class="number">2</span> * v7) +  <span class="number">211</span> * (v10 + v25) +  <span class="number">21</span> * (v17 + <span class="number">7</span> * v41) +  <span class="number">11</span> * (v4 + <span class="number">23</span> * (v16 + v39) + <span class="number">2</span> * (v40 + <span class="number">5</span> * v30 + <span class="number">2</span> * (<span class="number">2</span> * v18 + v29) + <span class="number">2</span> * v18 + v29)) +  <span class="number">5</span> * (<span class="number">46</span> * v9 + <span class="number">26</span> * v20 + <span class="number">4</span> * (v31 + <span class="number">2</span> * v21) + v15 + <span class="number">27</span> * v2 + <span class="number">10</span> * v1) +  <span class="number">36</span> * (v3 + <span class="number">5</span> * v26) == <span class="number">376007</span>)</span><br><span class="line">    ,  (<span class="number">63</span> * v19 +  <span class="number">143</span> * v5 +  <span class="number">250</span> * v6 +  <span class="number">136</span> * v2 +  <span class="number">214</span> * v40 +  <span class="number">62</span> * v26 +  <span class="number">221</span> * v42 +  <span class="number">226</span> * v7 +  <span class="number">171</span> * v28 +  <span class="number">178</span> * v8 +  <span class="number">244</span> * v23 +  ((v9 &lt;&lt; <span class="number">7</span>)) +  <span class="number">150</span> * v31 +  <span class="number">109</span> * v29 +  <span class="number">70</span> * v41 +  <span class="number">127</span> * v20 +  <span class="number">204</span> * v39 +  <span class="number">121</span> * v22 +  <span class="number">173</span> * v18 +  <span class="number">69</span> * (v25 + v30 + v27) +  <span class="number">74</span> * (v16 + <span class="number">2</span> * v15 + v15) +  <span class="number">22</span> * (<span class="number">7</span> * v24 + v17 + <span class="number">10</span> * v11) +  <span class="number">40</span> * (v1 + <span class="number">4</span> * v21 + v21) +  <span class="number">81</span> * v10 +  <span class="number">94</span> * v4 +  <span class="number">84</span> * v3 == <span class="number">411252</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v15 +  <span class="number">121</span> * v4 +  <span class="number">28</span> * v30 +  <span class="number">206</span> * v16 +  <span class="number">145</span> * v27 +  <span class="number">41</span> * v1 +  <span class="number">247</span> * v6 +  <span class="number">118</span> * v26 +  <span class="number">241</span> * v28 +  <span class="number">79</span> * v8 +  <span class="number">102</span> * v25 +  <span class="number">124</span> * v23 +  <span class="number">65</span> * v9 +  <span class="number">68</span> * v31 +  <span class="number">239</span> * v17 +  <span class="number">148</span> * v24 +  <span class="number">245</span> * v39 +  <span class="number">115</span> * v11 +  <span class="number">163</span> * v22 +  <span class="number">137</span> * v18 +  <span class="number">53</span> * (v5 + <span class="number">2</span> * v29) +  <span class="number">126</span> * (v40 + <span class="number">2</span> * v10) +  <span class="number">38</span> * (v7 + v21 + <span class="number">4</span> * v7 + <span class="number">6</span> * v41) +  <span class="number">12</span> * (v2 + <span class="number">16</span> * v42) +  <span class="number">109</span> * v20 +  <span class="number">232</span> * v3 +  <span class="number">47</span> * v19 == <span class="number">435012</span>)</span><br><span class="line">    ,  (<span class="number">209</span> * v21 +  <span class="number">233</span> * v40 +  <span class="number">93</span> * v1 +  <span class="number">241</span> * v2 +  <span class="number">137</span> * v8 +  <span class="number">249</span> * v17 +  <span class="number">188</span> * v29 +  <span class="number">86</span> * v24 +  <span class="number">246</span> * v10 +  <span class="number">149</span> * v20 +  <span class="number">99</span> * v11 +  <span class="number">37</span> * v22 +  <span class="number">219</span> * v18 +  <span class="number">17</span> * (v6 + <span class="number">10</span> * v25) +  <span class="number">49</span> * (v5 + <span class="number">3</span> * v3 + <span class="number">4</span> * v28 + v28) +  <span class="number">5</span> * (<span class="number">16</span> * v39 + <span class="number">11</span> * (v41 + <span class="number">2</span> * v27 + v27) + <span class="number">12</span> * v7 + v31 + <span class="number">30</span> * v16 + <span class="number">27</span> * v19) +  <span class="number">18</span> * (v23 + <span class="number">2</span> * (v4 + v26 + <span class="number">2</span> * v4) + v4 + v26 + <span class="number">2</span> * v4) +  <span class="number">24</span> * v9 +  <span class="number">109</span> * v42 +  <span class="number">183</span> * v30 +  <span class="number">154</span> * v15 == <span class="number">392484</span>)</span><br><span class="line">    ,  (<span class="number">155</span> * v15 +  <span class="number">247</span> * v40 +  <span class="number">157</span> * v28 +  <span class="number">119</span> * v23 +  <span class="number">161</span> * v17 +  <span class="number">133</span> * v20 +  <span class="number">85</span> * v22 +  <span class="number">229</span> * (v7 + v24) +  <span class="number">123</span> * (<span class="number">2</span> * v31 + v42) +  <span class="number">21</span> * (v41 + <span class="number">12</span> * v30) +  <span class="number">55</span> * (v9 + v5 + v18 + <span class="number">2</span> * v5) +  <span class="number">15</span> * (v3 + <span class="number">16</span> * v10 + <span class="number">9</span> * v21) +  <span class="number">2</span>* (v2 +  <span class="number">115</span> * v29 +  <span class="number">111</span> * v16 +  <span class="number">26</span> * v6 +  <span class="number">88</span> * v8 +  <span class="number">73</span> * v39 +  <span class="number">71</span> * v11 +  <span class="number">28</span> * (v26 + <span class="number">2</span> * (v25 + <span class="number">2</span> * v1)) +  <span class="number">51</span> * v27 +  <span class="number">99</span> * v4 +  <span class="number">125</span> * v19) == <span class="number">437910</span>)</span><br><span class="line">    ,  (<span class="number">220</span> * v3 +  <span class="number">200</span> * v4 +  <span class="number">139</span> * v15 +  <span class="number">33</span> * v5 +  <span class="number">212</span> * v30 +  <span class="number">191</span> * v16 +  <span class="number">30</span> * v27 +  <span class="number">233</span> * v1 +  <span class="number">246</span> * v6 +  <span class="number">89</span> * v2 +  <span class="number">252</span> * v40 +  <span class="number">223</span> * v42 +  <span class="number">19</span> * v25 +  <span class="number">141</span> * v21 +  <span class="number">163</span> * v9 +  <span class="number">185</span> * v17 +  <span class="number">136</span> * v31 +  <span class="number">46</span> * v24 +  <span class="number">109</span> * v10 +  <span class="number">217</span> * v39 +  <span class="number">75</span> * v22 +  <span class="number">157</span> * v18 +  <span class="number">125</span> * (v11 + v19) +  <span class="number">104</span> * (v33 + v20) +  <span class="number">43</span> * (v28 + <span class="number">2</span> * v29 + v29) +  <span class="number">32</span> * (v8 + v7 + <span class="number">2</span> * v8 + <span class="number">2</span> * (v23 + v26)) == <span class="number">421905</span>)</span><br><span class="line">    ,  (<span class="number">211</span> * v24 +  <span class="number">63</span> * v15 +  <span class="number">176</span> * v5 +  <span class="number">169</span> * v16 +  <span class="number">129</span> * v27 +  <span class="number">146</span> * v40 +  <span class="number">111</span> * v26 +  <span class="number">68</span> * v42 +  <span class="number">39</span> * v25 +  <span class="number">188</span> * v23 +  <span class="number">130</span> * v9 +  ((v31 &lt;&lt; <span class="number">6</span>)) +  <span class="number">91</span> * v41 +  <span class="number">208</span> * v20 +  <span class="number">145</span> * v39 +  <span class="number">247</span> * v18 +  <span class="number">93</span> * (v22 + v17) +  <span class="number">71</span> * (v6 + <span class="number">2</span> * v11) +  <span class="number">103</span> * (v8 + <span class="number">2</span> * v30) +  <span class="number">6</span> * (v21 + <span class="number">10</span> * v28 + <span class="number">28</span> * v7 + <span class="number">9</span> * v29 + <span class="number">19</span> * v2 + <span class="number">24</span> * v1 + <span class="number">22</span> * v3) +  <span class="number">81</span> * v10 +  <span class="number">70</span> * v4 +  <span class="number">23</span> * v19 == <span class="number">356282</span>)</span><br><span class="line">    ,  (<span class="number">94</span> * v42 +  <span class="number">101</span> * v2 +  <span class="number">152</span> * v40 +  <span class="number">200</span> * v7 +  <span class="number">226</span> * v8 +  <span class="number">211</span> * v23 +  <span class="number">121</span> * v24 +  <span class="number">74</span> * v11 +  <span class="number">166</span> * v18 +  (((v6 + <span class="number">3</span> * v28) &lt;&lt; <span class="number">6</span>)) +  <span class="number">41</span> * (<span class="number">4</span> * v9 + v21) +  <span class="number">23</span> * (v39 + <span class="number">11</span> * v41) +  <span class="number">7</span> * (v20 + <span class="number">10</span> * v25 + <span class="number">2</span> * v12 + v12) +  <span class="number">3</span> * (<span class="number">78</span> * v30 + <span class="number">81</span> * v16 + <span class="number">55</span> * v27 + <span class="number">73</span> * v1 + <span class="number">4</span> * v26 + v15 + <span class="number">85</span> * v3 + <span class="number">65</span> * v19) +  <span class="number">62</span> * v22 +  <span class="number">88</span> * v5 +  <span class="number">110</span> * v4 == <span class="number">423091</span>)</span><br><span class="line">    ,  (<span class="number">133</span> * v22 +  <span class="number">175</span> * v15 +  <span class="number">181</span> * v30 +  <span class="number">199</span> * v16 +  <span class="number">123</span> * v27 +  <span class="number">242</span> * v1 +  <span class="number">75</span> * v6 +  <span class="number">69</span> * v2 +  <span class="number">153</span> * v40 +  <span class="number">33</span> * v26 +  <span class="number">100</span> * v42 +  <span class="number">229</span> * v7 +  <span class="number">177</span> * v8 +  <span class="number">134</span> * v31 +  <span class="number">179</span> * v29 +  <span class="number">129</span> * v41 +  <span class="number">14</span> * v10 +  <span class="number">247</span> * v24 +  <span class="number">228</span> * v20 +  <span class="number">92</span> * v11 +  <span class="number">86</span> * (v9 + v32) +  <span class="number">94</span> * (v23 + v21) +  <span class="number">37</span> * (v17 + <span class="number">4</span> * v3) +  <span class="number">79</span> * (v25 + <span class="number">2</span> * v28) +  <span class="number">72</span> * v5 +  <span class="number">93</span> * v39 +  <span class="number">152</span> * v4 +  <span class="number">214</span> * v19 == <span class="number">391869</span>)</span><br><span class="line">    ,  (<span class="number">211</span> * v24 +  <span class="number">213</span> * v18 +  <span class="number">197</span> * v40 +  <span class="number">159</span> * v25 +  <span class="number">117</span> * v21 +  <span class="number">119</span> * v9 +  <span class="number">98</span> * v17 +  <span class="number">218</span> * v41 +  <span class="number">106</span> * v39 +  <span class="number">69</span> * v11 +  <span class="number">43</span> * (v2 + v29 + <span class="number">2</span> * v2) +  <span class="number">116</span> * (v4 + v10 + v37) +  <span class="number">5</span> * (v42 + <span class="number">9</span> * v23 + <span class="number">35</span> * v20 + <span class="number">37</span> * v31) +  <span class="number">11</span> * (v16 + <span class="number">13</span> * v27 + <span class="number">5</span> * v5 + <span class="number">8</span> * v30) +  <span class="number">6</span> * (<span class="number">29</span> * v28 + <span class="number">25</span> * v8 + <span class="number">38</span> * v22 + v15 + <span class="number">13</span> * v1 + <span class="number">10</span> * v3) +  <span class="number">136</span> * v7 +  <span class="number">142</span> * v6 +  <span class="number">141</span> * v19 == <span class="number">376566</span>)</span><br><span class="line">    ,  (<span class="number">173</span> * v3 +  <span class="number">109</span> * v15 +  <span class="number">61</span> * v30 +  <span class="number">187</span> * v1 +  <span class="number">79</span> * v6 +  <span class="number">53</span> * v40 +  <span class="number">184</span> * v21 +  <span class="number">43</span> * v23 +  <span class="number">41</span> * v9 +  <span class="number">166</span> * v31 +  <span class="number">193</span> * v41 +  <span class="number">58</span> * v24 +  <span class="number">146</span> * v10 +  ((v20 &lt;&lt; <span class="number">6</span>)) +  <span class="number">89</span> * v39 +  <span class="number">121</span> * v11 +  <span class="number">5</span> * (v17 + <span class="number">23</span> * v8) +  <span class="number">7</span> * (<span class="number">29</span> * v18 + v29 + <span class="number">4</span> * v7) +  <span class="number">13</span> * (<span class="number">3</span> * v42 + v16 + <span class="number">7</span> * v26 + <span class="number">13</span> * v2) +  <span class="number">3</span> * (v4 + <span class="number">83</span> * v5 + <span class="number">51</span> * v27 + <span class="number">33</span> * v22 + <span class="number">8</span> * (v19 + <span class="number">4</span> * v28) + <span class="number">18</span> * v25) == <span class="number">300934</span>)</span><br><span class="line">    ,  (<span class="number">78</span> * v1 +  <span class="number">131</span> * v5 +  <span class="number">185</span> * v16 +  <span class="number">250</span> * v40 +  <span class="number">90</span> * v26 +  <span class="number">129</span> * v42 +  <span class="number">255</span> * v28 +  <span class="number">206</span> * v8 +  <span class="number">239</span> * v25 +  <span class="number">150</span> * v10 +  <span class="number">253</span> * v39 +  <span class="number">104</span> * v22 +  <span class="number">58</span> * (v2 + <span class="number">2</span> * v7) +  <span class="number">96</span> * (v15 + v31) +  <span class="number">117</span> * (v9 + <span class="number">2</span> * v4) +  <span class="number">27</span> * (v17 + <span class="number">8</span> * v18 + v18) +  <span class="number">19</span> * (v23 + <span class="number">3</span> * v21 + <span class="number">4</span> * v29 + v29) +  <span class="number">7</span> * (<span class="number">22</span> * v41 + <span class="number">3</span> * (v11 + <span class="number">11</span> * v24) + v3 + <span class="number">29</span> * v6 + <span class="number">14</span> * v27) +  <span class="number">109</span> * v20 +  <span class="number">102</span> * v30 +  <span class="number">100</span> * v19 == <span class="number">401351</span>)</span><br><span class="line">    ,  (<span class="number">233</span> * v19 +  <span class="number">71</span> * v5 +  <span class="number">209</span> * v27 +  <span class="number">82</span> * v6 +  <span class="number">58</span> * v26 +  <span class="number">53</span> * v25 +  <span class="number">113</span> * v23 +  <span class="number">206</span> * v31 +  <span class="number">39</span> * v41 +  <span class="number">163</span> * v20 +  <span class="number">222</span> * v11 +  <span class="number">191</span> * v18 +  <span class="number">123</span> * (v7 + v40) +  <span class="number">69</span> * (v9 + <span class="number">2</span> * v22 + v22) +  <span class="number">9</span> * (v3 + <span class="number">8</span> * v24 + <span class="number">7</span> * (<span class="number">3</span> * v1 + v28) + <span class="number">5</span> * v16 + <span class="number">19</span> * v30) +  <span class="number">4</span> * (v15 + <span class="number">26</span> * v17 + <span class="number">61</span> * v29 + <span class="number">43</span> * v42 + <span class="number">49</span> * v2 + <span class="number">32</span> * v4) +  <span class="number">10</span> * (<span class="number">7</span> * (v8 + v36) + v39 + <span class="number">12</span> * v10) == <span class="number">368427</span>)</span><br><span class="line">    ,  (<span class="number">139</span> * v30 +  <span class="number">53</span> * v5 +  <span class="number">158</span> * v16 +  <span class="number">225</span> * v1 +  <span class="number">119</span> * v6 +  <span class="number">67</span> * v2 +  <span class="number">213</span> * v40 +  <span class="number">188</span> * v28 +  <span class="number">152</span> * v8 +  <span class="number">187</span> * v21 +  <span class="number">129</span> * v23 +  <span class="number">54</span> * v9 +  <span class="number">125</span> * v17 +  <span class="number">170</span> * v24 +  <span class="number">184</span> * v11 +  <span class="number">226</span> * v22 +  <span class="number">253</span> * v18 +  <span class="number">26</span> * (v29 + v41) +  <span class="number">97</span> * (v4 + <span class="number">2</span> * v25) +  <span class="number">39</span> * (<span class="number">5</span> * v26 + v27) +  <span class="number">21</span> * (v39 + <span class="number">8</span> * v42) +  <span class="number">12</span> * (<span class="number">17</span> * v10 + v31 + <span class="number">15</span> * v7 + <span class="number">12</span> * v19) +  <span class="number">165</span> * v20 +  <span class="number">88</span> * v15 +  <span class="number">157</span> * v3 == <span class="number">403881</span>)</span><br><span class="line">    ,  (<span class="number">114</span> * v3 +  <span class="number">61</span> * v27 +  <span class="number">134</span> * v40 +  <span class="number">62</span> * v42 +  <span class="number">89</span> * v9 +  <span class="number">211</span> * v17 +  <span class="number">163</span> * v41 +  <span class="number">66</span> * v24 +  <span class="number">201</span> * (v7 + v18) +  <span class="number">47</span> * (<span class="number">5</span> * v16 + v22) +  <span class="number">74</span> * (v4 + v31) +  <span class="number">142</span> * (v2 + v28) +  <span class="number">35</span> * (v20 + <span class="number">6</span> * v26) +  <span class="number">39</span> * (v15 + <span class="number">6</span> * v30) +  <span class="number">27</span> * (v25 + <span class="number">9</span> * v23 + <span class="number">8</span> * v6) +  <span class="number">4</span> * (v21 + <span class="number">63</span> * v19 + <span class="number">2</span> * (v1 + <span class="number">12</span> * (v10 + v5) + <span class="number">8</span> * v11 + <span class="number">26</span> * v29)) +  <span class="number">10</span> * (v8 + <span class="number">4</span> * v39 + v39) == <span class="number">382979</span>)</span><br><span class="line">    ,  (<span class="number">122</span> * v25 +  <span class="number">225</span> * v21 +  <span class="number">52</span> * v23 +  <span class="number">253</span> * v9 +  <span class="number">197</span> * v17 +  <span class="number">187</span> * v31 +  <span class="number">181</span> * v29 +  <span class="number">183</span> * v41 +  <span class="number">47</span> * v20 +  <span class="number">229</span> * v39 +  <span class="number">88</span> * v22 +  <span class="number">127</span> * (v10 + v32) +  <span class="number">37</span> * (v7 + <span class="number">3</span> * v3) +  (((v11 + <span class="number">2</span> * v30 + v30) &lt;&lt; <span class="number">6</span>)) +  <span class="number">7</span> * (<span class="number">21</span> * v8 + v27 + <span class="number">18</span> * (v4 + v1 + v38)) +  <span class="number">6</span> * (<span class="number">23</span> * v24 + v26 + <span class="number">17</span> * v2 + <span class="number">39</span> * v6) +  <span class="number">10</span> * (v5 + <span class="number">11</span> * v28 + <span class="number">21</span> * v42) +  <span class="number">149</span> * v19 +  <span class="number">165</span> * v40 +  <span class="number">121</span> * v15 == <span class="number">435695</span>)</span><br><span class="line">    ,  (<span class="number">165</span> * v20 +  <span class="number">223</span> * v4 +  <span class="number">249</span> * v5 +  <span class="number">199</span> * v1 +  <span class="number">135</span> * v2 +  <span class="number">133</span> * v26 +  <span class="number">254</span> * v42 +  <span class="number">111</span> * v7 +  <span class="number">189</span> * v28 +  <span class="number">221</span> * v25 +  <span class="number">115</span> * v21 +  <span class="number">186</span> * v9 +  <span class="number">79</span> * v41 +  <span class="number">217</span> * v24 +  <span class="number">122</span> * v11 +  <span class="number">38</span> * v18 +  <span class="number">109</span> * (v34 + v29) +  <span class="number">14</span> * (v8 + <span class="number">17</span> * v40 + <span class="number">8</span> * (v6 + v38)) +  <span class="number">4</span> * (<span class="number">11</span> * (<span class="number">5</span> * v30 + v39) + <span class="number">6</span> * (v10 + <span class="number">2</span> * v22) + v27 + <span class="number">52</span> * v17 + <span class="number">50</span> * v23) +  <span class="number">229</span> * v15 +  <span class="number">86</span> * v3 +  <span class="number">234</span> * v19 == <span class="number">453748</span>)</span><br><span class="line">    ,  (<span class="number">181</span> * v25 +  <span class="number">94</span> * v42 +  <span class="number">125</span> * v1 +  <span class="number">226</span> * v26 +  <span class="number">155</span> * v7 +  <span class="number">95</span> * v21 +  <span class="number">212</span> * v17 +  <span class="number">91</span> * v31 +  <span class="number">194</span> * v29 +  <span class="number">98</span> * v24 +  <span class="number">166</span> * v11 +  <span class="number">120</span> * v22 +  <span class="number">59</span> * v18 +  <span class="number">32</span> * (v9 + v8) +  <span class="number">158</span> * (v6 + v5) +  <span class="number">101</span> * (v41 + v19) +  <span class="number">63</span> * (v4 + <span class="number">2</span> * v23) +  <span class="number">67</span> * (v28 + <span class="number">2</span> * v20) +  <span class="number">11</span> * (v39 + <span class="number">10</span> * v16 + <span class="number">11</span> * v10) +  <span class="number">39</span> * (v30 + <span class="number">4</span> * (v2 + v15)) +  <span class="number">233</span> * v40 +  <span class="number">56</span> * v27 +  <span class="number">225</span> * v3 == <span class="number">358321</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v21 +  <span class="number">135</span> * v4 +  <span class="number">197</span> * v15 +  <span class="number">118</span> * v5 +  <span class="number">143</span> * v16 +  <span class="number">134</span> * v6 +  <span class="number">204</span> * v40 +  <span class="number">173</span> * v26 +  <span class="number">81</span> * v7 +  <span class="number">60</span> * v28 +  <span class="number">58</span> * v8 +  <span class="number">179</span> * v23 +  <span class="number">142</span> * v9 +  <span class="number">178</span> * v17 +  <span class="number">230</span> * v31 +  <span class="number">148</span> * v29 +  <span class="number">224</span> * v41 +  <span class="number">194</span> * v24 +  <span class="number">223</span> * v10 +  <span class="number">87</span> * v20 +  <span class="number">200</span> * v39 +  <span class="number">233</span> * v11 +  <span class="number">49</span> * v22 +  <span class="number">127</span> * v35 +  <span class="number">31</span> * (<span class="number">4</span> * v27 + v18) +  <span class="number">42</span> * (v1 + <span class="number">6</span> * v2) +  <span class="number">109</span> * v42 +  <span class="number">75</span> * v3 +  <span class="number">165</span> * v19 == <span class="number">456073</span>)</span><br><span class="line">    ,  (<span class="number">41</span> * v4 +  <span class="number">253</span> * v3 +  <span class="number">163</span> * v15 +  <span class="number">193</span> * v30 +  <span class="number">155</span> * v16 +  <span class="number">113</span> * v27 +  <span class="number">131</span> * v6 +  <span class="number">55</span> * v2 +  <span class="number">21</span> * v40 +  <span class="number">53</span> * v26 +  <span class="number">13</span> * v8 +  <span class="number">201</span> * v25 +  <span class="number">237</span> * v9 +  <span class="number">223</span> * v31 +  <span class="number">95</span> * v24 +  <span class="number">194</span> * v20 +  <span class="number">62</span> * v39 +  <span class="number">119</span> * v11 +  <span class="number">171</span> * v22 +  <span class="number">135</span> * v18 +  <span class="number">69</span> * (v10 + <span class="number">3</span> * v28) +  <span class="number">211</span> * (v1 + v29) +  <span class="number">4</span> * (<span class="number">43</span> * v7 + v42 + <span class="number">40</span> * v17) +  <span class="number">6</span> * (v5 + <span class="number">33</span> * v41 + <span class="number">20</span> * (<span class="number">2</span> * v19 + v21) + <span class="number">24</span> * v23) == <span class="number">407135</span>)</span><br><span class="line">    ,  (<span class="number">111</span> * v19 +  <span class="number">190</span> * v3 +  <span class="number">149</span> * v4 +  <span class="number">173</span> * v28 +  <span class="number">118</span> * v23 +  <span class="number">146</span> * v29 +  <span class="number">179</span> * v10 +  <span class="number">51</span> * v20 +  <span class="number">49</span> * v39 +  <span class="number">61</span> * v11 +  <span class="number">125</span> * v22 +  <span class="number">162</span> * v18 +  <span class="number">214</span> * v35 +  <span class="number">14</span> * (v34 + v24) +  <span class="number">178</span> * (v41 + v16) +  <span class="number">11</span> * (<span class="number">4</span> * v9 + v21 + <span class="number">17</span> * v42) +  <span class="number">65</span> * (v26 + v17 + <span class="number">2</span> * v26 + <span class="number">2</span> * v5) +  <span class="number">4</span> * (v7 + <span class="number">38</span> * v15 + <span class="number">4</span> * v13 + v13 + <span class="number">8</span> * v40 + <span class="number">43</span> * v2) == <span class="number">369835</span>)</span><br><span class="line">    ,  (<span class="number">27</span> * v27 +  <span class="number">223</span> * v6 +  <span class="number">147</span> * v26 +  <span class="number">13</span> * v21 +  <span class="number">35</span> * (v17 + <span class="number">7</span> * v4) +  <span class="number">57</span> * (v19 + v32 + <span class="number">3</span> * v11) +  <span class="number">11</span> * (v1 + <span class="number">17</span> * (v9 + v5) + <span class="number">10</span> * v16 + <span class="number">3</span> * v31) +  <span class="number">2</span>* (<span class="number">53</span> * v23 +  v25 +  <span class="number">38</span> * v15 +  <span class="number">43</span> * v42 +  <span class="number">115</span> * v29 +  <span class="number">61</span> * v22 +  <span class="number">111</span> * (v10 + v40) +  <span class="number">14</span> * (v20 + v7 + <span class="number">2</span> * v7 + <span class="number">8</span> * v28) +  <span class="number">109</span> * v2 +  <span class="number">100</span> * v41 +  <span class="number">63</span> * v8) +  <span class="number">93</span> * v39 +  <span class="number">251</span> * v30 +  <span class="number">131</span> * v3 == <span class="number">393303</span>)</span><br><span class="line">    ,  (<span class="number">116</span> * v9 +  <span class="number">152</span> * v29 +  <span class="number">235</span> * v20 +  <span class="number">202</span> * v18 +  <span class="number">85</span> * (v8 + <span class="number">3</span> * v11) +  <span class="number">221</span> * (v16 + v40) +  <span class="number">125</span> * (v33 + v24) +  <span class="number">7</span> * (<span class="number">19</span> * v4 + <span class="number">9</span> * (v10 + <span class="number">2</span> * v25) + v2 + <span class="number">33</span> * v3 + <span class="number">32</span> * v19) +  <span class="number">3</span> * (<span class="number">71</span> * v39 + <span class="number">43</span> * v22 + <span class="number">32</span> * (v17 + v26) + <span class="number">15</span> * (v5 + v6 + <span class="number">2</span> * v23) + v28 + <span class="number">74</span> * v31 + <span class="number">48</span> * v42) +  <span class="number">10</span> * (v21 + <span class="number">11</span> * v30 + <span class="number">16</span> * v15) +  <span class="number">136</span> * v7 +  <span class="number">106</span> * v1 +  <span class="number">41</span> * v27 == <span class="number">403661</span>)</span><br><span class="line">    ,  (<span class="number">127</span> * v4 +  <span class="number">106</span> * v15 +  <span class="number">182</span> * v30 +  <span class="number">142</span> * v5 +  <span class="number">159</span> * v16 +  <span class="number">17</span> * v1 +  <span class="number">211</span> * v6 +  <span class="number">134</span> * v2 +  <span class="number">199</span> * v7 +  <span class="number">103</span> * v28 +  <span class="number">247</span> * v23 +  <span class="number">122</span> * v9 +  <span class="number">95</span> * v41 +  <span class="number">62</span> * v10 +  <span class="number">203</span> * v39 +  <span class="number">16</span> * v11 +  <span class="number">41</span> * (<span class="number">6</span> * v42 + v25) +  <span class="number">9</span> * (<span class="number">22</span> * v24 + v20 + <span class="number">27</span> * v31 + <span class="number">28</span> * v40) +  <span class="number">10</span> * (v8 + v22 + v36 + <span class="number">8</span> * v17 + <span class="number">2</span> * (v22 + v36 + <span class="number">8</span> * v17) + <span class="number">13</span> * v29) +  <span class="number">6</span> * (<span class="number">23</span> * v27 + v26) +  <span class="number">213</span> * v18 +  <span class="number">179</span> * v3 +  <span class="number">43</span> * v19 == <span class="number">418596</span>)))</span><br><span class="line">s.add(<span class="number">149</span> * v19 +  v1 +  <span class="number">133</span> * v22 +  <span class="number">207</span> * v41 +  <span class="number">182</span> * v26 +  <span class="number">234</span> * v7 +  <span class="number">199</span> * v8 +  <span class="number">168</span> * v21 +  <span class="number">58</span> * v10 +  <span class="number">108</span> * v20 +  <span class="number">142</span> * v18 +  <span class="number">156</span> * (v9 + v25) +  <span class="number">16</span> * (v29 + <span class="number">6</span> * v31) +  <span class="number">126</span> * (v17 + <span class="number">2</span> * v39) +  <span class="number">127</span> * (v4 + <span class="number">2</span> * v27 + v40) +  <span class="number">49</span> * (v30 + <span class="number">4</span> * v16) +  <span class="number">11</span> * (v5 + <span class="number">22</span> * v11) +  <span class="number">5</span> * (v15 + v42 + <span class="number">45</span> * v24 + <span class="number">50</span> * v28) +  <span class="number">109</span> * v2 +  <span class="number">124</span> * v6 +  <span class="number">123</span> * v3 == <span class="number">418697</span>)</span><br><span class="line">pcheck(s,a1)</span><br><span class="line"><span class="comment">#hgame&#123;SMC_4nd_s0lv1ng_equ4t1Ons&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SICTF#3 wp及复现</title>
      <link href="/posts/65f5db04.html"/>
      <url>/posts/65f5db04.html</url>
      
        <content type="html"><![CDATA[<p>又被暴打了QAQ</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="baby-c"><a href="#baby-c" class="headerlink" title="baby_c++"></a>baby_c++</h3><p>判断的地方找数组即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a = [<span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x49</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x7B</span>, <span class="number">0x34</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x62</span>, <span class="number">0x38</span>, <span class="number">0x61</span>, <span class="number">0x2D</span>, <span class="number">0x39</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x62</span>, <span class="number">0x2D</span>, <span class="number">0x39</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x64</span>, <span class="number">0x34</span>, <span class="number">0x66</span>, <span class="number">0x35</span>, <span class="number">0x65</span>, <span class="number">0x33</span>, <span class="number">0x37</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x66</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">pl(a)</span><br><span class="line"><span class="comment">#SICTF&#123;4e474b8a-9df6-454b-9ea6-d4f5e37cd51f&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ez-pyc"><a href="#ez-pyc" class="headerlink" title="ez_pyc"></a>ez_pyc</h3><p>分析逻辑可知，是求解一个数独，同时只要求其中的一个解</p><p>尝试放到网上直接求解，直接出来了</p><p><img src="https://s2.loli.net/2024/02/23/yepYRodIr564mOT.png" alt="image-20240223163033222"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2548656723194376198518245679931748649825721856943342156965374812</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/02/23/UEgNoFqBv1CbdZm.png" alt="image-20240223163250217"></p><blockquote><p>这里我把输入改成十进制了</p></blockquote><p>之后更新一个碰撞md5的方法</p><h3 id="Sweet-Tofu"><a href="#Sweet-Tofu" class="headerlink" title="Sweet_Tofu"></a>Sweet_Tofu</h3><p>动调直接找检查数组，判断时要异或0x66</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a = [<span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x07</span>, <span class="number">0x01</span>, <span class="number">0x1D</span>, <span class="number">0x3F</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, </span><br><span class="line">     <span class="number">0x39</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x39</span>, <span class="number">0x2F</span>, <span class="number">0x39</span>, <span class="number">0x21</span>, </span><br><span class="line">     <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x39</span>, <span class="number">0x25</span>, <span class="number">0x14</span>, <span class="number">0x03</span>, </span><br><span class="line">     <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x09</span>, </span><br><span class="line">     <span class="number">0x08</span>, <span class="number">0x41</span>, <span class="number">0x12</span>, <span class="number">0x39</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x39</span>, <span class="number">0x15</span>, </span><br><span class="line">     <span class="number">0x03</span>, <span class="number">0x14</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x15</span>, <span class="number">0x47</span>, <span class="number">0x1B</span>]</span><br><span class="line"></span><br><span class="line">pxor(a,<span class="number">0x66</span>)</span><br><span class="line"><span class="comment">#flag&#123;You_and_I_God&#x27;s_Creation!Don&#x27;t_be_serious!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="artbreaker"><a href="#artbreaker" class="headerlink" title="artbreaker"></a>artbreaker</h3><p>ida打开后发现不能反编译也不能看流程，修改最大节点数量然后跳到流程图</p><p>结果</p><p><img src="https://s2.loli.net/2024/02/23/zvDxTWEJqRoksOM.png" alt="image-20240223164916217"></p><p>居然用流程图把flag画出来了,看未定义变量的wp，说是用了**<a href="https://github.com/JuliaPoo/Artfuscator">Artfuscator</a>**这个来画的画</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Rabbit_falls_into_rabbit_hole&#125;</span></span><br></pre></td></tr></table></figure><h3 id="BattleCity"><a href="#BattleCity" class="headerlink" title="BattleCity"></a>BattleCity</h3><p>游戏题，看样子是要通关，在assets中可以看到levels.ldtk文件，用文本文件编辑器打开可以发现里面有各种东西的属性，于是我把每一关的敌人只留了一个，然后把基地的长宽改成0，打完4关，assets里出现了win.png，是二维码，扫码就出来了</p><h3 id="closeme"><a href="#closeme" class="headerlink" title="closeme"></a>closeme</h3><p>提示是要用正常方式结束程序</p><p>由于程序一直弹出窗口，因此需要通过messagebox函数的交叉引用找到主函数。或者通过动态调试找到位置。</p><p>然后动调分析一下，发现是一个循环+一些东西，要结束的话只能先break，在205行有唯一的break。同时后面有一个goto，让执行流又回到label_4了，这就</p><p>（看了wp）发现下面有一个xor加密的hint，解密得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a=[<span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x0D</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x4B</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x0A</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x1D</span>, <span class="number">0x06</span>, <span class="number">0x54</span>, <span class="number">0x16</span>, <span class="number">0x1A</span>, <span class="number">0x18</span>, <span class="number">0x0B</span>, <span class="number">0x1C</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x14</span>, <span class="number">0x18</span>, <span class="number">0x5E</span>, <span class="number">0x12</span>, <span class="number">0xE5</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0xE0</span>, <span class="number">0xE4</span>, <span class="number">0xE8</span>, <span class="number">0xF0</span>, <span class="number">0xA9</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xAC</span>, <span class="number">0xEE</span>, <span class="number">0xE2</span>, <span class="number">0xE6</span>, <span class="number">0xF3</span>, <span class="number">0xFA</span>, <span class="number">0xB2</span>, <span class="number">0xF3</span>, <span class="number">0xCD</span>, <span class="number">0xF0</span>, <span class="number">0xE5</span>, <span class="number">0xF7</span>, <span class="number">0xB8</span>, <span class="number">0xF6</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0xFC</span>, <span class="number">0xD3</span>, <span class="number">0xF1</span>, <span class="number">0xFF</span>, <span class="number">0x8C</span>, <span class="number">0x81</span>, <span class="number">0xCB</span>, <span class="number">0xD7</span>, <span class="number">0x84</span>, <span class="number">0xD2</span>, <span class="number">0xCF</span>, <span class="number">0xCB</span>, <span class="number">0xC4</span>, <span class="number">0x89</span>, <span class="number">0xC8</span>, <span class="number">0xCE</span>, <span class="number">0x8C</span>, <span class="number">0xDE</span>, <span class="number">0xDA</span>, <span class="number">0xC0</span>, <span class="number">0xC2</span>, <span class="number">0xD4</span>, <span class="number">0xD6</span>, <span class="number">0x9D</span>, <span class="number">0x94</span>, <span class="number">0xFF</span>, <span class="number">0xC3</span>, <span class="number">0xC4</span>, <span class="number">0xCC</span>, <span class="number">0x99</span>, <span class="number">0xD9</span>, <span class="number">0xD3</span>, <span class="number">0xD3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0xDA</span>, <span class="number">0xE0</span>, <span class="number">0x98</span>, <span class="number">0xA7</span>, <span class="number">0xB0</span>, <span class="number">0xEB</span>, <span class="number">0x8B</span>, <span class="number">0xA9</span>, <span class="number">0xEF</span>, <span class="number">0xF9</span>, <span class="number">0xE6</span>, <span class="number">0xFA</span>, <span class="number">0xE2</span>, <span class="number">0xEC</span>, <span class="number">0xA4</span>, <span class="number">0xA0</span>, <span class="number">0xEF</span>, <span class="number">0xB1</span>, <span class="number">0xF1</span>, <span class="number">0xB1</span>, <span class="number">0xB6</span>, <span class="number">0xA6</span>, <span class="number">0xA1</span>, <span class="number">0xB7</span>, <span class="number">0xBE</span>, <span class="number">0xB6</span>, <span class="number">0xF9</span>, <span class="number">0xB5</span>, <span class="number">0xA9</span>, <span class="number">0xB8</span>, <span class="number">0xB8</span>, <span class="number">0xAC</span>, <span class="number">0xFF</span>, <span class="number">0x97</span>, <span class="number">0x89</span>, <span class="number">0x8B</span>, <span class="number">0x80</span>, <span class="number">0x8C</span>, <span class="number">0xC5</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0x9D</span>, <span class="number">0x82</span>, <span class="number">0x8E</span>, <span class="number">0xCC</span>, <span class="number">0x8B</span>, <span class="number">0x82</span>, <span class="number">0x8E</span>, <span class="number">0x97</span>, <span class="number">0xDD</span>, <span class="number">0xD2</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x96</span>, <span class="number">0x9E</span>, <span class="number">0xD7</span>, <span class="number">0x99</span>, <span class="number">0x8A</span>, <span class="number">0xDA</span>, <span class="number">0xCB</span>, <span class="number">0xCD</span>, <span class="number">0xCD</span>, <span class="number">0xCE</span>, <span class="number">0xCE</span>,<span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x2D</span>, <span class="number">0x24</span>, <span class="number">0x55</span>, <span class="number">0x6A</span>, <span class="number">0x62</span>, <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x6F</span>, <span class="number">0x2B</span>, <span class="number">0x7F</span>, <span class="number">0x78</span>, <span class="number">0x6C</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x65</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x71</span>, <span class="number">0x37</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x73</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x3D</span>, <span class="number">0x6A</span>, <span class="number">0x77</span>, <span class="number">0x45</span>, <span class="number">0x01</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x08</span>, <span class="number">0x45</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x49</span>, <span class="number">0x0D</span>, <span class="number">0x4E</span>, <span class="number">0x7C</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x4F</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x40</span>, <span class="number">0x5E</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i] ^= i+<span class="number">102</span></span><br><span class="line">pl(a)</span><br><span class="line"><span class="comment">#Every time you close the messagebox by click `Yes` or `No`, it will be stored. Just choose Yes/No(1/0) in a certain order which is the flag, such as 01001100. Please submit flag which the format like `SICTF&#123;01001100&#125;`</span></span><br></pre></td></tr></table></figure><p>那么根据上面的break，可以看出需要输入16次</p><p>但是要检测到按键按的是哪个</p><p>根据messageboxW：yes是6，no是7。查找后可以发现</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 == <span class="number">5</span> * (v2 / <span class="number">5</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        v63 = (<span class="type">const</span> WCHAR *)&amp;unk_140022B10;</span><br><span class="line">        v64 = (__int64)&amp;unk_140022B3C;</span><br><span class="line">        LOWORD(Size) = <span class="number">0</span>;</span><br><span class="line">        LODWORD(v66) = <span class="number">1</span>;</span><br><span class="line">        sub_140003240(&amp;v70, &amp;v63);</span><br><span class="line">        lpWindowName = v71;</span><br><span class="line">        v63 = (<span class="type">const</span> WCHAR *)&amp;unk_140022B3C;</span><br><span class="line">        v64 = (__int64)&amp;unk_140022B5D;</span><br><span class="line">        LOWORD(Size) = <span class="number">0</span>;</span><br><span class="line">        LODWORD(v66) = <span class="number">1</span>;</span><br><span class="line">        sub_140003240(lpCaption, &amp;v63);</span><br><span class="line">        v73 = (<span class="type">unsigned</span> __int64)lpCaption[<span class="number">1</span>];</span><br><span class="line">        choose = MessageBoxW(<span class="number">0</span>i64, lpWindowName, lpCaption[<span class="number">1</span>], <span class="number">4u</span>);</span><br><span class="line">        <span class="keyword">if</span> ( lpCaption[<span class="number">0</span>] )</span><br><span class="line">          sub_1400038E0(v73, <span class="number">2</span> * (__int64)lpCaption[<span class="number">0</span>], <span class="number">2</span>i64);</span><br><span class="line">        <span class="keyword">if</span> ( v70 )</span><br><span class="line">          sub_1400038E0(lpWindowName, <span class="number">2</span>i64 * (_QWORD)v70, <span class="number">2</span>i64);</span><br><span class="line">        this_choose_ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> ( choose != <span class="number">6</span> )                      <span class="comment">// 否</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( choose != <span class="number">7</span> )                    <span class="comment">// 否，不可能进入</span></span><br><span class="line">          &#123;</span><br><span class="line">            v63 = (<span class="type">const</span> WCHAR *)&amp;off_140022B98;</span><br><span class="line">            v64 = <span class="number">1</span>i64;</span><br><span class="line">            Size = (<span class="type">size_t</span>)&amp;off_140022888;</span><br><span class="line">            v66 = <span class="number">0</span>i64;</span><br><span class="line">            sub_1400214A0(&amp;v63, &amp;off_140022BA8);</span><br><span class="line">          &#125;</span><br><span class="line">          this_choose_ans = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cont2 = cont;                           <span class="comment">// 是</span></span><br><span class="line">        <span class="keyword">if</span> ( cont == v59 )                      <span class="comment">// ?</span></span><br><span class="line">        &#123;</span><br><span class="line">          sub_140003820(&amp;v59);</span><br><span class="line">          cont2 = cont;</span><br><span class="line">        &#125;</span><br><span class="line">        *(_BYTE *)(save_place + cont2) = this_choose_ans;</span><br><span class="line">        <span class="keyword">if</span> ( ++cont == <span class="number">16</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>修正this_choose_ans的值，是=&#x3D;1，否=&#x3D;0,最后存在save_place中</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">sp0 = *(<span class="type">unsigned</span> __int8 *)save_place;</span><br><span class="line"><span class="keyword">if</span> ( sp0 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp1 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp1 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp2 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp2 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp3 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp3 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp4 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp4 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp5 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp5 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp6 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">6</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp6 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp7 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">7</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp7 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp8 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">8</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp8 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp9 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp9 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp10 = (LPCWSTR)*(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)sp10 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp11 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">11</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp11 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp12 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">12</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp12 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp13 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">13</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp13 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp14 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">14</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp14 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp15 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">15</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp15 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">final = sp0</span><br><span class="line">      + <span class="number">10</span></span><br><span class="line">      * (sp1</span><br><span class="line">       + <span class="number">10</span></span><br><span class="line">       * (sp2</span><br><span class="line">        + <span class="number">10</span></span><br><span class="line">        * (sp3</span><br><span class="line">         + <span class="number">10</span></span><br><span class="line">         * (sp4</span><br><span class="line">          + <span class="number">10</span></span><br><span class="line">          * (sp5</span><br><span class="line">           + <span class="number">10</span></span><br><span class="line">           * (sp6</span><br><span class="line">            + <span class="number">10</span></span><br><span class="line">            * (sp7</span><br><span class="line">             + <span class="number">10</span></span><br><span class="line">             * (sp8</span><br><span class="line">              + <span class="number">10</span> * (sp9 + <span class="number">10</span>i64 * (_QWORD)&amp;sp10[<span class="number">50000</span> * sp15 + <span class="number">5000</span> * sp14 + <span class="number">500</span> * sp13 + <span class="number">50</span> * sp12 + <span class="number">5</span> * sp11])))))))));</span><br></pre></td></tr></table></figure><p>经过这里后label_4会到第一个while（1）的位置最后,那只能继续分析final，它储存了所有输入内容计算后的最终值，由于先输入sp0，然后1。。。说明高位后输入，低位先输入</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_14001F580(&amp;final, &amp;zero) )</span><br></pre></td></tr></table></figure><p>并且由于提示的按一定方式点击，说明肯定有检测的存在</p><p>在label_3的位置：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (what &amp; <span class="number">0xFFFF0000</span>) != <span class="number">-1443823616</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_3:</span><br><span class="line">    cont = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>只要等于就可以往后走</p><p>反异或一下what的值等于1443758080&#x2F;560E 0000</p><p>动态调试，输入测试，发现sp0到15就是放入的值1010101，唯一奇怪的是sp13和sp11是特定的值0x800和0x90000000</p><p><del>继续看what的生成</del>看不出来，试试代数据</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000</span> <span class="string">》</span>           <span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">》</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">0000 </span><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">》</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001</span> <span class="string">》</span> <span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br></pre></td></tr></table></figure><p>根据第一组数据感觉是倒序排入，上面final也是倒序的。倒序一下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000 </span><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">》</span>           <span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000</span> <span class="string">》</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000</span> <span class="string">》</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001</span> <span class="string">》</span> <span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br></pre></td></tr></table></figure><p>第四个看得很明显如果不看后4位是最后两个变到了前面</p><p>试一试最后的what是不是这样变的</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">560e0000</span>：</span><br><span class="line"><span class="number">0101011000001110</span></span><br><span class="line"><span class="number">0101100000111001</span></span><br><span class="line"><span class="symbol">0101 </span><span class="number">1000</span> <span class="number">0011</span> <span class="number">1001</span></span><br></pre></td></tr></table></figure><p>不对？重新看了一遍发现是与运算，不是异或，那就是说最后的A9F1就是结果的末值</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1010 </span><span class="number">1001 </span><span class="number">1111 </span><span class="number">0001</span></span><br><span class="line"><span class="number">1010 </span><span class="number">0111 </span><span class="number">1100 </span><span class="number">0110</span></span><br><span class="line"><span class="number">0110 </span><span class="number">0011 </span><span class="number">1110 </span><span class="number">0101</span></span><br><span class="line"><span class="string">得到</span></span><br><span class="line"><span class="string">SICTF&#123;0110001111100101&#125;</span></span><br></pre></td></tr></table></figure><p>这道题告诉我看到这种抽象的题要多调试，静下来分析QAQ</p><h3 id="virus-nlys1s-待补充"><a href="#virus-nlys1s-待补充" class="headerlink" title="virus-nlys1s[待补充]"></a>virus-nlys1s[待补充]</h3><p>居然是病毒样本，没玩过，之后再说</p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="vigenere"><a href="#vigenere" class="headerlink" title="vigenere"></a>vigenere</h3><p>从名字可以看出是维吉尼亚密码</p><p>第二段可以明显看出有一段是SICTF{}，进入</p><p><a href="https://www.dcode.fr/vigenere-cipher%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%EF%BC%8C%E8%BE%93%E5%85%A5%E5%AF%86%E6%96%87%E5%92%8C%E5%B7%B2%E7%9F%A5%E7%9A%84%E6%98%8E%E6%96%87">https://www.dcode.fr/vigenere-cipher这个网站，输入密文和已知的明文</a></p><p>得key：SAATF和明文</p><h3 id="SuperbRSA"><a href="#SuperbRSA" class="headerlink" title="SuperbRSA"></a>SuperbRSA</h3><p>这个是变体的共模攻击</p><p>通过e1，e2求gcd，最后的结果要取gcd的根</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line"></span><br><span class="line">g,x,y=gmpy2.gcdext(e1,e2)</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n</span><br><span class="line">m=gmpy2.iroot(m,g)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;SICTF&#123;S0_Great_RSA_Have_Y0u_Learned?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="easyLattice-待补充"><a href="#easyLattice-待补充" class="headerlink" title="easyLattice[待补充]"></a>easyLattice[待补充]</h3><p>感觉在考逆元和模的基本运算？但是没做出来悲伤。</p><p>翻wp发现是考格密码，按照<a href="https://blog.csdn.net/u010883831/article/details/128262134">VSCode配置sage教程 不用notebook直接运行+代码高亮+命令行输出_sage windows-CSDN博客</a>安装好环境，（最后失败了，于是把库全放到自带的解释器里面）</p><p>没见过呀（TVT），看不懂，之后再说</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">p = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>     </span><br><span class="line">T = <span class="number">2</span>^<span class="number">250</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">1</span>,T*h],[<span class="number">0</span>,T*p]])</span><br><span class="line"></span><br><span class="line">f,g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(f)))</span><br><span class="line"><span class="comment"># SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;</span></span><br></pre></td></tr></table></figure><p>大概是说<br>$$<br>h &#x3D; (f^{-1}g) \mod p<br>$$</p><p>$$<br>g &#x3D; fh+kp<br>$$</p><h1 id="begin-pmatrix-f-k-end-pmatrix-times-begin-pmatrix-1-h-0-p-end-pmatrix"><a href="#begin-pmatrix-f-k-end-pmatrix-times-begin-pmatrix-1-h-0-p-end-pmatrix" class="headerlink" title="$$\begin{pmatrix}f &amp; k \\end{pmatrix}\times\begin{pmatrix}1 &amp; h \0 &amp; p\end{pmatrix}"></a>$$<br>\begin{pmatrix}<br>f &amp; k \<br>\end{pmatrix}<br>\times<br>\begin{pmatrix}<br>1 &amp; h \<br>0 &amp; p<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>f &amp; g \<br>\end{pmatrix}<br>$$</p><h3 id="gggcd-待补充"><a href="#gggcd-待补充" class="headerlink" title="gggcd[待补充]"></a>gggcd[待补充]</h3><p>这个第一次见到诶，好怪：同e，n不同m，$m_2&#x3D;f(m_1)$</p><p>m2是m1的线性变换</p><p>然后已知c1，c2，n，e</p><p>查了查，原来这个叫相关消息攻击</p><p>通过求可能的g再求其gcd（g1，g2）得到m</p><p>看大佬们的wp，exp都是用sage写的，我安装好后也不能导入python，但是直接用sage自带的好像可以，不过不能导入Crypto.Util.number，我就先解出m再longtobytes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">....: c2 = <span class="number">205635624489021368248826364689528951802539834493392269547383991633413</span></span><br><span class="line">....: <span class="number">32272571882209784996486250189912121870946577915881638415484043534161071782</span></span><br><span class="line">....: <span class="number">38735899371291867878739806568899981073418921390469351451959495552246015176</span></span><br><span class="line">....: <span class="number">94795153230498219402854082280557713496709195875609525488767962526341049263</span></span><br><span class="line">....: <span class="number">67078177733076253</span></span><br><span class="line">....: e = <span class="number">65537</span></span><br><span class="line">....: a = <span class="number">233</span></span><br><span class="line">....: b = <span class="number">9527</span></span><br><span class="line">....:</span><br><span class="line">....: <span class="keyword">import</span> binascii</span><br><span class="line">....: <span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2</span>):</span><br><span class="line">....:     PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">....:     g1 = (x)^e - c1</span><br><span class="line">....:     g2 = (<span class="number">233</span>*x+<span class="number">9527</span>)^e - c2</span><br><span class="line">....:</span><br><span class="line">....:     <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">....:         <span class="keyword">while</span> g2:</span><br><span class="line">....:             g1, g2 = g2, g1 % g2</span><br><span class="line">....:         <span class="keyword">return</span> g1.monic()</span><br><span class="line">....:     <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line">....:</span><br><span class="line">....: m=franklinReiter(n,e,c1,c2)</span><br><span class="line">....: <span class="built_in">print</span>((m))</span><br><span class="line"><span class="number">11658736990073968144116409270602503966776095409763057826884617698882016691134900406351481309826095854973</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">print</span>(long_to_bytes(<span class="number">11658736990073968144116409270602503966776095409763057826884617698882016691134900406351481309826095854973</span>))</span><br><span class="line"><span class="attribute">b</span>&#x27;SICTF&#123;<span class="number">45115</span>fb2-<span class="number">84</span>d6-<span class="number">4369</span>-<span class="number">88</span>c2-c8c3d72b4c55&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="签到，确信-待补充"><a href="#签到，确信-待补充" class="headerlink" title="签到，确信![待补充]"></a>签到，确信![待补充]</h3><p>我不解，但我大受震撼</p><h3 id="铜匠-待补充"><a href="#铜匠-待补充" class="headerlink" title="铜匠[待补充]"></a>铜匠[待补充]</h3><p>似乎这个是已知p的高位</p><p>但是转5进制之后似乎不能准确表示p的高位，难度是把n转5进制？</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">import</span> gmpy2</span><br><span class="line"><span class="attribute">from</span> tqdm import *</span><br><span class="line"></span><br><span class="line"><span class="attribute">leak</span> = <span class="string">&quot;2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012&quot;</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">c</span> = <span class="number">64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> five_to_ten(num):</span><br><span class="line">    <span class="attribute">temp</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">i</span> = <span class="number">109</span></span><br><span class="line">    <span class="attribute">for</span> j in reversed(num):</span><br><span class="line">        <span class="attribute">temp</span> += int(j) * <span class="number">5</span>**i</span><br><span class="line">        <span class="attribute">i</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> temp</span><br><span class="line"></span><br><span class="line"><span class="attribute">leak</span> = five_to_ten(leak)</span><br><span class="line"><span class="attribute">gift</span> = leak &gt;&gt; <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in trange(<span class="number">2</span>^<span class="number">8</span>):</span><br><span class="line">    <span class="attribute">ph</span> = gift &lt;&lt; <span class="number">8</span></span><br><span class="line">    <span class="attribute">phigh</span> = ph + i</span><br><span class="line">    <span class="attribute">phigh</span> = phigh &lt;&lt; <span class="number">248</span></span><br><span class="line">    <span class="attribute">R</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">f</span> = phigh + x</span><br><span class="line">    <span class="attribute">res</span> = f.small_roots(X=<span class="number">2</span>^<span class="number">248</span>, beta=<span class="number">0</span>.<span class="number">4</span>, epsilon=<span class="number">0</span>.<span class="number">01</span>)</span><br><span class="line">    <span class="attribute">if</span> res !=<span class="meta"> []:</span></span><br><span class="line"><span class="meta">        p = phigh + int(res[0])</span></span><br><span class="line"><span class="meta">        q = n // p</span></span><br><span class="line"><span class="meta">        d = gmpy2.invert(e,(p-1)*(q-1))</span></span><br><span class="line"><span class="meta">        m = pow(c,d,n)</span></span><br><span class="line"><span class="meta">        print(f&quot;i = &#123;i&#125;&quot;)</span></span><br><span class="line"><span class="meta">        print(long_to_bytes(int(m)))</span></span><br><span class="line"><span class="meta">        break</span></span><br><span class="line"><span class="meta"></span></span><br></pre></td></tr></table></figure><h3 id="babyRSA-待补充"><a href="#babyRSA-待补充" class="headerlink" title="babyRSA[待补充]"></a>babyRSA[待补充]</h3><h3 id="easy-or-baby-RSA-待补充"><a href="#easy-or-baby-RSA-待补充" class="headerlink" title="easy_or_baby_RSA[待补充]"></a>easy_or_baby_RSA[待补充]</h3><h3 id="2024-New-Setback-待补充"><a href="#2024-New-Setback-待补充" class="headerlink" title="2024_New_Setback[待补充]"></a>2024_New_Setback[待补充]</h3><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>略</p><h3 id="geekchallenge"><a href="#geekchallenge" class="headerlink" title="geekchallenge"></a>geekchallenge</h3><p>这个要连接一个地址，连接后是一个猜数字游戏，114位，一共5种字符，一开始尝试了很久不知道为什么错了，最后发现它延迟一次显示，上一次的结果出现在下一次在，那么解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有可见字符</span></span><br><span class="line">visible_chars = string.printable[:-<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个socket对象</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到服务器</span></span><br><span class="line">s.connect((<span class="string">&quot;yuanshen.life&quot;</span>, <span class="number">34757</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个114位的列表，初始值为None</span></span><br><span class="line">password = [<span class="literal">None</span>] * <span class="number">114</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存上一次的字符</span></span><br><span class="line">last_char = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环遍历所有可能的字符</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> visible_chars:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">all</span>(v <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">for</span> v <span class="keyword">in</span> password):</span><br><span class="line">        <span class="comment"># 将guess设为password并将空位全部改为char</span></span><br><span class="line">        guess = <span class="string">&#x27;&#x27;</span>.join([v <span class="keyword">if</span> v <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> char <span class="keyword">for</span> v <span class="keyword">in</span> password]) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 否则，guess为114个相同的字符</span></span><br><span class="line">        guess = char * <span class="number">114</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送字符串到服务器</span></span><br><span class="line">    s.send(guess.encode())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收服务器的响应</span></span><br><span class="line">    response = s.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(guess)</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line">    <span class="comment"># 如果response中有&#x27;1&#x27;，就把上一次的char放入password中的每一个返回的&#x27;1&#x27;的位置</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">in</span> response <span class="keyword">and</span> last_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i, bit <span class="keyword">in</span> <span class="built_in">enumerate</span>(response):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(password) <span class="keyword">and</span> bit == <span class="string">&#x27;1&#x27;</span><span class="keyword">and</span> password[i] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                password[i] = last_char</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新上一次的字符</span></span><br><span class="line">    last_char = char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">filter</span>(<span class="literal">None</span>, password)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    message = <span class="built_in">input</span>(<span class="string">&quot;请输入你要发送的消息：\n&quot;</span>)</span><br><span class="line">    message += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    s.send(message.encode())</span><br><span class="line">    response = s.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">s.close()</span><br><span class="line"><span class="comment">#SICTF&#123;18e62b78-c753-407c-9b0f-aa386fb4d6fd&#125;</span></span><br></pre></td></tr></table></figure><h3 id="New-year-s-regret"><a href="#New-year-s-regret" class="headerlink" title="New_year&#96;s regret"></a>New_year&#96;s regret</h3><p>给了一个压缩包，有秘密，但是说了格式：xxxxSICTF</p><p>那就掩码爆破：格式是????SICTF</p><p>出来是2024SICTF</p><p>解压压缩包得到一个task.png和output.txt，同时压缩包注释表示压缩包有额外数据，用010editor查看得：43637d135333</p><p>task.png是400x400的类似二维码的黑白图像，一行25个格</p><p>output.txt是一堆0101二进制串，22464个字符加一个换行符</p><p>那么很有可能要把output转为图片，但是并不知道要怎么转换。</p><p>然后这里的额外数据43637d135333实在想不出来是什么意思，看wp后才知道要反转之后from hex：351×64刚好22464</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image_from_file</span>(<span class="params">filename, width, height</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        data = file.read().replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    pixels = img.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data)):</span><br><span class="line">        row = i // width</span><br><span class="line">        col = i % width</span><br><span class="line">        <span class="keyword">if</span> data[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            pixels[col, row] = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)  </span><br><span class="line">        <span class="keyword">elif</span> data[i] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            pixels[col, row] = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)  </span><br><span class="line"></span><br><span class="line">    img.save(<span class="string">&#x27;output.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">create_image_from_file(<span class="string">&#x27;output.txt&#x27;</span>,<span class="number">351</span>,<span class="number">64</span>)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/02/21/GcEh8Qu1xPMSW3o.png" alt="output"></p><p>得到一张五线谱，这个叫Music Sheet Cipher</p><p>通过网站：<a href="https://www.dcode.fr/music-sheet-cipher">Music Sheet Cipher - Online Notes Decoder, Encoder, Translator (dcode.fr)</a></p><p>来解码</p><p>得到：PUTITALLTOGETHER&#x2F;put_it_all_together</p><p>以zip形式打开task.png</p><p>发现有base64编码的字符,解码后好像还是base64，多试几次，最后发现35次的时候有PNG的标志，37次就不能继续了，把它输出成png，是一个二维码，扫码然后获得部分flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>):</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;something.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(data)</span><br></pre></td></tr></table></figure><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;Congratuation_to_you!</span><br></pre></td></tr></table></figure><p>再查看task.png,二进制打开看有没有什么标志，除了50 4B 03 04还有一个PNG，复制PNG保存打开是一张武器表，根据提示：你知道这是几星吗想到要找武器星级</p><p><img src="https://s2.loli.net/2024/02/21/EATqRXUfzZDg5F4.png" alt="k"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">44664654464566654465645644544664654654644546445446646565444454544664654664544545646454544454466465465645644</span><br></pre></td></tr></table></figure><p>结果是如上。四五六有三种变化，猜莫斯密码</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">..--.-</span> <span class="string">..-.</span> <span class="params">---</span> <span class="string">..-</span> -. -<span class="string">..</span> <span class="string">..--.-</span> <span class="string">.-</span> <span class="string">.-..</span> <span class="string">.-..</span> <span class="string">..--.-</span> - <span class="string">....</span> . <span class="string">..--.-</span> <span class="string">.--.</span> <span class="string">..</span> . -<span class="string">.-.</span> . <span class="string">...</span> <span class="string">..--.-</span> <span class="string">.-</span> -. -<span class="string">..</span></span><br></pre></td></tr></table></figure><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">_FOUND_ALL_THE_PIECES_AND</span></span><br></pre></td></tr></table></figure><p>拼接flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">SICTF</span><span class="template-variable">&#123;Congratulation_to_you!_found_all_the_pieces_and_put_it_all_together&#125;</span></span><br></pre></td></tr></table></figure><h3 id="WHOWHOWHO"><a href="#WHOWHOWHO" class="headerlink" title="WHOWHOWHO"></a>WHOWHOWHO</h3><p>又是有密码的压缩包,但是有提示：6位数小写密码，爆破：qweqwe</p><p>二号位置有空白字符，很明显是0宽隐写,网上找工具解密</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">U2FsdGVkX19uvldJ6CGUNff3B28QEdIjZqgUh98K</span>+/<span class="number">0</span>J16ELU8WVQydohw4P5+<span class="number">2</span>M</span><br><span class="line"><span class="attribute">jbhTLQHNOpcoOd7kSRgy8pwpovCmimdD8M0IbYUeXjNKYePL</span>/WP4PCMaOJHAW3HR</span><br><span class="line"><span class="attribute">b7IEoDDH1NYh3o5NwMmcFEqy1ujf72VgQIQkaeYFFFE</span>=</span><br></pre></td></tr></table></figure><p>base64，有三行，直接解密，解完发现是乱码，但是一开头说salted，加盐了</p><p>上网查时发现rabbit加密开头一定是U2FsdGVkX1，base64之后就是salted_所以尝试用这个解密，需要key才可以，根据txt文件中的谁是渣男，尝试：shumu</p><p>成功</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GTAGAGCTAGTCCTT&#123;GGGTCACGGTTC_GGGTCACGGTTC_GAACGGTTC_GTAGTG_GCTTC<span class="built_in">A_GTAGACGTGGCGGTG</span>_GTAGACTC<span class="built_in">A_TATGACCGG</span>_GCTCGGGCT&#125;</span><br></pre></td></tr></table></figure><p>这个是dna加密，好像没有直接解密的，但是有脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;</span><br><span class="line">        <span class="string">&#x27;AAA&#x27;</span>:<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;AAC&#x27;</span>:<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;AAG&#x27;</span>:<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;AAT&#x27;</span>:<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;ACA&#x27;</span>:<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;ACC&#x27;</span>:<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;ACG&#x27;</span>:<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;ACT&#x27;</span>:<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;AGA&#x27;</span>:<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;AGC&#x27;</span>:<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;AGG&#x27;</span>:<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;AGT&#x27;</span>:<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;ATA&#x27;</span>:<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;ATC&#x27;</span>:<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;ATG&#x27;</span>:<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;ATT&#x27;</span>:<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;CAA&#x27;</span>:<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;CAC&#x27;</span>:<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;CAG&#x27;</span>:<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;CAT&#x27;</span>:<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;CCA&#x27;</span>:<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;CCC&#x27;</span>:<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;CCG&#x27;</span>:<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;CCT&#x27;</span>:<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;CGA&#x27;</span>:<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;CGC&#x27;</span>:<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;CGG&#x27;</span>:<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;CGT&#x27;</span>:<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;CTA&#x27;</span>:<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;CTC&#x27;</span>:<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;CTG&#x27;</span>:<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;CTT&#x27;</span>:<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;GAA&#x27;</span>:<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;GAC&#x27;</span>:<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;GAG&#x27;</span>:<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;GAT&#x27;</span>:<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;GCA&#x27;</span>:<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;GCC&#x27;</span>:<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;GCG&#x27;</span>:<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;GCT&#x27;</span>:<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;GGA&#x27;</span>:<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;GGC&#x27;</span>:<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;GGG&#x27;</span>:<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;GGT&#x27;</span>:<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;GTA&#x27;</span>:<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;GTC&#x27;</span>:<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;GTG&#x27;</span>:<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;GTT&#x27;</span>:<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;TAA&#x27;</span>:<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;TAC&#x27;</span>:<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;TAG&#x27;</span>:<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;TAT&#x27;</span>:<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;TCA&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;TCC&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;TCG&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;TCT&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;TGA&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;TGC&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;TGG&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;TGT&#x27;</span>:<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;TTA&#x27;</span>:<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;TTC&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;TTG&#x27;</span>:<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;TTT&#x27;</span>:<span class="string">&#x27;.&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>= <span class="string">&#x27;GTAGAGCTAGTCCTT&#123;GGGTCACGGTTC_GGGTCACGGTTC_GAACGGTTC_GTAGTG_GCTTCA_GTAGACGTGGCGGTG_GTAGACTCA_TATGACCGG_GCTCGGGCT&#125;&#x27;</span></span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(<span class="built_in">input</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;_&#x27;</span><span class="keyword">or</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">or</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        final+=<span class="built_in">input</span>[i]</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = <span class="built_in">input</span>[i:i+<span class="number">3</span>]</span><br><span class="line">        final += mapping[tmp]</span><br><span class="line">        i+=<span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"><span class="comment">#SICTF&#123;Q1A0_Q1A0_GA0_SU_N1_SHUMU_SH1_ZHA_NAN&#125;</span></span><br></pre></td></tr></table></figure><h3 id="日志分析1"><a href="#日志分析1" class="headerlink" title="日志分析1"></a>日志分析1</h3><p>使用了windows自带的evtx浏览器和logparser</p><p>尝试查找注册或者登录：id4779</p><p>找到</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">日志分析<span class="number">1.</span>evtx<span class="number">1600</span><span class="number">2020</span><span class="number">-07</span><span class="number">-22</span> <span class="number">10</span>:<span class="number">52</span>:<span class="number">19</span><span class="number">2020</span><span class="number">-07</span><span class="number">-22</span> <span class="number">10</span>:<span class="number">52</span>:<span class="number">19</span><span class="number">4779</span><span class="number">8</span>Success Audit event<span class="number">12551</span>The name <span class="keyword">for</span> category <span class="number">12551</span> <span class="keyword">in</span> Source <span class="string">&quot;Microsoft-Windows-Security-Auditing&quot;</span> cannot be found. The <span class="built_in">local</span> computer may <span class="keyword">not</span> have <span class="keyword">the</span> necessary registry information <span class="keyword">or</span> message DLL <span class="built_in">files</span> <span class="built_in">to</span> display messages <span class="built_in">from</span> <span class="keyword">a</span> remote computerMicrosoft-Windows-Security-Auditingattack$|ADOFLMB|<span class="number">0x12a334</span>|RDP-Tcp<span class="comment">#0|kali|192.168.222.200WIN-WH8G5MDPHE5.ADoflmb.comNULLThe description for Event ID 4779 in Source &quot;Microsoft-Windows-Security-Auditing&quot; cannot be found. The local computer may not have the necessary registry information or message DLL files to display messages from a remote computerNULL</span></span><br></pre></td></tr></table></figure><p>这里找到attack$的用户名，ADOFLMB的用户域，下面的192.168.222.200是内网登录的ip，然后查找创建计划任务的id：</p><p>得到任务名称\callback，文件路径c:\windows\system32\windows_attack.exe</p><p>锁定这一天寻找其它内容就能找到就能找到用户组是Administrators</p><p>远程登录账户是WIN-WH8G5MDPHE5$</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">\callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\WIN-WH8G5MDPHE5$&#125;</span><br></pre></td></tr></table></figure><p>但是不对，结果远程登录账户就是attack$</p><p>在4769号内容2020&#x2F;7&#x2F;22&#x2F;10：52：06</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">已请求 Kerberos 服务票证。</span><br><span class="line"></span><br><span class="line">帐户信息:</span><br><span class="line">帐户名:attack$@ADOFLMB.COM</span><br><span class="line">帐户域:ADOFLMB.COM</span><br><span class="line">登录 GUID:&#123;7539ad21<span class="string">-0</span>be8<span class="string">-8</span>cb6<span class="string">-7406</span><span class="string">-054797</span>c14d68&#125;</span><br><span class="line"></span><br><span class="line">服务信息:</span><br><span class="line">服务名称:WIN-WH8G5MDPHE5$</span><br><span class="line">服务 ID:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-867333373</span><span class="string">-202576419</span><span class="string">-2389709931</span><span class="string">-1000</span></span><br><span class="line"></span><br><span class="line">网络信息:</span><br><span class="line">客户端地址:::1</span><br><span class="line">客户端端口:0</span><br><span class="line"></span><br><span class="line">附加信息:</span><br><span class="line">票证选项:0x40810000</span><br><span class="line">票证加密类型:0x12</span><br><span class="line">故障代码:0x0</span><br><span class="line">传递服务:-</span><br><span class="line"></span><br><span class="line">每次请求访问资源(例如计算机或 Windows 服务)时生成此事件。服务名称表示请求访问的资源。</span><br><span class="line"></span><br><span class="line">可以通过比较每个事件中的“登录 GUID”字段将此事件与 Windows 登录事件相关联。登录事件发生在被访问的计算机上，通常情况下，该计算机不是颁发服务票证的域控制器计算机。</span><br><span class="line"></span><br><span class="line">票证选项、加密类型和故障代码是在 RFC 4120 中定义的。</span><br></pre></td></tr></table></figure><p>第一行得到目标账户名，这个事件是生成凭证以访问资源的所以没问题？</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">\callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\attack$&#125;</span><br></pre></td></tr></table></figure><p>然而，任务名不加\，这个\表示它位于任务计划程序的根目录下，所以正确flag是</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\attack$&#125;</span><br></pre></td></tr></table></figure><p>（所以说$表示隐藏为什么要加QAQ）</p><h3 id="日志分析2-待补充"><a href="#日志分析2-待补充" class="headerlink" title="日志分析2[待补充]"></a>日志分析2[待补充]</h3><h3 id="神秘的流量-待补充"><a href="#神秘的流量-待补充" class="headerlink" title="神秘的流量[待补充]"></a>神秘的流量[待补充]</h3><hr><h2 id="FORENSICS"><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h2><p>明明是社工却叫取证？</p><h3 id="OSINT签到"><a href="#OSINT签到" class="headerlink" title="OSINT签到"></a>OSINT签到</h3><p>直接放到谷歌识图，得出答案</p><p>红城湖公园位于海南省<a href="https://baike.baidu.com/item/%E6%B5%B7%E5%8F%A3/5775?fromModule=lemma_inlink">海口</a>琼山区府城街道红城湖路北侧</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;海南省<span class="literal">_</span>海口市<span class="literal">_</span>琼山区<span class="literal">_</span>红城湖公园&#125;</span><br></pre></td></tr></table></figure><h3 id="这才是签到"><a href="#这才是签到" class="headerlink" title="这才是签到"></a>这才是签到</h3><p>谷歌识图得出地点是意大利的威尼斯，图片中是一个酒店，但是提示说不酒店，拍摄地点找没有空格的好像找不出来？</p><p>看对话jpg，是说穿过小巷，感觉很多啊。奇怪诶。</p><p>好吧，看了wp发现没有特殊字符是省略空格就可以，那拍摄地点是Gondola Danieli</p><p>穿过小道，我之前一直理解成往左边走，结果是往右？？</p><p>不过提示了比例尺是20m，穷举也是可以的</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">SICTF</span><span class="template-variable">&#123;意大利_威尼斯_GondolaDanieli_ChiesadiSanZaccaria&#125;</span></span><br></pre></td></tr></table></figure><h3 id="真的签到"><a href="#真的签到" class="headerlink" title="真的签到"></a>真的签到</h3><p>显眼的是摩天轮</p><p>谷歌识图找到地点</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;广东省<span class="literal">_</span>珠海市<span class="literal">_</span>斗门区<span class="literal">_</span>大信新都汇&#125;</span><br></pre></td></tr></table></figure><h3 id="树木的压迫"><a href="#树木的压迫" class="headerlink" title="树木的压迫"></a>树木的压迫</h3><p>百度识图只搜索红框部分</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;四川省<span class="literal">_</span>达州市<span class="literal">_</span>通川区<span class="literal">_</span>凤凰大道<span class="number">376</span>号<span class="literal">_</span>达州市体育中心&#125;</span><br></pre></td></tr></table></figure><h3 id="签退"><a href="#签退" class="headerlink" title="签退"></a>签退</h3><p>根据左下角车是右舵，去网上搜索地区</p><blockquote><p>采用右舵，靠左行驶的国家主要是英联邦国家，也就是原来受英国的影响比较大的国家，较大的国家有英国、日本、印度、澳大利亚、南非，等三十多个国家和地区。</p><p>具体都包括：孟加拉、不丹、文莱、东帝汶、印度、印度尼西亚、日本、马来西亚、马尔代夫、尼泊尔、巴基斯坦、新加坡、斯里兰卡、泰国、中国香港地区和澳门地区、爱尔兰、塞浦路斯、马耳他、英国、博茨瓦纳、肯尼亚、莱索托、马拉维、毛里求斯、莫桑比克、纳米比亚、塞舌尔、南非、斯威士兰、坦桑尼亚、乌干达、赞比亚、津巴布韦、安提瓜和巴布达、巴哈马、巴巴多斯、格林纳达、圭亚那、牙买加、圣基茨和尼维斯、圣卢西亚、圣文森特和格林纳丁斯、苏里南、特立尼达和多巴哥、澳大利亚、斐济、基里巴斯、新西兰、巴布亚新几内亚、所罗门群岛、汤加、图瓦卢。</p></blockquote><p>通过直接搜图，发现一个视频<a href="https://www.bilibili.com/video/BV1TF411E7Kj/">【超清南非】第一视角 开车从开普敦机场高速前往市中心 (1080P高清版) 2022.2_哔哩哔哩_bilibili</a></p><p>其中红绿灯一样，建筑也差不多，就猜是开普敦了</p><p>同时裁剪图片搜索右上角建筑，可以发现中间被涂掉的蜘蛛侠。那么地点就是这里了。</p><p>根据这个图片继续查找，发现这个建筑的另一边</p><p><a href="https://www.property24.com/to-rent/cape-town-city-centre/cape-town/western-cape/9138/112975960">Commercial property to rent in Cape Town City Centre - 63 Strand Street - P24-112975960 (property24.com)</a></p><p>得到附近地址<br>strand street</p><p>全景地图观察发现就是这里</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;南非\_开普敦\_StrandSt_STEERS&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF-r18题目复现</title>
      <link href="/posts/cc56fc8c.html"/>
      <url>/posts/cc56fc8c.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="genshinwishsimulator"><a href="#genshinwishsimulator" class="headerlink" title="genshinwishsimulator"></a>genshinwishsimulator</h3><p>原神抽卡模拟，先开Assembly-CSharp.dll看看，看到</p><p><img src="https://s2.loli.net/2024/02/16/Dnhg4uE96Nky1Hx.png" alt="image-20240216120848553"></p><p>其中input为已知数组。那么我们就需要找bucket是什么了，发现这个方法下面是check,搜索check方法：</p><p><img src="https://s2.loli.net/2024/02/16/oLrf9gustUlB2bM.png" alt="image-20240216121045048"></p><p>可以发现如果check&#x3D;&#x3D;1，就返回5星，否则其它，那么就需要check返回1才可以</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Check</span>()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span>[] bucket = GachaManager.instance.gachaHistoryBucket.GetBucket();</span><br><span class="line"><span class="keyword">return</span> bucket[<span class="number">0</span>] * <span class="number">40</span> + bucket[<span class="number">1</span>] * <span class="number">65</span> + bucket[<span class="number">2</span>] * <span class="number">-53</span> + bucket[<span class="number">3</span>] * <span class="number">70</span> + bucket[<span class="number">4</span>] * <span class="number">-84</span> + bucket[<span class="number">5</span>] * <span class="number">-38</span> + bucket[<span class="number">6</span>] * <span class="number">94</span> + bucket[<span class="number">7</span>] * <span class="number">-39</span> + bucket[<span class="number">8</span>] * <span class="number">-91</span> + bucket[<span class="number">9</span>] * <span class="number">-35</span> + bucket[<span class="number">10</span>] * <span class="number">54</span> + bucket[<span class="number">11</span>] * <span class="number">17</span> + bucket[<span class="number">12</span>] * <span class="number">45</span> + bucket[<span class="number">13</span>] * <span class="number">92</span> + bucket[<span class="number">14</span>] * <span class="number">-29</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">3004</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-15</span> + bucket[<span class="number">1</span>] * <span class="number">74</span> + bucket[<span class="number">2</span>] * <span class="number">-89</span> + bucket[<span class="number">3</span>] * <span class="number">-82</span> + bucket[<span class="number">4</span>] * <span class="number">-92</span> + bucket[<span class="number">5</span>] * <span class="number">27</span> + bucket[<span class="number">6</span>] * <span class="number">21</span> + bucket[<span class="number">7</span>] * <span class="number">-24</span> + bucket[<span class="number">8</span>] * <span class="number">-82</span> + bucket[<span class="number">9</span>] * <span class="number">-58</span> + bucket[<span class="number">10</span>] * <span class="number">-36</span> + bucket[<span class="number">11</span>] * <span class="number">64</span> + bucket[<span class="number">12</span>] * <span class="number">-49</span> + bucket[<span class="number">13</span>] * <span class="number">-22</span> + bucket[<span class="number">14</span>] * <span class="number">59</span> + bucket[<span class="number">15</span>] * <span class="number">-47</span> == <span class="number">-674</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">67</span> + bucket[<span class="number">1</span>] * <span class="number">-23</span> + bucket[<span class="number">2</span>] * <span class="number">63</span> + bucket[<span class="number">3</span>] * <span class="number">-38</span> + bucket[<span class="number">4</span>] * <span class="number">-32</span> + bucket[<span class="number">5</span>] * <span class="number">61</span> + bucket[<span class="number">6</span>] * <span class="number">-71</span> + bucket[<span class="number">7</span>] * <span class="number">49</span> + bucket[<span class="number">8</span>] * <span class="number">83</span> + bucket[<span class="number">9</span>] * <span class="number">-92</span> + bucket[<span class="number">10</span>] * <span class="number">-16</span> + bucket[<span class="number">11</span>] * <span class="number">65</span> + bucket[<span class="number">12</span>] * <span class="number">-22</span> + bucket[<span class="number">13</span>] * <span class="number">12</span> + bucket[<span class="number">14</span>] * <span class="number">-85</span> + bucket[<span class="number">15</span>] * <span class="number">74</span> == <span class="number">945</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-49</span> + bucket[<span class="number">1</span>] * <span class="number">48</span> + bucket[<span class="number">2</span>] * <span class="number">-11</span> + bucket[<span class="number">3</span>] * <span class="number">20</span> + bucket[<span class="number">4</span>] * <span class="number">-14</span> + bucket[<span class="number">5</span>] * <span class="number">92</span> + bucket[<span class="number">6</span>] * <span class="number">-19</span> + bucket[<span class="number">7</span>] * <span class="number">32</span> + bucket[<span class="number">8</span>] * <span class="number">64</span> + bucket[<span class="number">9</span>] * <span class="number">-77</span> + bucket[<span class="number">10</span>] * <span class="number">49</span> + bucket[<span class="number">11</span>] * <span class="number">-19</span> + bucket[<span class="number">12</span>] * <span class="number">72</span> + bucket[<span class="number">13</span>] * <span class="number">-64</span> + bucket[<span class="number">14</span>] * <span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">54</span> == <span class="number">1721</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">36</span> + bucket[<span class="number">1</span>] * <span class="number">-21</span> + bucket[<span class="number">2</span>] * <span class="number">-59</span> + bucket[<span class="number">3</span>] * <span class="number">-54</span> + bucket[<span class="number">4</span>] * <span class="number">-96</span> + bucket[<span class="number">5</span>] * <span class="number">-81</span> + bucket[<span class="number">6</span>] * <span class="number">-33</span> + bucket[<span class="number">7</span>] * <span class="number">31</span> + bucket[<span class="number">8</span>] * <span class="number">-41</span> + bucket[<span class="number">9</span>] * <span class="number">-70</span> + bucket[<span class="number">10</span>] * <span class="number">-27</span> + bucket[<span class="number">11</span>] * <span class="number">24</span> + bucket[<span class="number">12</span>] * <span class="number">95</span> + bucket[<span class="number">13</span>] * <span class="number">-61</span> + bucket[<span class="number">14</span>] * <span class="number">-17</span> + bucket[<span class="number">15</span>] * <span class="number">-52</span> == <span class="number">-2198</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">78</span> + bucket[<span class="number">1</span>] * <span class="number">-62</span> + bucket[<span class="number">2</span>] * <span class="number">70</span> + bucket[<span class="number">3</span>] * <span class="number">-69</span> + bucket[<span class="number">4</span>] * <span class="number">38</span> + bucket[<span class="number">5</span>] * <span class="number">90</span> + bucket[<span class="number">6</span>] * <span class="number">-52</span> + bucket[<span class="number">7</span>] * <span class="number">41</span> + bucket[<span class="number">8</span>] * <span class="number">63</span> + bucket[<span class="number">9</span>] * <span class="number">-65</span> + bucket[<span class="number">10</span>] * <span class="number">-15</span> + bucket[<span class="number">11</span>] * <span class="number">59</span> + bucket[<span class="number">12</span>] * <span class="number">-31</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">33</span> + bucket[<span class="number">15</span>] * <span class="number">-57</span> == <span class="number">-1833</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">56</span> + bucket[<span class="number">1</span>] * <span class="number">75</span> + bucket[<span class="number">2</span>] * <span class="number">71</span> + bucket[<span class="number">3</span>] * <span class="number">78</span> + bucket[<span class="number">4</span>] * <span class="number">-39</span> + bucket[<span class="number">5</span>] * <span class="number">-84</span> + bucket[<span class="number">6</span>] * <span class="number">55</span> + bucket[<span class="number">7</span>] * <span class="number">54</span> + bucket[<span class="number">8</span>] * <span class="number">-12</span> + bucket[<span class="number">9</span>] * <span class="number">-57</span> + bucket[<span class="number">10</span>] * <span class="number">32</span> + bucket[<span class="number">11</span>] * <span class="number">-19</span> + bucket[<span class="number">12</span>] * <span class="number">13</span> + bucket[<span class="number">13</span>] * <span class="number">-83</span> + bucket[<span class="number">14</span>] * <span class="number">11</span> + bucket[<span class="number">15</span>] * <span class="number">-67</span> == <span class="number">829</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">10</span> + bucket[<span class="number">1</span>] * <span class="number">-97</span> + bucket[<span class="number">2</span>] * <span class="number">56</span> + bucket[<span class="number">3</span>] * <span class="number">-61</span> + bucket[<span class="number">4</span>] * <span class="number">45</span> + bucket[<span class="number">5</span>] * <span class="number">-22</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">81</span> + bucket[<span class="number">8</span>] * <span class="number">32</span> + bucket[<span class="number">9</span>] * <span class="number">49</span> + bucket[<span class="number">10</span>] * <span class="number">-19</span> + bucket[<span class="number">11</span>] * <span class="number">-18</span> + bucket[<span class="number">12</span>] * <span class="number">80</span> + bucket[<span class="number">13</span>] * <span class="number">-98</span> + bucket[<span class="number">14</span>] * <span class="number">79</span> + bucket[<span class="number">15</span>] * <span class="number">-36</span> == <span class="number">-2551</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">24</span> + bucket[<span class="number">1</span>] * <span class="number">-61</span> + bucket[<span class="number">2</span>] * <span class="number">91</span> + bucket[<span class="number">3</span>] * <span class="number">93</span> + bucket[<span class="number">4</span>] * <span class="number">76</span> + bucket[<span class="number">5</span>] * <span class="number">54</span> + bucket[<span class="number">6</span>] * <span class="number">-33</span> + bucket[<span class="number">7</span>] * <span class="number">-29</span> + bucket[<span class="number">8</span>] * <span class="number">-72</span> + bucket[<span class="number">9</span>] * <span class="number">20</span> + bucket[<span class="number">10</span>] * <span class="number">48</span> + bucket[<span class="number">11</span>] * <span class="number">79</span> + bucket[<span class="number">12</span>] * <span class="number">76</span> + bucket[<span class="number">13</span>] * <span class="number">68</span> + bucket[<span class="number">14</span>] * <span class="number">51</span> + bucket[<span class="number">15</span>] * <span class="number">25</span> == <span class="number">2996</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-83</span> + bucket[<span class="number">1</span>] * <span class="number">-77</span> + bucket[<span class="number">2</span>] * <span class="number">-64</span> + bucket[<span class="number">3</span>] * <span class="number">-38</span> + bucket[<span class="number">4</span>] * <span class="number">-13</span> + bucket[<span class="number">5</span>] * <span class="number">-85</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">-76</span> + bucket[<span class="number">8</span>] * <span class="number">27</span> + bucket[<span class="number">9</span>] * <span class="number">14</span> + bucket[<span class="number">10</span>] * <span class="number">-79</span> + bucket[<span class="number">11</span>] * <span class="number">-63</span> + bucket[<span class="number">12</span>] * <span class="number">-78</span> + bucket[<span class="number">13</span>] * <span class="number">53</span> + bucket[<span class="number">14</span>] * <span class="number">-73</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">-2315</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">84</span> + bucket[<span class="number">1</span>] * <span class="number">-67</span> + bucket[<span class="number">2</span>] * <span class="number">57</span> + bucket[<span class="number">3</span>] * <span class="number">26</span> + bucket[<span class="number">4</span>] * <span class="number">94</span> + bucket[<span class="number">5</span>] * <span class="number">20</span> + bucket[<span class="number">6</span>] * <span class="number">-71</span> + bucket[<span class="number">7</span>] * <span class="number">-88</span> + bucket[<span class="number">8</span>] * <span class="number">-28</span> + bucket[<span class="number">9</span>] * <span class="number">-13</span> + bucket[<span class="number">10</span>] * <span class="number">-40</span> + bucket[<span class="number">11</span>] * <span class="number">76</span> + bucket[<span class="number">12</span>] * <span class="number">-14</span> + bucket[<span class="number">13</span>] * <span class="number">33</span> + bucket[<span class="number">14</span>] * <span class="number">76</span> + bucket[<span class="number">15</span>] * <span class="number">-75</span> == <span class="number">-150</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-60</span> + bucket[<span class="number">1</span>] * <span class="number">88</span> + bucket[<span class="number">2</span>] * <span class="number">-66</span> + bucket[<span class="number">3</span>] * <span class="number">-72</span> + bucket[<span class="number">4</span>] * <span class="number">41</span> + bucket[<span class="number">5</span>] * <span class="number">49</span> + bucket[<span class="number">6</span>] * <span class="number">48</span> + bucket[<span class="number">7</span>] * <span class="number">-77</span> + bucket[<span class="number">8</span>] * <span class="number">-42</span> + bucket[<span class="number">9</span>] * <span class="number">25</span> + bucket[<span class="number">10</span>] * <span class="number">-50</span> + bucket[<span class="number">11</span>] * <span class="number">-84</span> + bucket[<span class="number">12</span>] * <span class="number">40</span> + bucket[<span class="number">13</span>] * <span class="number">50</span> + bucket[<span class="number">14</span>] * <span class="number">-83</span> + bucket[<span class="number">15</span>] * <span class="number">-27</span> == <span class="number">-1919</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-16</span> + bucket[<span class="number">1</span>] * <span class="number">-53</span> + bucket[<span class="number">2</span>] * <span class="number">-21</span> + bucket[<span class="number">3</span>] * <span class="number">-44</span> + bucket[<span class="number">4</span>] * <span class="number">26</span> + bucket[<span class="number">5</span>] * <span class="number">-56</span> + bucket[<span class="number">6</span>] * <span class="number">-90</span> + bucket[<span class="number">7</span>] * <span class="number">-93</span> + bucket[<span class="number">8</span>] * <span class="number">-73</span> + bucket[<span class="number">9</span>] * <span class="number">48</span> + bucket[<span class="number">10</span>] * <span class="number">15</span> + bucket[<span class="number">11</span>] * <span class="number">-43</span> + bucket[<span class="number">12</span>] * <span class="number">-61</span> + bucket[<span class="number">13</span>] * <span class="number">-24</span> + bucket[<span class="number">14</span>] * <span class="number">71</span> + bucket[<span class="number">15</span>] * <span class="number">67</span> == <span class="number">-1199</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">55</span> + bucket[<span class="number">1</span>] * <span class="number">-34</span> + bucket[<span class="number">2</span>] * <span class="number">-22</span> + bucket[<span class="number">3</span>] * <span class="number">60</span> + bucket[<span class="number">4</span>] * <span class="number">93</span> + bucket[<span class="number">5</span>] * <span class="number">-95</span> + bucket[<span class="number">6</span>] * <span class="number">50</span> + bucket[<span class="number">7</span>] * <span class="number">36</span> + bucket[<span class="number">8</span>] * <span class="number">-48</span> + bucket[<span class="number">9</span>] * <span class="number">-26</span> + bucket[<span class="number">10</span>] * <span class="number">-94</span> + bucket[<span class="number">11</span>] * <span class="number">-35</span> + bucket[<span class="number">12</span>] * <span class="number">21</span> + bucket[<span class="number">13</span>] * <span class="number">-27</span> + bucket[<span class="number">14</span>] * <span class="number">91</span> + bucket[<span class="number">15</span>] * <span class="number">-76</span> == <span class="number">-1163</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">64</span> + bucket[<span class="number">1</span>] * <span class="number">-50</span> + bucket[<span class="number">2</span>] * <span class="number">-23</span> + bucket[<span class="number">3</span>] * <span class="number">-70</span> + bucket[<span class="number">4</span>] * <span class="number">-78</span> + bucket[<span class="number">5</span>] * <span class="number">34</span> + bucket[<span class="number">6</span>] * <span class="number">26</span> + bucket[<span class="number">7</span>] * <span class="number">64</span> + bucket[<span class="number">8</span>] * <span class="number">-72</span> + bucket[<span class="number">9</span>] * <span class="number">10</span> + bucket[<span class="number">10</span>] * <span class="number">-96</span> + bucket[<span class="number">11</span>] * <span class="number">61</span> + bucket[<span class="number">12</span>] * <span class="number">-15</span> + bucket[<span class="number">13</span>] * <span class="number">31</span> + bucket[<span class="number">14</span>] * <span class="number">36</span> + bucket[<span class="number">15</span>] * <span class="number">50</span> == <span class="number">-266</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-27</span> + bucket[<span class="number">1</span>] * <span class="number">86</span> + bucket[<span class="number">2</span>] * <span class="number">-61</span> + bucket[<span class="number">3</span>] * <span class="number">89</span> + bucket[<span class="number">4</span>] * <span class="number">-53</span> + bucket[<span class="number">5</span>] * <span class="number">10</span> + bucket[<span class="number">6</span>] * <span class="number">-42</span> + bucket[<span class="number">7</span>] * <span class="number">92</span> + bucket[<span class="number">8</span>] * <span class="number">-48</span> + bucket[<span class="number">9</span>] * <span class="number">13</span> + bucket[<span class="number">10</span>] * <span class="number">84</span> + bucket[<span class="number">11</span>] * <span class="number">-71</span> + bucket[<span class="number">12</span>] * <span class="number">93</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">-69</span> + bucket[<span class="number">15</span>] * <span class="number">-30</span> == <span class="number">892</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>尝试z3:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">bucket = [Int(<span class="string">&#x27;bucket[%d]&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(And(bucket[<span class="number">0</span>] * <span class="number">40</span> + bucket[<span class="number">1</span>] * <span class="number">65</span> + bucket[<span class="number">2</span>] * -<span class="number">53</span> + bucket[<span class="number">3</span>] * <span class="number">70</span> + bucket[<span class="number">4</span>] * -<span class="number">84</span> + bucket[<span class="number">5</span>] * -<span class="number">38</span> + bucket[<span class="number">6</span>] * <span class="number">94</span> + bucket[<span class="number">7</span>] * -<span class="number">39</span> + bucket[<span class="number">8</span>] * -<span class="number">91</span> + bucket[<span class="number">9</span>] * -<span class="number">35</span> + bucket[<span class="number">10</span>] * <span class="number">54</span> + bucket[<span class="number">11</span>] * <span class="number">17</span> + bucket[<span class="number">12</span>] * <span class="number">45</span> + bucket[<span class="number">13</span>] * <span class="number">92</span> + bucket[<span class="number">14</span>] * -<span class="number">29</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">3004</span> , bucket[<span class="number">0</span>] * -<span class="number">15</span> + bucket[<span class="number">1</span>] * <span class="number">74</span> + bucket[<span class="number">2</span>] * -<span class="number">89</span> + bucket[<span class="number">3</span>] * -<span class="number">82</span> + bucket[<span class="number">4</span>] * -<span class="number">92</span> + bucket[<span class="number">5</span>] * <span class="number">27</span> + bucket[<span class="number">6</span>] * <span class="number">21</span> + bucket[<span class="number">7</span>] * -<span class="number">24</span> + bucket[<span class="number">8</span>] * -<span class="number">82</span> + bucket[<span class="number">9</span>] * -<span class="number">58</span> + bucket[<span class="number">10</span>] * -<span class="number">36</span> + bucket[<span class="number">11</span>] * <span class="number">64</span> + bucket[<span class="number">12</span>] * -<span class="number">49</span> + bucket[<span class="number">13</span>] * -<span class="number">22</span> + bucket[<span class="number">14</span>] * <span class="number">59</span> + bucket[<span class="number">15</span>] * -<span class="number">47</span> == -<span class="number">674</span> , bucket[<span class="number">0</span>] * <span class="number">67</span> + bucket[<span class="number">1</span>] * -<span class="number">23</span> + bucket[<span class="number">2</span>] * <span class="number">63</span> + bucket[<span class="number">3</span>] * -<span class="number">38</span> + bucket[<span class="number">4</span>] * -<span class="number">32</span> + bucket[<span class="number">5</span>] * <span class="number">61</span> + bucket[<span class="number">6</span>] * -<span class="number">71</span> + bucket[<span class="number">7</span>] * <span class="number">49</span> + bucket[<span class="number">8</span>] * <span class="number">83</span> + bucket[<span class="number">9</span>] * -<span class="number">92</span> + bucket[<span class="number">10</span>] * -<span class="number">16</span> + bucket[<span class="number">11</span>] * <span class="number">65</span> + bucket[<span class="number">12</span>] * -<span class="number">22</span> + bucket[<span class="number">13</span>] * <span class="number">12</span> + bucket[<span class="number">14</span>] * -<span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">74</span> == <span class="number">945</span> , bucket[<span class="number">0</span>] * -<span class="number">49</span> + bucket[<span class="number">1</span>] * <span class="number">48</span> + bucket[<span class="number">2</span>] * -<span class="number">11</span> + bucket[<span class="number">3</span>] * <span class="number">20</span> + bucket[<span class="number">4</span>] * -<span class="number">14</span> + bucket[<span class="number">5</span>] * <span class="number">92</span> + bucket[<span class="number">6</span>] * -<span class="number">19</span> + bucket[<span class="number">7</span>] * <span class="number">32</span> + bucket[<span class="number">8</span>] * <span class="number">64</span> + bucket[<span class="number">9</span>] * -<span class="number">77</span> + bucket[<span class="number">10</span>] * <span class="number">49</span> + bucket[<span class="number">11</span>] * -<span class="number">19</span> + bucket[<span class="number">12</span>] * <span class="number">72</span> + bucket[<span class="number">13</span>] * -<span class="number">64</span> + bucket[<span class="number">14</span>] * <span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">54</span> == <span class="number">1721</span> , bucket[<span class="number">0</span>] * <span class="number">36</span> + bucket[<span class="number">1</span>] * -<span class="number">21</span> + bucket[<span class="number">2</span>] * -<span class="number">59</span> + bucket[<span class="number">3</span>] * -<span class="number">54</span> + bucket[<span class="number">4</span>] * -<span class="number">96</span> + bucket[<span class="number">5</span>] * -<span class="number">81</span> + bucket[<span class="number">6</span>] * -<span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">31</span> + bucket[<span class="number">8</span>] * -<span class="number">41</span> + bucket[<span class="number">9</span>] * -<span class="number">70</span> + bucket[<span class="number">10</span>] * -<span class="number">27</span> + bucket[<span class="number">11</span>] * <span class="number">24</span> + bucket[<span class="number">12</span>] * <span class="number">95</span> + bucket[<span class="number">13</span>] * -<span class="number">61</span> + bucket[<span class="number">14</span>] * -<span class="number">17</span> + bucket[<span class="number">15</span>] * -<span class="number">52</span> == -<span class="number">2198</span> , bucket[<span class="number">0</span>] * <span class="number">78</span> + bucket[<span class="number">1</span>] * -<span class="number">62</span> + bucket[<span class="number">2</span>] * <span class="number">70</span> + bucket[<span class="number">3</span>] * -<span class="number">69</span> + bucket[<span class="number">4</span>] * <span class="number">38</span> + bucket[<span class="number">5</span>] * <span class="number">90</span> + bucket[<span class="number">6</span>] * -<span class="number">52</span> + bucket[<span class="number">7</span>] * <span class="number">41</span> + bucket[<span class="number">8</span>] * <span class="number">63</span> + bucket[<span class="number">9</span>] * -<span class="number">65</span> + bucket[<span class="number">10</span>] * -<span class="number">15</span> + bucket[<span class="number">11</span>] * <span class="number">59</span> + bucket[<span class="number">12</span>] * -<span class="number">31</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">33</span> + bucket[<span class="number">15</span>] * -<span class="number">57</span> == -<span class="number">1833</span> , bucket[<span class="number">0</span>] * <span class="number">56</span> + bucket[<span class="number">1</span>] * <span class="number">75</span> + bucket[<span class="number">2</span>] * <span class="number">71</span> + bucket[<span class="number">3</span>] * <span class="number">78</span> + bucket[<span class="number">4</span>] * -<span class="number">39</span> + bucket[<span class="number">5</span>] * -<span class="number">84</span> + bucket[<span class="number">6</span>] * <span class="number">55</span> + bucket[<span class="number">7</span>] * <span class="number">54</span> + bucket[<span class="number">8</span>] * -<span class="number">12</span> + bucket[<span class="number">9</span>] * -<span class="number">57</span> + bucket[<span class="number">10</span>] * <span class="number">32</span> + bucket[<span class="number">11</span>] * -<span class="number">19</span> + bucket[<span class="number">12</span>] * <span class="number">13</span> + bucket[<span class="number">13</span>] * -<span class="number">83</span> + bucket[<span class="number">14</span>] * <span class="number">11</span> + bucket[<span class="number">15</span>] * -<span class="number">67</span> == <span class="number">829</span> , bucket[<span class="number">0</span>] * <span class="number">10</span> + bucket[<span class="number">1</span>] * -<span class="number">97</span> + bucket[<span class="number">2</span>] * <span class="number">56</span> + bucket[<span class="number">3</span>] * -<span class="number">61</span> + bucket[<span class="number">4</span>] * <span class="number">45</span> + bucket[<span class="number">5</span>] * -<span class="number">22</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">81</span> + bucket[<span class="number">8</span>] * <span class="number">32</span> + bucket[<span class="number">9</span>] * <span class="number">49</span> + bucket[<span class="number">10</span>] * -<span class="number">19</span> + bucket[<span class="number">11</span>] * -<span class="number">18</span> + bucket[<span class="number">12</span>] * <span class="number">80</span> + bucket[<span class="number">13</span>] * -<span class="number">98</span> + bucket[<span class="number">14</span>] * <span class="number">79</span> + bucket[<span class="number">15</span>] * -<span class="number">36</span> == -<span class="number">2551</span> , bucket[<span class="number">0</span>] * <span class="number">24</span> + bucket[<span class="number">1</span>] * -<span class="number">61</span> + bucket[<span class="number">2</span>] * <span class="number">91</span> + bucket[<span class="number">3</span>] * <span class="number">93</span> + bucket[<span class="number">4</span>] * <span class="number">76</span> + bucket[<span class="number">5</span>] * <span class="number">54</span> + bucket[<span class="number">6</span>] * -<span class="number">33</span> + bucket[<span class="number">7</span>] * -<span class="number">29</span> + bucket[<span class="number">8</span>] * -<span class="number">72</span> + bucket[<span class="number">9</span>] * <span class="number">20</span> + bucket[<span class="number">10</span>] * <span class="number">48</span> + bucket[<span class="number">11</span>] * <span class="number">79</span> + bucket[<span class="number">12</span>] * <span class="number">76</span> + bucket[<span class="number">13</span>] * <span class="number">68</span> + bucket[<span class="number">14</span>] * <span class="number">51</span> + bucket[<span class="number">15</span>] * <span class="number">25</span> == <span class="number">2996</span> , bucket[<span class="number">0</span>] * -<span class="number">83</span> + bucket[<span class="number">1</span>] * -<span class="number">77</span> + bucket[<span class="number">2</span>] * -<span class="number">64</span> + bucket[<span class="number">3</span>] * -<span class="number">38</span> + bucket[<span class="number">4</span>] * -<span class="number">13</span> + bucket[<span class="number">5</span>] * -<span class="number">85</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * -<span class="number">76</span> + bucket[<span class="number">8</span>] * <span class="number">27</span> + bucket[<span class="number">9</span>] * <span class="number">14</span> + bucket[<span class="number">10</span>] * -<span class="number">79</span> + bucket[<span class="number">11</span>] * -<span class="number">63</span> + bucket[<span class="number">12</span>] * -<span class="number">78</span> + bucket[<span class="number">13</span>] * <span class="number">53</span> + bucket[<span class="number">14</span>] * -<span class="number">73</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == -<span class="number">2315</span> , bucket[<span class="number">0</span>] * <span class="number">84</span> + bucket[<span class="number">1</span>] * -<span class="number">67</span> + bucket[<span class="number">2</span>] * <span class="number">57</span> + bucket[<span class="number">3</span>] * <span class="number">26</span> + bucket[<span class="number">4</span>] * <span class="number">94</span> + bucket[<span class="number">5</span>] * <span class="number">20</span> + bucket[<span class="number">6</span>] * -<span class="number">71</span> + bucket[<span class="number">7</span>] * -<span class="number">88</span> + bucket[<span class="number">8</span>] * -<span class="number">28</span> + bucket[<span class="number">9</span>] * -<span class="number">13</span> + bucket[<span class="number">10</span>] * -<span class="number">40</span> + bucket[<span class="number">11</span>] * <span class="number">76</span> + bucket[<span class="number">12</span>] * -<span class="number">14</span> + bucket[<span class="number">13</span>] * <span class="number">33</span> + bucket[<span class="number">14</span>] * <span class="number">76</span> + bucket[<span class="number">15</span>] * -<span class="number">75</span> == -<span class="number">150</span> , bucket[<span class="number">0</span>] * -<span class="number">60</span> + bucket[<span class="number">1</span>] * <span class="number">88</span> + bucket[<span class="number">2</span>] * -<span class="number">66</span> + bucket[<span class="number">3</span>] * -<span class="number">72</span> + bucket[<span class="number">4</span>] * <span class="number">41</span> + bucket[<span class="number">5</span>] * <span class="number">49</span> + bucket[<span class="number">6</span>] * <span class="number">48</span> + bucket[<span class="number">7</span>] * -<span class="number">77</span> + bucket[<span class="number">8</span>] * -<span class="number">42</span> + bucket[<span class="number">9</span>] * <span class="number">25</span> + bucket[<span class="number">10</span>] * -<span class="number">50</span> + bucket[<span class="number">11</span>] * -<span class="number">84</span> + bucket[<span class="number">12</span>] * <span class="number">40</span> + bucket[<span class="number">13</span>] * <span class="number">50</span> + bucket[<span class="number">14</span>] * -<span class="number">83</span> + bucket[<span class="number">15</span>] * -<span class="number">27</span> == -<span class="number">1919</span> , bucket[<span class="number">0</span>] * -<span class="number">16</span> + bucket[<span class="number">1</span>] * -<span class="number">53</span> + bucket[<span class="number">2</span>] * -<span class="number">21</span> + bucket[<span class="number">3</span>] * -<span class="number">44</span> + bucket[<span class="number">4</span>] * <span class="number">26</span> + bucket[<span class="number">5</span>] * -<span class="number">56</span> + bucket[<span class="number">6</span>] * -<span class="number">90</span> + bucket[<span class="number">7</span>] * -<span class="number">93</span> + bucket[<span class="number">8</span>] * -<span class="number">73</span> + bucket[<span class="number">9</span>] * <span class="number">48</span> + bucket[<span class="number">10</span>] * <span class="number">15</span> + bucket[<span class="number">11</span>] * -<span class="number">43</span> + bucket[<span class="number">12</span>] * -<span class="number">61</span> + bucket[<span class="number">13</span>] * -<span class="number">24</span> + bucket[<span class="number">14</span>] * <span class="number">71</span> + bucket[<span class="number">15</span>] * <span class="number">67</span> == -<span class="number">1199</span> , bucket[<span class="number">0</span>] * <span class="number">55</span> + bucket[<span class="number">1</span>] * -<span class="number">34</span> + bucket[<span class="number">2</span>] * -<span class="number">22</span> + bucket[<span class="number">3</span>] * <span class="number">60</span> + bucket[<span class="number">4</span>] * <span class="number">93</span> + bucket[<span class="number">5</span>] * -<span class="number">95</span> + bucket[<span class="number">6</span>] * <span class="number">50</span> + bucket[<span class="number">7</span>] * <span class="number">36</span> + bucket[<span class="number">8</span>] * -<span class="number">48</span> + bucket[<span class="number">9</span>] * -<span class="number">26</span> + bucket[<span class="number">10</span>] * -<span class="number">94</span> + bucket[<span class="number">11</span>] * -<span class="number">35</span> + bucket[<span class="number">12</span>] * <span class="number">21</span> + bucket[<span class="number">13</span>] * -<span class="number">27</span> + bucket[<span class="number">14</span>] * <span class="number">91</span> + bucket[<span class="number">15</span>] * -<span class="number">76</span> == -<span class="number">1163</span> , bucket[<span class="number">0</span>] * <span class="number">64</span> + bucket[<span class="number">1</span>] * -<span class="number">50</span> + bucket[<span class="number">2</span>] * -<span class="number">23</span> + bucket[<span class="number">3</span>] * -<span class="number">70</span> + bucket[<span class="number">4</span>] * -<span class="number">78</span> + bucket[<span class="number">5</span>] * <span class="number">34</span> + bucket[<span class="number">6</span>] * <span class="number">26</span> + bucket[<span class="number">7</span>] * <span class="number">64</span> + bucket[<span class="number">8</span>] * -<span class="number">72</span> + bucket[<span class="number">9</span>] * <span class="number">10</span> + bucket[<span class="number">10</span>] * -<span class="number">96</span> + bucket[<span class="number">11</span>] * <span class="number">61</span> + bucket[<span class="number">12</span>] * -<span class="number">15</span> + bucket[<span class="number">13</span>] * <span class="number">31</span> + bucket[<span class="number">14</span>] * <span class="number">36</span> + bucket[<span class="number">15</span>] * <span class="number">50</span> == -<span class="number">266</span> , bucket[<span class="number">0</span>] * -<span class="number">27</span> + bucket[<span class="number">1</span>] * <span class="number">86</span> + bucket[<span class="number">2</span>] * -<span class="number">61</span> + bucket[<span class="number">3</span>] * <span class="number">89</span> + bucket[<span class="number">4</span>] * -<span class="number">53</span> + bucket[<span class="number">5</span>] * <span class="number">10</span> + bucket[<span class="number">6</span>] * -<span class="number">42</span> + bucket[<span class="number">7</span>] * <span class="number">92</span> + bucket[<span class="number">8</span>] * -<span class="number">48</span> + bucket[<span class="number">9</span>] * <span class="number">13</span> + bucket[<span class="number">10</span>] * <span class="number">84</span> + bucket[<span class="number">11</span>] * -<span class="number">71</span> + bucket[<span class="number">12</span>] * <span class="number">93</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * -<span class="number">69</span> + bucket[<span class="number">15</span>] * -<span class="number">30</span> == <span class="number">892</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this.bucket[%d] = %s;&#x27;</span> % (i, m[bucket[i]]))</span><br><span class="line">       <span class="comment"># print(&#x27;%s,&#x27;% m[bucket[i]],end=&#x27;&#x27;)</span></span><br><span class="line"><span class="comment">#this.bucket[0] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[1] = 14;</span></span><br><span class="line"><span class="comment">#this.bucket[2] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[3] = 17;</span></span><br><span class="line"><span class="comment">#this.bucket[4] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[5] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[6] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[7] = 0;</span></span><br><span class="line"><span class="comment">#this.bucket[8] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[9] = 4;</span></span><br><span class="line"><span class="comment">#this.bucket[10] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[11] = 17;</span></span><br><span class="line"><span class="comment">#this.bucket[12] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[13] = 0;</span></span><br><span class="line"><span class="comment">#this.bucket[14] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[15] = 16;</span></span><br></pre></td></tr></table></figure><p>那么在int[] bucket &#x3D; GachaManager.instance.gachaHistoryBucket.GetBucket();中直接写入bucket的值，右键-&gt;编辑方法-&gt;写入上面的内容-&gt;编译-&gt;上面工具栏保存所有-&gt;打开主程序-&gt;出金</p><p><img src="https://s2.loli.net/2024/02/16/q9Az37dHfU52bsl.png" alt="image-20240216121732007"></p><h3 id="EzADVM"><a href="#EzADVM" class="headerlink" title="EzADVM"></a>EzADVM</h3><p>这个是个安卓vm，jadx打开，然后打开main_activity,</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">CheckClick</span><span class="params">(View a)</span> &#123;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.sampleText;</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">flagText</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.flagtext;</span><br><span class="line">        <span class="type">String</span> <span class="variable">flagstring</span> <span class="operator">=</span> flagText.getText().toString();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Right!&quot;</span>.equals(stringFromJNI(flagstring))) &#123;</span><br><span class="line">            tv.setText(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">            tv.setTextColor(-<span class="number">16711936</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>看到有stringFromJNI(flagstring)，去找函数原型，没找到，应该在库里。</p><p>用apktool反编译出源代码。打开so文件</p><p>重点是这些：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">now_num = <span class="number">0</span>;</span><br><span class="line">  i = <span class="number">1</span>;</span><br><span class="line">  used_char = _JNIEnv::GetStringUTFChars(in, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !i++ )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_29:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string&lt;decltype(nullptr)&gt;(v14, <span class="string">&quot;Error!&quot;</span>);</span><br><span class="line">        v7 = (<span class="type">const</span> <span class="type">char</span> *)sub_20F50(v14);</span><br><span class="line">        v13 = _JNIEnv::NewStringUTF(in, v7);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v14);</span><br><span class="line">        <span class="keyword">return</span> v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( code[i] != <span class="number">0x21</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      __strcpy_chk(input, used_char, <span class="number">1024LL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0xFF</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0x88</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( code[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xA1</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = or_not_num &amp; or_num;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xC3</span>u:</span><br><span class="line">        or_num = b1 | b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB2</span>u:</span><br><span class="line">        not_1 = ~b1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xE5</span>u:</span><br><span class="line">        not_2 = ~b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xF1</span>u:</span><br><span class="line">        b1 = input[now_num];</span><br><span class="line">        b2 = input[++now_num];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xD4</span>u:</span><br><span class="line">        or_not_num = not_2 | not_1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBF</span>u:</span><br><span class="line">        i_form = now_num++;</span><br><span class="line">        save[<span class="number">0</span>] = s[i_form];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x99</span>u:</span><br><span class="line">        now_num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBB</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = now_num + save[<span class="number">0</span>] - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;last, s, <span class="number">0x20</span>uLL) )</span><br></pre></td></tr></table></figure><p>输入用来初始化input了，所以相当于是用指令码对input加密，最后得到last</p><p>以及一开始有一个循环只有当code[i]&#x3D;&#x3D;0先1时才会执行初始化，所以只需要匹配合理的指令即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, </span><br><span class="line">        <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, </span><br><span class="line">        <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x99</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x99</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x88</span>, <span class="number">0xFF</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> opcode:</span><br><span class="line">    <span class="keyword">match</span> code:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xa1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num - 1] = or_not_num &amp; or_num&quot;</span> )</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xc3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_num = b1 | b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xb2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_1 = ~b1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_2 = ~b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xf1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b1 = input[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num += 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b2 = input[now_num]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xd4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_not_num = not_2 | not_1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbf</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;save = last[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num+=1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x99</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num = 0&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbb</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num-1] = now_num + save - 1&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>大致是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0</span>]*<span class="number">100</span></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">now_num = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>然后化简逆向：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x42</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, </span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x31</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x67</span>, <span class="number">0x6E</span>, </span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x81</span>, </span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># last = [0]*100</span></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     b1 = input[now_num]</span></span><br><span class="line"><span class="comment">#     now_num += 1</span></span><br><span class="line"><span class="comment">#     b2 = input[now_num]</span></span><br><span class="line"><span class="comment">#     or_num = b1 | b2</span></span><br><span class="line"><span class="comment">#     not_1 = ~b1</span></span><br><span class="line"><span class="comment">#     not_2 = ~b2</span></span><br><span class="line"><span class="comment">#     or_not_num = not_2 | not_1</span></span><br><span class="line"><span class="comment">#     last[now_num - 1] = or_not_num &amp; or_num</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     save = last[now_num]</span></span><br><span class="line"><span class="comment">#     now_num+=1</span></span><br><span class="line"><span class="comment">#     last[now_num-1] = now_num + save - 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]-=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]^=last[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment">#NSSCTF&#123;H@ppy_Ch1ne5_NEwY3ar!1!1&#125;</span></span><br></pre></td></tr></table></figure><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="过年来下棋"><a href="#过年来下棋" class="headerlink" title="过年来下棋"></a>过年来下棋</h3><p>XXVAF AVXAX DXFVX DXDVA XAGV</p><p>很明显是棋盘密码ADFGVX</p><p>根据密文段数发现是key为5位</p><p>写脚本穷举：</p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">4h9343nse2r4</span>: abcde</span><br><span class="line"><span class="attribute">4gl393mgewr8</span>: abced</span><br><span class="line"><span class="attribute">4h9343ise2rf</span>: abdce</span><br><span class="line"><span class="attribute">44lz934mbwr2</span>: abdec</span><br><span class="line"><span class="attribute">4bl393cgd2r3</span>: abecd</span><br><span class="line"><span class="attribute">4fl3l3fmdkr2</span>: abedc</span><br><span class="line"><span class="attribute">5b98405sy2r4</span>: acbde</span><br><span class="line"><span class="attribute">5al8904gywr8</span>: acbed</span><br><span class="line"><span class="attribute">5g99y0ls2erf</span>: acdbe</span><br><span class="line"><span class="attribute">94fh8344nsq2</span>: acdeb</span><br><span class="line"><span class="attribute">5al930fg1er3</span>: acebd</span><br><span class="line"><span class="attribute">9fflk3f4pgq2</span>: acedb</span><br><span class="line"><span class="attribute">5b984z6sy2m9</span>: adbce</span><br><span class="line"><span class="attribute">9alk934mgwq8</span>: adbec</span><br><span class="line"><span class="attribute">5g99yzrs2em9</span>: adcbe</span><br><span class="line"><span class="attribute">94fh8344isq2</span>: adceb</span><br><span class="line"><span class="attribute">9all33fmjeq3</span>: adebc</span><br><span class="line"><span class="attribute">9fflk3f4jmq2</span>: adecb</span><br><span class="line"><span class="attribute">4bl89y6gs2q9</span>: aebcd</span><br><span class="line"><span class="attribute">4fl8ly9mskq8</span>: aebdc</span><br><span class="line"><span class="attribute">4gl93yrgweq9</span>: aecbd</span><br><span class="line"><span class="attribute">49f5ky94ugq2</span>: aecdb</span><br><span class="line"><span class="attribute">44l53y9mteq3</span>: aedbc</span><br><span class="line"><span class="attribute">49f5ky94tmq2</span>: aedcb</span><br><span class="line"><span class="attribute">fh8948nse264</span>: bacde</span><br><span class="line"><span class="attribute">fgk998mgew68</span>: baced</span><br><span class="line"><span class="attribute">fh8948ise26f</span>: badce</span><br><span class="line"><span class="attribute">f4k5984mbw62</span>: badec</span><br><span class="line"><span class="attribute">fbk998cgd263</span>: baecd</span><br><span class="line"><span class="attribute">ffk9l8fmdk62</span>: baedc</span><br><span class="line"><span class="attribute">b58946zsy29m</span>: bcade</span><br><span class="line"><span class="attribute">b4k996ygyw9q</span>: bcaed</span><br><span class="line"><span class="attribute">bl8946ks2e9c</span>: bcdae</span><br><span class="line"><span class="attribute">r44h9343nse2</span>: bcdea</span><br><span class="line"><span class="attribute">bfk996eg1e90</span>: bcead</span><br><span class="line"><span class="attribute">rf4ll3f3pge2</span>: bceda</span><br><span class="line"><span class="attribute">b589450sy24r</span>: bdace</span><br><span class="line"><span class="attribute">f4kl99ymgw8q</span>: bdaec</span><br><span class="line"><span class="attribute">bl8945qs2e46</span>: bdcae</span><br><span class="line"><span class="attribute">r44h9343ise2</span>: bdcea</span><br><span class="line"><span class="attribute">ffkl99emje80</span>: bdeac</span><br><span class="line"><span class="attribute">rf4ll3f3jme2</span>: bdeca</span><br><span class="line"><span class="attribute">a5k9940gs28r</span>: beacd</span><br><span class="line"><span class="attribute">a9k9l43msk8q</span>: beadc</span><br><span class="line"><span class="attribute">alk994qgwe86</span>: becad</span><br><span class="line"><span class="attribute">m945ly93uge2</span>: becda</span><br><span class="line"><span class="attribute">a9k5948mte80</span>: bedac</span><br><span class="line"><span class="attribute">m945ly93tme2</span>: bedca</span><br><span class="line"><span class="attribute">lb984q5wa264</span>: cabde</span><br><span class="line"><span class="attribute">lal89q4kaw68</span>: cabed</span><br><span class="line"><span class="attribute">lg99yqlwee6f</span>: cadbe</span><br><span class="line"><span class="attribute">94b58846bs02</span>: cadeb</span><br><span class="line"><span class="attribute">lal93qfkde63</span>: caebd</span><br><span class="line"><span class="attribute">9fb9k8f6dg02</span>: caedb</span><br><span class="line"><span class="attribute">g5934rzwa29m</span>: cbade</span><br><span class="line"><span class="attribute">g4l39rykaw9q</span>: cbaed</span><br><span class="line"><span class="attribute">gl934rkwee9c</span>: cbdae</span><br><span class="line"><span class="attribute">645b98405sy2</span>: cbdea</span><br><span class="line"><span class="attribute">gfl39rekde90</span>: cbead</span><br><span class="line"><span class="attribute">6f5fl8f07gy2</span>: cbeda</span><br><span class="line"><span class="attribute">h499yn3wye4r</span>: cdabe</span><br><span class="line"><span class="attribute">94bl89y6gs2q</span>: cdaeb</span><br><span class="line"><span class="attribute">hf984n8wye46</span>: cdbae</span><br><span class="line"><span class="attribute">9m5g99y0ls2e</span>: cdbea</span><br><span class="line"><span class="attribute">9fbl89e6ja20</span>: cdeab</span><br><span class="line"><span class="attribute">9c5lf9e0j42y</span>: cdeba</span><br><span class="line"><span class="attribute">g4l93m3kse8r</span>: ceabd</span><br><span class="line"><span class="attribute">49b9k436sg2q</span>: ceadb</span><br><span class="line"><span class="attribute">gfl89m8kse86</span>: cebad</span><br><span class="line"><span class="attribute">4r54l430xg2e</span>: cebda</span><br><span class="line"><span class="attribute">49b58486ta20</span>: cedab</span><br><span class="line"><span class="attribute">4655f480t42y</span>: cedba</span><br><span class="line"><span class="attribute">lb984k6wa2c9</span>: dabce</span><br><span class="line"><span class="attribute">9ah8984naw08</span>: dabec</span><br><span class="line"><span class="attribute">lg99ykrweec9</span>: dacbe</span><br><span class="line"><span class="attribute">94b58845cs02</span>: daceb</span><br><span class="line"><span class="attribute">9ah938fnde03</span>: daebc</span><br><span class="line"><span class="attribute">9fb9k8f5dm02</span>: daecb</span><br><span class="line"><span class="attribute">g5934l0wa2fr</span>: dbace</span><br><span class="line"><span class="attribute">44h399ynaw3q</span>: dbaec</span><br><span class="line"><span class="attribute">gl934lqweef6</span>: dbcae</span><br><span class="line"><span class="attribute">645b984z6sy2</span>: dbcea</span><br><span class="line"><span class="attribute">4fh399ende30</span>: dbeac</span><br><span class="line"><span class="attribute">6f5fl8fz7my2</span>: dbeca</span><br><span class="line"><span class="attribute">h499yi3wyefr</span>: dcabe</span><br><span class="line"><span class="attribute">94bl89y5ms2q</span>: dcaeb</span><br><span class="line"><span class="attribute">hf984i8wyef6</span>: dcbae</span><br><span class="line"><span class="attribute">9m5g99yzrs2e</span>: dcbea</span><br><span class="line"><span class="attribute">9fbl89e5pa20</span>: dceab</span><br><span class="line"><span class="attribute">9c5lf9ezp42y</span>: dceba</span><br><span class="line"><span class="attribute">44h9343nse2r</span>: deabc</span><br><span class="line"><span class="attribute">49b9k435sm2q</span>: deacb</span><br><span class="line"><span class="attribute">4fh8948nse26</span>: debac</span><br><span class="line"><span class="attribute">4r54l43zxm2e</span>: debca</span><br><span class="line"><span class="attribute">49b58485ua20</span>: decab</span><br><span class="line"><span class="attribute">4655f48zu42y</span>: decba</span><br><span class="line"><span class="attribute">fbl89e6ja209</span>: eabcd</span><br><span class="line"><span class="attribute">ffl8le9pak08</span>: eabdc</span><br><span class="line"><span class="attribute">fgl93erjee09</span>: eacbd</span><br><span class="line"><span class="attribute">f9f5ke97cg02</span>: eacdb</span><br><span class="line"><span class="attribute">f4l53e9pbe03</span>: eadbc</span><br><span class="line"><span class="attribute">f9f5ke97bm02</span>: eadcb</span><br><span class="line"><span class="attribute">a5l39f0ja23r</span>: ebacd</span><br><span class="line"><span class="attribute">a9l3lf3pak3q</span>: ebadc</span><br><span class="line"><span class="attribute">all39fqjee36</span>: ebcad</span><br><span class="line"><span class="attribute">c99ble916gy2</span>: ebcda</span><br><span class="line"><span class="attribute">a9lz9f8pbe30</span>: ebdac</span><br><span class="line"><span class="attribute">c99ble915my2</span>: ebdca</span><br><span class="line"><span class="attribute">b4l93c3jye3r</span>: ecabd</span><br><span class="line"><span class="attribute">f9flkf37mg2q</span>: ecadb</span><br><span class="line"><span class="attribute">bfl89c8jye36</span>: ecbad</span><br><span class="line"><span class="attribute">fr9glf31rg2e</span>: ecbda</span><br><span class="line"><span class="attribute">f9fh8f87na20</span>: ecdab</span><br><span class="line"><span class="attribute">f69hff81n42y</span>: ecdba</span><br><span class="line"><span class="attribute">f4ll3f3pge2r</span>: edabc</span><br><span class="line"><span class="attribute">f9flkf37gm2q</span>: edacb</span><br><span class="line"><span class="attribute">fflk9f8pge26</span>: edbac</span><br><span class="line"><span class="attribute">fr9glf31lm2e</span>: edbca</span><br><span class="line"><span class="attribute">f9fh8f87ia20</span>: edcab</span><br><span class="line"><span class="attribute">f69hff81i42y</span>: edcba</span><br></pre></td></tr></table></figure><p>总不可能让我一个一个输吧。。看到题目</p><blockquote><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新年快乐呀！来一起下象棋吧！我都摆好咯~ 祝愿大家在新的一年里 lucky！flag格式：NSSCTF&#123;<span class="strong">**字母小写**</span>&#125;</span><br></pre></td></tr></table></figure></blockquote><p>唯一的五位key盲猜lucky，那么NSSCTF{h499yn3wye4r}</p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="温馨的酒吧"><a href="#温馨的酒吧" class="headerlink" title="温馨的酒吧"></a>温馨的酒吧</h3><p>看视频过完所有剧情即可拿flag</p><p>官方wp是遍历所有节点返回名字含flag的图片来得到的</p><p>注意有一段有5个乱码和中间正好一样，猜测：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;新年快乐_不要停下来啊_CTFer!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="userssssssssss"><a href="#userssssssssss" class="headerlink" title="userssssssssss"></a>userssssssssss</h3><p>进入后按创建日期排序，最后是laminous，打开看到flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;f9d04fc8-<span class="number">77</span>a6-<span class="number">4700</span>-b114-<span class="number">2</span>a071ff76ceb&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF_r17题目复现</title>
      <link href="/posts/b3e0bfc3.html"/>
      <url>/posts/b3e0bfc3.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h3><p>这个题是游戏题，相当于通关就可以得到最后的flag，可惜当时被go的抽象给蒙蔽了双眼，没有想去动调</p><p>逻辑大概是：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">10</span>; i = v65 + <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v65 = i;</span><br><span class="line">    snake_pkg_app_Run(<span class="number">20</span>, <span class="number">20</span>, v0, v1, (_DWORD)v2, v3, v4, v5, v6, v57, v58);</span><br><span class="line">    v74 = v8;</span><br><span class="line">    v15 = runtime_convT64(v65, <span class="number">20</span>, v10, v1, (_DWORD)v2, v11, v12, v13, v14, v57);</span><br><span class="line">    *(_QWORD *)&amp;v74 = &amp;RTYPE_int;</span><br><span class="line">    *((_QWORD *)&amp;v74 + <span class="number">1</span>) = v15;</span><br><span class="line">    v1 = <span class="number">19</span>;</span><br><span class="line">    v2 = &amp;v74;</span><br><span class="line">    fmt_Fprintf(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;%d Game round ends\n&quot;</span>,</span><br><span class="line">      <span class="number">19</span>,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v74,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v16,</span><br><span class="line">      v17,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61,</span><br><span class="line">      v62,</span><br><span class="line">      v63);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">10</span> &amp;&amp; qword_569E78 == <span class="number">400</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v73[<span class="number">0</span>] = &amp;RTYPE_string;</span><br><span class="line">    v73[<span class="number">1</span>] = &amp;off_4E5D98;</span><br><span class="line">    v18 = <span class="number">1</span>;</span><br><span class="line">    LODWORD(v19) = <span class="number">1</span>;</span><br><span class="line">    fmt_Fprintln(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)v73,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v3,</span><br><span class="line">      v4,</span><br><span class="line">      v5,</span><br><span class="line">      v6,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61);</span><br><span class="line">    v23 = snake_pkg_game_All_rand;</span><br><span class="line">    v71 = snake_pkg_game_All_rand;</span><br><span class="line">    v24 = qword_569E78;</span><br><span class="line">    v67 = qword_569E78;</span><br><span class="line">    v25 = <span class="number">0LL</span>;</span><br><span class="line">    v26 = <span class="number">0LL</span>;</span><br><span class="line">    v27 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v25 &lt; v24 )</span><br><span class="line">    &#123;</span><br><span class="line">      v66 = v25;</span><br><span class="line">      v64 = v26;</span><br><span class="line">      v70 = v27;</span><br><span class="line">      v28 = *(_QWORD *)(v23 + <span class="number">8</span> * v25);</span><br><span class="line">      v75 = v8;</span><br><span class="line">      v29 = runtime_convT64(v28, v27, v28, v18, v19, v24, v20, v21, v22, v57);</span><br><span class="line">      *(_QWORD *)&amp;v75 = &amp;RTYPE_int;</span><br><span class="line">      *((_QWORD *)&amp;v75 + <span class="number">1</span>) = v29;</span><br><span class="line">      v18 = fmt_Sprintf((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;%02x&quot;</span>, <span class="number">4</span>, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v75, <span class="number">1</span>, <span class="number">1</span>, v30, v31, v32, v33, v57, v58, v59, v60, v61);</span><br><span class="line">      v34 = v70;</span><br><span class="line">      v39 = runtime_concatstring2(<span class="number">0</span>, v70, v64, v18, <span class="number">4</span>, v35, v36, v37, v38, v57, v58, v59, v60, v61);</span><br><span class="line">      v23 = v71;</span><br><span class="line">      v24 = v67;</span><br><span class="line">      v19 = v39;</span><br><span class="line">      v25 = v66 + <span class="number">1</span>;</span><br><span class="line">      v26 = v34;</span><br><span class="line">      v27 = v19;</span><br><span class="line">    &#125;</span><br><span class="line">    *(_OWORD *)v69.h = v8;</span><br><span class="line">    v40 = &amp;v57 + <span class="number">12</span>;</span><br><span class="line">    v56 = &amp;v76;</span><br><span class="line">    ((<span class="type">void</span> (__fastcall *)(__int64 *))loc_45F36B)(v40);</span><br><span class="line">    *(_QWORD *)v69.h = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">    *(_QWORD *)&amp;v69.h[<span class="number">2</span>] = <span class="number">0x1032547698BADCFE</span>LL;</span><br><span class="line">    v69.h[<span class="number">4</span>] = <span class="number">-1009589776</span>;</span><br><span class="line">    *(_OWORD *)&amp;v69.nx = v8;</span><br><span class="line">    v46 = (uint8 *)runtime_stringtoslicebyte(</span><br><span class="line">                     (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v68,</span><br><span class="line">                     v27,</span><br><span class="line">                     v41,</span><br><span class="line">                     (_DWORD)v40,</span><br><span class="line">                     v19,</span><br><span class="line">                     v42,</span><br><span class="line">                     v43,</span><br><span class="line">                     v44,</span><br><span class="line">                     v45,</span><br><span class="line">                     v57,</span><br><span class="line">                     v58,</span><br><span class="line">                     v59);</span><br><span class="line">    v77.cap = v47;</span><br><span class="line">    v77.len = v27;</span><br><span class="line">    v77.ptr = v46;</span><br><span class="line">    crypto_sha1__ptr_digest_Write(&amp;v69, v77);</span><br><span class="line">    v77.ptr = <span class="number">0LL</span>;</span><br><span class="line">    v77.len = <span class="number">0LL</span>;</span><br><span class="line">    v77.cap = <span class="number">0LL</span>;</span><br><span class="line">    v77 = crypto_sha1__ptr_digest_Sum(&amp;v69, v77);</span><br><span class="line">    v72 = v8;</span><br><span class="line">    v53 = runtime_convTslice(v48, v77.ptr, v77.len, <span class="number">0</span>, v19, v49, v50, v51, v52, v57, v58, v59);</span><br><span class="line">    *(_QWORD *)&amp;v72 = &amp;RTYPE__slice_uint8;</span><br><span class="line">    *((_QWORD *)&amp;v72 + <span class="number">1</span>) = v53;</span><br><span class="line">    fmt_Fprintf(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;flag&#123;%x&#125;\n&quot;</span>,</span><br><span class="line">      <span class="number">9</span>,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v72,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v54,</span><br><span class="line">      v55,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61,</span><br><span class="line">      v62,</span><br><span class="line">      v63);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>根据汇编，化简逻辑是</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">判断i <span class="operator">=</span><span class="operator">=</span> <span class="number">10</span></span><br><span class="line">不是 再来一轮</span><br><span class="line">是   判断qword_569E78 <span class="operator">=</span><span class="operator">=</span> <span class="number">400</span></span><br><span class="line">不是  结束</span><br><span class="line">是    输出flag</span><br></pre></td></tr></table></figure><p>以及网上有人说flag是根据输入变换的，但是我动态调试的时候试过不同的发现flag都一样，不过这个代码太抽象我也不知道flag怎么打出来的</p><p>最后就是在第一个判断0A的位置下断点，不断改变标志位，让程序到达输出success的位置，最后调用printf</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;da39a3ee5e6b4b0d3255bfef95601890afd80709&#125;</span></span><br></pre></td></tr></table></figure><h3 id="can-can-need-pxory"><a href="#can-can-need-pxory" class="headerlink" title="can_can_need_pxory"></a>can_can_need_pxory</h3><p>这个题完全不能理解（现在也是）</p><p>是py转exe，先反编译出pyc，然后再反编译成py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ccccccccccccccccccccccccccccccccccc!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;D0 U know C?&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n#include &lt;NSSCTF.h&gt;\nv01d bnssst(int FTC[], int lenggggggg) &#123;\n    int i, j, SSN;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;This is CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;6L+Z5piv5L2g6KaB55qEZmxhZ+WQl++8nwpOU1NDVEZ7YjVlMzlkMDktODg3Yy1hZGI0LTE4OWMtMWI0OGEwNWJmOTY2fQ==&#x27;</span>)</span><br><span class="line">A = &#123;</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;NSSCTF&#123;a81c0d5e-ec6d-2b80&#x27;</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n                SSN = FTC[j];\n                printf(&quot;flag&quot;);\n            &#125;\n&#125;\nint mian() &#123;\n    int FTC[] = [ -,\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ccccccccccccccccccc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\nb, 2, 6, 7, -, d, 5, 8, 4, -, 6, 8, 7, 4, -, f, 1, 2, 6, e, 3, a, 5, 1, 0, 6, 1, &#125;];\n    int lenggggggg = (int) sizeof(FTC) / sizeof(*FTC);\n    bnsScrt(FTC, lenggggggg);\n    int i;\n    for (i = 0; i &lt; lenggggggg; i++)\n        printf(&quot;%d &quot;, FTC[i]);\n    remake 0;\n&#125;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag = <span class="string">&#x27;************************************&#x27;</span></span><br><span class="line">r = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> (x + <span class="number">1</span>) % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">        res = <span class="built_in">str</span>(<span class="built_in">ord</span>(flag[x]) ^ <span class="number">2421</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="built_in">str</span>(<span class="built_in">ord</span>(flag[x]) &lt;&lt; <span class="number">6</span> &lt;&lt; <span class="number">7</span> &gt;&gt; <span class="number">2</span> &gt;&gt; <span class="number">1</span> ^ <span class="number">92</span>)</span><br><span class="line">    r = r + res + <span class="string">&#x27;,&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(base64.b16encode(base64.b32encode(r.encode(<span class="string">&#x27;utf-8&#x27;</span>)))).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure><p>上面print出来的东西好像是一段c语言代码，但是语法很抽象，就算改完语法的错，我也不理解ccccccccc是啥玩意，根据后面正常的py语法，怀疑c代码是给最后的末值的，</p><p>之后有机会补</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Level-1"><a href="#Level-1" class="headerlink" title="Level_1"></a>Level_1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">e1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">e2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = e1 * e2</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"><span class="built_in">print</span>(e1)</span><br><span class="line"><span class="built_in">print</span>(e2)</span><br></pre></td></tr></table></figure><p>这里已知n，c1，c2，e1，e2，把e1，e2看成p，q</p><p>那么可以根据$c_1 &#x3D; m^p \mod n$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">22517647586235353449147432825948355885962082318127038138351524894369583539246623545565501496312996556897362735789505076324197072008392656511657262430676945685471397862981216472634785622155317188784494912316440866051402627470561626691472280850273482836308002341429493460677206562201947000047718275995355772707947408688836667011206588727438261189233517003341094758634490421007907582147392858070623641389171229435187248184443645883661560636995548332475573072064240073037558031928639832259001407585962782698021735648128101459118863015844905452823095147248865104102562991382119836061161756978764495337874807458182581421229</span></span><br><span class="line">c1 = <span class="number">1432393096266401187029059077791766305797845826173887492889260179348416733820890797101745501984437201566364579129066414005659742104885321270122634155922766503333859812540068278962999824043206496595825886026095484801291802992082454776271149083516187121160475839108002133113254134626407840182541809478892306748590016896975053434021666376203540725254480252049443975835307793528287818262102688334515632062552114342619781840154202525919769192765621085008206581226486157149883898548933475155236509073675387541466324512294079413938239828341890576923100769181401944289365386552139418728492565319685207500539721582552448971814</span></span><br><span class="line">c2 = <span class="number">13299679392897297864252207869444022461237574801991239380909482153705185317634241850084078027230394830079554676426505967970943836811048777462696506309466535820372917756458083553031417406403895116557560548183674144457502601887632495739472178857537011190162283185735114683172731936834993707871636782206418680404006299140864001776588991141011500807549645227520128216130966268810165946959810884593793452437010902774726405217517557763322690215690606067996057037379898630878638483268362526985225092000670251641184960698506349245915816808028210142606700394584541282682338561482561343076218115042099753144875658666459825545602</span></span><br><span class="line">e1 = <span class="number">155861690390761931560700906834977917646203451142415617638229284868013723431003139974975998354830978765979365632120896717380895021936387027045347260400512396388028781862427862974453223157509702913026222541667006325100878113871620322023188372501930117363623076837619478555007555970810681502521309925774889678793</span></span><br><span class="line">e2 = <span class="number">144471983652821947847253052623701746810204736865723159569786739658583884214397562204788127484897909964898113250509653721265240138487697822089282456150238116811225975640330930854549232972314642221382625614304415750165289831040623741828600283778523993251940904896081111235859249916040849697146542311990869696453</span></span><br><span class="line"></span><br><span class="line">phi = (e1-<span class="number">1</span>)*(e2-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e1,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;Y0u_Hav3_S01v3d_Crypt0_Leve1_i&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>这就是标准的RSA解密流程</p><p>也可以用共模攻击</p><blockquote><p>共模是指：就是明文m,相同。用两个公钥e1,e2加密得到两个私钥d1,d2 和两个密文c1,c2（e不同，n同）<br>共模攻击，即当m不变的情况下，知道n,e1,e2,c1,c2, 可以在不知道d1,d2的情况下，解出m<br>利用条件为&#x3D;&gt; gcd(e1,e2)&#x3D;1</p></blockquote><p>若两个e互素，gcd(e1,e2)&#x3D;1</p><p>那么一定存在x，y使得gcd(a,b) &#x3D; ax+by</p><p>所以$e_1s_1+e_2s_2&#x3D;1$</p><p>根据复杂的推导过程最后得到：</p><p>(c1^s1*c2^s2)%n&#x3D;m%n&#x3D;m</p><p>即：m &#x3D; (pow(c_1,s_1,n)*pow(c_2,s_2,n)) % n</p><p>所以另一个方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">155861690390761931560700906834977917646203451142415617638229284868013723431003139974975998354830978765979365632120896717380895021936387027045347260400512396388028781862427862974453223157509702913026222541667006325100878113871620322023188372501930117363623076837619478555007555970810681502521309925774889678793</span></span><br><span class="line">e2 = <span class="number">144471983652821947847253052623701746810204736865723159569786739658583884214397562204788127484897909964898113250509653721265240138487697822089282456150238116811225975640330930854549232972314642221382625614304415750165289831040623741828600283778523993251940904896081111235859249916040849697146542311990869696453</span></span><br><span class="line">n = <span class="number">22517647586235353449147432825948355885962082318127038138351524894369583539246623545565501496312996556897362735789505076324197072008392656511657262430676945685471397862981216472634785622155317188784494912316440866051402627470561626691472280850273482836308002341429493460677206562201947000047718275995355772707947408688836667011206588727438261189233517003341094758634490421007907582147392858070623641389171229435187248184443645883661560636995548332475573072064240073037558031928639832259001407585962782698021735648128101459118863015844905452823095147248865104102562991382119836061161756978764495337874807458182581421229</span></span><br><span class="line">c1 = <span class="number">1432393096266401187029059077791766305797845826173887492889260179348416733820890797101745501984437201566364579129066414005659742104885321270122634155922766503333859812540068278962999824043206496595825886026095484801291802992082454776271149083516187121160475839108002133113254134626407840182541809478892306748590016896975053434021666376203540725254480252049443975835307793528287818262102688334515632062552114342619781840154202525919769192765621085008206581226486157149883898548933475155236509073675387541466324512294079413938239828341890576923100769181401944289365386552139418728492565319685207500539721582552448971814</span></span><br><span class="line">c2 = <span class="number">13299679392897297864252207869444022461237574801991239380909482153705185317634241850084078027230394830079554676426505967970943836811048777462696506309466535820372917756458083553031417406403895116557560548183674144457502601887632495739472178857537011190162283185735114683172731936834993707871636782206418680404006299140864001776588991141011500807549645227520128216130966268810165946959810884593793452437010902774726405217517557763322690215690606067996057037379898630878638483268362526985225092000670251641184960698506349245915816808028210142606700394584541282682338561482561343076218115042099753144875658666459825545602</span></span><br><span class="line"></span><br><span class="line">s,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">m=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="Level-2"><a href="#Level-2" class="headerlink" title="Level_2"></a>Level_2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 猜猜我是谁 猜对了直接秒出flag喔</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">p = ***</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c=<span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><p>根据提示说e很常见，盲猜65537</p><p>p的取值在ps.txt文件中，遍历p直接求出结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">q=<span class="number">145721736470529261146573065574028992352505611489859183763269215489708531333597694809923949026781460438320576519639268582565188719134157402292313959218961804213310847081787824780075530751842057663327444602428455144829447776271394663729996984613471623158126083062443634493708467568220146024273763894704649472957</span></span><br><span class="line">c=<span class="number">17441814714407189483380175736850663249578989775568187792928771544069162420510939242665830363276698262009780462912108642025299275146709817979705069095332726251759039923303627023610865046363171692163473939115438686877494878334016463787558794121885354719336139401336137097548305393030069499625065664884238710759260231321106291200849044147840392021931720902340003746946851806025722944795391356835342258387797980787437188976704677008092850181043891802072500430200735973581081228711070923822341261809453662427341958883142789220800541626034573952425948295446202775198692920613709157662831071515700549093766182579873408465779</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ps.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ps = [<span class="built_in">int</span>(line.strip()) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> ps:</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag = long_to_bytes(m).decode()</span><br><span class="line">        <span class="keyword">if</span> flag.startswith(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h3 id="Level-3"><a href="#Level-3" class="headerlink" title="Level_3"></a>Level_3</h3><p>当时没做出来，后来发现nc的时候应该输ip 空格 端口 而不是ip:端口</p><p>就很亏</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">n,e1,e2,c1,c2</span>):</span><br><span class="line">t = gmpy2.gcd(e1,e2)</span><br><span class="line"><span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="keyword">return</span> flag</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)+k*n)%n,t)</span><br><span class="line"><span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;IP&quot;</span>,端口号)</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里需要666次，试了试665次打不出来</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">666</span>):</span><br><span class="line">data = sh.recvuntil(<span class="string">b&quot; y0u J01n In th3 NSS t3am?\n py?\n&quot;</span>)</span><br><span class="line">n = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">e1 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">e2 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">c1 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">c2 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag = decode(n,e1,e2,c1,c2)</span><br><span class="line">sh.sendlineafter(<span class="string">b&quot;[+] Pl Give Me flaag :&quot;</span>,flag)</span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#转自https://www.cnblogs.com/mumuhhh/p/17993151#top</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>春秋杯2023冬 复现</title>
      <link href="/posts/64aac72c.html"/>
      <url>/posts/64aac72c.html</url>
      
        <content type="html"><![CDATA[<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="upx2023"><a href="#upx2023" class="headerlink" title="upx2023"></a>upx2023</h3><p>先脱upx壳，这是修改了标志，用010editor把upx修改成UPX然后用upx -d脱壳</p><p>进入主函数后，发现逻辑大概是</p><ol><li>读flag</li><li>变换flag</li><li>用随机数异或flag加密</li><li>和check数组检验</li></ol><p>那么可以直接拿到check数组<br>我们要找flag就要找到那个随机数，srand函数传入的是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Seed = time(<span class="number">0</span>i64);</span><br><span class="line">srand(Seed);</span><br></pre></td></tr></table></figure><p>同时动态调试可以得到：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZ&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">变成</span></span><br><span class="line"><span class="language-xml">f</span><span class="template-variable">&#123;37BFGNRVZlg02468ACEGIKMOQSUWY&#125;</span><span class="language-xml">a159DHLPTX</span></span><br></pre></td></tr></table></figure><p>因此我们可以找时间遍历，遍历去年的时间戳</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="comment">/*unsigned int seed = time(0);</span></span><br><span class="line"><span class="comment">srand(seed);</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;[&#x27;;</span></span><br><span class="line"><span class="comment">for (int i = 0; i &lt; 42; i++) &#123;</span></span><br><span class="line"><span class="comment">int r = rand() % 255;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; r;</span></span><br><span class="line"><span class="comment">if (i != 41) &#123;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;,&#x27;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;]&#x27;;*/</span></span><br><span class="line"><span class="type">int</span> check[<span class="number">6</span>];</span><br><span class="line">check[<span class="number">0</span>] = <span class="string">&#x27;f&#x27;</span> ^ <span class="number">0x9</span>;</span><br><span class="line">check[<span class="number">1</span>] = <span class="string">&#x27;&#123;&#x27;</span> ^ <span class="number">0x63</span>;</span><br><span class="line">check[<span class="number">2</span>] = <span class="string">&#x27;l&#x27;</span>^ <span class="number">0xC6</span>;</span><br><span class="line">check[<span class="number">3</span>] = <span class="string">&#x27;g&#x27;</span>^ <span class="number">0x65</span>;</span><br><span class="line">check[<span class="number">4</span>] = <span class="string">&#x27;&#125;&#x27;</span>^ <span class="number">0xFD</span>;</span><br><span class="line">check[<span class="number">5</span>] = <span class="string">&#x27;a&#x27;</span>^ <span class="number">0xFA</span>;</span><br><span class="line"><span class="type">int</span> r[<span class="number">42</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> time = <span class="number">1672416000</span>; time &lt; <span class="number">1706253391</span>; time++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">srand</span>(time);</span><br><span class="line"><span class="keyword">if</span> (check[<span class="number">0</span>] != (r[<span class="number">0</span>] = <span class="built_in">rand</span>() % <span class="number">255</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (check[<span class="number">1</span>] != (r[<span class="number">1</span>] = <span class="built_in">rand</span>() % <span class="number">255</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line">r[i] = <span class="built_in">rand</span>() % <span class="number">255</span>;</span><br><span class="line"><span class="keyword">if</span> ((check[<span class="number">2</span>] != r[<span class="number">11</span>]) || (check[<span class="number">3</span>] != r[<span class="number">12</span>]) || (check[<span class="number">4</span>] != r[<span class="number">31</span>]) || (check[<span class="number">5</span>] != r[<span class="number">32</span>]))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (time &lt; <span class="number">1706253391</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;the seed is: &quot;</span> &lt;&lt; time&lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;[&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">42</span>; j++) &#123;</span><br><span class="line">cout &lt;&lt; r[j];</span><br><span class="line"><span class="keyword">if</span> (j != <span class="number">41</span>) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到seed:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">the seed is: <span class="number">1682145110</span></span><br><span class="line">[<span class="number">111,24,236,196</span>,<span class="number">58,186,93,97</span>,<span class="number">61,51,169,170</span>,<span class="number">2,17,113,139</span>,<span class="number">162,38,14,77</span>,<span class="number">131,66,112,202</span>,<span class="number">80,113,231,107</span>,<span class="number">15,50,159,128</span>,<span class="number">155,183,227,184</span>,<span class="number">224,28,16,180</span>,<span class="number">42</span>,<span class="number">57</span>]</span><br></pre></td></tr></table></figure><p>最后异或一下，发现是打乱的flag</p><p>根据这个对应写代码逆向</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">check = [<span class="number">0x09</span>, <span class="number">0x63</span>, <span class="number">0xD9</span>, <span class="number">0xF6</span>, <span class="number">0x58</span>, <span class="number">0xDD</span>, <span class="number">0x3F</span>, <span class="number">0x4C</span>, </span><br><span class="line">         <span class="number">0x0F</span>, <span class="number">0x0B</span>, <span class="number">0x98</span>, <span class="number">0xC6</span>, <span class="number">0x65</span>, <span class="number">0x21</span>, <span class="number">0x41</span>, <span class="number">0xED</span>, </span><br><span class="line">         <span class="number">0xC4</span>, <span class="number">0x0B</span>, <span class="number">0x3A</span>, <span class="number">0x7B</span>, <span class="number">0xE5</span>, <span class="number">0x75</span>, <span class="number">0x5D</span>, <span class="number">0xA9</span>, </span><br><span class="line">         <span class="number">0x31</span>, <span class="number">0x41</span>, <span class="number">0xD7</span>, <span class="number">0x52</span>, <span class="number">0x6C</span>, <span class="number">0x0A</span>, <span class="number">0xFA</span>, <span class="number">0xFD</span>, </span><br><span class="line">         <span class="number">0xFA</span>, <span class="number">0x84</span>, <span class="number">0xDB</span>, <span class="number">0x89</span>, <span class="number">0xCD</span>, <span class="number">0x7E</span>, <span class="number">0x27</span>, <span class="number">0x85</span>, </span><br><span class="line">         <span class="number">0x13</span>, <span class="number">0x08</span>]</span><br><span class="line">rand = [<span class="number">111</span>,<span class="number">24</span>,<span class="number">236</span>,<span class="number">196</span>,<span class="number">58</span>,<span class="number">186</span>,<span class="number">93</span>,<span class="number">97</span>,<span class="number">61</span>,<span class="number">51</span>,<span class="number">169</span>,<span class="number">170</span>,<span class="number">2</span>,<span class="number">17</span>,<span class="number">113</span>,<span class="number">139</span>,<span class="number">162</span>,<span class="number">38</span>,<span class="number">14</span>,<span class="number">77</span>,<span class="number">131</span>,<span class="number">66</span>,<span class="number">112</span>,<span class="number">202</span>,<span class="number">80</span>,<span class="number">113</span>,<span class="number">231</span>,<span class="number">107</span>,<span class="number">15</span>,<span class="number">50</span>,<span class="number">159</span>,<span class="number">128</span>,<span class="number">155</span>,<span class="number">183</span>,<span class="number">227</span>,<span class="number">184</span>,<span class="number">224</span>,<span class="number">28</span>,<span class="number">16</span>,<span class="number">180</span>,<span class="number">42</span>,<span class="number">57</span>]</span><br><span class="line"></span><br><span class="line">miao =    <span class="string">&#x27;flag&#123;0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZ&#125;&#x27;</span></span><br><span class="line">mia2 =    <span class="string">&#x27;f&#123;37BFGNRVZlg02468ACEGIKMOQSUWY&#125;a159DHLPTX&#x27;</span></span><br><span class="line"></span><br><span class="line">back = [<span class="number">0</span>]*<span class="number">42</span></span><br><span class="line"></span><br><span class="line">a = pxor(check,rand)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">        <span class="keyword">if</span> (miao[i]==mia2[j]):</span><br><span class="line">            back[i]=a[j]</span><br><span class="line"></span><br><span class="line">pl(back)</span><br><span class="line"><span class="comment">#flag&#123;0305f8f2-14b6-fg7b-7c7a-010299c881e1&#125;</span></span><br></pre></td></tr></table></figure><p>总结：</p><p>一开始没看出来标志的大小写有问题TAT，于是直接调试找的main。。。</p><p>其次，由于srand随机的是当前时间，所以调试的时候值几乎不可能是当时的值，所以只有爆破才能找到真的seed，因此就要先把第一个变换通过动调看出来是打乱才可以（当然也不能验证）</p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="谁偷吃了我的外卖"><a href="#谁偷吃了我的外卖" class="headerlink" title="谁偷吃了我的外卖"></a>谁偷吃了我的外卖</h3><p>这道题是压缩包<br>先打开，看到小凯.jpg</p><p>继续打开，发现外卖箱.zip<br>继续打开，一个flag文件夹和一堆外卖，</p><p>结构是：用户xxx_yyyy的外卖，yyyy很明显可以看出是base64，根据hint（在信息中）：I can give you a hint: - &#x3D; &#x2F;<br>But there was a takeaway that was partially eaten.</p><p>可以知道这里的-就是&#x2F;，那么先写一个脚本把文件中的yyyy提取出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_filenames</span>(<span class="params">zip_path</span>):</span><br><span class="line">    <span class="comment"># 打开压缩文件</span></span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">        <span class="comment"># 获取压缩文件中的所有文件名</span></span><br><span class="line">        all_files = zip_ref.namelist()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 对文件名进行解码</span></span><br><span class="line">        all_files = [filename.encode(<span class="string">&#x27;cp437&#x27;</span>).decode(<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">for</span> filename <span class="keyword">in</span> all_files]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 提取每个文件名中的用户编号并按照编号排序文件名</span></span><br><span class="line">        all_files.sort(key=<span class="keyword">lambda</span> filename: <span class="built_in">int</span>(re.search(<span class="string">r&#x27;用户(\d+)&#x27;</span>, filename).group(<span class="number">1</span>)) <span class="keyword">if</span> re.search(<span class="string">r&#x27;用户(\d+)&#x27;</span>, filename) <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 初始化一个空字符串用于存储字符</span></span><br><span class="line">        combined = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 对每个文件名进行操作</span></span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> all_files:</span><br><span class="line">            <span class="comment"># 提取文件名中倒数第7到倒数第4的字符</span></span><br><span class="line">            part = filename[-<span class="number">7</span>:-<span class="number">3</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 将字符添加到 combined 中</span></span><br><span class="line">            combined += part</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> combined</span><br><span class="line"></span><br><span class="line">result = process_filenames(<span class="string">&#x27;外卖箱.zip&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>得到：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BBQAAAAIAEVSIlgh03NsbQIAAI8DAAARACEA0KG-rbXEt9y2t7nKysIubWR1cB0AAW909RzlsI-lh6-nmoTlpYvmlpfmlYXkuosubWRFUsFu2kAQvUfKP-AJ7SdUlfoFlXqMuLQ99Fb1UPViYggBbAyJARssbUzthIBiQgjBGAz-Qnd21yf8CZ21GypZPszOe-Pem4FHA6rTQkr6z3tF39vnh9BIie4cNn3wuqB3ARuu-cOm8f7jB-DuWU0-PTk9ofENXfs0jBKl9No3Y9YUMjreL0NllKijw4Ykpn3YlMTOprGe+DteWiTjNvyegDHFfhqOkTeZWKzWgOtb7ExJZ5VpuHILyAmqwc0FxDMaKuxmedhodN0FZyTcHnjPsFzC4xZ8k82H8ilssgcPWhrrvYidJdQYO3nc5msHgpqUNLwAQsC7Y9ZWRBMc+kc5R22ZEoUFCxrqsJpD1ZUW6jPY9VinQqNGJkwjGJMi7R9tsp4PYYhwpjRRnkS1UQnhdizDsqaYT+K1UBuz+zSsYwX9YhtvNoRSyWntlBgXBfTFzVEeJjaI7QAaHtOHYHRzNonaNsGPkY2XX6DVRHc5G7u0wImQP6nWmbmVVFisK8yZ4sIwh9wmuqPrCn5yU0ufxo4UNniW+oe3TJ3Lubs4UVqZsKtxSpqB9HvcchZURKMLbhIRuAgXioYajvUcDjuVhg--NWTkRw3YzMmAD7Y5PA+f3+kQaGhQZriaC9fF-n85myNRHcNyJp8MDbcmZfeG4E7Y2pVDVVVuf0X4+YpGAVaOAnhpwsuPSIVH-ZQS08-WZ4zFbYk5tVwYYuX1PrlYkQdgTPPEWO9GBBGeOp4KeGUad-Avm1-hXH3gl7McjpDX6RGGI71bhN9H2Wjtcu+M5GR5RIXP34pffn16+-3r2c83P87eFYv4FYvZ019QSwMEFAAAAAgAJFYiWGBgdxu3ewAAdqsAAAgAEwDUv7PXLnBuZ3VwDwAB21h3qumSpeWMmS5wbmfsvAdYk2f-L45NX2jfMlptZZP6at2KiILMtKUVRxXFsmRERU1lxYBhZUlpQWXEqoiKkFpcjBAVIYwsiyEqhogQggRIJEAgIYsQEjJP0NpW7Xuuc-7n-K7-+7tOvRSfPI-39-7Oz3fk8T65a2ewzT+d-mlhYWGzdctXoRYWlhoLCwDmPUvzHWcfXoP5r3lpocFfWtR1ukyYP7wL+WLHFxYWt7Ef6Pf-w-z5-aNbotIsLOYfm-szb+gwMNPCouaDrV998W1m3KQBdXrNLIqnZn5Z8i39G+OOUaz+p-XnM6w+WHHu3ePbHtROrly1dknbgz1DLavfyfsk+s5X0Xan6z45Ely4oPa96H8eufH53kdhq2-+UPVL7JfJd1f40L9-BK9656OwfwbNv7pl3+3j7wV+x4TM-9cX32d+eutzIbI1BNc9KORQu9MO7wzJYIljVSsnJcpN9QUIaQVr5uLZ7m7vT45GD01fhxQQSark3B4ORtDNy1xidwpSYTDQJzzt9jKGpq1MWxT5plKVwLa5U4KYYVKpKjFGgDWUkSsQHaqK4IHDPDCHKnVL3BZLNfLOjalEYG9sxujaGjjhbAtzh1v8+KiCGjQ9GPhZRtQenmpmMHAtcCWcu4iR0NxRV4kAMcFqULsnHajvZXMUwbxw-7Mkl7GRieEi6KSakIdRFdGBGgDmZ812zIT7vIGLILXQOICvlqnd9T9Sn2S7WKSM+VGVfmcZ+4v1ysceGmHCXr2hiZLKP7tk65mXvzcYrJFnXn16WrhevvX3T56PaMt+-8RcDsD9sajyf3HRzWhnDWVGRbAHI8nL0coO8Co6mOHxx78mcoqsKO4YlWo430i3P5VhOstayJvi6Q8opnXgVagOjKGA3ooZr6fbGfT2p9wxoypVw2e-Lx+86myDxBknZZ-wZkxG9rAzRSY85a0XgqL9P6F4679R9KjNP-JKoBp3dKOm0cRxL+WU-C7EsXpbN03gFA9zO1Mro4TbZPOUnnTvAOPsMOaulnfDCE3EeCKvZ4qgtXoIbkWFEaNHKtpMwwXiaLuJkmG6N+5jO-BeU+gfetgP4N0wjZYW3DDVcB7tJ7hNU0ZNs0o62AjFXNMA7-9MdFNVaEPaQuxDyMSpaYz50Q2MoEOMcHyy3a7grDc1knTHeKg6Ig6ZBktdf-S9AQTG-RO7CPUnau9IQQ44OzOUNEu-T2YI6uoQ5bfXS8UjI89FjjardH0ISv7vXLRE3f4HajIeGG2qpjbtjFEvjUXwdU8j4tw747R0lWP2Ksxi5HUNkKrG2ZuouFmkYpmxDLwczcswKYerZMaJR2BwFkwlbqgHZuJJ2KHe+Mht1pGqnzn+4RFFB2w8kg5JZSMjzK8RCwpyCIikffhFyX27mqDyVdSKLwQxuqxSXqU23TLwlY6vVkbYZTT-BH0AzzsmyZE9ZKEomghKBiovDnV+CIFpyWwDm4R0tf8se7geZ0pQyAEmlEI3VO+mGsbwlBPDVSbxI9NoN516p2XoLAuJRkEnDvycUF7U61CVvnZ7uE2SH6C-8z1vJF8cEFS3OnDn3ZZYn0cByD4EKEzFwIabuC4Gy8Ti9PKP3CvaxhK9--DTotAUWise5t7SS1OrCBhyphqjTqQ79wKbm32CZISI+CGqUSM8xTNMiekEtHQVHajjgiJss0MMyxJNwpBPQlCcG2ZXawj5RDZnXhIhpuyLNZbV7cFhUqCmuqu2pfOW58RUJTgshV8g-NYmAaabSUtG-wChSLZcqFWi+nr12ZUGsJJ-43d3vJpY4jSVkjZQULdRjnpeA3anqGTURsfpX02TULMbitWmGEWvTPdsmKdxxzRqnoF1oT5DhkkCuioz+vKEmhOHj6kl3ZqKAEUhxTxj8xQldJT1HSKS5FAZJbqTelVcHFtenGoJRuxKtEuu0WVP0IeZRR3RvtujU74q7DgTv99Hnwwleq70zQ15paMjPZdyh5KxiK4GSwpPP8w5dYMqg0QDW2epmhBQrB4DUjUPE6mabAUXnEnWPIqghtsin7PB5uAdk8XFygjoO5kiQq0eF7eiQttB+DjEBMHFDXIiOOpLKzx2NnTyxXEUt1av4TvS2+cpOdDxYIhX503E6BxfwlDbVLwwbhAyM9nchB2Jyka1CWaywnln76v+BDxm30I892KQxy8BeGJ6t0mNi8WMjGnjvU39NfRoY-uyApyhxD0pj0ygGBuGMyiakqdncXr8MMbICYzyVwExv2SKuhgFN4xPzT+oOrbAGskMLZW4tmrz7jYdMT2Dd223cyYWME5S94-Gqwp-DGAtVm1CAVVRbuBBVoEq2Xdx-LMhQtQfYDZ40JIytdjX1MkqBW2HKm+XPSdQQvVd1NmHw-ZoQ8EoTd1PQN3O1PH0mYpgiu7GNlM3dWoPfQ9GIaDvkcUZZGDNw+FoU8Gcmji96v46F-yloMigwkj8vFrPuI35t7SENLV9f-xea2SV5-ilNq7It+qj5DScXUG+xww5EkS8fxHR3IX3LyD4LZwJuCHKfqbo+gONNySomuxNXL2YK9oLABdmyIzB1BjSosDUen0fM8LLbNe8YKA7RYIAr0ELiGiC5tdSsLuxT41ucVFuwxhx+FqjmmWoH7bBzCw7lYGR23fo+qMPXD7lkeh5Hu7OQ94-xGLslzq3ZoP+VZ89kP2V2DZBIS73nPTCwsmemkfDjR5TJSAqwWNGdTcrcFQyH8tuyE76A8vRVV-IGoMpiTbIrrMhhnSFjT1utdlvcMsrtFgQZbaPecM4HPIJVcYy1Q-H8kxVw2k40zYFzoQxB0AbZnqBWY3pnxnVoFpkG850cvjhKmoDhfit+IvVlvWpSxCR-gOFcFiUcLKxc1d4cawdsC6-ZdNigmeK5AEPHIvoqZFmQD5PamwmJFbcI9YFKm+pH5M2D967zT7O+APgmR02WUSfqd8R1ViDqwlMVbobe8bivcWe02geZvr2MEsvCbGPwGljFKDZTqB7hdYuYhjThjNGwmYMoFjkhDoOzOOmlMHcE4oOQlOQk6MtI5lhRdCH91b5pYcFxfB2NXr+Qkc1RLQyL0TGEVQDBA95CeSjOukNEonC0kch-4SurckPjmdEL+Y1WFHGu6naa8MTatJe2+xrY1HZvFkB3SQPMUUqYoGabxRUYx1uZTD5hjG3BKSKp3e7679VTIBnh7Vxlj1ON-JsDnmk072v3zEJ1njTUSqkP6QH9EsYK1HYWCYMBw91ZQ1xcZ9cyLRVjRPPZNv+mYM16ZcXtcUGTA1ezbWkjOdjtBmnbpjORnhVDu3BLEUmeY6j2nDan4btTKPs2xhTsDnaRrALQ0wluNVoTTcumpcdMtrX63h3ODJxMJrtSHgEI2SVtxsO4qUCOnNLr+cD1UTgjRZmWofdWdWnz-yewPutLxT5bfgDyAdx5iz+S4jpUekpqM7I+pgnh5jjug0jjx+Nyr4GckTfzWyjqhfTvZFCrLlMoGDikNpSAmys4g-gPejtpPllrrYYzo+bjVFITVrwx7ypoZDzENGP0FlpyEKZMQfnjh5fgFtFWPz7xhNjg5n8Gl0-hxqHVKwCu6OVGWD3N6sbvM0fcHWmGJfzO7ZuvbT7Dy0uObLZUfMHP46H-lSfHT73-2VRz2G+bkAYaGXx4tc3l3PsXl4dvk-77Z7nAT7gxcVxRw-5vBdXtEIHzcuH+zZbI19erVtsGfjy6sJHAODLq8cn-hfI0QJSs7Let-hmy7lsZuerW-OhS64XAywy2l4uO+iosdi39+VWn583E71O-99+MGprSekY1o9c3USNMWmnSJuiDL5i0qzViZrh4Q3FOPvSsvj86ort-u1jsyMxsR-f8GMt62EdUaPXsmoEqJ3udU4cAi5EkOg8ZZj4bgii0rTyarRZDUCQUMNbNbfL9YfmnbtT5TS1nqqrG-kRERv7San9jQlYlVt9+uYr182Zy8+loXyhfQRT3JBs2dRdMLwSltXN1mZFcPBWhCaToTLM9HOvi2o9ADyDeFrp9iyUl6tFWyEHG25TIl5Yp+CFHPwcWYjpIcYv6-muKs8O0e6bsto7TNq5o+gou2DVBbYRLm304QqfNpuy-VdZ1QZUssdWk1ScaGOLsd-ORWNpfUyy+zZFRmqSlqMJL+zlYrbXNx33ADyqmkHdmPV8R09bKFpTZfVLwrvcoeueK+HB17UzzfX9dbB27ph1Q6H0VjgmtmweHp7OXWOHLCOMkprG-TkD7zW7ToRvNsXBpXMWOL51nXwe7a6Lv9wgMz2of-iBeiUDl01zSg+P6rP9XPLRZD8ALLC+I73ZY4x8OJ1c3aF1S8zw53qnlMfFuOznJ2KKRtU3SXEo08nda48MyD6Z47T7IB9w-IhPJh8hnig7Yy9Ny8oaAh1gM5wguOS6+ttuVb1tT1VWlLHxXpJJ0tfk6Z9cwdvmn2LQewl6F1WG+Q-Nippd4-lc14UdwoZm5oRWV-Yk6-IR5As1NG03O-CF87lWlG6AFWXbxg+TO9cm2nzeIPmwx6ncN7drEQCc9nM16xuuddTgIvys-5c+e-HFeLcMRDh3xre5qxpdOPPsKHO3O0ieTImIQgn2iXS30aRyGap78OUGF2xf6NnVBlmSvbw6v2LEotepKpxaZ0VREeycNU6Lw2LQF-3ib2UNlow4eCXd3YZGISwp08nhXhCBqjBNpa6iEJgEge42ipLcPRs3FyjrXF-w3OqoeXT7iN-SWLzx+IdBTzovsB2Vj8R1hD3YIDaN44IX6Zh2SOaVqqcZ5JIOJVuQzEpvTSqO9PE4yg6KCc3oEQM16e23emkRqDXMj25tvNuwgRoxyGgWyMJExheqSXuxjZ+jxkuwxzqjyJO5dm-8ro2ByVYkUaOBKrXNHgTL+l3vaQllpk0dEot0LkQOpw4VjZk3-ygj0KueYhzV6rj6OPgOIWKuvacdc5gLT+k+fqItVPVzWFEAd97knZadhWFiRbUTPT2-cjCHsGrjV8lAYguhnRCRHmhbn1W224ryOL6xk19DaNXudSc4cZKRIeG8DpGijFcjOd1ErqUk49E7VfEb0eTU2t88Zv+cxzhi+InGpCZNVsqNZfQjhSE1HZcAfZ0ObAddY9uutJvVpha3qhZqipvYDZxY8T4xbZYZXNNDy2jQahs5VYz6hMztsZh4CD+xBspFBvrxuqduX7quJL8zh3++1sjgJ9mY5AuQOM342Az7pB3XdJyKIqEGz2Mpu-zTpr5R-Bosjgeuicu8btjkjA-5oCOGwPJ0-xg4OOB2nLvBSIugHt0IdvGqBG8p3Jo4WrAnq3Xm8zCbfarb2hkJmOOeVGVPdmUK67Mq8ovCuYwdBWJOfAzebbpawFSk-tz7gaxXSiMa4pLcW1t-E9ncP0EfZDag3Y8o474VBOCN6p71sgg21rHy6XtYU5d9xTMXWfERLtc7-25xj+5qUMniWJbBm2rHFFyb2RJBBkUAEwcipprZnGiMnUh4i7JTZbgpizcYf86x43-XDnyB-Mejmg1mPFua3H7rC0D0lqLD3OfVLvjN2XqJyqlNcBjZcflr+zOL9woyD7vUmG1o0u65N5XeaYwOkAaD+kkoQeKWQG+IfN43J18miAct5djxAdvdfvF7XEJskpg5Nz36JdaQst1r0vJ4Hm4gj7HPoGWp4zSOZi84cz9i4f4t6AO9WmM6BZJY5vnRHnCiulnSV4xGqe1osJep6XhtmR2yqJ7qW9nFz8FnXd-LQk1jv2Eg9JJgeIUZ6xVr4Of3B-NOhANDbJGSL-DIilGVSOjFh5U5AQ4hXJJweHssW7-lqXidfp5L-isuJ2gcp3u+pTZufaLniZAN-aAUV7WCG98nHQ0Q6Vp7aRz93pV47BLU2EXmPqJA-+OMshboncJF2eY2WDGm4RabLF+mxtPwyhyCGy48FLjoomtfqG8b57Bc5FxVrNdca48fAS29e4XCFMHqscSuJl57MnFxdBo-BlvRLOxvSd6s1PVvEkCpiRU73qM1vBK2zYoiYeydKX8Ox+fgfbxKQgXh3beBoCTgYgy5MfvCQFacyoKTZsnrZDknoVZ-x9vH0RjvWlIkEi4rHgHC776LrqUIw-vV6nePc-e9TNB3bM2YFL-n8If9hUeqctb4LcEfZNz6yA1zDT6onbV2IIpyoMLaX3s536JsmAq87qPyaGYOFNEIhhuMOe4VyvRPJ-03q8UZlkDawVdcBpl3-LDE9OBRmXWSShUKJPu0C6Dtd5hpDl4r80Qe8xdHonAwXbvBGwfWaUvpH4xy+l00LVorSqiyltZ+gqhEwf9MLtEMavurWdn7zBxyXPsuVX6rvuPhRp3tuswUb7S8Q8H+w3Xac8qrlA7HrYhr0n8naClaBFWRiJCJWKE1xT6cg8fKbHMfCoc0-TOe8nkuZ1+Z2RxRjg9SUzbdYkPGr+XdFIDQaR9yXe9cwuL8Wtf5-MIGxLDiOcTkIZmUxilx0HyJZDLBxCWWvnMenfcbEd9JiNx1D2pmwD-4asLpgvpJrWWzW9FHqWrjJQDY5IjkMlJsf0J0fr+aNVNDQOx45vHh8SDH3wSrskGyt8Cf+mXOoz19dW+i-J6VhbrsN+rr53Lrb3pYPZdWCv7PHhQGylFqnv5FBccvvjpUz2W8qGaWvZrlXVWYNURb-1WVwMdcWT7dSZ3eTr1rXHVk7ywk7TIS99nWM2M-mQmeX7TNleVhLrrTp8Yo1y9hvBgP1ea+94jbXDnm+EuPwsVM8MgyqDSx+j9ioWMWH3EtU8FcRn-YVtpLdetd5U5p3uQTNSgdYdILCOesTnlzMGu2tqhIzYQvBsdVmmvDz0UNhkuYJZvGccxSt3bcIrc6N1gkzOB9g3Kz1G3hMigaprpxMYXNCTVEXWtEkaZYHg+5DasIRG1ekmng7HlkCvEyD2DW6FhXJAAcA7S49EtPomW+z4jOZ5hGdFPPh367kQ2dbhgaEJFWhFPnLd3qu3NogPPz4fXyr0cfeO87WFPBmUlMKEp7lkNQoJZT3cU5BL1Ygku7g2l85vllXMZN0la03WlzCxAcP9dTXNtGPnz0QhAFt9gGqRu633H5GVF5eK+IeoZ3R2duVJVjFMuNt80JA7PlXI8+bbOQ5epRnVwhMDeKWtZq5u46rWeIcjXJ3LlttHDTkinoP2hb0GBfm92BAdQMM29NOoeyy8BkoHdJZuWarEFn8sPlWxPGmCib6qzr-UMtbeFp5rKLrHWaYR0eAI+x3h3F7Qhl+Rlczlby96r0ezjmvjvGdPEQYmYf3MQ0-VylqnpXYfjG+kR8RXOEUG1hdsCsueLv0IlQRlqxr7whsLcavadm1jJs1jJaRB0iEMpOu+haoA+2nkk5461m1-oiVisukYLF8CyIdZItUtGBMn2xi-0E44Uw5f4cNrqvUZePVaX1DdVtpHxdbhr-Lhq5hp0mQwwkXO0wRR0SNo6qV1eIC8Qg+yI1cP1swOd-9qjLH2EswWEGy4gVs0ujWme29NXJdmww63JqTpdHzxWkg+v9ADwtqHerLbTI0lT-DJH+PL0wkWjAFlQLLzbFyWjEZLW4VpYBB7uHAw6IkkjTmI-ZWXomv9TkNrj5Nw2bS67IvOVwf8hIDiHbE6rB5FBQ9Xjd9QgSMYx6Mrw4bzHp2Wdb1Z+ZPXuL6iIKYYovS70gosxkWFHCxPNWqc+gyzFee0yLnnRGZYlFORK61ksR0xI-t7sOclYbOcXyH7xSBxvbpwpgmnyOFILUmjfE3G1J0drQDL7Q7-A8+Snv7ri9g8GzeVFZtVp3njf0F5vMoF1nNvib98eIc6T0+x-2rth4NzmFlyVZy6h5bIgV45jSW30az6+IpW7hnO0gDtxcV4tYGxSbiky7quKVDqNpew2OEDh5iEHO1bt9uvXMBqy5YbtlvVuU2Wmu9bQ76rypmqdjRQRjC-DHBnT95H7D4X4Rp4aK7ssE1M4uHaB4v-vZ1jazC8+E4RQLCa3Pdte6PNMGrvRUQHIDTF2dDaZnMXbfuVN6HHXZ-cg1o5L+yphQA+ScCpfWzyuQKA4ryDV1C0pltgWjuCOh2Iaf3FZAPalWW84sYS42Q+TqoHO+FZ5Pg49d5-ETOG4aL6iLlylxdorZKCnbK-Huyh5afm5JrB9UuipaqGpyGn0qiNI1tESZxOk+R1Wkn4FTrMOGre9MCLvqTLN1CcaLV9lXALxGvfqIaV0W902femiLVAUfSuZ9UyOtnB2LUDNvTdmQ9LlbzliOMFGqsKJDJ+9N9ANLUX2YC2l4jBeHVaVN+0qVGYSmxGZ-F-2ip396f-0rjK60RbYCPdglmYAaNfPuQNn+M1fLzHQkPU4d2dUEz-HFS7DecjZk8jMcY8znuskaVpnjjnZ7rqW0tZVqTfr4F+SSf4+4pQhL3vVy7+5L0PNFprzSJYP5Zjw87BEYK9yY4XlLUtHS60S7E78-pBnjVSP00YOMVQQesiLfGlmme9a82iDEDZgTHiwVC6BkcB7K5pkTivIBzapDOdXh3jYealq9vm7O0a-mhJzZcMNMuWoMx4RNoc6-DIPICofoOIRko0NRDtTp3wP6eQaN0WeN7P7wWrHQQbNkq19WGngPE1QmGNGtfulat-wtA9sP88vmoopBW7a1-2GZ7lKC8ZnLMh7kJcDkjnrIPbwAvA2-5zkz9H6rZI1tmg3c-tIrVmNzsLcdNdf-fdrZl2WNLGTSvG3Mflz8aiZzab9ZEDcAMN5TvmPOreJfDWEOXzCzDrmbI3tYOXzv4VbYnSl+19lhxTMRAei-suJqXccvf9rs5Rdnj82qO+ukqfDP3mULS7Y7FRzSz3GWwmCNbjOieEuKruPl3p1dVhQCWlVDl+k7ZR9TDVxq7NAYES0mbqPOllGjkDP1uDVodQYmA7XjN8pBzhn81tWdGZZ5AZ1EbFoWOvRyXMxGKVQyRSJJZw8JM3dmlXUPD6+EPdvszxuAz8TaZlRm8MXFUJVjJgQbzXG9SkpGfEoy9zRFP0Cwe0o9lllSjrxA7EA5-Zb9pbYhqr7UdMdFjTZwMGTNyDJQFFJRAI4BR-82Nz1tbi9sXe4fOO1HXl73CGzn-E+1DdrDIUXm+VxU3fSoON8y8PoROS2iP2AB9DQDUmOCOmhuOrzUj4+WZl8Zx3tgD+CFGEdCzpeiJraD9-K+-I005fp6uaqiPKJl5dqdNdySyoHZ2Yr9a+rARakR9jfwXdCbvWkrginK4dQntxw4iYH2DjyVGf4EfqxTDKagCEeISBhodJm6VIrPpwzmyLYqxr9QZnMZW1AHv0s8+Ng-kKGcIVLJmgfBgWdIk+wI8JoKjHF25NCf5FeJsOOTxUjqTCI1XP8Aq9+iQFDViNFD+biH6lDFUZUzfa4CGejebhdyCsJTPtJGdK2iIyqS9XkLKlAs0Xc3St3q1iKasu+mKDSshfjWgQgZSvUxhzf7To2w3NSiq0ujpQWOexEHtTL2E+qzM1crVY8QFeQZGaOVcC9-EDtXxJk90+NpGOQJXUIE7PUZ2hj4a9oJ-em+RpOx-B5jQ2wGnzvbxCyvV-YGxSpnAJ18xNT4agwQBZHbZCGL-9VO7nkQgUUANTSrvYzE30TbPHuik4UxKh-+JIvAqCIKsOjpSrqYQI0rRsLIbZ0jzuvk9M8b3SSN0LXtkgMHxYX7isRe28krHA-xLiBHA+j1zOdHTw9+JClhG+5z+iiTlgAwi+NQAmZ1pjl9avoqZQUAd1UXq1aPD0Dzg-Lqy4oSOaaALFIOQVt-zygLM7I+VCC7WZI6MNZS-yzYbOkCqBYA1tU2S+C9anjW7stea6FbC9M4Tpq6tdUMqcEhBADsPtZHi7BLZl9o9GyRuM6zQn4FySobu-h9VQ6UL0jbMPgTlNdk-xuUFK6XG6QyY0rqiK6IpykaLomIW4GeZKBrNSdxmpPDC3CarxRVIahqklTlO0XjeD5NlsWr7-RsiQgLCDeMHZ69fpj15Hw1shIGN7ElfixEt3YHo1z4bZYmlJcW9xCzIIKYZolbMhjGTvxcMCnLJO81DJGV0QeU8BqZumMRp6r1HqY2lJoSy7VB4wjBT6SxpOl1BqfwQEYFZ3jqzkhas45TOaA0Q+VTw3iKJUW0eEOG0ZpaqYCVRtjTj8R-twpUXb+RlAw6n6bLjNUBMzL0HYOEHOyRli5HpPi2u8qEveU4ZDmXLoTNEL6zVuMSFjCFGg8C9vtJ--EbEgYDNaLdBGMzAmeYhGz3kNKDjxmn3E2pigKqpsCZOrWKGhrnDUYsWdW7OFrlFq2+Axd7f5Fh46rpB95whFbT46-yNGLnX3uhlo1DhVy15XMpiu5cOptDeCaFPxIONLM29VJwKuU2NMt3MyoNxlNvP3N+r7IhJTpj5Igxf-EE5+Z+zpGSTNfHHBPwh-sCOLiyQ5gWTSWUEtQTDCler9XioNrmHXzVciXJnA2OgS4ZHZGq0SJuCWgBVAWZSOWLHSVnIIN0gRp7fFa47ti5mIkAgV07bNDsRlmZ4ufJAbckrk9nbJHsTI7TdN7le97TCp9Tm3KqjWKH2QqEtLm3iUMiPfwDVzc5u1tSwCYV2D2Y-CHGFchyPPCkJpgC1l4Dr8TSP7yQLCxq7yyr4KDTCJ7fmxVRUeT5big08-pQX21FvEmFWIsYLRm+prr4nl-lIXXWsu2YZFlUgEkiGfYdFJa1yO5z2Ia4z6p5LnjWzeV4aLfvea22g1qqGl1lF8Ey1PF2lVxtvQl9vAKD+4bcmIQxMTeO+HLNlVFhAOF9Bj5b0o8iT4bHQnUxOmgGOYdgMDxrjppVH0VkqRFhgb2iSEMLlUySofPRZHPA7E0QzI1KppwaBf0i38GcWrfpbUJ6ViHKvia+KIewsZ+u2rM4+vI-+hDtsXCQGQxUrlQpy+IHjxgov2ZzoxW2YlrfwqDkuMOyEres-syScgXLuvobKDse4n9gmsYZu1MXFWPFhV-I8tHj+adYyDHPUY3aE6T0pOeD9M+ZTUQov8Cb1g89HAZFwnnyBPJEr+uphFH4sLbIe0drZRiPxtHl7UW8t4p3axXQ3WCZFKZktvY8iaCu6CPVan0zhj5PYqeVa5zEuQFgsFh3riSzrXk3Clwmi1DadDIXRGMMzGUtRkRvYA+5fMng2V5qRjpGV2MMOjkt3j6LGKvguefHQLawZawqYZfbjZntmDW5olkzaBnTvlQ2UCDLJSbjMVPtblQ5E+RMmq6QGrzB7hm4IO3GlAeGIT5iqRlbo7xFtAjbJJ0lZdBzYpjjF9R-+L7Yp36thzw29vL1fGrogeXWAZX7jBR+io2b5tFHKSpTaT2jlRPryvOpr8sifwEACwK9gORmPzmcQfriDx3OJbbcuMJMjFpmHBxWCBh0BsioGLZC861OyQxDsjXokWD0VdJqtDEuZiFEwQaOPoueHYvN2FU9pE8gA734OyiS4O-pZXOsqYDrnKq9uaGAvf44kdEL2hsbMXUSKiOuVPWJsyuUY+JTHWKqFE0mw4Ggba6JEWg7XzUue3ETiiySTUhP9KOCws5IQ-yoGSloQoid-6hKrUf7jPg+syQNNa4k8Ly30GUGb4eaR7pO6lJVBFl6jFpslIUIVct1qPEsstSfV06ldg3JoNosczk1gd4gonEyDg9uQ-R0YM4drvKUS0C5UB7qunuIbdZgl7tnzK+x466acFMhcSOjMYATUpw7i7vHacFuihu6rrygetD01EU7Exh49sDLok44DuDZU+Q-TgnlZJNB5h6ouWe3kGcy8MD6cqoy45RMR5GtsqJoIjsxUyHGrQqisZe3Eq1nYJCy4GPtZeDWypCxHc2Pjza4aoZnirzfPWtOJDbEGeVNN4xSXCEm4sAD15VL4-ylDUNXanjrYqgPI015juqfMm0lhBoUd0x9NztXYRHAE08ZfcERItmOWXVlYK8ub0ybSO5Vbz1zfo9OPc6WKRUIhFqtg1fxMK02zTsxqsSH2tKgbeRA9uha59AsXZAV5bE4bOqDSYobHlOeHRBDvZ5sojSwM3YH9nYmHhlDcwYnZVfmRggDmQAwLzg2vAUiKVkcK64lJxwvAHHOc1p7acTADihkOvGUTlZRVZrdeXHRkweMr65aBm5a+geoUzR09-PArlm1cYi3KlBVFfKJSQM0CaYw8SO6LqCha9ge-dz+FNWkNqEVATxlAB2kDTbd1M8iYQvBd4a8jdlGsUrlnMBWtDsf3DH6Y-ltST8A3JNpG8CBgqhiM5oaZP6m0GHm4x51tRKejDHGCrPJ9LTxwHBRZGuPM7bK28MGeeaYYa85HJ3W660pO8VwyM89hutxOFFqqU11Nn7AYJdjGR6I1m1co8oOYyuz76INK6lGMuGIRAtMDBOhxfNZc8WjurLLkuIwuB7Q10kj3nYTthAl1kg8BvtemQdBOBNbJSz13+MeoJEErh1w-aMIT5vOkW0Ha0NnPcpNcqCx7V+B33satd5ogfcpjNzO+IViD0i1Z5QggMjpcntBHPIghEezhyKv8e7WDD3ZToY1ogR3shfXZZUzHZGDXxCM8Nm8Z23D17QYjn2wgXUojKWKxuya6M78njtv7dUh+YDhktdnFW2dnKi4G4YL8FwcdOI9AE9rDix1k29FdueZY6ZHJNvabQYjN-kBXNsBQt-pEe+JjenNSm5KYYvNyC-Da7MvEQLYiTCRUWua3L2Q0FzWkW+DreK0l+9VRxN1L9OfUyKfa5sZkBuDk7KGamz8cwn6WdTJLryvoM4QiQBV1LvM4xInir9XZA7qcszNjEPZy85qruPn6ci8VQQgkONILTYVYZ8XxsPSwcgfhFBDL7REEHcCDCYEQO+UqKjvO0JvNgx9nGjuW03pQwPc5h31953PwQwz8Yy0ndZHZ91-2TNWxO5xvsnMIZCQqo3+yEiD7Gfvfwh8ZH65BC2iS+-7yHu1X8h61dLD6tXnpnyrPFf4qt23qq+VunlhQmrjAKm5u0RqXkpQXTd4DH6T0CPubpGKafvxVHc-QgSMFNhrInNRtmJOQ+-t+5IIMKdt5oNwsc+3QfuFiE94Be05PYkCig6fCJJJExUUsBlwjtQVpVuaEfB1D+gAG1N9xulH7YknF7l3PinIcX-RGrHGP4BZgl38pLQIqoLT4-kD29Tq1tZPnADSQ6G72svSJUJ71mwfgCdNKxaqnmp3tDOVBEKr7HaHWEKp6ksxGJIHIkRMQU-ZBRSPOKbk6Q2tL0DgafaFKK4aCLmKNkm8RnwNh+LytSvB23sJGD9CmC4uPi-CLmFCF0c9fywurToUcz0STM3CnHRvMVxie-66UbZYdak0c6dOSqyeJbUSSnToNebk03z49d610hoJnn0UsQ22FKz37RwuwDHtD+gL6jUJ5uLNJMXrru+b2tGyuUxM5DkUeDPTh3gJAxmzY0eUzAdwWCvTuWYUs4OXufakNy8dCCnMIaSZds-GLGBEXONFTpKqJpifb21RN1jdmE7cBkURQhZU67WHNdneHOEcK22e8ntTDn-4VKUd0kNENmrF9Aiqlh2aMV7DoGiikA1i3D1vQz8073Bm-M4zV1vxLot0nefKjqahhszx7Lvp9U7bcRQiZ4OiCQidVuAbhPwWcoJarPittQ7FvJwR7Euqwix0jPjNqmKwKVvRQEDh-QugJ5rqfptiI19N1cyp4tVkm8uiWVl0vBobvHxH4vCrycert8ieWv95-v3ytYq8P4+YX7451fZqgPVa4-9yS8arN6yY614Nl16fAghHS8F5XdeMUQdj3hod-MUM5Pcd35xr-L7Jm7OKP8YH8fz4pN8auD9L+GfD-Z9ukTZOU2smr27Kkt-MPNNknfqn0cwrHeeOPnPUuOE+WbZsGdnNP3vu1c3hrlw2AbpBHrC201eNmtkEDzjf-tYoxexSpUL6w1lJYa65eac-fHgEBiuhkKpI0omvYWzypOiXTRIytmPYH2HSrc1v9Zi0pnAdphsr-LNPu0y74QKWuwUcAfpVJOzbsLKY9Rb1egdzdVaHCn-yobCULXFndZfiLlfYC2+cFCyqELDDYJ+wMlRiLaXfGvlN9+kcgtNIyhHkKtaHLmkPxPH81lVvqbXsMY3o9rS-VxDlIy+3Ly3nxsReVhcmRtDpRzY+ChMMaRvL61WP6rUi4R23j84Gxc0ODAceeCIOZNQNCt+P54LkYUGRqq7LXMEg7h5xVnU2mJ47BhJCsM7Ems53J4citqEwWA5ERweDRLPNGKZw-UhWD+RDr4aKPerGVXm0WChGxy3AIkcWP+yIQ6nYw7NCXEjcW7a8ZU6gI8fte3OjY4a07zGlz2Ds7zKyYc2Osrq6RowrZ8Lg0KlK7sbyGlzH9wL2nfHUXLiOAoAzHoj94oy+RkwXKSXgHFvQr+UEtd9hGjZa-TryDCPxVFgGYO9LvHpBubfgSJRuUdsIar4gLmGkhkG2Q-IBeMHGP6Ztv0XV4ENHZNlHdR6nJc4aL0hXMquzRlavjUIuK8OySU3jxchW4lbR5RWZDVp4Vntc6gZry8DrK-zk19rrGqZpGeH+KTHLvoV04LGlQc9uYYXf8MDD1rQpnxSC93jWuVAAWJtEv4VAfJkxwvX+vcH9Y-OiAHkD605BTlLAzUPmSlG8CSFLUHFUkRGuXGuECoUDf1wq9NBsBK1U3vLUXCLuwOaad6-C8Gva62aioNEPcwhZvTH4rN5BuBXlvqEkiDumkfLndmbMB4Cl1m3l3D3mPtHO3GAjGOR9bxlh7hULIMLnGD862nSZlHCC69o7LJSELd6n2qQCA7MtwdyNm38d8jTuczHrnnfxKL6D4Cc-1HlaLCJTx7ZccLC2QQpm7y8LvD37F43rn3w83gzKv8Yi+HNCaRaW0gmtKfsvc5uxokbu7Vsof5Onlp+yxIqS+ljk2NJ7BgA+8KFLNrlu6EodrDdOl0R59ET4k4tmPeAqdpwU8JbDO8-NBA+1WVI6ynFVGbFsgdsxS3BWkjrp3kxw0a93J82F4QO2uutyw-RRTnNs6vJay5bB+ufDmplIE404X63j126KHgzJ+MHF6P80Pm7jCLzOb5-84Ka3beVr7pTujP3cqF7s20qtw8JZTdtd-cxl5MjpUp3vvndaALzDn4p32x14mANViRninNpe71PsoP5eGrZ-NT74weOL2bkVjOymD-BXCDDScKUP9Oxb0Nfuoklvv2OODfwYa4Ir8msjINr3n9DxyCmzDY6zF04MempszwJHUrja1bT7UXmCQDvb-X8VWtIo6BUfER1M7Kx7fzCHgMjCSZ6EGx9TR+AzJ4QlL4rThhRis7W0fbUVZRn2lFUAhG2G1bfRKd4GyfUU9gNLm30WpMgckUGfdfKj7dIMgBitNaXc0-bs4oO628PiAV29kf9gbJO8BMtWer5jg+yGvM1WJx+w2fNGDlSZpluPjeeXBb6l4rlpdkoiP-fKX6L368PyPy35dwPw17L0a8nvj+9xf88gf+fk-6s5eXLIFhlhT5+YS5Zsf3TUZdzlj4WlNVSKv-vO9LW8lpZNsbHo0MuXwSkm39HpX5pWQutbZFpCByPQfa3YHF2M+JQ6u3xnc2rO+tZ-U9Yu-+wzTZOX3HDlH9u5BWyNaze8jWatjprqRXifH0oq+7VTI-t6HSlrWRGMzj2s59VNmyStSatSMNkwtk-cYLoyxnfxPnHWRimoWDbE2Qa5VcBYLUN4yhuA0LQsFGLTk9NzX5BY0R8+E4wcivXgNxhNkb6r3LzXessHoRw3zVrqHS3k5s3LmCu+M13u9qweRriIZwfS-srxYlRkPVdKdFc+e00bSZM5BLeHLUG9o1mQLYk22eKuOs-zrv7yjayfEyeskatGBccqoLN6W3MtsN8zJQJkFE1JJOnBrFCp+LibGeX9490VrMinqs5JTznsCU39uLQA20sthhEU4oQe3V7Fr8GcUoxUSf+A5aCZOfk6PML5BfdWKW+XNgzmQK+50Pshra6+5o3PFVCHCpNGlYnFLq1BB7fYIAe5ybXUYjLnJEM6dAOGBajskNx6qdZcGlnaIENOBdvNN-kTHPXSUmc7pB9lVy0akaJ3S+I7-+t1SUnmGmXoDKQFbgb0MRYj2qDl5xB8rtK-a8q+3JGNjHaF2qBdR+O9LAu1Xgpkfvk9otvHLFY00NDsgyDABod0P8xrd9Q09kPkYW24HGjFkHGGaA+cfRB8ppSsFdXQlSwQjjTZa0WZWuxffi8j9o1azQZZ7ilPNeeQLJ1kefo4jeM2kQ66Xu8nL2EdChgJY8zgFl0IBaXMqghUe67wI3VG3GVoRYjKIYgScfopSA43NovZDuYq8bO1YIS5lLzTsjOB74cgUQLqXy8kGqJdNY9gBL8xR03eW-mIa1Jc3p-Bj8Y973Vg27pqEhQOfoC9l2EcF-fw9M5fahjN3d3Dd5GFFbhyzpPsy1MeMwY9tYm1n7dqi0+nIxLFaM2tyIFKWxbzKDD3gX6aPagAChn4wJKy6PWoXOonh2++I32SXmlOOTGdzmqiT417ygJAjHryXl5myo0bHp+bS8kaxkQgYap5mRtC6fC+yiKS16jnPU47jipeL6dfREKwHHU3iYRAAXjzexbz8gOnr5AFcU14M8Xoo6yLqLc23eys6YW02Mw2pwZZ1qWu2x4H4dGIiPZYsXVr6omBiv0ct8nhRiGdPtYn4pQLn3jLP3MX+4crmyWXY9-jPAHJG0zPZEQ-eUBgDRaObo+b-aiC+XydJQjAi0ENL8D16eGFSFaAOiZxIDFu6OBbQa6wpKiWl+ozHzUuMtu4fAQVtjhK9vlCyDh+rQzoJOZy4rkij7q6R8L5WEdioh1c-MVtUso2g0urIBbeOnLxJIASfDpNDJHTkzkgqDvaMNKV28virWJN1hC4ut0Vq58l2yAN1sigN3K-jzyZcUsaDG9XSG4vMif6dYmxUJQJAW1tNGZlT-yEh-lvvsdGxV2OaItG8BM7YsO5yBiIMFvVlOFm8ptOPP4D101z4H5N54Oazs6adjEb7pYBqqunFOfIKM34HFmlOzJZxeqNmG-6KTcHeuJ1kWFWlG0+3ydv-v6Jmz7PBrkINjNQAVuT5EZVOXA9J716S0vbogVoOzezWex6IeNhrMXGFqOvyFNd5-Ptl8Emmr3psk2Xw-heYo3Vr6J4X0HfWKVvtDkBt0LfSrPp9gBerKgYropCtkI+8bKi3rdopmCZzzJ9bsBmwHq42uNXLWx+Jb8z7cecFJ015ZzmQqekieiq34bHTo4Emr2GgHuLf52X-B7qtIuGf+LfpfXGXEvK2V9SjT9Ow3ursZLaukR+R8FfJSZug1Vg8b-+C3NZSOGadY09oILCVf+J9cF-aNny-ztbt25bUoik0TXeZ1pCLPa9brqkxzmyJ3NUwK+x3Zf68v9n3G1q2hbbK5gibfIhL1-bGXJK2TFzqLQm-oZ9BD5+DYw7Ioj9xP7GMvrDLJNaKBo+Buey4TPPmrEznMghlmgWvLGu20SqEbINvtvnyh2R4kzpvHXOrzNc4Kh5dE9Cavomtnex5Z1U61VWdaJGj9Pw-EZlR4IL1xoi-qIWQU5NWoULHr7THhlhm3Zx3rolhHq3JcTcuIyex0WXL+ZADz1Ie2df-+vKGfOVl+R+m7CFC-E8QOezfZzrPI5uZP2wKpjKPOTxC7uUjtoQTG+npWcNpS0dfA4AI5C1bjeyU+xHMzlaX04j60qA-Fre47WQ6XmPt7+unX918lexbor90vDBglpyzyiblhFVfIB5pc6XYoBbw1SEmtt4I+Wu1f3r9wQHE-kFinWYvAPK5mNYogxhIIXycgN49hbX37DE++YG-pjzL765Zl3cZBAGGIkpV-MIHcMkfd-j+xactIVg0SSprlx8DMftlIjrrXSBp+qFmQNQFDjf+prFN5tfZ3HS3DBqqvMaEu529On1LQ5tw33Zpwt03xmSWrVoZXwEOnLSud82LcuN1ZCFU3FuGVWHbzqvk5cExQl0TyGs996n3X3d+5jZ-Jr86oEPGxzrGyGcsLYB+kxhq5TmfXRgO64rQmybzCacDeqPUwmuyjzRg94pS4FUpWElNPEx4AL5dXecNfecjkk3bhiAGc+8f42NOxYYWu8hV9kcaoWY8LVu6lu4G96T8b7EUME+f7WUTySnKCOViQngDDoj9Z3Vb8gZY0VxwA8LPMRXajMuiBNs4JIc2b+kAqSKOthV62nhBSTOXu4PFUSvcdOd3o1H4FQE58p4zpiPV0p0xZULTSkc-rz5x1e8MSQyt3IlA0-CsbCqjlAAeKM+LKivs6+hmfQUPdCOSj5oSbkCAkBlqOtulTJYBrYUHDQjfmffzjdDs4a61orSnXrMj9w04PpgL2DfNV1Ta3zUYXNRqLjA1RWaioQV2YUUhsRFVlgII-l-kCr0mHeh4A1I4YkIYmztagY+4T1uxdfERgif69qrzWvc-5SF0g14ARfsDaQuAqqfmZCNas9pisWFX17XNt0GqYokZtT22yJhQK7HGo8fbDblEsIr-pGBv726IljplVjlOdELGSxh4fVi1ecXdQ9Y7LRJ2xyJsM91PnHx8BXBEouMxW+BxtJQ9fsWSV+-XgdslM+zYHzyH4e4SbU5sjXQrI6iq9IFFn2nXq9H0-h+G8xUJu1fY7vxbo5sSn91k4+P+9oFpdfuq0Lc69LdW83t2U73UzVSRUmHsnt4uBo2N97cEaMWDW9A8d6HDZ49myl1DWDNs2h5XZjzmZZgnykbp-a1BcqzksiI4iSVJNuKUjMsmvplU4DPik53IqOD4Q9FhgzP+AUJwmCwfgeZEyButo-JzX-84D2LNwr5NFdNet6dK5dyoyCfF-yU4tkvceakr4UW-gjbDI7fNFBtSemJd9BYNFW9EXm4e-aVUQnfRBf8tHr2p3J2X6PhPabD+PzcfUHKQrLUcLUOzA3My7E7Lni9Syoz0SLKszjqeml6oG99uC2Gy5VYJ+UyGjq-43ShUxCWlM51kevl89btej0458+9A+OxBzLRgGkf6p2pbU1Abo9x9zH3V701QJkWAE6gpVkCLbxfd5nGEznQz+ALwakbarC4uI-tVckHPp20PfIMtsby3gyN4yTxtcTdg-ABfMs3lLxeHgZRbOz8tQC2OiscXJjDVqUCJVmDOTL9HY+hjZ3LXbQflcPIPZu+4wP23XwjSqyRV1xUOwsKOjr7OPGelBLi9sLE2LLbeB85+ykArFRorSidir3pB9893vj6yq9tzA1qcGzFwc7HiU1FnhpR-bzoyjhzlKL1hzeOSArzULk-mzWa+HoMRD+mRRQfVEWle9Dox8+DCmTmNhBdWyKqbVUdjTBZk+-TIgJ2ir4hiyKnsuYM+UZGb7ZDqhwRD3FEjsNwKKD-npnDO723migkT7kK1Jnt4DK1yeJW8NtIydTmtZ7TasvqJ3sZtk6aBDEMqg5sAdKfpS3d778548JqbDLUb1oMOP76dh5WlLItg8ssbr1uKK9ecynj8n97fDRKU0NNMmPDyI+63xe0PnxF4xyAp8QMs5a4D-zO3+COV8BwQ3uiE6SHLv3rhy4aIx+o7f23dHFGT95F0lHgK4865v37C8Gp-LljYkBZzwNfYdZEyu-v97JZfEQ3cGdcE-ZVgLaUvUKvnT5yg9jUi9vyb59WmQQZ-04aRyQ0e8-Ur6jftTT4+1vA1bh7GQmvtD527r+2zGx30gTO3MbOo3VdjUNIy950DvPS4p9yCPNfd44ZWmmL9XHdcwcC4K2HZk72rWZkupp7npK3AD3ep138+UF+zVtsOXR4xFn9CwD+7E1BaZHFCt8PHTUr38oX7amFnJwHtIiTb0q97nw8yfYrS8q2N733+G1rlKtGng+67F8x-y9Jrh+Bf9pO3iuaqvtrwigCgAmDjj+w-8vVZxCu48XZg2D1yb+UfcL82FmpLfb++i95mybbjmz2B-COvk34qdr3tLP8+xzohf84jboI4J+awfmtBF84+t-OOf4W5W9R-hblb1H+FuVvUf4W5W9R-t8Qxdw7zR2qedZe+jtV6dI3hDL3beeJlDVv9kj-r2l3rlfsLqvY8WbD92ehzM3mxItDc-6n2my-QfX4n2lTYP3fzY3+U232nyWKuZGTP7fDbMoinW-1-0sGr8ngn1qSKB+5Z0T9NTvmLvJmMEl6mpNBWvGXFD5T+z5xVbZQpQv+koU7MvjPPiIbR-WXfy3UaU6OuBCx6C9JHxoX057A3P976fwv3ccZYWZ+otHzTX7bXTQW-MhQQoB6x+sjtkgzW0ffejfpv8nXhH+z9Tdb-+Vs7bFFQpFa57cKiVcPZZka6lup83+DvgDyHyDkf63uLzvbvThJkTa4hQwhYueOITw0-fL8oAv2-9NThjpsLCnmGm7urDSLjgOvju+TTnLfvKcrFrLOvHnvOkRv-eJMoiY7szrWrbGyM5uy-+UJj+qc-81zIG-tcqfq16u-EslMcKSmDThWscVgAP46d87RizMpj-946rmwgRMX-zwlka-rYwS2-zq32MfWTTOkbYTujHtv7gzG3BwZep3c48X0W8DPkbnKkBFTX84dBedkjVTn5mCvzBnOxcxp4C8L5o6FZNIyQA4ah0dzNtj-cp-18kE7y8C8OWWlvlDWvit-XvviIM3I5QCeYR8-fvmchV8eQLbw0Z9IwYgAHvtrWHbq3pgYuHvr6s6zDMT0EOtDReQy+uwh0Z3ZlpZNa3Z2EtRWhA7l2eHp4Wr45GndvDk+r3vLA1a4BWTu8s8ONWlhsEZtxtTZy-WMIi7BP5AbkM5aA+fr7qmpxEwZIlHmjpbHgyJJGKVYvVCm49t51wFL6XARNWVoBkW3wmQiqEDdc7uFsmhXjMnOq3hwwZyXFre6ar7MuOx3sLbMnOKK9xdh3n84KDz9fPKwoD8MBmvJduM0keeE2hd1fZM8IOtYuNFP+Uww2IHzz97lnzl9UJjZUWRJcXBYUPl8m3+6P6FHAAqMHhy7Vzm8Vaj5dnUWf1UwKfV0jRUl4T43ZiZX5j6ko9gtBJE85XhTdhpXi65RyFAyjEmUCdEkzj4fzpUhoIohtWnfrBho5OuccvezjjaFFp8ZVR4B4v45p2OGqw1SrKjyyFP5ua89q+5al5Pj3n67N43s744zdRrOs+CGBpUNJKhuT2Jcxi0RIixACHDQm81yeH82gLe38JhfbtRlJse-lRDMo9kzMoyujSjM6IlSF1H1c9nkahWpsVTmCpSdyCFg+NwYaJqeXNZVR0pmPYiwzS66UqcTP9V+Q2MaSqr3H9VdmPPI46NN3TlQ2c3w4oggK8o8zqowLDlgD95HDnd3Xhkw-zygf+JrWIMRnuU1oOWMHjp5JekBfG+dqiE-s27CY4Mby3HO6Ts8GnIILn1eggFtUkvvp6Wp4f7F4mVWpFtuivTNbdJ9kSiX70SP74koEVjlyG7FPh68hbGMRuN4y+mmOitS6uPt1lDxT3UoktM7ZcDnF10029jwaKI7sAa99iWPF9hm++7Ag+7bdTvh0y1vd26KqMjiuNJ6IS5e7S3npwIXVEZlgScUyQ8yvb-jc29Sins41C613uyJkVcf2iBD3MJAaQTE+RifWpUN3BXf4bx4iJLjnkYdDT56vi3eFJyZ0jm1vQiT8ZjG8ZTTD8HSY32ayIRMk24PsL75TovBKkJNdJR7qZtRaw0AsEFRzvyC4FsAPQUSvPh-XR41OYSI1HPbuQHb8YiZwezHiTaJQZaUQcINpyUMJ422RH0W6QbYfO-8PIz7HJwVVtkgS6S7wsujOHpNh4QfDobUGDzKYNx2R-TFHII60A8iCQMVELLGeOHSrMFro2avwWFKnQS+Q2pKduZ2a+So6Xp+40xwhjSu19jH1NMibE5LsNpvBhkfzx166SM9xt+O3RKrC76mfUwhA-EX-bvr-OT4aet0H7-F-dpA8-NWKWd3HFWmc+UtmzsvkHb5mzR+4ondKSoZnt3EcTM+8lgDa4-VxQfm2yLZqBvovLiN4xsDs9MCNJ9hhuLGVtNaR6wplByoinOyXrFXPegzpPacnrFDli+6LYTJLr2Arp1WFHLbnvSj1XirlgI2XI1895D14dbF+w7wo1cwGhLRVw9tnGKHsxA92PFJJ01AyiMU1cpAnsOqbUt95GwgY3Z5O3nsYupJLC3G7jgzXlI-Xuctb5Ai0srHDD+KWh7iiBGBuPsKv8P8DmukmEvBwA09jsejVY6ZE1gOSeqIHFX2++Mm5k6JTR3oohHFp79Ycw4iw0Pt1V2IhWDZ5yVummoxOO1T8XeBROkh4kZ5CWeFFT1x2yDhBXDsNrMBz29iftfo9ryzGgxKQH0MwSOWDtlYUaZuLzB1ks7PqWC1H4B3eLzVSOO49s+U38soz4GqIXK82RLHF7eeNYcG5VHOivYGSfBhqfUBmGVMyrS4YlFE8a4JHJ0DMqqskauCLBvRs57j5pwgzvjBU2PrsM-suk1+e1w0-cDbUeU-cYwnOkW1LQ6cdPRYLGoGjOoFz4qfA8C6eO+a+NbFB8bulDMu5B2yRRZdMccuPrjRAODNTJKyH6zKb1Kx6DVQIKM-iAcH-VKfXStVEVk1sKR3XqUQWaaw1dyys52e9wPAewJSwkBgaMax6uJlKdFDJnge3pgDTTR4AjwBnNEsZbN1M1qlura2ZscRfkd5kTlb0TbsgPLFl7dynCYbS5ODqQmTNfnNqS5Jtkm5VhTK7XWw83F4-2iCx9K6Y4yHVZFjNPu2Z9p4d3GO++b6zs85FLTZ7XABHNfxS0QsVRoXDtq5xkdeApmQxHlvYNxf4TFnOhd-OXl0DdRcQIX4IJM311ByCAE7k1maaEN2AP8Q47rWNzcwdCrdkqJFi7CKccPNJw0P7ZBlsv1rAu6bs-262LPOmvm5Q+nrEq1TqzxH9xJjE+MILiOXTG7OThzZAMRHcwiUUu9kT2QRsimSeosb+38CgJXWTal8BFhBaQ+GSK2ReOzwpDXyZP1ECxFa-rC0Ce3Tt7Hzn7V3g+-jp6OO79k3h1ObMvmteNy9-1Hce8c1lW5-ozAo6EixA9LsjNJEpENiOTOMFStFSlBEOqEltBQQkXEQsAEiTUVFpIQeIJAEETJSEhUhQAiJIiCEJLQUEkJuEnTGmXPu+3nv75733r8gz977Kd9nle9ae++1ndNcbJFyoKO3-HshyWone10RJZRIhypWdO0js55BGmmbgu+RCKmX9uLutpzO2OEedd5Nzf-ZUkuZ8Ew+BycMIeIpmispvtO96T1x7cOA7uqV+ldvKoCUQ03HMnx7MnzfNOOikbdCRm876xgQsALDxgrNUSiJXvJ6hgNhVCtElW94yYAgVWleZZVhF2X7HAWQFb0mmDYksNOYsNfj5kFK7fOjUf53fKeplZ8dwlVrIqAfr8uMx1cio4gtZxGuqZ5D5I4ntNI1lGGE0-CuMQgyzTOm-eNyy-8uj-gPlERas-kOcD7oP9MaNh+4CF5maj1edIyeMkzZ5yvAcXxi1E6TFVLWs+2GHiv5A03M+O1jsnAbh4dc9a3INFsMElV+TpLRySpZGWApweLPW+6WXSmX2fYnI5OTq5LRvuXK4ls7-08eKFSDzSTLypt7wZKbNDU+1RWPSPiu1Wdz0S9-viqMMeDkUwGyYshHPHvg-9KXnj8krXz+YPPXyq5SLPy-Fkp3-bcDDS143jKuEubzjdKS8uBx-2yjzSy6-lvb-K2Clu+4r7QSeKqjloxt0wH7-t+XBJVujxuN2-1mjXT68T6mXyt4N4-ksY-J6K+c4bca5CSHSKkI4EVe-+sF5ySwpY-yWjdk9qSUdDNNSCP9MWEDTaTuGS5kzjhljiMqAD03Ztc3-nRqRDBOBb5136RelC3cA46SENteQh2Z9q6R3cUR5HpudM6hSDcM3y3j9CwonaLZofjCoa7Pq86Jxjb-pTx2o3Z4TklKTzuEEbYv3yGEHpge2TvKqWwn317M-0B2S8-OS6iMBXDgpQXpMgzi3aRxkH92H97S61FgwTO0vYKJfjlGc7bcP87Cy-d+CaFutmFMEXtsgV+C4k2+XGjS8t12VQkbuE+23tBO2dbMbeFb+LLz1NU5A5GBby4Fw5Fl6VNdefLRqdUKlr5zPvPw837CE3jODJb9Jo35hRwlluITmiO72GwLf7DVKeYX95jmMQcfKPjee+DtXcnosyMnGmerBGSOd4gJ2zYR7G22HYqiRN-KiA458svrja0yiNGykvP7CyU+rbQhfCtlaCzSLJf5xY7IRWzRuzPAryfl3SlH3FpLKuPM5IblSU3zYHC+wxBt2IwjCGL33JYKE15DNg+JFVIRDkTDgSXlupiHEj+c3Jh-pwKSlxG7k3ILYdvq5vvUQAnbW9k7N6waRGHsJNGPA8ZvjUX45c6gaW+rNaR4eFnJpChPGcZ5UBeheNH+Oic1Iqcy0J5fi7jqSQvN1G2u850pM8ZNDYHZEOe7JKaNAm2SzBinLgniWN7jQS33BXXLGhpSIJMzCUsZTn9lSCgNqAlI8yp7XPbMejrYoXFSAC8kQ09Thh0mYw1KxiFYwZET8Kt0H-bclxcODURp6W4O9EGprvdcLSTZznd5swjL69w-fUGvM1uj8KGELJIvjXubMRigzeo561C2-b0CBxS1ZZ-l7VGAIELYn0ikr+muXichpERmnkzx8DrSILlmqAWfpdnxUIE21ljU1jZ6QVpYmL1YJXGncNgfmjCKxM3YO42QDWz1dAabuiVxTEovZ3K8h2-TdzedsRzQsh58DaJRgEBj66tMZVgwJzhnxyALT+7Vbn5IPnrrUne1YpQxLinB5LUrrIzgf8xO-28LsdTgSzP+juZ-tLlC4Ynu6fnpE0M6-Pe+kvWtGcQ2Oc+VNnSP6AKmg3Fj9qRC8xXtAwgOBLXHVlGmt5xvpjffVsj9pznGjixU-1vbRHYrQlEmd-tMvpXKtwQEy4xovBD-X7DB0vAeTrHU-94RSD+okBaFNYjZJm2rMPw6MkDv3WqZJUz8n30N4n9ygNDM9aBxPKTTWFWMZCdRLi+bvjBUG05uOWvDC7GZbl6c7RzaUIwTH5FBJ8vq6KVcWk7QGD2maPClb41uJkq97zpZUsZFednD+K-W5Gu8+m+3lypJMzCvcr8mf47-gSeslcXoyzfZlvd-n-5y1uf9+v3TptelEYL0+es9Slh29JJhzLaum8tZqJrrEncvrak-Ks0ddSSwc-IbqAUtUdJSkbm56lk3O89+EhSpO2OyPPLV9YvU2y7w+Gklnz5Fch6ML4WGF3z9EMlxP5YCbYSQTiHIqj-4to2MVaYS2gbeJH56d4-P0G8rVNJvGxiZrNJP192o78uB15pIvwRyXJqqL0Uq0piqsMfaC4qpEVltC9L3WS+IBJOfIuMwhxRosUO2b2xxJ6iZu77mvzLfli6-UT0aZ8rxc75ZyWop1M8BAQElhMYEBZD1ehaWtuEhz43mAMdE5w5xOjulhTeDQoB630Aa-0WBdvuSUbH1IOSXJg1FS++h4QST9pah6PEurPD1ci7u4uEIYCJq9mn07Avf+7ZxsO4EMH8gbjR4SyKVGI-W3YreAYLQmHdCdWU0SlpFziivRf3IINewScf0wy5gVfUWep0eyVUF+ga4WFbbjmvPRmJeCo8h5vVTrnwTHR9l2OrReif4+XGIIrbbz1kSo8S1eww5x606kffYWbeEpKw8kL42z1hK9aRP4kYE6r0bEEbM92XtIj0xcGhkMjvSx4M8UePK2D5CdAjgSbXp1nI2mRA+bPJt9x-OScJ537KW8pkzeaZPywh1HxVohVz49W5CfB2haUxEJkCVsJOmFxVA42Hjf4rY0DCJjpF48HvfHrv2Hb+gAPoUa68AOma9vVwcajlvIWEOX0VoDKEIsu4qc8AIDJu6ZzigIiVszoC1GQrQp82PJfYdp0In-0SJqQIzKK7mQ4kdgbrA5p+MJymvD-brjCmqwTgOcWOAqnvPzL5t85AStk7gbUbxfcNRgzHMpibFv9kWwts9IBgW6b1BMobIvAsEm4RxaR9kab2v900lkal1zMfaDN8Z81-qZgv3n-PltGm4eJjw3uULFbHhO6cWtxl1T0fpfdMeP1cF2rGYPvcmYLV9RAgNT9ZlN54lH6WFSECNPTiVFmPvyz2Z-Z0CRTXNebxZo3Y2LVbiK3x8pxiVmvwOSm+ie7ugFMdn9KR0znoD5oCBKPaOw65bvilwN5LOsDZAzax7QN7Ch7ajc6TvJIsggM0fJJgPPZZKpZMkZHQqcCXHXfVsPUmklyDTChLSvb7JyoAazDTT3KFWJvnIeni-JOAmsY7nJjl76uuWaKuWeL9J-6JtMw1BWYb9KehQ6Uu8Ns7I0L0ODZeA6iQ8Idj0O3jDb1Nyy5xVwPq+6RcV3MV48pm0sJmls0MErjL+4lxlhykqIo+aABbBbLw9hdaEiIBhMhZEU-lTHA0kka-vx12IYU97QdnTG00SU2iBfMvwoWPUltPQT3cdYCeg4Iqe1rm9vqwMbw+e974eBRAEMwnPq0dx5dCbFIbHSptfu0aP4smx6X4+44hGX3Fv4RV4MxyH1fpOYUG3ImaUCrfptWlOMgpyweK1H5UBIX9JoP10sBIm4ClFxO-mEvygKFBz1AfRi24mAQatUWye7GocI8Spnh3mNSGWPGUZClnFtAVNWKj6nzNlJIAjMj0FXU0XI7ow3QVw52G2ORsF2Uy-pfFVvv5m92MkZpJczpvJxgALwYBvAp6WkN627yvEtxPSt-3-0f42WBk2pPZPh7VO-IPUDR+-LeB51hv974c4-7cHpIl-gi0to2mttM1l858Rx-Bs3z-JBuxraKX2-2jct4zRLJCizVkxSF4u-pnZcnhTTz4LHnr1-unSgN7eEPFgIEo+0FIk3ign15Xxza1fbfKaUIaFYqTufsj5a8+8hzPXJH20MCVhklwoSPNbpDqbid5tct3a1LMiUhFQ7yElMyyDb2uxHV4olzrT9jWZEv+OllIcPPzb6ufW5Rkm-HunEvAD--18Ka3QNHGxUdAbktpzOZ5stqNp3z5i1ZA2x9Tbbkxy-F0SV7WLyjzys8j2uCltcH2jFbWZKbs14Oluke7ROrYwNI3QKJANzImGOeXm2g-b98GZrjHTX44yYh117X-1RDnzwmxeCuOkVR2wdk-1IiA5DhPj2o2kHIo0QUDHymLFoY94aVT2zJiy45emnpRPLxc5FY8rrPnPFLEaX86iKYBTnhGht4RA09nudmL0uzlFZBmidXFmYJKsprvJsQ99HLswXK-N+j0BRZIVehI75oy4XZ5PEYP1lbDdnJdC67gm7KKsELbrjBWEOltFZG9QCGJh5uutKGaKN-j2L+GYt0sPeSJsrwie9rsEkXhhhywGakhA8aaa3l8IC7tILdceJZJ4yklhogD68bToMCe6xNJyvZ1aL4nn-BiAcY2FcN91+3Va21M4OZ+yLbGdlh1u4OvsYUXWtQSTIvvMDDFO12baHHSc668Co8yA45C+9okevnbKpoehCNDNcSoiLQxDXVchFH5YoqFfgmw3VHT-tXHZvXi0DvETl1L9uaN6bIvex+werJhzO2qLLzXvPO8MomtMgOpknN-xkahVd0QZdmoob9vIz5yrCGH3rEiB1iEIyqNW+3nZKWIvnRUDUelqW+pj2zEeHD9utNmwfUyViFF-apZ3r5ZqirLpE8B3L7hf7goCgd+y3UZdu49gy4Wt303lHd45NYwT3ac74cSDNOiOnbU44jYC+DRiOTLV3L7KuWA0ilrNPqsnfGM3pWfy0rLtHPgFW4e-Hvyi9fF-rPLQhUeXLIrZgtpHi2Jf68sc2JTPnHfciHikGwRqHePd7vaqi4N6mu8vL9fzXbR39Vj6yRwLIdTVFxAj0glfcm+66DIWdc2neGXU8Ria9Msm9ajloMxuWsXetnzGjPlJGdNOajdwaOgjdVAQhuPcmb4teoQGe4aJqSADR4TP+1IgxK1XLnJT1anbUOxocfY++0J593O34orvoHR5gOkEtZo0sjIMHhJTvyVSETQH1Hihh7NxwrIOIC2GBwp72Wam-GB2tfWJEJQeGiwGbEA7LjmsznsH-sJ2K6YM+36nzzpqMEzWKOCJmXu+ZYhzepjE55htDmnH1S-WWIGoWKw4-IGbh761ogXwZfUS437sxqDUW10-Q5tcCorvbZHjSkiIJbN5D9FoMg0mbG-2ojN6tPkvccMLoubHQuHBBfHCaw40UqmmYkmja9IGI153cHHprFpkTmU5ICIUjhwdAStiBVioOQ7L+mLJ55W9HkDysv8S+fBkBdBIadMNJh7deCrqACXXQ53YWcn69ESXvN6XZX4DLTDEaCFzrwZ0GSjh58mtNZx09YUEY0n8vDRQGkk7kUw5nQ7TE7xN5qbFteDJRXGKNFZ26LNwF4q9GdisCZKGjkyu7K5wpoFoVmhh9EwccWCAu1SnABLGuvXCLZWw23b4zAZOLujKLOY3zKjKsOxDpTGKIF4QdnbECqOX1KA5NOs73eu7BJGQCwAGXfwMADWLqfMUa9484UaLPqManW1ZwytoUUIzNhTwX4+hvD-HsRrGL454zs3uVgAVUN8FjosJ2ekDJ1O9j6YK44ZE2bHkXg1lcDBda1aYmYBq+0vgG3ISTKzvXhgs9OTMzdzVe+zKkEiCZHDCWQXQHLlWcAvHmsGOYyOA2ag7E7+mqY-mDGDANyw1+Q-WSEZifrmQr4NeEguvDtHmhAcXkUuDvtMZZ31-bK9kxWda1ZlN2+-F3eh7VO8kCsIJwl6iIGKHSO6vCB1e1nfbkpjAHvicJLxwxD3g-Jo3j0vNay4UgpoSXD3B2xVAMU1hm0FsZvZ96swTG8Yu5NVbCekL+6Y5rmJk8wft93WEiB1IiWB0M80klsZPFdztnSwBlFZk46uXifOFlAPneWVc7zIcMBHZbPd31xPhS8tvCkWFr2KIYyDwRDd7ZdaQZMrMpgYbLzql4WQZmM5wR+luKhH+fgeMz04+cTiq6QVxeMK5QN6b7m2sDLO3UXCJqCi50cw5vWm99wV38bQZv4+Hcb5MD-TM13rXwbAIKYg2bkXQJvNFzqJYYb8Q8c85RNkhM5tCC5jxZOn3OG21ys2mdUYkwcaq+vHSJiZE6HDiuXflyMpSTT73p2Qs3x4Tp0jtu8onwXaOeZKX1OQur2oa04TlyVfYH3Rqvcwqff10Vtgjbm5I-8szS7MO4NgxRWCi2u5XeMJ7Tf4LnfDnYbdy4kjnm3z-fp40O+G9dEvdMC8hvYwBh13lFf5WrPGX2VEEsMxHVh73pSdSfP7yclLKILtGLeS7fb1MH-E0+zefn5KQHtcd3SKZBR2q+beOa6MLN2cac0hLp8OEH-6Q5-WeFANXyslF-EmFZIHHNrnOd9o-JhybFBvIyUk7X574cszw9yTswm+npGSnXu--s5T4-+QAqzYLhNDcbMIhSc9xT-5GsTaPEAJRzYopUpzl6BYa34iPIkBKfCTUL3jfN+yVYVLsJUuneP1JhPhSIiTNeLZ8zQlFCZLzj3uuirhM956QZWmGFL8JoZ44DakvS1mkSzmgnFyo1rfsEpvPRetLydt0ZaRsESGy9NHodAKbJiDfVfek+YQhpE9UtIFAsiITE20Xxm2Cs8al5SZG1DZJC0qMAV5VCBNYeN7nd4mfPl-hkMiQPPsQquNoWBh09lH0-M4lwdGZLy1HZ+jv7hEhg7oFEBZDSmmWr3v43coa5hLAYpesviYPIeBlGHsxnGfxFpJnxn85wy6Nzq039Pnu4NQMK-hR+vcX9ySwJz-VSItklJ8lOBJTOokzp9Niis1eCHay9AJapTXqwfx6p7QEKfc6S4j75VV4F2NpLudePfLL-u9gSVaDWS5qwhrWgf8Y3aTX9qZbWUcSbrd39kc9p1WYycM36qNbv9sh6c2hGTY-6q46yzk1PJFYirEzIZ1-qdQUMB+Y23Lg-NyOg48vvcXz+EEi0vuKMyFvsyEMYans8KKZ7Qf8uzsLcUIKzRP2eYfeUU-uZAlqMwkohs3u-7f9XfKbfQWHIsaGPeGJdMm+VMVxPa1-2DKv4SfGq+t1L0iwtkIgPJVhDJA+Im0YQpwtmVe51ktIgJKGDRwOJg43b-pHpcm-jfD1Wed9jHflMbvPniU5RHp6bCwKiyHdjhKtuyPcC5y+oOC+EMHL-yBNFMP1Chp0mRfF2kXzuSr1WDZ2G1uwY-vx9zoL3NS4lu-wGXqHJ59Og9zchlqMJlJHOITI-PwxQPlck1X6HTCbND2CZejxbYAKKOtpc2MSQnucGNzXkT4+ZO+JPDGeqNSQzrAzIF7+zNBa5doU+1n4NhlQEzW05nthZSlhNWbPAtNNpJ97HuslCELI2sq83AmliQSw-bA56T5Dk9FhNhkLqKrWnj2r4HWZXsLyhZeyod3jFeMngJnj-8HNfofMuCR2hlILCtU7zDhnFTyNLJXHQpRUMAogzhwbeqMaWz1zmLRVvdBj0tuu04wT7rs0eqNliLn1bxhM4J3hQ1cF3gdQltO1yOcgcw0nAtHEFp14g4UnW3b4KGGvT45Y9JBxw3jyUjaiN6IkLQOoVRHn9mXfd5IZZTF9QQ8dI4s4QGrQhvS+KeEAvBae1drB0oTZl5tO+wDrzDgzBR5CXcZD7x3LX8f7qh+aSLoBsm6YRQh3SgT1YMPK4X2exyYLgY8nnCSqMRfCIXnwlPEB04GDlsRa0uDxo-k+q1Z-B7PPYoLa7ivTeCWz-4rJkrmPv1sdWeT5d-MldSdG7WoujR+AQmmmX+d-Gf5mSmAi7f5nsnxoAP1vCXQdUsGuf7adJPFlTwjJher9dRe2ZvnWIEvhv-BNQemNQ04wLfef8f5yjCxtOzc922mioFMsRslyyt9i5EOTao0VB4qRXHk5OuA3oBqOOxiIHzy5pPPuG5JzJnEywOOFXbi5Q9Jtz2yVoDkG4i6DzstGjidaLN-xljho3NQy8CwzMVEpWJolUpXG98iBZfCHfJfy1Aa-3jJnmYurCLKvLtaTFm31ajSXb7sPBS75LLuT0IKFKICfmeyxFZzEBkuLaRgZl6-PCmPzs+xlooGHj9EWQliygoWylPb8qJGj7ia1G55ZtrLkeX1hArvKCmjtKpKf2UJEI3+rtwPukX5jmoeGxiyJwWwEdOfRH+3kyZjIczvNqlv9MIcqDPrXXVTp-uynD43NeR4nXH3wVzc0TMFTrjcDJl++qlj1N7fhO-Wt2a25gi1aV5dIXUNdO-bvNWvd8Sli4pwPXy8iImruxQFhkkM7xJLXtvi6ldrt4vSTb13BoSqceJGUzKSe9Mnzq27WIzOSYoeGgvU6FkqJPVDucAi4JPjKAJPy9BYajYlBU9Cu2RMMbARH0M312M9+AadhddDIOGGAUNCNedrkWep4xoH4e7xkbwJ3023dv6gTBanJvwqKKnGDPHP1zuOCwjNf4vrGLtQZCcs95KxBqOIhUsY6CZqjVpfwUZ-PRbpGQ11OW61EXBJtv73GcX7TpSG7g1M-YF1DNQoUpzqPM3bRbbU4xGE7w5IboPR1NrurT5dvg16+4Wj3XB4EQgVYXxq4U3C3a1LSyU-Ttno-SLa9PDueveuZiOwZ-QT1pbUP6CUIEY5xynHZN8AZb02ux-TGg91RBr5T1e36PxbZjDI89eX15NzTelfCuovmnqytgVDaitgWOfaHLul2JQU3Fgj1Z1+di-XRyLoB3SFPe-YSwr2al7p0LpG9aZa5hn+5yPvHt6r3FGOZ8aiFSM+NNkAqdKYnA42Ou-bqSfXrydVS0br6A3aHdj-QSJj02HGg+-irxioT9xUhDU0gCueMmjJ-Lydw-fQFdsaRVRLp8yDupa8BoQaSghbuRU+QQyyS3ga7FCmP3K2aFLIVWgZNbvyArYb6+ZpADTN-aDxv1GX7Ez0QEh7QcZBdH28Seb1R1WXp6PGCgCbtb2CsihMWZaghbgDYb5NPCHEfx5+WPlvyf7mGOQYfuoh35nwBcDlrZVtSGG8SZLYysMcG7sr76N-oH3M1gpYUP9J0hWZKN8ifOl7H4H5cjT1ei403WRF8VKv0x7zcolX8WfhJxrxPswrkGC9n7VJzvSNg4YqQAFyqbJySfiqK2+MILDPeINWl7hUwh99EPceAFbcVYQvnIo-SDijC2u7BW2PhuP1ctDAmrLn+ZDPS9r56EgAqEKxT-XG1yX2JcBkTbipgn+mPnO3ZAB2ldaWAerOT-FP3lVvCT-qi1Pgd+nIUx9nexKPytBibF9XkqBBVltyHV02DTS-XlhvBOyo2fVaZS1E9d64qPRR2lDp26Tlq1D1xLav3MHbbkLAbjLjXrbfq6z4t+tf33Qtz3DWv7+vITQL4zWx7t6B0pqCeNrEau1smKBuUYHM+TH3+jdG5InbjvrJ1mzdf8nKFwqrYV6upV1o8ShDM2DV8Ys8wcXj6TVviqwZPA7oB5Wrt0GJxY+OzeFQubn4FrcJuIOSFb6nzDkNYVwP9aMY2GjbUZK0Mo3IAPQXeBPhyDFluM69QWFzcdJFmpvg7CoxGi2gI9hhZgPLHo3G6PmsfAA-VH0Q6SUyQ+ufr8qDZ856Xf-wIZdzfNrD2y885zN3X4VFHHjjFhJuoDH4i++-GfWBeh7QutaOmpwo+5YhO4oJwzwDTG6bznj0jDvcfegCR6yD+8s7UfyXMAbLzMGH8tqNOHTnHxhUDCeBsSfcmT-x4iZbzuNxfycBV-GKEXqy8jcZG8DDNHz23SsOphx4QfJZi7Mz4-vMGFwTxx98Xfb6hRth92PoxcEv+cIqIsbQHOz9+tIHdnuzS433s+n4egpG2FLRTYiE7wx7Gm4gokKT5PZjZm5htt7Q8Hbwf1IlXYw8Z6hPVDo2s-ZEr-9HjhdvInub9D24RttFtfSVGYSNdZ6jyaK+NSnLkzssOu-wxcVfyspJQekeBP7sinoR-CVJBFVaW+9we6NlmcxMomnAcIW37LGxRQ9xOipuYvS+zWtBeedopXkvvgc8lPC1b-z-6vqj94v-C0sSEa+aNM70eGRODBr+yqH1kSo3S77NnIttFvUc6WFadsU5fSD-y5ejXmhzwPF5vkpLrKvzsaRMV+pbfJYZgBe2UMhc6mjqaPFqNN1bbZObT3PNov4dTOSGg1yau0qyqf2JgBP4DdsCGoz-X8SikeBFGrUns3ZdpzvbSidQuXbaoUKY86G0SyGNf5pIdKEp3uluQVl3Efb4UQM46JSh4LH7A9R0R-AyCHmCa3DebipoqIFTt5UwkjbzMynlbkLoCJhdqnabGxy6IJl+JGreWb3qS4chsqzCMC0CtEbU-ClHuyVTAujZUx54YTQNhrMvd3JBFnJ1P4tlBXbZxSiu8hB9kyL5kaK+fhug8dvLdDYrSn9KXXG47VrnDou8IPmq1ZBA5dzN5mneXAjbk1tMDavyrIqIrEDIZVScuh51BmCKLC1irsa0SM0gP19aZhvNn9HuT4pKmS2Y4uS12v2lFylOCKNvpOaLZvlWDn3pgoiq+JQ-KSBOmQk4w3mV53N+ELskwkTiBaqKn+OarUpXUiwXhhh8OVxy5VjlpcxSf1WtUfLy-fP0PqmM6ZS1vLxnU6TDefXk7sTZvk0Rb5cgn8DyNuXjwTCuqbQOsmP-Zgxal-QpdCdoirPgZaJ5pzonowZeXHFkvR1xCFOjzdY9ItClr5Es8uwAx7wr5CDgXT171+WIHrtnypx+wz1BftHc5Drc9Qm2x4jrOM7la5Ake8HpCYhgS-pPVi+T7pd09EO6WS-3bNttqHMWT962MTi898uzcxk3yoL7HEim0-WaTTVVXcar0mVtEHZ-eYAVKZ4XhHUyCWl2dsMUj+xLFkvRBDRckObde20EJBhyCXfBYNf4v3-Tj+jJFm5g7dOrbNLnH5fXGHf-joQh5PfWD--FICklc27iWeJOomyVtw5v3jCfmyuzsO3kaCTHbPHnYSt8mzt1mGcICtfBvc0HTxE6Qbbkb8uyN82Qy+pykZC0zi4UKWDXA4i+Sg-emU4zcGy9SlCSH1yL0ypO0Q8uGi9J-kig6ZJ2M0KrvEdG13hZTDZKlfqdx1TKn-FkyiIu6vIz+VvwqmRdj+3K2YfNqqV9csfxOynbJCaUp8TLm6bLzrz7lUiQnVBj-IEtWeN2RnND38-LDHYbr-9uDsNdNizwgskdUQl1lLdJtqhf5-1ubcL6uUUaI6w2lA2dJUAIje2jLT9EEbpX2bG1DF9KPLM-IXUE6cGeKEkwPPv8urjhjNbukr0+30Gl37uEyOOCXshOSk2SY5e6k20L387si3hk3bBzcL2kmHZKuZv3zwcVdjB-5uqw6S8soSjJfgMDEcAKEL2uOIuVXM4aC2LqCAkKw1uEFlAUGdNkCUwUVX+3UErrd-TCKmAuIi+Ddvk9OEcbWUofU59SvV41xAt2GeNiI8IR8-Y2ujsJfIcE+d1k7QJsHzyGUY+Cvqh53ZxBshrybo-WMPjQAnztoknpbuaznF6AvnM9k2RNFnrH5dbkFI8mYnAXOrz7shh7u3ILDF8pZTi67si4wrlGgHQ66HphZfm54ZNMoR4UTO2XORoFrF1-YgTjeq4Nren95OV75ItBFH+noGlswkbT-JTmCtgCgD2X+3mhBaQuhttmonyLvlpezUpIhvK93zMSVugEWdnCv6s5upXefDkZqrNK61ng5z5-in9NVT2WND8T3Yg9hVrq6JquwmFpPKXGGhU3DM9oqFKbO-RzFSZ7KbPIhXCsj8iJpw++5L+BTmltNlLz1dJ+TR7yCobhIJtLdoi-4Yl9vpdi62bfdBxNsmUNdbF-wq8GEFbQtuv+E82RFi9XneDHZcRMxdo5u+UqwHkhxbuJsbnLEmZrWXcfJTRgLjEgvBtz8uTaVcoX3ash-8KIwP9tuivvOAz0oto-R8lvFsfm0pHWALZ6yfw4xFIkvtMXcHLddFGc0sTM6byDnRoUKWCd4Ce9fY7cZ7257CE8Ty1lxpSNRq+XkiDLp33WiduG4E39TXiuecqD-gHJNqkKgq9cd1acnE3qbhvJcXe4EqHXUKgpsLhWcswcFW3SHP+e0znAgZcr9zAzVmk0K4MeqI-G0-EMNQXImm+pKdI84jzcrtOhz7ZizzygO4tjKbmMtRgbVxMN1pKoy9URno7dRn9Z4svcXNsrJ9uigR5C3j9Doynh5TBMGrs6EBWCKcFn5nefQo9HDVREVA8PM8jOI1KJAmzVmnziuAbhkxmD7B+IkmxLYUAe3t4jSL3VEiu2PhZlc6CSiYs7110FTXy0OIFJmq0SbhZ2shcuutVN1M9q-iMy1uFo8M9rVGt9mlq6-R+J8NGXczH18SmS8YZISTKaqjc9hJNHw+NE-9cOULuTb0sqMh8aLlQpa49kHDlqq3FVJvDziNWe11UXz17j+MrTQUvV2r2LNsZH40bDE8HN5rdwer8kgL9i7AxXOHrpK1ikJgy+0+juVxg0ID-4gga23DqYIAz8UuWZxoiehA9ZnhH8o4vQkDE8iMD6pne0JlBpEK+mNKYHhaU1E7LPLAWY2iK1aZ0MoFahjOUx0M+3+ODZIOLGYhc3KJ83VjLJckgWO5K1Np8pjcIbIdOXxLyHshpuZg1FNqhOQAA-Sh9Wo4KDxWov6a3VOZW7GuDTqUqDwDQeSTjjjNsw2MyS9KmhSuUBrfR9cNdpWV12VDOmYG9Q5F5vfTpN-KdzTB+4rMmsCte-3ZTa+mJviXIHRjMaUPm6BcN6km+CgwtKnJ3+QC90sM2SXXnaD1itgTbCLLxtDC4p0YYh6NZDQUln7ZOKV1kf9Vm-NVfG1Su9fBiikFnorjs4eqoCFBjn3wftBgJ8s9ipOZSouTSb+bhtWETIYYrHWRUfbPtR1romodJY8FnP4zoba9P6rBp1Z85Q0Tgcrq1yU3tkO3WfEmEQLrQ3X+HCYl6oHalGDS1AKLcnCpqboaXCbhStl9518TMXSdGwQCTPbiFpRFgzE7TZBmNgXjvt3Ltjn5s9V5RWNbwM7LtiMClumFp8JLOyRaquFngiwdW9tqo9zX8yC4P6hrlNh9teqPNUwkE9xZ1xDGpnYudtGjoNvgjA1KhBOHovsXupdekQwfE-7OLJcNaNugpW7e9RHuGdJ73j6NjfUBtJ4d3nXZUSRFMGnVM9XFj1hJySxUNmCTA0z-1TDPt6mvBH64IFfLZRdUhNPVUPeH3o9KDe0tZR20dMg8OjZUy8c9-M3Kb2raqm4vK-y+f4X-dnEIwDkS1-Ln5xdwZdOl1u-VX-dgh0E2KZQyvFz17frB+h1Qys-v7VhDZ7SqEmDHGWnfhyfBjd7ttq7EtPvQi21fjK+PnrOeiHmC9fU3siJAqo1wk43z+fmFxnxxmN6dHrg9b+IrMv3EsFNz980fAE8uFOAGoOks42O5vxO3jtggQ0ZWjMym4Wto8JPB7P1AwJnFlWFJ0mXkIjWBmQ-pG9u-6ywBOp+nM1cgKhRuMKCXjRkKuk0u8IDqpoSXDK+fYD3wq7uqNVzKyDFsRLRWNBh7gHD5eiwp2Mb+zrvwlXGnyJ1UA7QReaI9oVJmr9HVnE+u0dqxoF-mfGPNLrWicQTrXJUKz87Va9exb7GhLIQuQM6-1qT6LzN8IVKqAqlL8tIjZU0+gbaKheorRyoPG2u2BEg9Fe5r5ZY9vFNcf1J030a5kqjjbHm6Xt0jzDsmKWwCnbM4OjNQYeICiiu0nNA9D7D3FgLNVpj2Jx+kRw78+Be8EVm1NpMx9GnECuvrXEtndTjJIb1YLiVZWUeZ3w7TrFhPjeVYu+EHG5kJjMoKcHVTajDtv1lFD9LE0Rw62zV8M176NpJ66Eduj2n2YueKeTiKvHig8zhHa+qHJqc2wVq4+j+uljj97ybh0Si7X0xVsQgYJtgAvEpFk45+YF4ochu2EEX+WkRkSUnR8+VEZNX53NwV5LkafuiLZXvnlQIGJHrtTrtrOXSqbQ0e6jstBOcXgbw689W7IQyPihi2+XRJxe3tGIwl-aV7teoP3B6c3qJNj2wt9gNHIavaEANbvXZzkJD8qGbJ2sVSRTj8c78WvjOxPetXpy7NaV-YsLL0gXNRuCYV9GIYOS9J1QuIfTXPAI3R0d4Prlt--uIjNhKiYezh7ipEuobSBQPK1z3SH42eqC8KzIvJvtS3sX6fZhTN6OpgeOLP6OCo5p6G9U8XwBmtPtYCfAbjWocZTZwwBrcpMasM0LNRere5f3mCm+terw4HXGm4Hy-cV+gFWiizhZur2pewi4fwrxNO9w8ghij3Lrh-cekWYa5B4r1oJ1czbkXce5Bx0DZOc+RKRfSqEz1sv9SPfXpVIUzrQdpB+jqSjBCQmNk3iXhAn6w-qTYRvlyRuK7Mz6nwbdVYRmJXh8hFxEHVG9wEltHHnmA-R8Z6opZDz7Rho6ml4WUOg6VV6HOBlbsM--wuJY9s+VCZhm+uqbzXG16GBV+qGvxYRpEczJf+0hfyOWFieZ7i0NWrFmrcxP2zsPIWvI5a9FCvxFor-f93JyBqq11PePNWQGjds98-Tt-dnuDagGMxrFOBe1YaHrGvVMcFHdbvb6u0qNNYNTkrOr5ErCpsjRngXYod7XwWOdNoSoPStN95VzH8iQcDKrDheRNPNzNXufTUGvxvqQuRcIW+qFO3IpTC-n30RMVBQNCh7oCmOhEnaevJ-t0MkIYLurgJtbkVnXVEAtn+BgB4LlHJJkXQ7lSpi3BLfkv5qA+3a04J2x5HhQarH3QQGl9UQJOiAmhlxiaxOWp6j4Hqs8m1F-xQrmAD2Re0PyXez9pa1+l3diN8Nv7eoacrV3cVlGMVFbphioXzRs+-uOVKdBX+CslkN9A3d1RdZfcKlq-xOwkKkaMNE0Ma6Zd0vhDh5vd59OPdSqqOplJeCvKZZmo16kJddJ2UQERB21vUXYTKp6WRo3Fw+2TZagVe7SeiJ0qm95ees+9sC0i+-dRpppegOenwXa4djTV8V3fc0FSYCNMd6SxN-BATfJEs4FhJ6th1uYZ08uJdvpUs3HvCHHwfBzlqLC58Lkd61Ss2gmCTtaFQf4nzl4yqB4RY92GCGyvmo2zAGV2GeQ+kbpDwJ-usKoqHqXx+ncF348QSySAf15VEYoCQxmqiWda5Zx979m3HVBZrO1gdyliX3k5W3j1q3xIVfAnqHZwCBQjvQ533Sk76GnjIEu9+akk5maum94+j-TxgCwTGmB29GOTJYpTWvp5WGMQdhYVg1nNUEv8MEHKi+6+V3c-RI-yvt5wABztUfOskmlnF6T3u08ey6pRWOvWFwQeaNjbRJcaeayRUrq-c9uCHpGx4woTs7HTDWtsZgINxlRlEU9GPqnLpEUdQrMFC8bDelVzAKOcyQy9uBhxFIXHXlctuBHMIOCih97VBNtho431iqNRL3DILnbCjMZ7b4ZRn20pUBfpHBJIdbX+OOQD0Rp0xA1Hh6QwLINy8nivbw7ulFCtn-+kWgZr+HcTWvY9OqAc3uZTm1B9eaup5odGLSWlzkNlxblhXrYsA723x2uVsI1VVymbE8NH8COPNH5KSUwJc32m2mrK-DAZOv9oCOvT3YIfhLhk6YOzigL02swfDh6lWMnlhmhRTqvD1Dp9IWkMZY4y78LZ8Se6tczquD1lyHdpn0x3KgxSTVUY8wrvWmexpcJnI8aTkLtxE5r2origtYPUSI+OwLuMQb-NhtpeM+7PBXWuSNSbZn5tWQ3tQ-HgxX6L+5TG3dTZJ8MDMSxaVHug5yLOjYWBpr7nfIqZnDxQXIB+zLo3O7RJXOS8ie2Y0uidV8BYan6+luQfzjxbxthEOQQ1HoQEgngfxdcuU2bs1DrXtNU21vCAcnL5WX9ZqE3TSfIv9v22UelNQCJMRAct5uzPkC+v8Ih4ZGOuzIIIHyjWbUn0MyqDb0oMHzgYtP+0hTLUQqn3xxG6XxVtROLbIqb7E4Qht6fftvT2SNhnTAf3jvGaRDSz7m6WeZBtbXY3dEPHScWYkcZLyCNwQt37LQcdldooCnwPHUGcefm9AvT8g2tWPzU35BSkBMWMupePecYCHKmZJfIHd7zV0Akfqt6vCkv-jdJLeU8-T7bIPOcfpV9GKs8dtN+fNRRxCTcDMEEdjQWiUeTz5Ha4XQk4nE0QnaJ8II5PwSHguMBm4K73ovbZ3+HnB92bLF81ZohHqhgXdM+ddWK4My-Ym9iONDA7Osvh4cPJdTPvg9fLxc-tlkbGq88FL93lqfKHHcpOeBKtHrm69lVZrapfX1vH1ajd-3FjAHPONMAnPB5QYWd4QhJRf6UO6mp8qyjROcWyIqUfZ86JAW3SMD6077+RHkhT5QNwInbv8vOrPqbZJ3bfe1ODLeYiuXeN6cLZ6knZS3ySETwu43kksbDkbw0CW2Cx8Yrlhr5dijA9GF9tuS9Jb43z8jTLl7LHQCQT+ZZwkMNrTihgwc7LtTLkJFol+SVCiy94rFpuKD2uzF8arUb9deVNeZp6gdhtORchWYaxKZ2ymI4s-cfIqZOv4Cw2++tVO64XZ7Yw5zzlC95c2S9b1j-+2CBe+oQKm5yXQZOTazJcRklOLnfd--H-tD+icSIj5ydQkV6h0+6sYqioIHE5OyOXtlZxTjybhQv9mL+95p1T+bd2p1N+ETorYNqTK+RptAtf4YMczmFspY+cNtGdFtG5RV+xP5j3dsxmFd-qQ8r3GRu5FxsG3ZXk9ZJjZ+LZFNq8pUxC5Oim1y3Ih-CEx552dCG9deQHbDpA8KX5Q4cM3fiIrTUNqj8AVCFO8rTKe8tziY-Y-bWxWZ7WSuWO9ZYwSxwGh9RH749Sh4L1Ajod1CiYnBwm9YgNG4GJMe86jgTgRc8vkj50U4-A3WTjEl-tPZITBa5DGXi-7wxBgwn7h4NpTYjaZnjOfetYTDOcEysc8wgeGG0ci2dTc8gZ3PcYuBv16tmarLcWINwAViuTUPewrrkCIRAsuoPx5PNr6JlU8N7UstsrE7fdP56In4LY0kuY+mrarXVrtu2UDerrL3p8ckdpzkqDYuhv6q35zY9PoUlBzWj0glXs+tmm5m4Q6p25EuxQDDWZzJxGgd3YkklxyAi-RKpF62yNzg0omsKFkjcTrQ5i++NNtPvJIKQOMkQJ5rHVArzWPIcJrxS1Uk+617GLsQsbIrf9S7uOgchnm2SwbVfAe4tmO+iyrYhPCb0jD4oYoDCZ8i3uyqF3F1wfmUXHYeCiMQ9xY8nIfCx8BczjkSXSY3XiEeEeys-KC88t1g6eaho+6rbGp7xBRXtyuwIWJBaQw0ShoZcuqvI76OXcFR4NnnodwSwM2acC+gcZciP4FfcjrXRqcCkiBo-Wf7qRL9ON3ObOH-kC-RfH4BVz3DrYS9TmLojPCSHDk60S8rucX-AK2LanZbUpx4Q-kqvAZj77rKo3HigolhghwBIxqmQNz-oAXetV8zR7n5ES7Ocj-g+BLVk3D3ngWHFJAYQVsFSO-TuZRoWuMzagM546nk2VPxn9iQXV1yrQ29kCWhVVVYQWvA3d8-nmFo77ankQYzX2s38TwlUgoJbnQR6H0fouY45TTnXHKCEkUg2fGXXuTRI+lcj8Ehe9VAR7mRQnXW9azDXwfthJ39A-aNicpTTPfsI2EGlAK3-zVKffStjA-mU9w--sAvLrWenTOzMFv+x1TynYw8Xs+gGO-swnZ8juS46aY20x3gsLdcWDdYHb6IFKsIkNcR5C1+j3EewNcdvWbp7WmTyKfWJ2nk8ALs1wUUhRIMz+RFmoyQlH3eldjoxu8WZPF0vDQLsLluXnDNNBDOupQqfkm8s6Qm8sBdYUrzS27X60S8VltgKM2-nHnsy2gy-0cOAb0dVF4r4j+Cx33KzN8+A9i02RKvYtvKf5O+lCAQOFBooXSNW3wXuG1vSE450xL8w5+vzdwo5jCphf8JY3wpZtvtxuhlrwYS-eb-EmawaeV6C2TCu3c3hK10Z6YLU2SXDUgaF100Z2LegN5YH1rI+0GHxOTcvVCrvpFTRvu6N49ecHPgt7UYhaDVZSsc40BHQnG157lbuTuvW6X2o8eMYfm+fi2RCkS0-yChFsIcJiFre8TcQ+qbbS-RNZuF-Pj+cfHjqu-j5perdKWMdB3-srryUDZsjswiFcPLiWuxJGrS1x79kaHPgDVp9zRR704MZtMKhe-TkUr349PujHto59Zf6ruO1yZcprknEo57j1YN2OUcdVY-Ig3S+cS15B+EtL1JoQ5Q33RKuXbZXxq8EjOVf3ofX9NPNrtF41SuStFvUltzgpxtVV4tgYKLHG55ONFuuvNVAZx7TeDJ4KilrgRvyAPWLvL1nx2lnREg-HBtUWjcabaByue7T5D52Xa9Ykt9+x13xw7Fq9Rt+Fw-UHXmtNHugusT-ZzxRerb7pqEwkTzAy7XfVz2+RaW6tC8RvQ+v9DudLaZ0XD3VMX-d4G4x0wZOVEgdi35DN0uaeF60oilkjdEkIVOU-R13IK3c1qokTjQXvohsdptm3VOnzdcffKGCPFMEly3yusgX0xjVD8XonpU1-xRGvKJBdME+3cX8KSp5ZsC93jAPRVmiCo2R665LSe8NCdM+pG9UZpGjUds8FHs+zWGETVtq8HT5ZLtjoCbp6eek+bUf+kq107IAb8SZLOR6k2aPY7XSq+jRTRY7MDlDAHvhQAvTPAqZa-i7vsuXLymQlCC8nklqVu7KWHsx-+PbqT+SMArEIuGyjuyU2WoPFXH305aFj6lW9h1uOFNC1fsgXIZNRFbNeDvgsrWvNH1eTYDGz168ObA4kW5f3+Bq3GG4FmPhumm5Ov5gt6yZU1XhPTcxe08WYK79uwCqGlzmyV0q9h8VXb+hu8PjkSRF4qvY1bqZutqhO4uWOfXXLBvrLnmbXMmuJz-jqw9Yvswl8x+pgiYdMP-JVQLxGvzqz5fsechXhXx3kV51xadj3gAR54SEmvMh44-PSQ8ybSQYuXrpPVP-GTn782pMc-dbUav4SIGf18s-Sc+rT8Dnhn+ym86eCfgOQmoQEfSQUXDH7yjqyLijGjjIOSRjMhEOBz7+1IuoX9v7VoTI-BLfx27jH9xa8pfBi1ypgSSuX5y43-aRDDkyTXoflL4Kqs7+OPLdXKhJKpnThgCM2q-sbCSoWasFkN7OWf0tZksSdg4OcGWMjTKCY4ksh4RbDhWzxHIYC7u3TpAbhooRINGhx-h7TgfbCCEhMFk+LmLhFQvkQCUhd+pwshggbq1TNSRH25degyPYaYaE-z-cEBnjRj4cW+wp7THD9tUL21KAomaIG8FsY49qKZwe4wCWRAyVdPIN7Dfokd2pUHcdvu7elQzRqgsxmSvY0PlOMFok-rPvdCPCDnmxJR38+9a-yw17X-i9QSwECFAAUAAAACABFUiJYIdNzbG0CAACPAwAAEQBFAAAAAAAAACAAAAAAAAAA0KG-rbXEt9y2t7nKysIubWQKACAAAAAAAAEAGAC7+QntIT3aAbAFmxslPdoBsnmP4rwm2gF1cB0AAW909RzlsI-lh6-nmoTlpYvmlpfmlYXkuosubWRQSwECFAAUAAAACAAkViJYYGB3G7d7AAB2qwAACAA3AAAAAAAAACAAAAC9AgAA1L+z1y5wbmcKACAAAAAAAAEAGAD6bmdBJj3aAX8Y5G0mPdoBUxKQ4rwm2gF1cA8AAdtYd6rpkqXljJkucG5nUEsFBgAAAAACAAIA8QAAAK1+AAAAAA==</span><br></pre></td></tr></table></figure><p>那么把他base64解码</p><p>解码的结果是一堆乱码，看最后可以看到有png，PK，.md的字样，也就是说这是一个压缩包</p><p>转换为hex，开头是04 14 00 00 00 08 00，再看上面的提示，补充前三个字符（50 4B 03），然后一起复制到新文件中，得到新压缩包，里面是之前加密的压缩包的flag文件夹中的两个文件，同时钥匙.png表示这是deflate+zipcrypyo，既然是zipcrypyo，就可以用明文攻击，使用archpr找到密钥（密钥是由密码生成，同时加密使用密钥）：</p><p>[ 48ff002a 56e00484 380c5c49 ]</p><p>然后用bkcrack解密压缩包</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\bkcrack -C <span class="selector-tag">a</span><span class="selector-class">.zip</span> -k <span class="number">48</span>ff002a <span class="number">56</span>e00484 <span class="number">380</span>c5c49 -U new<span class="selector-class">.zip</span> ok</span><br></pre></td></tr></table></figure><p>将原始密码换成ok</p><p>然后解密即可</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;W<span class="number">1</span>sh_y<span class="number">0</span>u_AaaAaaaaaaaaaaa_w<span class="number">0</span><span class="symbol">nderfu1</span>_CTF_jour<span class="symbol">ne9</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> 压缩包 </tag>
            
            <tag> upx </tag>
            
            <tag> 随机数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF_RE_VM</title>
      <link href="/posts/670cb6e7.html"/>
      <url>/posts/670cb6e7.html</url>
      
        <content type="html"><![CDATA[<h2 id="伪虚拟机保护"><a href="#伪虚拟机保护" class="headerlink" title="伪虚拟机保护"></a>伪虚拟机保护</h2><blockquote><p><strong>虚拟机</strong>（英语：virtual machine），在计算机科学中的体系结构里，是指一种特殊的软件，可以在计算机平台和终端用户之间建立一种环境，而终端用户则是基于虚拟机这个软件所建立的环境来操作其它软件。虚拟机（VM）是计算机系统的仿真器，通过软件模拟具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统，能提供物理计算机的功能。</p></blockquote><p>很明显，ctf中的vm技术和虚拟机并不相同，却有一定关系</p><p>伪虚拟机保护是一种模拟，它将程序可执行代码转换为自定义的中间操作码(operationcode)，如果操作码是一个字节，将它称为(bytecode)。中间操作码通过模拟器执行，实现程序原来的功能，同时阻碍逆向。这也是大多数跨平台语言可以成立的原因，先将代码翻译成中间码，这个代码就可以在任何有对应虚拟机的地方执行。</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>JVM</p><p>两个文件</p><p>JVM.class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p000;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: JVM */</span></span><br><span class="line"><span class="comment">/* loaded from: JVM.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JVM</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* renamed from: program */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">byte</span>[] flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] strArr)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(strArr[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">        flag = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">        fileInputStream.read(flag);</span><br><span class="line">        fileInputStream.close();</span><br><span class="line">        m0vm();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* renamed from: vm */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m0vm</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span>[] iArr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span>[] iArr2 = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">while</span> (i &lt; flag.length) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (flag[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> flag[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b2</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> iArr2[b];</span><br><span class="line">                    iArr2[b] = iArr2[b2];</span><br><span class="line">                    iArr2[b2] = i3;</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">n_next</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[n_next] = iArr2[n_next] + flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b3</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b3] = iArr2[b3] + iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b4</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b4] = iArr2[b4] - flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b5</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b5] = iArr2[b5] - iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b6</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b6] = iArr2[b6] * flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b7</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b7] = iArr2[b7] * iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b8</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b8] = iArr2[b8] / flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b9</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b9] = iArr2[b9] / iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b10</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b10] = iArr2[b10] % flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">25</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b11</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b11] = iArr2[b11] % iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">28</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b12</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b12] = iArr2[b12] &lt;&lt; flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">29</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b13</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b13] = iArr2[b13] &lt;&lt; iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:</span><br><span class="line">                    iArr2[flag[i + <span class="number">1</span>]] = bufferedReader.read();</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i4] = bufferedReader.read();</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">33</span>:</span><br><span class="line">                    System.out.print((<span class="type">char</span>) iArr2[flag[i + <span class="number">1</span>]]);</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">34</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    System.out.print((<span class="type">char</span>) iArr[i2]);</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">41</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b14</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b15</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (iArr2[b14] == <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b15;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">42</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b16</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b17</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (iArr2[b16] != <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b17;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">43</span>:</span><br><span class="line">                    i = flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">52</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i5</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i5] = iArr2[flag[i + <span class="number">1</span>]];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">53</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    iArr2[flag[i + <span class="number">1</span>]] = iArr[i2];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i6</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i6] = flag[i + <span class="number">1</span>];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Byte.MAX_VALUE:</span><br><span class="line">                    bufferedReader.close();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b18</span> <span class="operator">=</span> flag[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b19</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b20</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    flag[i] = (<span class="type">byte</span>) ((flag[i] ^ b19) ^ b20);</span><br><span class="line">                    flag[i + <span class="number">1</span>] = (<span class="type">byte</span>) ((flag[i] ^ b18) ^ b20);</span><br><span class="line">                    flag[i + <span class="number">2</span>] = (<span class="type">byte</span>) ((flag[i + <span class="number">1</span>] ^ b18) ^ b19);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>code.jvm(二进制文件)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">36</span> <span class="number">20</span> <span class="number">36</span> <span class="number">3</span>E <span class="number">22</span> <span class="number">22</span> <span class="number">08</span> <span class="number">00</span> <span class="number">0</span>A <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">08</span></span><br><span class="line"><span class="attribute">00</span> <span class="number">02</span> <span class="number">20</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">01</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">12</span> <span class="number">2</span>B <span class="number">2</span>C <span class="number">36</span> <span class="number">53</span> <span class="number">36</span> <span class="number">45</span> <span class="number">36</span></span><br><span class="line"><span class="attribute">59</span> <span class="number">22</span> <span class="number">22</span> <span class="number">22</span> <span class="number">7</span>F <span class="number">36</span> <span class="number">4</span>F <span class="number">36</span> <span class="number">4</span>E <span class="number">22</span> <span class="number">22</span> <span class="number">7</span>F <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span></span><br><span class="line"><span class="attribute">7D</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">09</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">36</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">0</span>A <span class="number">0</span>C <span class="number">02</span> <span class="number">63</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">15</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">08</span></span><br><span class="line"><span class="attribute">01</span> <span class="number">01</span> <span class="number">00</span> <span class="number">01</span> <span class="number">09</span> <span class="number">01</span> <span class="number">01</span> <span class="number">08</span> <span class="number">02</span> <span class="number">07</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">2A</span> <span class="number">02</span> <span class="number">6</span>A <span class="number">08</span> <span class="number">00</span> <span class="number">02</span> <span class="number">0</span>D <span class="number">00</span> <span class="number">01</span> <span class="number">0</span>D <span class="number">01</span> <span class="number">01</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">73</span> <span class="number">2</span>A</span><br><span class="line"><span class="attribute">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">6</span>B <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">01</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">70</span> <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">07</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">62</span></span><br><span class="line"><span class="attribute">2A</span> <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">04</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">0</span>B <span class="number">0</span>C <span class="number">03</span> <span class="number">6</span>B <span class="number">2</span>A <span class="number">03</span></span><br><span class="line"><span class="attribute">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">04</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span></span><br><span class="line"><span class="attribute">13</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">57</span> <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">1</span>A <span class="number">0</span>C <span class="number">02</span> <span class="number">54</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">04</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">07</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">2</span>C <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span></span><br><span class="line"><span class="attribute">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">0</span>F <span class="number">0</span>C <span class="number">01</span> <span class="number">5</span>E <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F</span><br><span class="line"><span class="attribute">2A</span> <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">29</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">2</span>C <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">02</span> <span class="number">27</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">48</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">2</span>D <span class="number">0</span>C <span class="number">02</span></span><br><span class="line"><span class="attribute">4C</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span></span><br><span class="line"><span class="attribute">07</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">29</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">23</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">41</span> <span class="number">2</span>A</span><br><span class="line"><span class="attribute">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">2</span>C <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">48</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">04</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span></span><br><span class="line"><span class="attribute">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">68</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">1</span>C</span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">5</span>B <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">7</span>B <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">46</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">54</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">43</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">73</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">72</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">75</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">65</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">74</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">6</span>D <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">2</span>B <span class="number">1</span>B</span><br></pre></td></tr></table></figure><p>可以看出vm的基本特征，即：</p><p>一个switch加一堆case<br>这是在判断这一个字节的指令是什么，然后执行相应指令</p><p>所以，给出了程序，我们需要逆向模拟器推出每一个指令是什么意思，然后把指令还原。同时，一般还会模拟寄存器和栈结构来读取数据，所以还要找到这两个结构才好理解。</p><p>所以，化简代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (i &lt; code.length) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (code[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> code[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b2</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> reg[b];</span><br><span class="line">                    reg[b] = reg[b2];</span><br><span class="line">                    reg[b2] = i3;</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b3</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b3] = reg[b3] + code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b4</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b4] = reg[b4] + reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b5</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b5] = reg[b5] - code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b6</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b6] = reg[b6] - reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b7</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b7] = reg[b7] * code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b8</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b8] = reg[b8] * reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b9</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b9] = reg[b9] / code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b10</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b10] = reg[b10] / reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b11</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b11] = reg[b11] % code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">25</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b12</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b12] = reg[b12] % reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">28</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b13</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b13] = reg[b13] &lt;&lt; code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">29</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b14</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b14] = reg[b14] &lt;&lt; reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:</span><br><span class="line">                    reg[code[i + <span class="number">1</span>]] = bufferedReader.read();</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i4] = bufferedReader.read();</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">33</span>:</span><br><span class="line">                    System.out.print((<span class="type">char</span>) reg[code[i + <span class="number">1</span>]]);</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">34</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    System.out.print((<span class="type">char</span>) stack[i2]);</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">41</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b15</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b16</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (reg[b15] == <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b16;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">42</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b17</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b18</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (reg[b17] != <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b18;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">43</span>:</span><br><span class="line">                    i = code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">52</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i5</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i5] = reg[code[i + <span class="number">1</span>]];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">53</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    reg[code[i + <span class="number">1</span>]] = stack[i2];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i6</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i6] = code[i + <span class="number">1</span>];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Byte.MAX_VALUE:</span><br><span class="line">                    bufferedReader.close();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b19</span> <span class="operator">=</span> code[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b20</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b21</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    code[i] = (<span class="type">byte</span>) ((code[i] ^ b20) ^ b21);</span><br><span class="line">                    code[i + <span class="number">1</span>] = (<span class="type">byte</span>) ((code[i] ^ b19) ^ b21);</span><br><span class="line">                    code[i + <span class="number">2</span>] = (<span class="type">byte</span>) ((code[i + <span class="number">1</span>] ^ b19) ^ b20);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>改写代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(code):</span><br><span class="line">b0 = code[i]</span><br><span class="line">b1 = code[i + <span class="number">1</span>] <span class="keyword">if</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">else</span> <span class="number">0xff</span></span><br><span class="line">b2 = code[i + <span class="number">2</span>] <span class="keyword">if</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">else</span> <span class="number">0xff</span></span><br><span class="line"><span class="keyword">if</span> b0 == <span class="number">0</span> <span class="keyword">or</span> b0 == <span class="number">1</span> <span class="keyword">or</span> b0 == <span class="number">2</span> <span class="keyword">or</span> b0 == <span class="number">3</span>:</span><br><span class="line">fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    swap r<span class="subst">&#123;b0&#125;</span> r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">i += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> b0 == <span class="number">8</span>:</span><br><span class="line">fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> += b2\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">9</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> += r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">12</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> -= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">13</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> -= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">16</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> *= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">17</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> *= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">20</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> /= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">21</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> /= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">24</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> mod= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">25</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> mod= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">28</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    shl r<span class="subst">&#123;b1&#125;</span>, <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">29</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    shl r<span class="subst">&#123;b1&#125;</span>, r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">31</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    read r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">32</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    rdpush\n&quot;</span>)<span class="comment">#i2为栈顶指针</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">33</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    print_write r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)<span class="comment">#只打印不改变栈</span></span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">34</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    print_pop\n&quot;</span>)<span class="comment">#打印加出栈</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">41</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b2&#125;</span> if !r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)<span class="comment">#这里jmp通过修改i来跳转</span></span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">42</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b2&#125;</span> if r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">43</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">52</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    push r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">53</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    pop r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">54</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    push <span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">127</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    quit\n&quot;</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">and</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(code):<span class="comment">#这是一个解密函数</span></span><br><span class="line">            code[i] = b0 ^ b1 ^ b2</span><br><span class="line">            code[i + <span class="number">1</span>] = b1</span><br><span class="line">            code[i + <span class="number">2</span>] = b0</span><br></pre></td></tr></table></figure><p>根据code.jvm生成正确的代码，然后人脑模拟运行得到flag</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">0 </span>   push <span class="number">32</span></span><br><span class="line"><span class="symbol">2 </span>   push <span class="number">62</span></span><br><span class="line"><span class="symbol">4 </span>   print_pop</span><br><span class="line"><span class="symbol">5 </span>   print_pop</span><br><span class="line"><span class="symbol">6 </span>   r0 += b2</span><br><span class="line"><span class="symbol">9 </span>   r0 += r0</span><br><span class="line"><span class="symbol">12 </span>   r0 += r0</span><br><span class="line"><span class="symbol">15 </span>   r0 += b2</span><br><span class="line"><span class="symbol">18 </span>   rdpush</span><br><span class="line"><span class="symbol">19 </span>   r0 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">22 </span>   jmp <span class="number">18</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">25 </span>   jmp <span class="number">44</span></span><br><span class="line"><span class="symbol">27 </span>   push <span class="number">83</span></span><br><span class="line"><span class="symbol">29 </span>   push <span class="number">69</span></span><br><span class="line"><span class="symbol">31 </span>   push <span class="number">89</span></span><br><span class="line"><span class="symbol">33 </span>   print_pop</span><br><span class="line"><span class="symbol">34 </span>   print_pop</span><br><span class="line"><span class="symbol">35 </span>   print_pop</span><br><span class="line"><span class="symbol">36 </span>   quit</span><br><span class="line"><span class="symbol">37 </span>   push <span class="number">79</span></span><br><span class="line"><span class="symbol">39 </span>   push <span class="number">78</span></span><br><span class="line"><span class="symbol">41 </span>   print_pop</span><br><span class="line"><span class="symbol">42 </span>   print_pop</span><br><span class="line"><span class="symbol">43 </span>   quit</span><br><span class="line"><span class="symbol">44 </span>   pop r0</span><br><span class="line"><span class="symbol">46 </span>   r0 -= <span class="number">125</span></span><br><span class="line"><span class="symbol">49 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">52 </span>   pop r0</span><br><span class="line"><span class="symbol">54 </span>   r0 -= <span class="number">9</span></span><br><span class="line"><span class="symbol">57 </span>   r0 -= <span class="number">54</span></span><br><span class="line"><span class="symbol">60 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">63 </span>   pop r2</span><br><span class="line"><span class="symbol">65 </span>   r2 -= <span class="number">10</span></span><br><span class="line"><span class="symbol">68 </span>   r2 -= <span class="number">99</span></span><br><span class="line"><span class="symbol">71 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">74 </span>   pop r2</span><br><span class="line"><span class="symbol">76 </span>   r2 -= <span class="number">21</span></span><br><span class="line"><span class="symbol">79 </span>   r2 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">82 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">85 </span>   pop r0</span><br><span class="line"><span class="symbol">87 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">90 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">93 </span>   pop r0</span><br><span class="line"><span class="symbol">95 </span>   r1 += b2</span><br><span class="line"><span class="symbol">98 </span>   <span class="keyword">swap</span> r0 r1</span><br><span class="line"><span class="symbol">100 </span>   r1 += r1</span><br><span class="line"><span class="symbol">103 </span>   r2 += b2</span><br><span class="line"><span class="symbol">106 </span>   r0 += r0</span><br><span class="line"><span class="symbol">109 </span>   r2 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">112 </span>   jmp <span class="number">106</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">115 </span>   r0 += b2</span><br><span class="line"><span class="symbol">118 </span>   r0 -= r1</span><br><span class="line"><span class="symbol">121 </span>   r1 -= r1</span><br><span class="line"><span class="symbol">124 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">127 </span>   pop r0</span><br><span class="line"><span class="symbol">129 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">132 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">135 </span>   pop r1</span><br><span class="line"><span class="symbol">137 </span>   r1 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">140 </span>   r1 -= <span class="number">115</span></span><br><span class="line"><span class="symbol">143 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">146 </span>   pop r2</span><br><span class="line"><span class="symbol">148 </span>   r2 -= <span class="number">3</span></span><br><span class="line"><span class="symbol">151 </span>   r2 -= <span class="number">107</span></span><br><span class="line"><span class="symbol">154 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">157 </span>   pop r1</span><br><span class="line"><span class="symbol">159 </span>   r1 -= <span class="number">3</span></span><br><span class="line"><span class="symbol">162 </span>   r1 -= <span class="number">112</span></span><br><span class="line"><span class="symbol">165 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">168 </span>   pop r0</span><br><span class="line"><span class="symbol">170 </span>   r0 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">173 </span>   r0 -= <span class="number">98</span></span><br><span class="line"><span class="symbol">176 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">179 </span>   pop r0</span><br><span class="line"><span class="symbol">181 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">184 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">187 </span>   pop r0</span><br><span class="line"><span class="symbol">189 </span>   r0 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">192 </span>   r0 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">195 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">198 </span>   pop r3</span><br><span class="line"><span class="symbol">200 </span>   r3 -= <span class="number">11</span></span><br><span class="line"><span class="symbol">203 </span>   r3 -= <span class="number">107</span></span><br><span class="line"><span class="symbol">206 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">209 </span>   pop r3</span><br><span class="line"><span class="symbol">211 </span>   r3 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">214 </span>   r3 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">217 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">220 </span>   pop r1</span><br><span class="line"><span class="symbol">222 </span>   r1 -= <span class="number">19</span></span><br><span class="line"><span class="symbol">225 </span>   r1 -= <span class="number">87</span></span><br><span class="line"><span class="symbol">228 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">231 </span>   pop r0</span><br><span class="line"><span class="symbol">233 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">236 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">239 </span>   pop r2</span><br><span class="line"><span class="symbol">241 </span>   r2 -= <span class="number">26</span></span><br><span class="line"><span class="symbol">244 </span>   r2 -= <span class="number">84</span></span><br><span class="line"><span class="symbol">247 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">250 </span>   pop r2</span><br><span class="line"><span class="symbol">252 </span>   r2 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">255 </span>   r2 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">258 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">261 </span>   pop r1</span><br><span class="line"><span class="symbol">263 </span>   r1 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">266 </span>   r1 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">269 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">272 </span>   pop r1</span><br><span class="line"><span class="symbol">274 </span>   r1 -= <span class="number">15</span></span><br><span class="line"><span class="symbol">277 </span>   r1 -= <span class="number">94</span></span><br><span class="line"><span class="symbol">280 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">283 </span>   pop r0</span><br><span class="line"><span class="symbol">285 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">288 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">291 </span>   pop r1</span><br><span class="line"><span class="symbol">293 </span>   r1 -= <span class="number">41</span></span><br><span class="line"><span class="symbol">296 </span>   r1 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">299 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">302 </span>   pop r2</span><br><span class="line"><span class="symbol">304 </span>   r2 -= <span class="number">39</span></span><br><span class="line"><span class="symbol">307 </span>   r2 -= <span class="number">72</span></span><br><span class="line"><span class="symbol">310 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">313 </span>   pop r2</span><br><span class="line"><span class="symbol">315 </span>   r2 -= <span class="number">45</span></span><br><span class="line"><span class="symbol">318 </span>   r2 -= <span class="number">76</span></span><br><span class="line"><span class="symbol">321 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">324 </span>   pop r0</span><br><span class="line"><span class="symbol">326 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">329 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">332 </span>   pop r0</span><br><span class="line"><span class="symbol">334 </span>   r0 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">337 </span>   r0 -= <span class="number">41</span></span><br><span class="line"><span class="symbol">340 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">343 </span>   pop r1</span><br><span class="line"><span class="symbol">345 </span>   r1 -= <span class="number">35</span></span><br><span class="line"><span class="symbol">348 </span>   r1 -= <span class="number">65</span></span><br><span class="line"><span class="symbol">351 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">354 </span>   pop r0</span><br><span class="line"><span class="symbol">356 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">359 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">362 </span>   pop r2</span><br><span class="line"><span class="symbol">364 </span>   r2 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">367 </span>   r2 -= <span class="number">72</span></span><br><span class="line"><span class="symbol">370 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">373 </span>   pop r3</span><br><span class="line"><span class="symbol">375 </span>   r3 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">378 </span>   r3 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">381 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">384 </span>   pop r3</span><br><span class="line"><span class="symbol">386 </span>   r3 -= <span class="number">0</span></span><br><span class="line"><span class="symbol">389 </span>   r3 -= <span class="number">104</span></span><br><span class="line"><span class="symbol">392 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">395 </span>   pop r0</span><br><span class="line"><span class="symbol">397 </span>   r0 -= <span class="number">28</span></span><br><span class="line"><span class="symbol">400 </span>   r0 -= <span class="number">91</span></span><br><span class="line"><span class="symbol">403 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">406 </span>   pop r0</span><br><span class="line"><span class="symbol">408 </span>   r0 -= <span class="number">123</span></span><br><span class="line"><span class="symbol">411 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">414 </span>   pop r0</span><br><span class="line"><span class="symbol">416 </span>   r0 -= <span class="number">70</span></span><br><span class="line"><span class="symbol">419 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">422 </span>   pop r0</span><br><span class="line"><span class="symbol">424 </span>   r0 -= <span class="number">84</span></span><br><span class="line"><span class="symbol">427 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">430 </span>   pop r0</span><br><span class="line"><span class="symbol">432 </span>   r0 -= <span class="number">67</span></span><br><span class="line"><span class="symbol">435 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">438 </span>   pop r0</span><br><span class="line"><span class="symbol">440 </span>   r0 -= <span class="number">115</span></span><br><span class="line"><span class="symbol">443 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">446 </span>   pop r0</span><br><span class="line"><span class="symbol">448 </span>   r0 -= <span class="number">114</span></span><br><span class="line"><span class="symbol">451 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">454 </span>   pop r0</span><br><span class="line"><span class="symbol">456 </span>   r0 -= <span class="number">117</span></span><br><span class="line"><span class="symbol">459 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">462 </span>   pop r0</span><br><span class="line"><span class="symbol">464 </span>   r0 -= <span class="number">101</span></span><br><span class="line"><span class="symbol">467 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">470 </span>   pop r0</span><br><span class="line"><span class="symbol">472 </span>   r0 -= <span class="number">116</span></span><br><span class="line"><span class="symbol">475 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">478 </span>   pop r0</span><br><span class="line"><span class="symbol">480 </span>   r0 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">483 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">486 </span>   pop r0</span><br><span class="line"><span class="symbol">488 </span>   r0 -= <span class="number">109</span></span><br><span class="line"><span class="symbol">491 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">494 </span>   pop r0</span><br><span class="line"><span class="symbol">496 </span>   r0 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">499 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">502 </span>   jmp <span class="number">27</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">q</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a),end =<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#对应每一个循环条件</span></span><br><span class="line"></span><br><span class="line">q(<span class="number">97</span>)</span><br><span class="line">q(<span class="number">109</span>)</span><br><span class="line">q(<span class="number">97</span>)</span><br><span class="line">q(<span class="number">116</span>)</span><br><span class="line">q(<span class="number">101</span>)</span><br><span class="line">q(<span class="number">117</span>)</span><br><span class="line">q(<span class="number">114</span>)</span><br><span class="line">q(<span class="number">115</span>)</span><br><span class="line">q(<span class="number">67</span>)</span><br><span class="line">q(<span class="number">84</span>)</span><br><span class="line">q(<span class="number">70</span>)</span><br><span class="line">q(<span class="number">123</span>)</span><br><span class="line">q(<span class="number">28</span>+<span class="number">91</span>)</span><br><span class="line">q(<span class="number">104</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">44</span>+<span class="number">72</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">35</span>+<span class="number">65</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">41</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">45</span>+<span class="number">76</span>)</span><br><span class="line">q(<span class="number">39</span>+<span class="number">72</span>)</span><br><span class="line">q(<span class="number">41</span>+<span class="number">44</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">15</span>+<span class="number">94</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">44</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">26</span>+<span class="number">84</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">19</span>+<span class="number">87</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">11</span>+<span class="number">107</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">98</span>)</span><br><span class="line">q(<span class="number">115</span>)</span><br><span class="line">q(<span class="number">110</span>)</span><br><span class="line">q(<span class="number">116</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">65</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">97</span>+<span class="number">21</span>)</span><br><span class="line">q(<span class="number">10</span>+<span class="number">99</span>)</span><br><span class="line">q(<span class="number">9</span>+<span class="number">54</span>)</span><br><span class="line">q(<span class="number">125</span>)</span><br><span class="line"><span class="comment">#amateursCTF&#123;wh4t_d0_yoU_m34n_j4v4_isnt_A_vm?&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>z3基本语法</title>
      <link href="/posts/b4d67d75.html"/>
      <url>/posts/b4d67d75.html</url>
      
        <content type="html"><![CDATA[<p>z3是一个约束求解器，可以理解为解方程的工具，每一个约束都要写在x.add的语句中。</p><h2 id="声明变量"><a href="#声明变量" class="headerlink" title="声明变量"></a>声明变量</h2><p>z3一共有三种变量</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a,b = Int(<span class="string">&#x27;a b&#x27;</span>)<span class="comment">#声明多个整数型变量</span></span><br><span class="line">a = Real(<span class="string">&#x27;a&#x27;</span>)<span class="comment">#声明单个实型变量</span></span><br><span class="line">a,b = Bitvec(<span class="string">&#x27;a b&#x27;</span>,<span class="number">8</span>)<span class="comment">#声明多个8位的向量型变量</span></span><br></pre></td></tr></table></figure><h2 id="使用例"><a href="#使用例" class="headerlink" title="使用例"></a>使用例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a,b = Int(<span class="string">&#x27;a b&#x27;</span>)</span><br><span class="line">solve(a+b == <span class="number">10</span>,a + <span class="number">3</span> * b ==<span class="number">12</span>)<span class="comment">#条件少时可以直接用solve不用add</span></span><br><span class="line"><span class="comment">#result : [b = 1,a = 9]</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x=Int(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y=Int(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (simplify(x + y + <span class="number">2</span>*x + <span class="number">3</span>))<span class="comment">#simplify用于打印化简后的表达式</span></span><br><span class="line"><span class="built_in">print</span> (simplify(x &lt; y + x + <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span> (simplify(And(x + <span class="number">1</span> &gt;= <span class="number">3</span>, x**<span class="number">2</span> + x**<span class="number">2</span> + y**<span class="number">2</span> + <span class="number">2</span> &gt;= <span class="number">5</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 + 3*x + y</span></span><br><span class="line"><span class="comment">#Not(y &lt;= -2)</span></span><br><span class="line"><span class="comment">#And(x &gt;= 2, 2*x**2 + y**2 &gt;= 3)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a,b = Ints(<span class="string">&#x27;a b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()  <span class="comment">#创建一个解的对象s</span></span><br><span class="line">s.add(a + b == <span class="number">10</span>)<span class="comment">#添加约束条件</span></span><br><span class="line">s.add(a + <span class="number">3</span> * b == <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat: <span class="comment">#check() 检查解是否存在，存在会return &#x27;sat&#x27;</span></span><br><span class="line">result = s.model() <span class="comment">#输出</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result[a])</span><br><span class="line"><span class="built_in">print</span>(result[b])</span><br></pre></td></tr></table></figure><h2 id="z3语法"><a href="#z3语法" class="headerlink" title="z3语法"></a>z3语法</h2><p>对于普通的自定义逻辑（带位移，异或之类的不好逆向），z3可以秒杀</p><p>比如这么写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">cmp = [<span class="number">0x66</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0xFD</span>, <span class="number">0x3C</span>, <span class="number">0x55</span>, <span class="number">0x90</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0xF6</span>, <span class="number">0x5D</span>, <span class="number">0xB1</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x81</span>, <span class="number">0xFD</span>, <span class="number">0x36</span>, <span class="number">0xA9</span>, <span class="number">0x1F</span>, <span class="number">0xA1</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x80</span>, <span class="number">0x8F</span>, <span class="number">0xCE</span>, <span class="number">0x77</span>, <span class="number">0xE8</span>, <span class="number">0x23</span>, <span class="number">0x9E</span>, <span class="number">0x27</span>, <span class="number">0x60</span>, <span class="number">0x2F</span>, <span class="number">0xA5</span>, <span class="number">0xCF</span>, <span class="number">0x1B</span>, <span class="number">0xBD</span>, <span class="number">0x32</span>, <span class="number">0xDB</span>, <span class="number">0xFF</span>, <span class="number">0x28</span>, <span class="number">0xA4</span>, <span class="number">0x5D</span>]</span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line">flag,out = pini(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = n = a = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> pl(<span class="number">7</span>,<span class="number">6</span>):</span><br><span class="line">    a = <span class="number">6</span> * i + j</span><br><span class="line">    m = flag[a]</span><br><span class="line">    n = flag[a]</span><br><span class="line">    m = ~m</span><br><span class="line">    m &amp;= i * (j + <span class="number">2</span>)</span><br><span class="line">    n = n &amp; ~(i * (j + <span class="number">2</span>)) | m</span><br><span class="line">    a = <span class="number">7</span> * j + i</span><br><span class="line">    out[a] = n</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">42</span>):</span><br><span class="line">    <span class="keyword">if</span> ( i % <span class="number">2</span> == <span class="number">1</span> ):</span><br><span class="line">        out[i] *= <span class="number">107</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        out[i] += out[i - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    f.add(cmp[i]==out[i])</span><br><span class="line">isflag(f,flag)</span><br><span class="line">pcheck(f,flag)</span><br></pre></td></tr></table></figure><p>但是可能遇到要对z3型数据判断的情况，比如下面这个题：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-C0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> out2[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-80h] BYREF</span></span><br><span class="line">  __int64 check[<span class="number">4</span>]; <span class="comment">// [rsp+80h] [rbp-40h]</span></span><br><span class="line">  __int16 v8; <span class="comment">// [rsp+A0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> len; <span class="comment">// [rsp+B0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+B4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+BCh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  check[<span class="number">0</span>] = <span class="number">0x10C0105000D07</span>LL;</span><br><span class="line">  check[<span class="number">1</span>] = <span class="number">0xF0509000F050D00</span>LL;</span><br><span class="line">  check[<span class="number">2</span>] = <span class="number">0x701030305020003</span>LL;</span><br><span class="line">  check[<span class="number">3</span>] = <span class="number">0xC02070201020B07</span>LL;</span><br><span class="line">  v8 = <span class="number">514</span>;</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  len = <span class="number">17</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Hi, PLZ input input&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">  <span class="built_in">memset</span>(out2, <span class="number">0</span>, <span class="keyword">sizeof</span>(out2));</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(flag);</span><br><span class="line">  <span class="keyword">if</span> ( v3 == len )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">16</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)flag[i] &gt; <span class="string">&#x27;`&#x27;</span> &amp;&amp; (<span class="type">unsigned</span> __int8)flag[i] &lt;= <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">        flag[i] = (flag[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)flag[i] &gt; <span class="string">&#x27;@&#x27;</span> &amp;&amp; (<span class="type">unsigned</span> __int8)flag[i] &lt;= <span class="string">&#x27;Z&#x27;</span> )</span><br><span class="line">        flag[i] = (flag[i] ^ <span class="number">0x4B</span>) - <span class="number">1</span>;</span><br><span class="line">      out2[<span class="number">2</span> * i] = (<span class="type">unsigned</span> __int8)flag[i] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      out2[<span class="number">2</span> * i + <span class="number">1</span>] = flag[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)check + <span class="number">2</span> * i) != out2[<span class="number">2</span> * (len - i) - <span class="number">2</span>]</span><br><span class="line">        &amp;&amp; *((_BYTE *)check + <span class="number">2</span> * i + <span class="number">1</span>) != out2[<span class="number">2</span> * (len - i) - <span class="number">2</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;wrong wrong wrong&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;woc,you got it,flag is your input&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a Ha ? wrong1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主函数是这样的，这里它不止对flag进行分类讨论，还在讨论后进行计算：z3型可以直接进行计算，包括加和乘，对于位向量还可以左右移以及异或，但是都不能进行判断大小，如果要进行判断必须要在add中做判断，比如判断两个值是否相等：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.add(check[<span class="number">2</span> * i]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)])</span><br></pre></td></tr></table></figure><p>那么如果我们根据这道题写，还需要If函数（Z3自带）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If(condition,a,b)</span><br></pre></td></tr></table></figure><p>意思是：如果条件成立，语句视为a，否则视为b</p><p>那么和add结合起来看就是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f.add(If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), out2[i] == (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, <span class="literal">True</span>))</span><br><span class="line">f.add(If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), out2[i] == (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>, <span class="literal">True</span>))</span><br></pre></td></tr></table></figure><p>如果条件成立，添加a约束，否则添加b约束，这里的b约束恒为真，表示如果条件不成立就跳过这个约束。可是问题来了，我们知道out[i]是由flag初始化的，也就是说out是z3位向量型，但是out2呢？如果把这里的out2视作一个普通列表，让out[i]计算后的值返回给out2，好像也没问题。但是！！这里的语句并不是赋值语句，而是判断语句，是一个<code>约束</code>，如果这里out2&#x3D;34*[0],那么就是让out[i]运算后的值恒等于0的条件成立，显然这是无解的，也就是说，这里的两个变量都必须是位向量才可以，同时，不应该忘了如果两个条件均不成立，就要让out&#x3D;out2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.add(out2[i] == If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>,If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, out[i])))</span><br></pre></td></tr></table></figure><p>进行if的嵌套完成这个效果</p><p>之后还要对flag继续做变换变成最后的数组，且数组大小翻倍，如果后面的检查比较简单，可以直接在check&#x3D;&#x3D;的时候写，但是由于这里的比较不是很直观，不如写出来变成单独的列表再比较，这时又要涉及到out2变成out3的问题了，由于这个是直接赋值，没有判断，所以方便起见，直接写赋值语句。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out3[<span class="number">2</span>*i] = LShR(out2[i], <span class="number">4</span>)</span><br><span class="line">out3[<span class="number">2</span>*i+<span class="number">1</span>] = out2[i] &amp; <span class="number">0xf</span></span><br></pre></td></tr></table></figure><p>通过这两个例子可以发现，当想要赋值时，如果要对z3型变量进行判断&#x2F;比较，就必须用add表达式，在其中，为了达成赋值效果，必须新建一个z3量才可以成功，但是如果是直接赋值，则直接对列表赋值即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">check = [<span class="number">0x07</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x0F</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x02</span>]</span><br><span class="line">flag,out = pini(<span class="number">17</span>)</span><br><span class="line">out2 = [BitVec(<span class="string">&#x27;out2[%2d]&#x27;</span> % i , <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">34</span>)]</span><br><span class="line">out3 = [<span class="number">0</span>]*<span class="number">34</span></span><br><span class="line"><span class="built_in">len</span> = <span class="number">17</span></span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line"></span><br><span class="line">    f.add(out2[i] == If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>,</span><br><span class="line">                     If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, out[i])))</span><br><span class="line"></span><br><span class="line">    out3[<span class="number">2</span>*i] = LShR(out2[i], <span class="number">4</span>)</span><br><span class="line">    out3[<span class="number">2</span>*i+<span class="number">1</span>] = out2[i] &amp; <span class="number">0xf</span></span><br><span class="line">isflag(f,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    f.add(check[<span class="number">2</span> * i]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)])</span><br><span class="line">    f.add(check[<span class="number">2</span> * i + <span class="number">1</span>]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)+<span class="number">1</span>])</span><br><span class="line">pcheck(f,flag)</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span></span><br></pre></td></tr></table></figure><p>以上均是解</p><p>补充说明：</p><p>如果想约束某个值只能出现一次，比如{,}，可以用Sum：</p><p>Sum用于计算一系列表达式的和类似于加</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.add(Sum([If(i == BitVecVal(<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>), <span class="number">8</span>), <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag]) &lt;= <span class="number">1</span>)</span><br><span class="line">s.add(Sum([If(i == BitVecVal(<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>), <span class="number">8</span>), <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag]) &lt;= <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>计算flag中等于括号的值的表达式个数，然后让其小于等于1</p>]]></content>
      
      
      <categories>
          
          <category> 知识集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 符号执行 </tag>
            
            <tag> z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内联钩子原理</title>
      <link href="/posts/23a55d41.html"/>
      <url>/posts/23a55d41.html</url>
      
        <content type="html"><![CDATA[<h1 id="Inline-hook"><a href="#Inline-hook" class="headerlink" title="Inline hook"></a>Inline hook</h1><p>Inline hook(内联钩子)是一种再程序运行时<code>修改函数执行流程</code>的技术。通过修改函数原始代码 讲目标函数的执行路径重定向到自定义的代码段，从而实现对目标函数的拦截和修改。</p><p><img src="https://s2.loli.net/2024/01/11/AidLhJUkqP7NXRY.png" alt="image-20240111101326816"></p><p><img src="https://s2.loli.net/2024/01/11/LOXJnCdHrv5UzbA.png" alt="image-20240111103102751"></p><p>对一个函数hook的方法：</p><ol><li>从哪来到哪去</li><li>如何实现跳转<br>E9 + 四字节相对地址（E9是jmp的值）（相当于一共5字节）<br>修改时，如果指令长度大于5，则多余的值会和下一条代码结合为新代码，所以防止崩溃可以写成nop（90）<br>这个相对地址不算这条指令本身</li><li>如何修改代码<br>当已经有一个我们想要hook的函数时，需要先获得它的传入参数，并令hook函数的参数与想要hook的函数的参数类型，个数相同，以保证堆栈平衡<br>为了在运行时修改代码需要virtualprotect函数（windows下）来修改某处的访问权限</li></ol><p>注：实验环境为x86，因为在x64下相对地址的值大于4字节导致不能正常跳转</p><p>那么尝试修改并hook一个函数：</p><h2 id="0x1"><a href="#0x1" class="headerlink" title="0x1"></a>0x1</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">hooker(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>main函数先调用hooker函数，修改messagebox的内容，然后执行被修改的messagebox函数</p><p>那么hooker函数就要传入messagebox函数的地址，和我们想要修改成的函数的地址，这里的长度可以是固定的，可以不写5</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">hooker</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line"><span class="built_in">memcpy</span>(back, src, len);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在函数外面创建一个备份BYTE back[5];用来保存原始数据，然后用VirtualProtect修改函数前5个字节变成可写属性(0x40),然后备份原始属性到old并修改，核心公式是：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>然后改回去</p><p>最后就是实现自己的函数，一定要注意函数的传入参数必须要和原函数相同</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> WINAPI <span class="title function_">mybox</span><span class="params">(_In_opt_ HWND hWnd, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpText, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpCaption, </span></span><br><span class="line"><span class="params"> _In_ UINT uType)</span></span><br><span class="line">&#123;</span><br><span class="line">lpText = <span class="string">L&quot;hooked&quot;</span>;<span class="comment">//想要修改的效果</span></span><br><span class="line">unhook(MessageBoxW, back, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(hWnd, lpText, lpCaption, uType);</span><br><span class="line">hooker(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里通过去官网直接抄传入参数就可以直接得到参数名<br>同时注意要先解除钩子再调用原函数不然会陷入循环递归</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">unhook</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* back, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line"><span class="built_in">memcpy</span>(src, back, <span class="number">5</span>);</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在调用完目标函数后，还要再次钩住函数，等待下一次调用</p><hr><h2 id="0x2"><a href="#0x2" class="headerlink" title="0x2"></a>0x2</h2><p>由于刚刚的hook函数，每次必须要先hook，然后再unhook，十分麻烦。同时，每次调用messagebox的效果都是一样的，如果想要实现显示其它东西，需要另一种方法。</p><p>对于第一个问题：如果不对hook过的函数unhook，那么就会陷入死循环，无限调用自己，如果现在有一个和messagebox的函数效果相同的函数，在hook后，不调用messagebox，而是调用这个函数，就不会内存溢出</p><p>对于第二个问题：如果有一个和messagebox函数相同的函数，那么直接调用那个函数并修改参数就可以显示其它东西。</p><p>因此，只要能构造出一个和我们想hook的函数功能相同的函数就可以解决上面两个问题。</p><img src="https://s2.loli.net/2024/01/22/qxNQeGt8BPVSALM.png" alt="hook前" style="zoom:50%;" /><img src="https://s2.loli.net/2024/01/22/3d5KXVOaSiGCMLx.png" alt="hook后" /><p>那么先构造trampoline函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>* <span class="title function_">trampoline</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">BYTE* boxin = (BYTE*)VirtualAlloc(<span class="number">0</span>, len + <span class="number">5</span>, <span class="number">0x00001000</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="built_in">memcpy</span>(boxin, src, len);</span><br><span class="line">*(boxin + len) = <span class="number">0xe9</span>;</span><br><span class="line">*(DWORD*)(boxin + len + <span class="number">1</span>) = (BYTE*)src - boxin - <span class="number">5</span>;</span><br><span class="line"><span class="comment">//以下为原hooker的内容</span></span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line"><span class="keyword">return</span> boxin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>前4句都是在创建功能相同函数，直接申请内存把messagebox前5个字节复制过来，然后jmp到messagebox里（偷懒）</p><p>第5句到10句的hooker和之前的hooker一样</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">hooker</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后一句return是为了之后使用不被hook的函数</p><p>然后先把相同功能函数的调用写出来</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">using PFUN = <span class="type">int</span> (WINAPI*)(</span><br><span class="line">_In_opt_ HWND hWnd,</span><br><span class="line">_In_opt_ LPCWSTR lpText,</span><br><span class="line">_In_opt_ LPCWSTR lpCaption,</span><br><span class="line">_In_ UINT uType);</span><br><span class="line">PFUN pfun = nullptr;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">pfun = (PFUN)trampoline(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">pfun(<span class="number">0</span>, <span class="string">L&quot;123123&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后添上hook函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> WINAPI <span class="title function_">mybox</span><span class="params">(_In_opt_ HWND hWnd, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpText, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpCaption, </span></span><br><span class="line"><span class="params"> _In_ UINT uType)</span></span><br><span class="line">&#123;</span><br><span class="line">lpText = <span class="string">L&quot;hooked&quot;</span>;</span><br><span class="line">pfun(hWnd, lpText, lpCaption, uType);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样调用时，会先显示3个hook，在最后显示123123.</p><hr><p>完</p>]]></content>
      
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 实践 </tag>
            
            <tag> hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码学数学基础2</title>
      <link href="/posts/84e84aaa.html"/>
      <url>/posts/84e84aaa.html</url>
      
        <content type="html"><![CDATA[<h2 id="等价关系"><a href="#等价关系" class="headerlink" title="等价关系"></a>等价关系</h2><p>一：<br>二元关系”&#x3D;”：</p><ul><li>自反性：对于所有$a\in R$,都有$a&#x3D;a$</li><li>对称性：对于所有$a,b\in R$,都有$a&#x3D;b\rightarrow b&#x3D;a$</li><li>传递性：对于所有$a,b,c\in R$,都有$a&#x3D;b,b&#x3D;c\rightarrow a&#x3D;c$</li></ul><p>二：</p><p>二元关系”$\cong$”:</p><p>同样有自反性，对称性，传递性</p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设集合S，以及一个定义在S上的二元关系R，若R满足以下性质，则称它为”等价关系”,以元组的形式表示</p><ul><li>自反性：对于所有$a\in S$,都有($a,a)\in R$</li><li>对称性：对于所有$a,b\in S$,都有$(a,a)\in R$</li><li>传递性：对于所有$a,b,c\in S$,都有$(a,b)\in R,(b,c)\in R\rightarrow (a,c)\in R$</li></ul><hr><h2 id="同余"><a href="#同余" class="headerlink" title="同余"></a>同余</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>$a \equiv b(\mod n)$：设n为正整数，整数a，b分别模n，如果得到相同的余数(或n|(a-b))，就称a和b在模n的情况下满足同余关系，n被称为模数。同余是一种关系,而不是一种运算</p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>$a \equiv b(\mod n)\iff a&#x3D;qn+b,\exists q\in Z\rightarrow n|a-b$</p><p>同余是一种<code>等价关系</code>,以下性质可以逆推</p><ul><li>对于同一个除数，两个数的乘积与它们余数的乘积同余。</li><li>对于同一个除数，如果有两个整数同余，那么它们的差就一定能被这个除数整除。</li><li>对于同一个除数，如果两个数同余，那么他们的乘方仍然同余。</li><li>对于同一个除数，若三个数a≡b（mod m），b≡c（mod m），那么a,b,c三个数对于除数m都同余（传递性）。</li><li>对于同一个除数，若四个数a≡b（mod m），c≡d（mod m），那么a±c≡c±d（mod m），（可加减性）。</li><li>对于同一个除数，若四个数a≡b（mod m），c≡d（mod m），那么ac≡cd（mod m），（可乘性）</li></ul><p>同余的运算性质</p><p>若$a \equiv b(\mod n)$，则：</p><ul><li>$a\pm m \equiv b\pm m(\mod n),m\in Z$</li><li>$a* m \equiv b* m(\mod n),m\in Z$</li><li>$a^m \equiv b^m(\mod n),m\in N$</li></ul><p>若同时$c \equiv d(\mod n)$,则：</p><ul><li>$a\pm c \equiv b\pm d(\mod n)$</li><li>$a* c \equiv b* d(\mod n)$</li></ul><hr><h2 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h2><p>倒数：两个数的乘积为1，这两个数互为倒数</p><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><p>设$a\in Z,n\in N,如果az\equiv 1(\mod n)$,则称z是模n下a的乘法逆元，记作$a^{-1}&#x3D;z$</p><p>在模运算下，所有的形如$a^{-1}$的值都可以直接被代换成a在某模数下的乘法逆元，然后继续运算</p><p>只有当一个整数和模数互素的时候，它才会有乘法逆元，即：<br>$$<br>gcd(a,n)&#x3D;1\iff 模n下有乘法逆元<br>$$<br>求乘法逆元：</p><p>扩展欧几里得算法</p><p>根据最大公约数表示定理：<br>$$<br>gcd(a,n)&#x3D;1 \rightarrow as+tn &#x3D; 1<br>$$<br>等式两边同时mod n:<br>$$<br>as \equiv 1 (\mod n)<br>$$<br>∴模n下a的逆元是s</p><p>∴调用gcd函数传入a和n算出的s即为乘法逆元</p><hr><h2 id="一次同余方程"><a href="#一次同余方程" class="headerlink" title="一次同余方程"></a>一次同余方程</h2><p>$$<br>a \equiv b(\mod n)<br>$$</p><p>等价于下面这个形式，其中m是a，b，n的公因数<br>$$<br>a&#x2F;m \equiv b&#x2F;m(\mod n&#x2F;m)<br>$$<br>如果gcd(m,n)&#x3D;1,那么<br>$$<br>a&#x2F;m \equiv b&#x2F;m(\mod n)<br>$$<br>才是成立的</p><h3 id="同余下的消去律"><a href="#同余下的消去律" class="headerlink" title="同余下的消去律"></a>同余下的消去律</h3><p>设$a,n\in Z,n&gt;0$,如果$gcd(a,n)&#x3D;d$,有<br>$$<br>az \equiv az’(\mod n)\rightarrow z \equiv z’(\mod n&#x2F;d)<br>$$</p><h3 id="同余方程的解"><a href="#同余方程的解" class="headerlink" title="同余方程的解"></a>同余方程的解</h3><p>$x \equiv b(\mod n)$的解集：{$b\pm nk$,其中$k&#x3D;0,1,2,…$}</p><p>同时有规律:<br>原模数为n，终模数为m，设n&#x2F;m &#x3D; d,有0~n-1之间解的数量等于d</p><h3 id="一次同余方程有解的条件"><a href="#一次同余方程有解的条件" class="headerlink" title="一次同余方程有解的条件"></a>一次同余方程有解的条件</h3><p>若gcd(a,n)&#x3D;d,则<br>$$<br>ax \equiv b(\mod n)有解 \iff d|b<br>$$</p><hr><h2 id="剩余类"><a href="#剩余类" class="headerlink" title="剩余类"></a>剩余类</h2><h3 id="等价类"><a href="#等价类" class="headerlink" title="等价类"></a>等价类</h3><p>等价类是等价关系的一种性质，若~是S上的等价关系，对于$a\in S$,定义其等价类为{$x\in S|x\sim a$}</p><p>由于同余关系是等价关系，所以同余中也有等价类，被叫做剩余类</p><h3 id="剩余类-1"><a href="#剩余类-1" class="headerlink" title="剩余类"></a>剩余类</h3><p>设$a\in Z$,定义其剩余类为{$x\in Z|x\equiv a(\mod n)$}<br>记作$[a]_n$简记为$[a]$,最简可化为a(如果没有歧义)</p><p> 剩余类中每一个整数都叫做这个剩余类的代表元.<br>$Z_n$表示模n下所有剩余类的集合</p><p>定义剩余类之间的计算：</p><p>$[a]+[b]&#x3D;[a+b]$</p><p>$[a]<em>[b]&#x3D;[a</em>b]$</p><p>即：最后得到的是以a+b&#x2F;ab为代表元的剩余类</p><p>设$u,v\in Z_n$（$Z_n$是包含所有剩余类的集合）,若uv&#x3D;[1],则u，v互为乘法逆元</p><p>再定义$Z_n^*$为$Z_n$中有乘法逆元的剩余类</p><h3 id="Z-n-与-Z-n-的关系"><a href="#Z-n-与-Z-n-的关系" class="headerlink" title="$Z_n^*$与$Z_n$的关系"></a>$Z_n^*$与$Z_n$的关系</h3><ul><li>n为素数：$Z_n^*$&#x3D;$Z_n$ \ {[0]}</li><li>n为合数：$Z_n^*$$\subsetneq$$Z_n$ \ {[0]}</li></ul><hr><h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><h3 id="一次同余方程组"><a href="#一次同余方程组" class="headerlink" title="一次同余方程组"></a>一次同余方程组</h3><p>设两两互素的模数$n_1,…,n_m\in N$,及任意整数$a_1,…,a_m\in Z$,并设$n&#x3D;\prod_{i&#x3D;1}^mn_i$<br>$$<br>\begin{cases}<br>x\equiv a_1(\mod n_1)\<br>…\<br>x\equiv a_m(\mod n_m)<br>\end{cases}<br>$$<br>为了求解这个方程，我们需要中国剩余定理CRT</p><h3 id="中国剩余定理-1"><a href="#中国剩余定理-1" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h3><p>设两两互素的模数$n_1,…,n_m\in N$,及任意整数$a_1,…,a_m\in Z$,并设$n&#x3D;\prod_{i&#x3D;1}^mn_i$，方程组<br>$$<br>\begin{cases}<br>x\equiv a_1(\mod n_1)\<br>…\<br>x\equiv a_m(\mod n_m)<br>\end{cases}<br>$$<br>必有解，设解为$a\in Z$.并且对任意$a’\in Z$,都有<br>$$<br>a’是方程组的解 \iff a \equiv a’(\mod n)<br>$$<br>求解方法：</p><ul><li>得到每个方程组的模数$n_1,n_2,…$</li><li>求$n  &#x3D;\prod_{i&#x3D;1}^mn_i$</li><li>求$n_i^*&#x3D;n&#x2F;n_i$</li><li>求$n_i^{<em>-1}$(在对应模数下$n_i^</em>$的乘法逆元)</li><li>求$e_i &#x3D; n_i^{<em>-1} * n_i^</em>$</li><li>求$a &#x3D; \sum_{i&#x3D;1}^{m}e_ia_i$</li><li>求$a\mod n$为最后的结果</li></ul><hr><h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><p>如果已知集合$Z_{n}^*&#x3D;{Z_{n}中有乘法逆元的剩余类}&#x3D;{[a]|a&#x3D;0,1,…,gcd(a,n)&#x3D;1}$</p><p>那么，给定一个n，如何求$Z_{n}^*$中有多少个整数&#x2F;剩余类呢</p><p>定义：欧拉函数，表示为$\phi (n)$，表示大于0，小于等于n的自然数和n互质的数的个数，<br>    即：$\phi (n):&#x3D;\left|Z_{n}^*\right|$（特别地，$\phi (1)&#x3D;1$）</p><h3 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h3><p>设两两互素的正整数$n_1,…,n_m\in N$并设$n  &#x3D;\prod_{i&#x3D;1}^mn_i$，那么有：$\phi (n)&#x3D;\prod\limits^m_{i&#x3D;1}\phi (n_i)$<br>用中国剩余定理+中国剩余映射求证</p><p>若p是素数，<br>$\phi (p^k)&#x3D;p^{k-1}\phi (p)$<br>$\phi (p)&#x3D;p-1$</p><h2 id="欧拉定理和费马小定理"><a href="#欧拉定理和费马小定理" class="headerlink" title="欧拉定理和费马小定理"></a>欧拉定理和费马小定理</h2><h3 id="乘法阶"><a href="#乘法阶" class="headerlink" title="乘法阶"></a>乘法阶</h3><p>设$a\in Z_n^*$，使得$a^k\equiv 1(\mod n)$的最小正整数k称作a在模n下的乘法阶。简写为a的阶.</p><p>如果$a\in Z_n^*$，其阶为k，则$a^0,a^1,a^2,…,a^{k-1}$彼此不同(注意这里是剩余类，要取模)</p><h4 id="性质-2"><a href="#性质-2" class="headerlink" title="性质"></a>性质</h4><p>$$<br>a^i\equiv1(\mod n)\iff k|i\<br>a^i\equiv a^j(\mod n) \iff i\equiv j (\mod k)<br>$$</p><h3 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h3>]]></content>
      
      
      <categories>
          
          <category> 密码学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 同余 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>密码学数学基础1</title>
      <link href="/posts/1de11b10.html"/>
      <url>/posts/1de11b10.html</url>
      
        <content type="html"><![CDATA[<h2 id="整除性"><a href="#整除性" class="headerlink" title="整除性"></a>整除性</h2><p>设$a,b\in Z$,如果存在一个$q\in Z$，使得$a&#x3D;qb$,则称“b<code>整除</code>a”或”<code>b是a的因子</code>“,记为“$b|a$”,并用$b\not\mid a$表示b不整除a</p><p>则：</p><ul><li>$b|0$</li><li>$1|a$</li><li>$0|a \iff a&#x3D;0$</li><li>$b|a \iff b|-a \iff -b|a$</li></ul><p>且：</p><p>自反性：$a|a$<br>传递性：$(b|a)\land (a|c) \rightarrow b|c$<br>相乘性：$b|a \rightarrow bc|ac$<br>消去性：$(bc|ac) \land (c\not&#x3D;0) \rightarrow b|a$<br>线性性：$b|a \land b|c\rightarrow\forall s,t\in Z,b|(sa\pm tc)$<br>比较性：$a,b\in N,b|a \rightarrow b\leq a$</p><p>定理一：$设a,b \in Z,则(b|a \land a|b) \iff a&#x3D;\pm b$</p><hr><h2 id="素数"><a href="#素数" class="headerlink" title="素数"></a>素数</h2><p>定义：设$n\in N\land n\geq2$,除了$1和n$以外,没有其它正整数整除n，则n称作“<code>素数</code>”（用p表示）；否则称为“合数”</p><p>注1：1既不是素数也不是合数<br>注2：若n为合数，则n&#x3D;ab，其中$1&lt;a&lt;n,1&lt;b&lt;n$</p><p>引理2-1：任何大于1的整数必有素因子。<br>定理2-1：任何合数$n$都至少有一个不超过$\sqrt n$的素因子<br>定理2-2：(算数基本定理)</p><p>任何非零整数$n$，都可以表示成如下乘积形式：<br>$$<br>n&#x3D;\pm p{_1}^{e_1}…p{_r}^{e_r}<br>$$<br>其中，$p_1,…p_r$是互不相同的素数，$e_1,…e_r$是正整数。</p><p>定理2-3:素数有无穷多个(欧几里得定理)</p><hr><h2 id="模运算"><a href="#模运算" class="headerlink" title="模运算"></a>模运算</h2><p>设$a,b\in Z \land b&gt;0,若q,r\in Z满足a&#x3D;qb +r,且0\leq r &lt; b,$则定义:</p><p>$a \mod b :&#x3D; r$</p><p>$a \mod n &#x3D; a - n⌊a&#x2F;n⌋(向下整除); a∈Z,n∈N*(正整数)$</p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>$b|a \iff a \mod b &#x3D; 0 $<br>$(a\pm b)\mod n &#x3D;(a\mod n\pm b\mod n)\mod n $<br>$(a<em>b)\mod n &#x3D;(a\mod n</em>b\mod n)\mod n $</p><hr><h2 id="最大公约数"><a href="#最大公约数" class="headerlink" title="最大公约数"></a>最大公约数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设$a,b\in Z,如果d \in Z  \land d|a,d|b,$则称d是a和b的公因子(公约数)<br>如果$d\geq0$,且a和b的所有公因子都整除d,则称d是a和b的最大公约数,记作gcd(a,b)</p><p>公因数可以是任何整数<br>最大公因数只能是0或正整数，不能是负数</p><p>特别的，gcd(0,0)&#x3D;1</p><h3 id="互素"><a href="#互素" class="headerlink" title="互素"></a>互素</h3><p>定义：设$a,b\in Z$,如果gcd(a,b)&#x3D;1,则称a和b互素</p><p>设gcd(a,b)&#x3D;d,则存在$q_1,q_2\in Z$,使得$a&#x3D;q_1d,b&#x3D;q_2d$,且$gcd(q_1,q_2)&#x3D;1$,所以$q_1和q_2$互素。</p><h3 id="欧几里得算法-辗转相除法"><a href="#欧几里得算法-辗转相除法" class="headerlink" title="欧几里得算法&#x2F;辗转相除法"></a>欧几里得算法&#x2F;辗转相除法</h3><p>设$a\geq b\geq 0$,求gcd(a,b)<br>数学原理：</p><ul><li>b&#x3D;0时，gcd(a,0)&#x3D;a</li><li>b&gt;0时，gcd(a,b)&#x3D;gcd(b,r)[a&#x3D;qb+r]</li><li>最后gcd(b,r)&#x3D;gcd($r,r_1$)&#x3D;gcd($r_n,0$)&#x3D;$r_n$</li></ul><h4 id="证明"><a href="#证明" class="headerlink" title="证明:"></a>证明:</h4><p>gcd递归定律：</p><p>$gcd(a,b)&#x3D;gcd(b,a\mod b)$</p><p>要证:<br>$$<br>gcd(a,b)&#x3D;gcd(b,a\mod b)<br>$$</p><p>根据整除性定理一：即证:<br>$$<br>gcd(a,b)|gcd(b, a \mod b) \land gcd(b,a \mod b)|gcd(a,b)<br>$$<br>对于前一项：<br>$$<br>gcd(a,b)|gcd(b, a \mod b)<br>$$<br>设 d &#x3D; gcd(a, b)<br>∴ d|a 且 d|b<br>∵根据模的定义：<br>$$<br>a \mod b是a,b的线性组合<br>$$</p><p>∵根据整除性的线性性：<br>$$<br>d|(a和b的线性组合)<br>$$<br>∴<br>$$<br>gcd(a,b)|gcd(b, a \mod b)<br>$$</p><p>对于后一项：<br>$$<br>gcd(b,a \mod b)|gcd(a,b)<br>$$<br>设 c &#x3D; gcd(b, a mod b)<br>∴ c|b 且 c|(a mod b)<br>∵ a &#x3D; qb +r<br>∵ r &#x3D; a mod b<br>∴ a &#x3D; qb + a mod b ,即:<br>$$<br>a 是 b 和 (a \mod b) 的线性组合<br>$$<br>∴根据整除性的线性性：<br>$$<br>c | a<br>$$<br>∵ c | a且c | b</p><p>∴<br>$$<br>c | gcd(a,b)<br>$$<br>∴<br>$$<br>gcd(b,a \mod b)|gcd(a,b)<br>$$<br>得证.</p><hr><h2 id="扩展欧几里得定理"><a href="#扩展欧几里得定理" class="headerlink" title="扩展欧几里得定理"></a>扩展欧几里得定理</h2><h3 id="定理5-1-最大公约数表示定理"><a href="#定理5-1-最大公约数表示定理" class="headerlink" title="定理5-1(最大公约数表示定理)"></a>定理5-1(最大公约数表示定理)</h3><p>设$a,b\in Z$,d&#x3D;gcd(a,b),则存在$s,t\in Z$,使得$as+bt&#x3D;d$</p><p>推论：$d|v \iff as+bt&#x3D;v$</p><p>在欧几里得算法中，计算出的q，根据递推公式：<br>$$<br>s_{i+1}&#x3D;s_{i-1}-s_iq_i<br>$$</p><p>$$<br>t_{i+1}&#x3D;t_{i-1}-t_iq_i<br>$$</p><p>同时,$s_0&#x3D;1,s_1&#x3D;0,s_0&#x3D;0,s_1&#x3D;1$,可以计算出$s_n和t_n即是最后的s和t$</p><p>扩展欧几里得算法就是用来计算定理5-1中的s和t的。同时求出gcd</p><hr><h2 id="最小公倍数"><a href="#最小公倍数" class="headerlink" title="最小公倍数"></a>最小公倍数</h2><p>设$a,b\in Z$,若$m\in Z$分别是a,b的倍数，m称作a,b的公倍数</p><p>lcm(a,b):a,b的最小公倍数(可以是负数)</p><ul><li>若$a,b\not&#x3D; 0$,m是a，b中所有正的公倍数中最小的，m叫作a和b的最小公倍数</li><li>若a或b有一个等于0,lam(a,b)&#x3D;0</li></ul><p>设$m&#x3D;lcm(a,b)$,如果$a|c,b|c$,则$m|c$</p><p>$gcd(a,b)&#x3D;1\rightarrow lcm(a,b)&#x3D;ab$</p><p>计算lcm：</p><ul><li>$lcm(a,b)&#x3D;\frac{ab}{gcd(a,b)}$</li><li>两个数迭代加自己直到相等</li></ul>]]></content>
      
      
      <categories>
          
          <category> 密码学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 密码学 </tag>
            
            <tag> 数学 </tag>
            
            <tag> 知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF_r16题目复现</title>
      <link href="/posts/6e766646.html"/>
      <url>/posts/6e766646.html</url>
      
        <content type="html"><![CDATA[<p>（好难，被薄纱了QAQ）</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="test-your-Debugger"><a href="#test-your-Debugger" class="headerlink" title="test your Debugger"></a>test your Debugger</h3><p>直接动态调试在提示的位置打断点</p><p>得结果</p><p>略</p><h3 id="CompileMe"><a href="#CompileMe" class="headerlink" title="CompileMe!!!"></a>CompileMe!!!</h3><p>文件打开以后是sln源代码文件？？甚至不用逆向？<br>打开之后：完型填空？</p><p>看起来是一个简单的XTEA，但是vs一开就崩溃，vscode也不知道为什么不能运行。。。那先看看题（补全后）：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">NSSCTF</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> key = <span class="keyword">new</span> <span class="built_in">ulong</span>[] &#123; <span class="number">0x57656c636f6d6520</span>, <span class="number">0x746f204e53534354</span>, <span class="number">0x4620526f756e6423</span>, <span class="number">0x3136204261736963</span> &#125;;</span><br><span class="line">            <span class="keyword">var</span> c = <span class="keyword">new</span> <span class="built_in">ulong</span>[] &#123; <span class="number">0xc60b34b2bff9d34a</span>, <span class="number">0xf50af3aa8fd96c6b</span>, <span class="number">0x680ed11f0c05c4f1</span>, <span class="number">0x6e83b0a4aaf7c1a3</span>, <span class="number">0xd69b3d568695c3c5</span>, <span class="number">0xa88f4ff50a351da2</span>, <span class="number">0x5cfa195968e1bb5b</span>, <span class="number">0xc4168018d92196d9</span> &#125;;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">ulong</span> e = <span class="number">0x9E3779B9</span>;</span><br><span class="line">            <span class="keyword">var</span> delta = Enumerable.Range(<span class="number">0</span>, <span class="number">32</span>).Select(index =&gt; e * (<span class="number">32</span> - (<span class="built_in">uint</span>)index)).ToArray();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> decryptedBlocks = c.Select((block, index) =&gt; <span class="keyword">new</span> &#123; Value = block, Index = index &#125;)</span><br><span class="line">                .GroupBy(item =&gt; item.I ndex / <span class="number">2</span>)</span><br><span class="line">                .Select(<span class="keyword">group</span> =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">ulong</span> b1 = <span class="keyword">group</span>.ElementAt(<span class="number">0</span>).Value;</span><br><span class="line">                    <span class="built_in">ulong</span> b2 = <span class="keyword">group</span>.ElementAt(<span class="number">1</span>).Value;</span><br><span class="line">                    <span class="built_in">ulong</span> sum = e * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">                    delta.ToList().ForEach(currentDelta =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        b2 -= (((b1 &lt;&lt; <span class="number">4</span>) ^ (b1 &gt;&gt; <span class="number">5</span>)) + b1) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                        sum -= e;</span><br><span class="line">                        b1 -= (((b2 &lt;&lt; <span class="number">4</span>) ^ (b2 &gt;&gt; <span class="number">5</span>)) + b2) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span>[] &#123; b1, b2 &#125;;</span><br><span class="line">                &#125;)</span><br><span class="line">                .SelectMany(block =&gt; block)</span><br><span class="line">                .ToArray();</span><br><span class="line"></span><br><span class="line">            <span class="built_in">ulong</span>[] decryptedText = <span class="keyword">new</span> <span class="built_in">ulong</span>[decryptedBlocks.Length];</span><br><span class="line">            Array.Copy(decryptedBlocks, decryptedText, decryptedText.Length);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            decryptedText.SelectMany(block =&gt; BitConverter.GetBytes(<span class="keyword">new</span> ZZZ(block).GetVal()).Reverse()).ToList().ForEach(byteValue =&gt; Console.Write(Encoding.ASCII.GetString(<span class="keyword">new</span>[] &#123; byteValue &#125;)));</span><br></pre></td></tr></table></figure><p>但是逻辑可以看懂，可以尝试用C重写一遍代码</p><p>但是后面有一个调用zzz</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">ZZZ</span>(<span class="title">ulong</span> <span class="title">val</span>) : <span class="title">ZZY</span>(<span class="title">val</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">ulong</span> <span class="title">GetVal</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.GetVal();</span><br><span class="line">        <span class="keyword">return</span> val + <span class="number">0x413FD584E295889</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而ZZZ到A的一万六千行代码都是类似这个的函数</p><p>（事后才发现这里调用的代码是base.GetVal()只是调用了继承自ZZY的getval函数然而没有返回值到确定的变量）</p><p>那么就需要用一个函数来读取并输出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lines = <span class="built_in">open</span>(<span class="string">&#x27;Program.cs&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).readlines()</span><br><span class="line"> </span><br><span class="line">a = <span class="string">b&#x27;unsigned __int64 (unsigned __int64 val) &#123;\n&#x27;</span></span><br><span class="line">c = <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">if</span> line.startswith(<span class="string">b&#x27;            return val&#x27;</span>):</span><br><span class="line">        a += <span class="string">b&#x27;    val = &#x27;</span>+line[<span class="number">18</span>:]</span><br><span class="line">a += c</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;c.py&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(a)</span><br></pre></td></tr></table></figure><p>然后复制这个函数到解密里面并调用。</p><p>最后的代码是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> __int64 *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> __int64 b2; </span><br><span class="line">    <span class="type">unsigned</span> __int64 b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="type">unsigned</span> __int64 key[<span class="number">4</span>] = &#123; <span class="number">0x57656c636f6d6520</span>, <span class="number">0x746f204e53534354</span>, <span class="number">0x4620526f756e6423</span>, <span class="number">0x3136204261736963</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> __int64 sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        b2 -= (((b1 &lt;&lt; <span class="number">4</span>) ^ (b1 &gt;&gt; <span class="number">5</span>)) + b1) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= e;</span><br><span class="line">        b1 -= (((b2 &lt;&lt; <span class="number">4</span>) ^ (b2 &gt;&gt; <span class="number">5</span>)) + b2) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">ccc</span><span class="params">(<span class="type">unsigned</span> __int64 val)</span> &#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line"> &#125;<span class="comment">//写完就5万字了</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">unsigned</span> __int64 Q[<span class="number">8</span>] = &#123;</span><br><span class="line">    <span class="number">0xc60b34b2bff9d34a</span>, <span class="number">0xf50af3aa8fd96c6b</span>, <span class="number">0x680ed11f0c05c4f1</span>, <span class="number">0x6e83b0a4aaf7c1a3</span>, </span><br><span class="line">    <span class="number">0xd69b3d568695c3c5</span>, <span class="number">0xa88f4ff50a351da2</span>, <span class="number">0x5cfa195968e1bb5b</span>, <span class="number">0xc4168018d92196d9</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">//sdecrypt(&amp;Q[k * 2], &amp;Q[k * 2 + 1]);</span></span><br><span class="line"></span><br><span class="line">        Q[k * <span class="number">2</span>] = ccc(Q[k * <span class="number">2</span>]);</span><br><span class="line">        Q[k * <span class="number">2</span> +<span class="number">1</span>] = ccc(Q[k * <span class="number">2</span>+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#llx,\n&quot;</span>, Q[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;Q[i]);</span><br><span class="line">    getchar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x4e53534354467b35</span>,</span><br><span class="line"><span class="number">0x384d745534695478</span>,</span><br><span class="line"><span class="number">0x34754b7538505648</span>,</span><br><span class="line"><span class="number">0x4559795939613774</span>,</span><br><span class="line"><span class="number">0x5a30646171564966</span>,</span><br><span class="line"><span class="number">0x4a5656396b704d52</span>,</span><br><span class="line"><span class="number">0x5a37757644475948</span>,</span><br><span class="line"><span class="number">0x52754a35384d7a7d</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;<span class="number">58</span>MtU4iTx4uKu8PVHEYyY9a7tZ0daqVIfJVV9kpMRZ7uvDGYHRuJ58Mz&#125;</span><br></pre></td></tr></table></figure><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="pr"><a href="#pr" class="headerlink" title="pr"></a>pr</h3><p>打开题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag=plaintext = <span class="string">&#x27;NSSCTF&#123;****************&#125;&#x27;</span></span><br><span class="line">charset = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span></span><br><span class="line">padding_length = <span class="number">100</span> - <span class="built_in">len</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(padding_length):</span><br><span class="line">    plaintext += random.choice(charset)</span><br><span class="line"></span><br><span class="line">e = <span class="number">31413537523</span></span><br><span class="line">message = bytes_to_long(plaintext.encode())</span><br><span class="line"><span class="keyword">assert</span> message &gt; (<span class="number">1</span> &lt;&lt; <span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> message &lt; (<span class="number">1</span> &lt;&lt; <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">prime_p = getPrime(<span class="number">512</span>)</span><br><span class="line">prime_q = getPrime(<span class="number">512</span>)</span><br><span class="line">prime_r = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = prime_p * prime_q</span><br><span class="line">n2 = prime_q * prime_r</span><br><span class="line">ciphertext1 = <span class="built_in">pow</span>(message, e, n1)</span><br><span class="line">ciphertext2 = <span class="built_in">pow</span>(message, e, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>, ciphertext1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>, ciphertext2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>, prime_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>, prime_r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1= 36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695</span></span><br><span class="line"><span class="string">c2= 15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752</span></span><br><span class="line"><span class="string">p= 12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123</span></span><br><span class="line"><span class="string">r= 10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">过程:</span></span><br><span class="line">取质数p,q,r</span><br><span class="line">e = ...</span><br><span class="line">n1 = pq</span><br><span class="line">n2 = qr</span><br><span class="line">c1 = m^e mod n1</span><br><span class="line">c2 = m^e mod n2</span><br><span class="line">已知c1,c2,e,p,r求m</span><br></pre></td></tr></table></figure><p>根据<br>$$<br>\begin{cases}<br>c_1\equiv m^e(\mod n_1)\\<br>c_2\equiv m^e(\mod n_2)<br>\end{cases}<br>$$<br>和同余定理<br>$$<br>若a-b是n的倍数,那么a和b在\mod n下同余<br>$$<br>因为原式可得<br>$$<br>\begin{cases}<br>c_1-m^e&#x3D;kpq\\<br>c_2-m^e&#x3D;kqr<br>\end{cases}<br>$$<br>所以<br>$$<br>\begin{cases}<br>c_1\equiv m^e(\mod p)\\<br>c_2\equiv m^e(\mod r)<br>\end{cases}<br>$$<br>所以<br>$$<br>\begin{cases}<br>m^e\equiv c_1(\mod p)\\<br>m^e\equiv c_2(\mod r)<br>\end{cases}<br>$$<br>根据中国剩余定理可以直接求m</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的参数</span></span><br><span class="line">c1 = <span class="number">36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695</span></span><br><span class="line">c2 = <span class="number">15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752</span></span><br><span class="line">p = <span class="number">12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123</span></span><br><span class="line">r = <span class="number">10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383</span></span><br><span class="line">e = <span class="number">31413537523</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求n</span></span><br><span class="line">n = p*r</span><br><span class="line"></span><br><span class="line"><span class="comment">#求模逆元</span></span><br><span class="line">j1 = invert(r,p)</span><br><span class="line">j2 = invert(p,r)</span><br><span class="line"><span class="comment">#求a</span></span><br><span class="line">a = c1*j1*r+c2*j2*p</span><br><span class="line"><span class="comment">#开方</span></span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">last = <span class="built_in">pow</span>(a,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(last))</span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;yUanshEnx1ncHun2o23!&#125;FA3JmflIoai8BxgdIGUQumsNc5R0hpo53zICaiWZRfjBj59P36EwC4CSfJOsZ3LIOYnhUmsQ&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逆核06-内嵌补丁</title>
      <link href="/posts/9b8c0cc4.html"/>
      <url>/posts/9b8c0cc4.html</url>
      
        <content type="html"><![CDATA[<h2 id="内嵌代码补丁"><a href="#内嵌代码补丁" class="headerlink" title="内嵌代码补丁"></a>内嵌代码补丁</h2><p>区别于直接修改程序代码，内嵌补丁是专门作用于有加密，校验，压缩的程序，在程序中插入内嵌补丁，并在解密解压后执行补丁内容，最后跳转到OEP，比修改加密&#x2F;压缩后的代码更方便。</p><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>设置补丁的位置</p><ul><li>文件的空白区域（补丁代码少时）</li><li>扩展后的最后一个节区</li><li>添加的新节区</li></ul><p>注：添加补丁的节区一定要有可写权限，获得相应内存的可写权限</p><p>在解密后的位置（jmp OEP）写跳转语句跳到补丁位置，最后由补丁跳到OEP</p><hr><p>[施工中][QAQ]</p><hr><p>第二部分：完</p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 学习 </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密02:TEA</title>
      <link href="/posts/d89283b5.html"/>
      <url>/posts/d89283b5.html</url>
      
        <content type="html"><![CDATA[<h1 id="Tiny-Encryption-Algorithm"><a href="#Tiny-Encryption-Algorithm" class="headerlink" title="Tiny Encryption Algorithm"></a>Tiny Encryption Algorithm</h1><p>（微型加密算法）</p><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>块加密，对称加密</p><ul><li>块加密：将明文按一定大小分组之后用确定的算法和对称密钥对魅族分别加密，一般来说加密和解密函数为反函数，一般会进行多轮加密</li><li>对称加密：加密解密双方使用同一个密钥加密解密或双方使用的是两个可以简单地相互推算的密钥</li></ul><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h3 id="定义与初始化"><a href="#定义与初始化" class="headerlink" title="定义与初始化"></a>定义与初始化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key = [a,b,c,d]<span class="comment">#一般是4个值</span></span><br><span class="line">delta = <span class="number">0x9E3779B9</span></span><br></pre></td></tr></table></figure><h3 id="轮加密"><a href="#轮加密" class="headerlink" title="轮加密"></a>轮加密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>,<span class="built_in">len</span>(m),<span class="number">2</span>):</span><br><span class="line">x = m[i]</span><br><span class="line">y = m[i+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">delta++</span><br><span class="line">x += ((y &lt;&lt; <span class="number">4</span>) + Key[<span class="number">0</span>]) ^ (y + delta) ^ ((y &gt;&gt; <span class="number">5</span>) + Key[<span class="number">1</span>])</span><br><span class="line">y += ((x &lt;&lt; <span class="number">4</span>) + Key[<span class="number">2</span>]) ^ (x + delta) ^ ((x &gt;&gt; <span class="number">5</span>) + Key[<span class="number">3</span>])</span><br></pre></td></tr></table></figure><p>注：具体算法可能不同，但是一般都是x 由y和key改变，y由x和key改变，delta可能加可能减,但是一般情况不会把for i in (0,len(m),2)改成for i in (len-1)，这样就不是块加密了</p><p>此处省略了&amp;0xffffffff，需要让所有值都是int&#x2F;dword，下面也是，之后不说了</p><hr><p>XTEA的加密部分：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    x += (((y &lt;&lt; <span class="number">4</span>) ^ (y &gt;&gt; <span class="number">5</span>)) + y) ^ (delta + key[delta &amp; <span class="number">3</span>])</span><br><span class="line">    delta++</span><br><span class="line">    y += (((x &lt;&lt; <span class="number">4</span>) ^ (x &gt;&gt; <span class="number">5</span>)) + x) ^ (delta + key[(delta&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>])</span><br></pre></td></tr></table></figure><p>注；相当于添加了与和位移,让key的取值不固定,但是框架没啥区别</p><hr><p>XXTEA的加密部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">round</span> = <span class="number">6</span> + <span class="number">52</span> // n <span class="comment">#n为数据个数（输入数组长度）,长度可以不是4的倍数</span></span><br><span class="line">MX = <span class="keyword">lambda</span> <span class="built_in">sum</span>, y, z, p, e, k: ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">round</span>):</span><br><span class="line"><span class="built_in">sum</span> = (<span class="built_in">sum</span> + DELTA) &amp; <span class="number">0xffffffff</span></span><br><span class="line">e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">y = m[(p + <span class="number">1</span>) % n]</span><br><span class="line">z = m[p] = (m[p] + MX(<span class="built_in">sum</span>, y, z, p, e, k)) &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure><p>贴一个c语言版</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//也不知道网上都写的啥，看都看不懂</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xxtea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span>* key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)             <span class="comment">// encrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">// decrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 两个32位无符号整数，即待加密的64bit明文数据</span></span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>] = &#123;<span class="number">0x12345678</span>, <span class="number">0x78563412</span>&#125;;</span><br><span class="line">    <span class="comment">// 四个32位无符号整数，即128bit的key</span></span><br><span class="line">    <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x4</span>&#125;;</span><br><span class="line">    <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">    <span class="type">int</span> n = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    xxtea(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Encrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    xxtea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="破解方法"><a href="#破解方法" class="headerlink" title="破解方法"></a>破解方法</h2><h3 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h3><p>[等待施工][QAQ]</p>]]></content>
      
      
      <categories>
          
          <category> 密码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 对称加密 </tag>
            
            <tag> 块加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密01:RC4</title>
      <link href="/posts/ed8aa7e2.html"/>
      <url>/posts/ed8aa7e2.html</url>
      
        <content type="html"><![CDATA[<h1 id="Rivest-Cipher-4"><a href="#Rivest-Cipher-4" class="headerlink" title="Rivest Cipher 4"></a>Rivest Cipher 4</h1><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>串流加密，密钥长度可变，对称加密，加密解密使用同一套算法</p><ul><li>串流加密：即密钥是通过一个随机种子通过算法得到的伪随机密钥流，用这一串密钥加密或解密。使加密过程有完善保密性（密钥长度不短于明文长度）</li><li>对称加密：加密解密双方使用同一个密钥加密解密或双方使用的是两个可以简单地相互推算的密钥</li><li>加密解密使用同一套算法：RC4一般使用异或加密，由于异或的对合性（$f(f(x))&#x3D;x$,对任意x均成立），可以使用相同算法加密</li></ul><hr><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h3 id="初始化（KSA）"><a href="#初始化（KSA）" class="headerlink" title="初始化（KSA）"></a>初始化（KSA）</h3><ol><li><p>初始化S盒</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S.append(i)</span><br></pre></td></tr></table></figure></li><li><p>打乱S盒(这个算法可以保证每一项都被换过)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key = ...</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">    swap(S[i],S[j])</span><br></pre></td></tr></table></figure></li></ol><h3 id="伪随机子密码生成（PRGA）"><a href="#伪随机子密码生成（PRGA）" class="headerlink" title="伪随机子密码生成（PRGA）"></a>伪随机子密码生成（PRGA）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    i,j = (i+<span class="number">1</span>)%<span class="number">256</span>,(j+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line">    swap(S[i],S[j])</span><br><span class="line">    c = m[i] ^ S[(S[i] + S[j]) % <span class="number">256</span>]</span><br></pre></td></tr></table></figure><p>注：最后的算法不一定是标准的，但是只要是原文和一个在过程中产生的值异<br>或，就可以算作RC4。</p><hr><h2 id="破解方法"><a href="#破解方法" class="headerlink" title="破解方法"></a>破解方法</h2><h3 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h3><p>[等待施工][QAQ]</p>]]></content>
      
      
      <categories>
          
          <category> 密码学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 密码 </tag>
            
            <tag> 加密方法 </tag>
            
            <tag> 对称加密 </tag>
            
            <tag> 流加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《逆核》05-Upack和PE结构</title>
      <link href="/posts/65cde422.html"/>
      <url>/posts/65cde422.html</url>
      
        <content type="html"><![CDATA[<p>upack是一个压缩器，用于压缩PE文件,跟随逆核一起深入学习PE文件结构</p><h1 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h1><p>PE文件经过upack之后有以下特点：</p><h2 id="重叠文件头"><a href="#重叠文件头" class="headerlink" title="重叠文件头"></a>重叠文件头</h2><ul><li><p>把MZ文件头(dos头)和PE头重合在一起</p></li><li><p>原理是dos头中的e_lfanew指向NT头但是并没有说NT头不能和DOS头重合,一般情况下:</p></li><li><pre><code>e_fanew = MZ文件大小(40h)+DOS存根=E0<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 但是Upack后e_fanew值是<span class="number">10</span><span class="built_in">h</span>,所以hex方式打开后,第一排是<span class="number">4</span>D5A下一排就是<span class="number">5045</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 在可选头中插入解码代码</span></span><br><span class="line"></span><br><span class="line">- 修改SizeOfOpionalHeader的值增加至<span class="number">148</span><span class="built_in">h</span>，这样在节区头和可选头中间就可以插入解码代码，此时节区头的起始偏移是</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  <span class="number">170</span><span class="built_in">h</span>=<span class="number">28</span><span class="built_in">h</span>(可选头起始偏移)+<span class="number">148</span><span class="built_in">h</span></span><br></pre></td></tr></table></figure></code></pre></li><li><p>(SizeOfOpionalHeader的作用是想要根据PE文件形态更换和插入其它可选头形态的结构体)</p></li></ul><h2 id="在文件头插入解码代码"><a href="#在文件头插入解码代码" class="headerlink" title="在文件头插入解码代码"></a>在文件头插入解码代码</h2><ul><li>可选头中的NumberOfRvaAndSizes由10h变为Ah,使得DataDirectory只有前10个元素,,并把后面6个元素的位置改为自己的解码代码</li></ul><h2 id="在节区头中记录自身数据和重叠节区"><a href="#在节区头中记录自身数据和重叠节区" class="headerlink" title="在节区头中记录自身数据和重叠节区"></a>在节区头中记录自身数据和重叠节区</h2><ul><li>节区头中类似重定位节区是不需要的,所以这种节区可以用于记录自身数据</li><li>整个PE文件分为4个部分:PE头,第一节区,第二节区,第三节区.有以下几个特性:</li><li>内存中,PE头,第一节区,第三节区均由同一区域映射而来,即SizeOfRawData和RawOffset相同,但是VirtulSize不同<ul><li>源文件压缩于第二节区</li><li>第一节区的SizeOfImage与原PE文件相同,即原PE文件会解压到第一节区</li></ul></li></ul><hr><h2 id="RVA-to-RAW"><a href="#RVA-to-RAW" class="headerlink" title="RVA to RAW"></a>RVA to RAW</h2><p>标准操作是:</p><p><code>RAW=RVA-VA+PointerToRawData</code></p><p>但是经过upack后,第一节区的PointerToRawData值为10,然而不为FileAlignment(200h)的倍数,因此PE装载器强制识别为其整倍数(确保指向一页),令其等于0</p><p>所以正确值是:</p><p><code>RAW=RVA-VA</code></p><h2 id="导入表"><a href="#导入表" class="headerlink" title="导入表"></a>导入表</h2><ul><li>通过存在在节区的末尾,省略最后的null结构体,映射到内存时,后面自然有null填充,这样可以节约空间</li></ul><h2 id="导入地址表"><a href="#导入地址表" class="headerlink" title="导入地址表"></a>导入地址表</h2><ul><li>在DOS存根中存放导入DLL的名称,查看FirstThunk可以找到对应加载的函数.</li></ul><hr><h1 id="调试过程"><a href="#调试过程" class="headerlink" title="调试过程"></a>调试过程</h1><ul><li>先是解码循环,再是设置IAT(和UPX差不多?),但是设置IAT的方法是用导入的函数LoadLibraryA和GetProcAddress一边循环一遍构建(先获取导入函数实际地址,再写入原函数)IAT</li></ul>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 学习 </tag>
            
            <tag> PE </tag>
            
            <tag> 壳 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023安洵杯RE部分复现</title>
      <link href="/posts/a04e3508.html"/>
      <url>/posts/a04e3508.html</url>
      
        <content type="html"><![CDATA[<h1 id="安洵杯RE"><a href="#安洵杯RE" class="headerlink" title="安洵杯RE"></a>安洵杯RE</h1><h2 id="mobilego"><a href="#mobilego" class="headerlink" title="mobilego"></a>mobilego</h2><p>现在模拟器中尝试输入，返回nonono</p><p>jadx打开mainactivity</p><p>发现判断函数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> m141lambda$onCreate$<span class="number">0</span>$comexamplemobilegoMainActivity(View v) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Game.checkflag(<span class="built_in">this</span>.editText.getText().toString()).equals(getResources().getString(C0569R.string.cmp))) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;yes your flag is right&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;No No No&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在C0569R中有</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">string</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">app_name</span> <span class="operator">=</span> <span class="number">2131689500</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> <span class="number">2131689512</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的cmp是它的id值而不是它的具体值</p><p>所以动态调试找到终值</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>这里使用了Game.checkflag这个方法来加密</p><p>所以先看这个</p><p>根据game</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> p004go.Seq;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Game</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">_init</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">checkflag</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Seq.touch();</span><br><span class="line">        _init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Game</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">touch</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>怀疑checkflag是通过lib加载的</p><p>打开ida，反汇编so文件</p><p>搜索checkflag</p><p>找到5个函数</p><p><img src="https://s2.loli.net/2023/12/28/Z4TbAVSxCklJaOB.png" alt="image-20231228150946781"></p><p>函数是这几个</p><p>好复杂，看不懂。。</p><p>最后看了看wp，发现一个一直没注意的东西，如果输入</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1234567890</span>变为<span class="number">6143580927</span>，</span><br><span class="line">&#123;qwertyuiopasdfghjklzxcvbnm&#125;变为bhgsruc&#123;iojqkdpwnezyvxa&#125;lfmt</span><br></pre></td></tr></table></figure><p>说明这个加密只是字符交换，交换之后是</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>一共38个字符</p><p>那么尝试输入一个不重复的值，这样就可以直接找到映射表：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t<span class="number">2</span>F<span class="number">7</span>GTglISYL<span class="symbol">nMzc6</span>CqhD<span class="symbol">N5</span>OdX<span class="number">8</span>wPjsKufVbE&#125;</span><br></pre></td></tr></table></figure><p>变为</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC</span><br></pre></td></tr></table></figure><p>根据这个对应关系，逆向解出原来的关系</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">d1 = <span class="string">&#x27;t2F7GTglISYLnMzc6CqhDN5OdX8wPjsKufVbE&#125;&#x27;</span></span><br><span class="line">d2 = <span class="string">&#x27;NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC&#x27;</span></span><br><span class="line"></span><br><span class="line">f2 = <span class="string">&#x27;49021&#125;5f919038b440139g74b7Dc88330e5d&#123;6&#x27;</span></span><br><span class="line">f1 = [<span class="number">0</span>]*<span class="number">38</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">        <span class="keyword">if</span> (d2[j] == d1[i]):</span><br><span class="line">            f1[i] = f2[j]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(f1))</span><br><span class="line"><span class="comment">#D0g3&#123;4c3b5903d11461f94478b7302980e958&#125;</span></span><br></pre></td></tr></table></figure><p>总结：</p><p>猜测输入时尽量使用有规律的字符，更容易看清</p><p>如果不容易逆向可以尝试看或者猜</p><hr><h2 id="牢大想你了"><a href="#牢大想你了" class="headerlink" title="牢大想你了"></a>牢大想你了</h2><p>用dnspy打开Assembly-CSharp.dll后，可以看到主内容中不同类（没学过csharp，猜的），是以下几个类：</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">AABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB</span></span><br><span class="line"><span class="attribute">ABBBBABABBAABABBBBBABBBBABABBBAAAABBBAABBBAABBA</span></span><br><span class="line"><span class="attribute">BBBBAAABABABABAAABABBBBBAAABBBAAAAABBBBAABAAABB</span></span><br><span class="line"><span class="attribute">GameManager</span></span><br><span class="line"><span class="attribute">UIManager</span></span><br></pre></td></tr></table></figure><p>上面三个的变量名和类名都被混淆了，需要先根据字符串找到逻辑代码</p><p>在GameManager找到多个：</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br></pre></td></tr></table></figure><p>同时在这个语句上面均有</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RuntimeHelpers.InitializeArray(array, fieldof(&lt;PrivateImplementationDetails&gt;.BC42CACDF93A0A1981A27121FBDC9584A9570918).FieldHandle);</span><br></pre></td></tr></table></figure><p>相当于先把array先初始化为BC42CACDF93A0A1981A27121FBDC9584A9570918的值，这个字符不是值而是类似于变量名的东西</p><p>所以打开看看</p><p>结果向下看发现直接就有array的值，这样末值就有了</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uint</span>[] array = <span class="keyword">new</span> <span class="built_in">uint</span>[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">3363017039U</span>,</span><br><span class="line"><span class="number">1247970816U</span>,</span><br><span class="line"><span class="number">549943836U</span>,</span><br><span class="line"><span class="number">445086378U</span>,</span><br><span class="line"><span class="number">3606751618U</span>,</span><br><span class="line"><span class="number">1624361316U</span>,</span><br><span class="line"><span class="number">3112717362U</span>,</span><br><span class="line"><span class="number">705210466U</span>,</span><br><span class="line"><span class="number">3343515702U</span>,</span><br><span class="line"><span class="number">2402214294U</span>,</span><br><span class="line"><span class="number">4010321577U</span>,</span><br><span class="line"><span class="number">2743404694U</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">c</span><span class="number">873914</span>f<span class="punctuation">,</span></span><br><span class="line"><span class="number">4</span>a<span class="number">628600</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">20</span><span class="keyword">c</span><span class="number">77</span>a<span class="number">1</span><span class="keyword">c</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">1</span>a<span class="number">877</span>aaa<span class="punctuation">,</span></span><br><span class="line">d<span class="number">6</span>faa<span class="number">982</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">60</span>d<span class="number">1</span><span class="keyword">c</span><span class="number">964</span><span class="punctuation">,</span></span><br><span class="line">b<span class="number">9884</span><span class="keyword">c</span><span class="number">32</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">2</span>a<span class="number">08</span>a<span class="number">862</span><span class="punctuation">,</span></span><br><span class="line"><span class="keyword">c</span><span class="number">74</span>a<span class="number">0036</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">8</span>f<span class="number">2</span>ee<span class="number">196</span><span class="punctuation">,</span></span><br><span class="line">ef<span class="number">08</span>a<span class="number">6</span>a<span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">a<span class="number">3850896</span></span><br></pre></td></tr></table></figure><p>然后就是找加密函数即encryptedData的来源</p><p>在上面一行：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Buffer.BlockCopy(paddedArray, <span class="number">0</span>, uintArray, <span class="number">0</span>, paddedArray.Length);</span><br><span class="line"><span class="built_in">uint</span>[] encryptedData = <span class="keyword">new</span> <span class="built_in">uint</span>[<span class="number">0</span>];</span><br><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str);</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; uintArray.Length; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">encryptedData = encryptedData.Concat(str2.BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBA(uintArray[i], uintArray[i + <span class="number">1</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBA是一个方法，那么化简一下方法名：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; uintArray.Length; i += <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">encryptedData = encryptedData.Concat(str2.tea(uintArray[i], uintArray[i + <span class="number">0</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>十分明显了，uintArray是输入，定义是</p><p>uint[] uintArray &#x3D; new uint[paddedArray.Length &#x2F; 0];</p><p>str2在前面是</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str);</span><br></pre></td></tr></table></figure><p>一个抽象的定义，所以直接进tea看看</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">uint</span>[] <span class="title">tea</span>(<span class="params"><span class="built_in">uint</span> ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA, <span class="built_in">uint</span> BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> v0 = ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA;</span><br><span class="line"><span class="built_in">uint</span> v = BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA;</span><br><span class="line"><span class="built_in">uint</span> sum = <span class="number">1U</span>;</span><br><span class="line"><span class="built_in">uint</span> delta = <span class="number">4294967252U</span>;</span><br><span class="line"><span class="built_in">uint</span>[] str2 = <span class="keyword">this</span>.BBABABBBABBABABAAABBBAABBAAAAAAABBBBBAABBAAAAAA;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="number">-103</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">sum += delta;</span><br><span class="line">v0 += ((v &lt;&lt; <span class="number">7</span>) + str2[<span class="number">1</span>] ^ v + sum ^ (v &gt;&gt; <span class="number">0</span>) + str2[<span class="number">1</span>]);</span><br><span class="line">v += ((v0 &lt;&lt; <span class="number">7</span>) + str2[<span class="number">5</span>] ^ v0 + sum ^ (v0 &gt;&gt; <span class="number">4</span>) + str2[<span class="number">8</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">uint</span>[] array = <span class="keyword">new</span> <span class="built_in">uint</span>[<span class="number">8</span>];</span><br><span class="line">array[<span class="number">0</span>] = v0;</span><br><span class="line">array[<span class="number">0</span>] = v;</span><br><span class="line"><span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以这里还需要str2的值，在GameManager的上面部分写了</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uint[] str = <span class="keyword">new</span> uint[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="number">286331153</span>U</span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>可知，</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encryptedData = encryptedData.Concat(str2.BBBABAABAAABBAAABBBAABBAAAAAABABBBBBBABBABABAAB(<span class="built_in">uint</span>Array[i], <span class="built_in">uint</span>Array[i + <span class="number">0</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br></pre></td></tr></table></figure><p>这里的str2就是这四个值，key也就是这四个值</p><p>最后还要在加密的类里面看哪个是正确的加密函数（有一堆tea），检查i的值（不应该是无限循环）和key数组的个数（0到3）</p><p>最后只剩一个</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">uint</span>[] <span class="title">BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBA</span>(<span class="params"><span class="built_in">uint</span> ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA, <span class="built_in">uint</span> BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> v0 = ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA;</span><br><span class="line"><span class="built_in">uint</span> v = BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA;</span><br><span class="line"><span class="built_in">uint</span> sum = <span class="number">0U</span>;</span><br><span class="line"><span class="built_in">uint</span> delta = <span class="number">2654435769U</span>;</span><br><span class="line"><span class="built_in">uint</span>[] str2 = <span class="keyword">this</span>.BBABABBBABBABABAAABBBAABBAAAAAAABBBBBAABBAAAAAA;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">sum += delta;</span><br><span class="line">v0 += ((v &lt;&lt; <span class="number">4</span>) + str2[<span class="number">0</span>] ^ v + sum ^ (v &gt;&gt; <span class="number">5</span>) + str2[<span class="number">1</span>]);</span><br><span class="line">v += ((v0 &lt;&lt; <span class="number">4</span>) + str2[<span class="number">2</span>] ^ v0 + sum ^ (v0 &gt;&gt; <span class="number">5</span>) + str2[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">uint</span>[]</span><br><span class="line">&#123;</span><br><span class="line">v0,</span><br><span class="line">v</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么写tea解密函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tt[<span class="number">4</span>] = &#123; <span class="number">0x11111111</span>, <span class="number">0x11111111</span>, <span class="number">0x11111111</span>, <span class="number">0x11111111</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line">        </span><br><span class="line">        b2 -= ((b1 &lt;&lt; <span class="number">4</span>) + tt[<span class="number">2</span>] ^ b1 + sum ^ (b1 &gt;&gt; <span class="number">5</span>) + tt[<span class="number">3</span>]);</span><br><span class="line">        b1 -= ((b2 &lt;&lt; <span class="number">4</span>) + tt[<span class="number">0</span>] ^ b2 + sum ^ (b2 &gt;&gt; <span class="number">5</span>) + tt[<span class="number">1</span>]);</span><br><span class="line">        sum -= e;</span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Q[<span class="number">12</span>] = &#123; <span class="number">0xc873914f</span>,</span><br><span class="line">                            <span class="number">0x4a628600</span>,</span><br><span class="line">                            <span class="number">0x20c77a1c</span>,</span><br><span class="line">                            <span class="number">0x1a877aaa</span>,</span><br><span class="line">                            <span class="number">0xd6faa982</span>,</span><br><span class="line">                            <span class="number">0x60d1c964</span>,</span><br><span class="line">                            <span class="number">0xb9884c32</span>,</span><br><span class="line">                            <span class="number">0x2a08a862</span>,</span><br><span class="line">                            <span class="number">0xc74a0036</span>,</span><br><span class="line">                            <span class="number">0x8f2ee196</span>,</span><br><span class="line">                            <span class="number">0xef08a6a9</span>,</span><br><span class="line">                            <span class="number">0xa3850896</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">//sdecrypt(&amp;Q[k * 2], &amp;Q[k * 2 + 1]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#x,\n&quot;</span>, Q[i]);</span><br><span class="line">    getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0x695f7469,</span></span><br><span class="line"><span class="comment">//0x65625f73,</span></span><br><span class="line"><span class="comment">//0x615f6e65,</span></span><br><span class="line"><span class="comment">//0x6e6f6c5f,</span></span><br><span class="line"><span class="comment">//0x61645f67,</span></span><br><span class="line"><span class="comment">//0x69775f79,</span></span><br><span class="line"><span class="comment">//0x756f6874,</span></span><br><span class="line"><span class="comment">//0x6f795f74,</span></span><br><span class="line"><span class="comment">//0x796d5f75,</span></span><br><span class="line"><span class="comment">//0x6972665f,</span></span><br><span class="line"><span class="comment">//0x646e65,</span></span><br></pre></td></tr></table></figure><p>然后按行取反转hex再全取反得到结果：</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">it_is_been_<span class="built_in">a_long</span>_day_without_you_my_friend</span><br></pre></td></tr></table></figure><p>即</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D0g3&#123;it_is_been_<span class="built_in">a_long</span>_day_without_you_my_friend&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="感觉有点点简单"><a href="#感觉有点点简单" class="headerlink" title="感觉有点点简单"></a>感觉有点点简单</h2><p>这是一个sys文件，根据网上教程</p><blockquote><p>静态IDA<br>动态SICE 或者 Syser</p></blockquote><p>先尝试用ida打开</p><p>进入主要的检查函数</p><p>找到关键代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (_BYTE)v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( HIDWORD(v1) &lt;= <span class="number">0xC00</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        rc4(NumberOfBytes_4, HIDWORD(v1), <span class="string">&quot;the_key_&quot;</span>, <span class="number">8</span>i64, v1);</span><br><span class="line">        base64(P, NumberOfBytes_4, HIDWORD(v1));</span><br><span class="line">        LOBYTE(v1) = sub_140001560(P, <span class="number">56</span>i64);</span><br><span class="line">        v8 = <span class="string">&quot;tips: YES, RIGHT FLAG.   you got it!&quot;</span>;</span><br><span class="line">        v7 = <span class="string">&quot;tips: NO , WRONG ANSWER. try again !&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( (_BYTE)v1 )</span><br><span class="line">          DbgPrint(<span class="string">&quot;tips: %s\n&quot;</span>, v8);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          DbgPrint(<span class="string">&quot;tips: %s\n&quot;</span>, v7);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        DbgPrint(<span class="string">&quot;tips: file to long \n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NumberOfBytes_4</span> = ExAllocatePool(NonPagedPool, <span class="number">0</span>x1000ui64)<span class="comment">;</span></span><br><span class="line"><span class="attr">P</span> = ExAllocatePool(NonPagedPool, <span class="number">0</span>x1000ui64)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>这两个指针的初始化用了ExAllocatePool函数</p><p>这是内核模式下的内存分配函数，意思是从非分页池中分配4096字节给两个指针</p><p>在最后有ExFreePoolWithTag释放这两个空间，这两个函数类似于malloc和free</p><p>在最后LOBYTE(v1) &#x3D; sub_140001560(P, 56i64);   &#x2F;&#x2F; 比较函数进行了比较</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">sub_140001560</span><span class="params">(__int64 a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a2 == <span class="number">56</span> &amp;&amp; !(<span class="type">unsigned</span> <span class="type">int</span>)sub_1400019F0(a1, <span class="string">&quot;6zviISn2McHsa4b108v29tbKMtQQXQHA+2+sTYLlg9v2Q2Pq8SP24Uw=&quot;</span>, <span class="number">56</span>i64);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>意思是令a1等于后面的值，也就是说拿到P的终值了： </p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>zviIS<span class="symbol">n2</span>McHsa<span class="number">4</span>b<span class="number">108</span>v<span class="number">29</span>tbKMtQQXQHA<span class="number">+2</span>+sTYLl<span class="name">g9</span>v<span class="number">2</span>Q<span class="number">2</span>Pq<span class="number">8</span>SP<span class="number">24</span>Uw=</span><br></pre></td></tr></table></figure><p>因为other通过自定义base64转换成P所以other终值直接放base64解码是</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">otherl = [<span class="number">0x70</span>,<span class="number">0x5c</span>,<span class="number">0x9e</span>,<span class="number">0xcc</span>,<span class="number">0x4d</span>,<span class="number">0x4c</span>,<span class="number">0xe2</span>,<span class="number">0x08</span>,</span><br><span class="line">          <span class="number">0x8e</span>,<span class="number">0xac</span>,<span class="number">0x00</span>,<span class="number">0xd0</span>,<span class="number">0x5b</span>,<span class="number">0x0c</span>,<span class="number">0x8c</span>,<span class="number">0x95</span>,</span><br><span class="line">          <span class="number">0x80</span>,<span class="number">0xc1</span>,<span class="number">0xe1</span>,<span class="number">0x85</span>,<span class="number">0x14</span>,<span class="number">0xf1</span>,<span class="number">0x48</span>,<span class="number">0x92</span>,</span><br><span class="line">          <span class="number">0x4c</span>,<span class="number">0xc4</span>,<span class="number">0xce</span>,<span class="number">0xee</span>,<span class="number">0x4d</span>,<span class="number">0x89</span>,<span class="number">0x36</span>,<span class="number">0x5c</span>,</span><br><span class="line">          <span class="number">0x8c</span>,<span class="number">0x50</span>,<span class="number">0xc8</span>,<span class="number">0xd1</span>,<span class="number">0xc0</span>,<span class="number">0x48</span>,<span class="number">0xcc</span>,<span class="number">0x03</span>,</span><br><span class="line">          <span class="number">0x11</span>]</span><br></pre></td></tr></table></figure><p>不对，这个base64不是常规的，要自己写解密函数，因为加密部分是：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*(_BYTE *)(a1 + v5) = v6[*(_BYTE *)(a2 + v4) &amp; <span class="number">0x3F</span>];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">1</span>) = v6[(<span class="number">4</span> * (*(_BYTE *)(a2 + v4 + <span class="number">1</span>) &amp; <span class="number">0xF</span>)) | ((*(_BYTE *)(a2 + v4) &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">2</span>) = v6[(<span class="number">16</span> * (*(_BYTE *)(a2 + v4 + <span class="number">2</span>) &amp; <span class="number">3</span>)) | ((*(_BYTE *)(a2 + v4 + <span class="number">1</span>) &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">3</span>) = v6[(*(_BYTE *)(a2 + v4 + <span class="number">2</span>) &amp; <span class="number">0xFC</span>) &gt;&gt; <span class="number">2</span>];</span><br></pre></td></tr></table></figure><p>加密过程是：</p><p>a &#x3D;0位后6个</p><p>b&#x3D;0位前2和1位后4组合</p><p>c&#x3D;2位后2和1位前4</p><p>d&#x3D;2位前6</p><p>所以：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">num = [<span class="number">0</span>]*<span class="number">42</span></span><br><span class="line"><span class="built_in">input</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="built_in">list</span>(<span class="string">&#x27;6zviISn2McHsa4b108v29tbKMtQQXQHA+2+sTYLlg9v2Q2Pq8SP24Uw&#x27;</span>)<span class="comment">#最后剩三个</span></span><br><span class="line">table = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;4KBbSzwWClkZ2gsr1qA+Qu0FtxOm6/iVcJHPY9GNp7EaRoDf8UvIjnL5MydTX3eh&#x27;</span>]</span><br><span class="line">tl = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">way</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        <span class="keyword">if</span> (table[i]==n):</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    tl.append(<span class="built_in">ord</span>(last[i]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num),<span class="number">3</span>):</span><br><span class="line"></span><br><span class="line">    num[i] = ((way(tl[j])) | (((way(tl[j+<span class="number">1</span>])) &amp; <span class="number">3</span>)  &lt;&lt; <span class="number">6</span>))</span><br><span class="line">    num[i+<span class="number">1</span>] = (((way(tl[j+<span class="number">1</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">2</span>) | ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">if</span> ((j+<span class="number">3</span>) &lt; <span class="built_in">len</span>(num)):</span><br><span class="line">        num[i+<span class="number">2</span>] = ((way(tl[j+<span class="number">3</span>]) &lt;&lt; <span class="number">2</span>) | ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num[i+<span class="number">2</span>] = ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    j += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    <span class="built_in">input</span> += <span class="built_in">chr</span>(num[i])</span><br><span class="line">hnum = [<span class="built_in">hex</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> num]</span><br><span class="line"><span class="built_in">print</span>(hnum)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>)</span><br><span class="line"><span class="comment">#[&#x27;0x5c&#x27;, &#x27;0x21&#x27;, &#x27;0x7b&#x27;, &#x27;0x33&#x27;, &#x27;0x51&#x27;, &#x27;0x33&#x27;, &#x27;0x38&#x27;, &#x27;0x28&#x27;, &#x27;0x3a&#x27;, &#x27;0x2b&#x27;, &#x27;0x30&#x27;, &#x27;0x40&#x27;, &#x27;0x16&#x27;, &#x27;0x2c&#x27;, &#x27;0x33&#x27;, &#x27;0x25&#x27;, &#x27;0x36&#x27;, &#x27;0x4&#x27;, &#x27;0x38&#x27;, &#x27;0x46&#x27;, &#x27;0x51&#x27;, &#x27;0x3c&#x27;, &#x27;0x25&#x27;, &#x27;0x4a&#x27;, &#x27;0x13&#x27;, &#x27;0x33&#x27;, &#x27;0x39&#x27;, &#x27;0x3b&#x27;, &#x27;0x69&#x27;, &#x27;0x27&#x27;, &#x27;0x4d&#x27;, &#x27;0x29&#x27;, &#x27;0x3&#x27;, &#x27;0x14&#x27;, &#x27;0x33&#x27;, &#x27;0x2&#x27;, &#x27;0x30&#x27;, &#x27;0x31&#x27;, &#x27;0x2&#x27;, &#x27;0x40&#x27;, &#x27;0x6c&#x27;, &#x27;0x0&#x27;]</span></span><br><span class="line"><span class="comment">#[92, 33, 123, 51, 81, 51, 56, 40, 58, 43, 48, 64, 22, 44, 51, 37, 54, 4, 56, 70, 81, 60, 37, 74, 19, 51, 57, 59, 105, 39, 77, 41, 3, 20, 51, 2, 48, 49, 2, 64, 108, 0]</span></span><br><span class="line"><span class="comment">#\!&#123;3Q38(:+0@,3%68FQ&lt;%J39;i&#x27;M)301@l</span></span><br></pre></td></tr></table></figure><p>要注意：</p><ul><li>逆向时位数是6，左移右移和与的值要注意</li><li>py左移时不会溢出</li><li>最后剩了三个要分情况</li></ul><p>得到值</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[92, 33, 123, 51, 81, 51, 56, 40, 58, 43, 48, 64, 22, 44, 51, 37, 54, 4, 56, 70, 81, 60, 37, 74, 19, 51, 57, 59, 105, 39, 77, 41, 3, 20, 51, 2, 48, 49, 2, 64, 108, 0]</span></span><br></pre></td></tr></table></figure><p>最后在上面那个函数rc4</p><p>因为这里是对称加密，直接复制其实就可以了，或者如果会调试sys，直接输入密文就好了</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">otherl = [<span class="number">92</span>, <span class="number">33</span>, <span class="number">123</span>, <span class="number">51</span>, <span class="number">81</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">40</span>, <span class="number">58</span>, <span class="number">43</span>, <span class="number">48</span>, <span class="number">64</span>, <span class="number">22</span>, <span class="number">44</span>, <span class="number">51</span>, <span class="number">37</span>, <span class="number">54</span>, <span class="number">4</span>, <span class="number">56</span>, <span class="number">70</span>, <span class="number">81</span>, <span class="number">60</span>, <span class="number">37</span>, <span class="number">74</span>, <span class="number">19</span>, <span class="number">51</span>, <span class="number">57</span>, <span class="number">59</span>, <span class="number">105</span>, <span class="number">39</span>, <span class="number">77</span>, <span class="number">41</span>, <span class="number">3</span>, <span class="number">20</span>, <span class="number">51</span>, <span class="number">2</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">2</span>, <span class="number">64</span>, <span class="number">108</span>]</span><br><span class="line">k = <span class="string">&#x27;&#x27;</span></span><br><span class="line">p = []</span><br><span class="line">inset = [<span class="number">0</span>]*<span class="number">64</span></span><br><span class="line">S = [<span class="number">0</span>]*<span class="number">64</span></span><br><span class="line">key = <span class="built_in">list</span>(<span class="string">&#x27;the_key_&#x27;</span>)</span><br><span class="line"><span class="comment">#初始化</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    inset[i] = i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    S[i] = <span class="built_in">ord</span>(key[i % <span class="number">8</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    a = (S[i] + inset[i] + a) % <span class="number">64</span></span><br><span class="line">    inset[i],inset[a] = inset[a],inset[i]</span><br><span class="line"></span><br><span class="line">b = c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(otherl)):</span><br><span class="line">    b = (b + <span class="number">1</span>) % <span class="number">64</span>;</span><br><span class="line">    c = (inset[b] + c) % <span class="number">64</span></span><br><span class="line">    inset[b],inset[c] = inset[c],inset[b]</span><br><span class="line">    otherl[i] ^= ((c ^ b) &amp; inset[(((c ^ b) + inset[c] + inset[b]) % <span class="number">64</span>)])</span><br><span class="line">    k += <span class="built_in">chr</span>(otherl[i])</span><br><span class="line">    p.append(otherl[i])</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="comment">#D0g3&#123;608292C4-15400BA4-B3299A5C-0429D&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="你好PE"><a href="#你好PE" class="headerlink" title="你好PE"></a>你好PE</h2><p>ida打开后搜索字符，找不到， 尝试动态调试找到主函数</p><p>最后找到主函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_1005F820</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v1; <span class="comment">// [esp+D0h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1005B16F(&amp;unk_1014000F);</span><br><span class="line">  ((<span class="type">void</span> (__stdcall *)(_DWORD, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>))kernel32_VirtualAlloc)(<span class="number">0</span>, <span class="number">65548</span>, <span class="number">12288</span>, <span class="number">4</span>);</span><br><span class="line">  v1 = (_DWORD *)sub_1005A260();</span><br><span class="line">  <span class="keyword">if</span> ( !v1 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v1[<span class="number">1</span>] = <span class="number">0x10000</span>;</span><br><span class="line">  *v1 = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">2</span>] = v1 + <span class="number">3</span>;</span><br><span class="line">  sub_10059572(v1[<span class="number">2</span>], <span class="number">0</span>, v1[<span class="number">1</span>]);</span><br><span class="line">  sub_10058BC7(<span class="string">&quot;[out]: PLZ Input FLag \n&quot;</span>);</span><br><span class="line">  sub_10058BC7(<span class="string">&quot;[in ]: &quot;</span>);</span><br><span class="line">  sub_100581A4(&amp;unk_10114B68, v1[<span class="number">2</span>]);</span><br><span class="line">  *v1 = sub_1005B5BB(v1[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( *v1 == <span class="number">41</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v1 = <span class="number">48</span>;</span><br><span class="line">    sub_1005A242(v1);</span><br><span class="line">    <span class="keyword">if</span> ( sub_10058AA0(v1[<span class="number">2</span>], &amp;unk_1013C008, <span class="number">48</span>) )</span><br><span class="line">      sub_10058BC7(<span class="string">&quot;[out]: WRONG FLAG\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      sub_10058BC7(<span class="string">&quot;[out]: RIGHT FLAG\n&quot;</span>);</span><br><span class="line">    ((<span class="type">void</span> (__stdcall *)(_DWORD *, _DWORD, <span class="type">int</span>))kernel32_VirtualFree)(v1, <span class="number">0</span>, <span class="number">49152</span>);</span><br><span class="line">    sub_1005A260();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_10058BC7(<span class="string">&quot;[out]: len error\n&quot;</span>);</span><br><span class="line">    ((<span class="type">void</span> (__stdcall *)(_DWORD *, _DWORD, <span class="type">int</span>))kernel32_VirtualFree)(v1, <span class="number">0</span>, <span class="number">49152</span>);</span><br><span class="line">    sub_1005A260();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有两个函数需要注意</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sub_1005A242(v1);</span><br><span class="line"><span class="keyword">if</span> ( sub_10058AA0(v1[<span class="number">2</span>], &amp;unk_1013C008, <span class="number">48</span>) )</span><br></pre></td></tr></table></figure><p>第二个函数进去之后根据逻辑判断</p><p>先比较了前32个值，然后很麻烦的比较了后面的值，反正就是那两个值相等</p><p>也就是说末值就是unk_1013C008</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0x76</span>, <span class="number">0x29</span>, <span class="number">0xF5</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x59</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0xB1</span>, <span class="number">0xC4</span>, <span class="number">0x2F</span>, <span class="number">0x21</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0xB3</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xA8</span>, <span class="number">0xED</span>, <span class="number">0xF7</span>, <span class="number">0xDB</span>, <span class="number">0xE1</span>, <span class="number">0x53</span>, <span class="number">0xF0</span>, <span class="number">0xDB</span>, <span class="number">0xE9</span>, <span class="number">0x03</span>, <span class="number">0x51</span>, <span class="number">0x5E</span>, <span class="number">0x09</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xDF</span>, <span class="number">0xF0</span>, <span class="number">0x96</span>, <span class="number">0xFC</span>, <span class="number">0xC1</span>, <span class="number">0xB5</span>, <span class="number">0xE6</span>, <span class="number">0x62</span>, <span class="number">0x95</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br></pre></td></tr></table></figure><p>第一个应该是加密，用findcrypt搜索一下，搜不出来。。好像在调试的时候搜会很卡，那就直接分析</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_1005F6F0</span><span class="params">(_DWORD *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+D0h] [ebp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-24h]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [esp+E8h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> *v5; <span class="comment">// [esp+F8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1005B16F(&amp;unk_1014000F);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; *a1 &gt;&gt; <span class="number">3</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="type">int</span> *)(a1[<span class="number">2</span>] + <span class="number">8</span> * i);</span><br><span class="line">    v1 = *v5;</span><br><span class="line">    v4 = *(_QWORD *)v5;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">64</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v1) = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">        v4 = qword_1013C000 ^ sub_10059F9F(v1, HIDWORD(v4));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v4 = sub_10059F9F(v1, HIDWORD(v4));</span><br><span class="line">    &#125;</span><br><span class="line">    *(_QWORD *)v5 = v4;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>这啥啊，看不懂。。。</del>最外层循环控制轮数，内层循环控制一轮的加密次数，根据这个来直接写逆向？？</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __usercall <span class="symbol">sub_1005FDE0@<span class="keyword">&lt;eax&gt;</span></span>(__int64 <span class="symbol">pnum@<span class="keyword">&lt;edx:eax&gt;</span></span>, unsigned __int8 <span class="symbol">ahigh@<span class="keyword">&lt;cl&gt;</span></span>)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ahigh &gt;= <span class="number">64</span>u )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v2) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( ahigh &gt;= <span class="number">32</span>u )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v2) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> pnum &lt;&lt; (ahigh &amp; <span class="number">0x1F</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是这里似乎sub_10059F9F(v1, HIDWORD(v4))的位置有问题，是ida反编译的锅，应该是先执行这个再if else</p><p>看汇编窗口：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">debug033:1005FDE0 ; int __usercall sub_1005FDE0@&lt;eax&gt;(__int64 pnum@&lt;edx:eax&gt;, unsigned __int8 ahigh@&lt;cl&gt;)</span><br><span class="line">debug033:1005FDE0 sub_1005FDE0    proc near               ; CODE XREF: cal↑j</span><br><span class="line">debug033:1005FDE0                 cmp     cl, 40h ; &#x27;@&#x27;</span><br><span class="line">debug033:1005FDE3                 jnb     short loc_1005FDFA</span><br><span class="line">debug033:1005FDE5                 cmp     cl, 20h ; &#x27; &#x27;</span><br><span class="line">debug033:1005FDE8                 jnb     short loc_1005FDF0</span><br><span class="line">debug033:1005FDEA                 shld    edx, eax, cl</span><br><span class="line">debug033:1005FDED                 shl     eax, cl</span><br><span class="line">debug033:1005FDEF                 retn</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov     cl, 1  ;在调用cal之前</span><br></pre></td></tr></table></figure><p>这里的cl就是1，和传入无关，最后有一句shl     eax, cl</p><p>shl是<code>双精度左移</code>，这是类似循环左移的操作，即左移，右边的空值由左边溢出的值补充，类似还有shr双精度右移，并没有0x1f</p><p>因此，整体逻辑是：</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">先分组为<span class="number">8</span>字节<span class="built_in">x6</span>组</span><br><span class="line">如果是奇数：与key再左移</span><br><span class="line">如果是偶数：直接左移</span><br><span class="line">得到结果</span><br></pre></td></tr></table></figure><p>所以逆向是</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">分组</span><br><span class="line">如果是奇数：与<span class="built_in">key</span>再右移</span><br><span class="line">如果是偶数：直接右移</span><br></pre></td></tr></table></figure><p>同时可以知道的是，</p><p>如果是奇数右移，左边应该补1</p><p>如果是偶数右移，左边不用补</p><p>那么逆向：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0x76</span>, <span class="number">0x29</span>, <span class="number">0xF5</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x59</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0xB1</span>, <span class="number">0xC4</span>, <span class="number">0x2F</span>, <span class="number">0x21</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0xB3</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xA8</span>, <span class="number">0xED</span>, <span class="number">0xF7</span>, <span class="number">0xDB</span>, <span class="number">0xE1</span>, <span class="number">0x53</span>, <span class="number">0xF0</span>, <span class="number">0xDB</span>, <span class="number">0xE9</span>, <span class="number">0x03</span>, <span class="number">0x51</span>, <span class="number">0x5E</span>, <span class="number">0x09</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xDF</span>, <span class="number">0xF0</span>, <span class="number">0x96</span>, <span class="number">0xFC</span>, <span class="number">0xC1</span>, <span class="number">0xB5</span>, <span class="number">0xE6</span>, <span class="number">0x62</span>, <span class="number">0x95</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">q = [<span class="number">0x599EA9F52976B84D</span>, <span class="number">0x302C212FC4B15655</span>, <span class="number">0xDBF7EDA8177879B3</span>, <span class="number">0x5E5103E9DBF053E1</span>, <span class="number">0xC1FC96F0DF00C109</span>, <span class="number">0x000000019562E6B5</span>]</span><br><span class="line">key = <span class="number">0x54AA4A9</span></span><br><span class="line">k=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span> (q[i] &amp; <span class="number">1</span>):</span><br><span class="line">            q[i] = (q[i] ^ key) &gt;&gt; <span class="number">1</span></span><br><span class="line">            q[i] |= <span class="number">0x8000000000000000</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            q[i] = (q[i] &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    k.append(<span class="built_in">hex</span>(q[i]))</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"><span class="comment">#[&#x27;0x4530367b33673044&#x27;, &#x27;0x37352d4132374531&#x27;, &#x27;0x372d304642384136&#x27;, &#x27;0x2d39424243313037&#x27;, &#x27;0x4345353134323042&#x27;, &#x27;0x7d&#x27;]</span></span><br></pre></td></tr></table></figure><p>逆序，转hex，按字符逆序</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">D0g3</span>&#123;<span class="number">60</span>E1E72A-<span class="number">576</span>A8BF0-<span class="number">7701</span>CBB9-B02415EC&#125;</span><br></pre></td></tr></table></figure><h2 id="你见过蓝色的小鲸鱼吗"><a href="#你见过蓝色的小鲸鱼吗" class="headerlink" title="你见过蓝色的小鲸鱼吗"></a>你见过蓝色的小鲸鱼吗</h2><p>打开文件后，发现是win程序，说明进入主窗口程序和判断函数不一定在一个位置 </p><p>所以打开后需要找到判断代码，搜索string无效</p><p>根据弹窗函数是MessageBox，尝试搜索</p><p>然后找到判断函数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __thiscall <span class="title function_">lastcall</span><span class="params">(<span class="type">void</span> *this)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> wrong[<span class="number">28</span>]; <span class="comment">// [esp+D0h] [ebp-54h] BYREF</span></span><br><span class="line">  CHAR yes[<span class="number">20</span>]; <span class="comment">// [esp+ECh] [ebp-38h] BYREF</span></span><br><span class="line">  CHAR Caption[<span class="number">24</span>]; <span class="comment">// [esp+100h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+118h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = this;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52102F);</span><br><span class="line">  <span class="built_in">strcpy</span>(Caption, <span class="string">&quot;tip&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(yes, <span class="string">&quot;You Get It!&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(wrong, <span class="string">&quot;Wrong user/passwd&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v5 + <span class="number">2</span>) != *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    || j__memcmp(*(<span class="type">const</span> <span class="type">void</span> **)v5, *((<span class="type">const</span> <span class="type">void</span> **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, wrong, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, yes, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的v5+2和v5+3一定指向一个是输入（可能加密了），另一个说不准，因为有一个密码一个用户名</p><p>由于需要进入else分支，所以条件必须为假</p><p>即：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*((_DWORD *)v5 + <span class="number">2</span>) == *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    &amp;&amp; ！j__memcmp<span class="comment">(*(const void **)</span>v5, *((<span class="keyword">const</span> void **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>既然如此，需要找出能改变v5+2和+3的地址的函数（修改了this），向上找：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *v6; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *lpString; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> WindowTextLengthA; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  WindowTextLengthA = GetWindowTextLengthA(hWnd);</span><br><span class="line">  v10 = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  lpString = (CHAR *)j__malloc(__CFADD__(WindowTextLengthA, <span class="number">16</span>) ? <span class="number">-1</span> : WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(v10, <span class="number">16</span>) ? <span class="number">-1</span> : v10 + <span class="number">16</span>);</span><br><span class="line">  v6 = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( lpString &amp;&amp; result )</span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, lpString, WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">    GetWindowTextA(DlgItem, v6, v10 + <span class="number">16</span>);</span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);</span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;unk_51D38C, <span class="number">0x10</span>u);</span><br><span class="line">    sub_45126F(lpString, WindowTextLengthA, (<span class="type">int</span>)v6, v10);</span><br><span class="line">    j_lastcall(v4);</span><br><span class="line">    j__free(lpString);</span><br><span class="line">    j__free(v6);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>动调可知：第一个是用户名，第二个是密码</p><p>化简：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *password; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *username; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> lenOFpass; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> lenOFname; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  lenOFname = GetWindowTextLengthA(hWnd);</span><br><span class="line">  lenOFpass = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  username = (CHAR *)j__malloc(__CFADD__(lenOFname, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFname + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(lenOFpass, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFpass + <span class="number">16</span>);</span><br><span class="line">  password = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( username &amp;&amp; result )                     <span class="comment">// 检查空指针</span></span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, username, lenOFname + <span class="number">16</span>);<span class="comment">// 用户名</span></span><br><span class="line">    GetWindowTextA(DlgItem, password, lenOFpass + <span class="number">16</span>);<span class="comment">// 密码</span></span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);                        <span class="comment">// 分配内存</span></span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);              <span class="comment">// 初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;specialloc, <span class="number">0x10</span>u);             <span class="comment">// 初始化对象</span></span><br><span class="line">    encode(username, lenOFname, (<span class="type">int</span>)password, lenOFpass);</span><br><span class="line">    j_lastcall(v4);                             <span class="comment">// 判断</span></span><br><span class="line">    j__free(username);</span><br><span class="line">    j__free(password);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后面实在分析不出来了，里面有一些涉及c++的理解的,所以看看wp</p><p>在后面有加密函数，用插件findcrypt可以直接看出来是blowfish</p><p>在cmp时下断点buf1就是最后的值</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11A51F049550E2508F17E16CF1632B47</span><br></pre></td></tr></table></figure><p>写blowfish的解密：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Blowfish</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文（以十六进制表示）</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;11A51F049550E2508F17E16CF1632B47&quot;</span></span><br><span class="line">ciphertext = binascii.unhexlify(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥（简单字符串）</span></span><br><span class="line">key = <span class="string">&quot;UzBtZTBuZV9EMGcz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Blowfish ECB模式的解密器</span></span><br><span class="line">cipher = Blowfish.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>), Blowfish.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plaintext_bytes = cipher.decrypt(ciphertext)</span><br><span class="line">plaintext = plaintext_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"><span class="comment">#QHRoZWJsdWVmMXNo</span></span><br></pre></td></tr></table></figure><p>这个答案是个base64，解密后是@thebluef1sh</p><p>（和蓝鲸的唯一关系吗。。。）</p><p>所以</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">D0g3</span><span class="template-variable">&#123;UzBtZTBuZV9EMGczQHRoZWJsdWVmMXNo&#125;</span></span><br></pre></td></tr></table></figure><hr><p>写完啦，</p><p>如有错误，请在下方评论区写下您的想法。感谢！</p><details class="folding-tag" ><summary> 题目下载 </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="(百度网盘)" href="https://pan.baidu.com/s/1XAZU4ED-xjuUVUno-Kx81Q?pwd=Game"><div class="left"><img src="/assets/coffee.png"/></div><div class="right"><p class="text">(百度网盘)</p><p class="url">https://pan.baidu.com/s/1XAZU4ED-xjuUVUno-Kx81Q?pwd=Game</p></div></a></div><p>解压密码:</p><p>pRism</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录(2)</title>
      <link href="/posts/8f76d0c7.html"/>
      <url>/posts/8f76d0c7.html</url>
      
        <content type="html"><![CDATA[<h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h2 id="NSSRound-4-SWPU-hide-and-seek"><a href="#NSSRound-4-SWPU-hide-and-seek" class="headerlink" title="[NSSRound#4 SWPU]hide_and_seek"></a>[NSSRound#4 SWPU]hide_and_seek</h2><p>打开调试后，发现有反调试，把一开始的exit给nop掉</p><p>然后调试跳到后面发现有flag：SCTF{wud3_0n@,34p}</p><p>但是结果不对？？</p><p>再次调试，在hex视图中alt+t搜索NSSCTF，发现flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;h1d3_0n_h34p&#125;</span></span><br></pre></td></tr></table></figure><h2 id="NSSRound-X-Basic-ez-z3"><a href="#NSSRound-X-Basic-ez-z3" class="headerlink" title="[NSSRound#X Basic]ez_z3"></a>[NSSRound#X Basic]ez_z3</h2><p>先用die查壳，发现是upx，尝试用upx-d脱壳，然后失败，应该是改过什么东西，打开ida看看，结果发现节区名从UPX变成了XYU，所以尝试还原，还原后还是失败，在03E0处还需修改为UPX，这次UPX-d成功，参考<a href="https://www.52pojie.cn/thread-326995-1-1.html">UPX防脱壳机脱壳、去除特征码、添加花指令小探 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p><p>打开ida查看main函数并尝试调试</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Please input the flag:<span class="number">1212121</span></span><br><span class="line">Can you calculated out z3?</span><br><span class="line">Please input z3:<span class="number">121212</span></span><br><span class="line">YOU are wrong</span><br><span class="line">oh no!!!!!your flag is wrong,try again</span><br></pre></td></tr></table></figure><p>main函数大致逻辑：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(std::cout, <span class="string">&quot;Please input the flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">getin</span>(std::cin, flag);</span><br><span class="line">  v3 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;Can you calculated out z3?&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, guessNoUse);</span><br><span class="line">  <span class="built_in">print</span>(std::cout, <span class="string">&quot;Please input z3:&quot;</span>);</span><br><span class="line">  <span class="built_in">getin</span>(std::cin, z3num);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(flag); ++i )</span><br><span class="line">    storn[i] = <span class="built_in">change</span>(flag[i], exenum[i]);</span><br><span class="line">  <span class="built_in">z3check1</span>(z3num);</span><br><span class="line">  <span class="built_in">z3check2</span>(z3num);</span><br><span class="line">  check = <span class="built_in">sub_7FF7CCBC10E6</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> ( check == <span class="number">1</span> )</span><br><span class="line">    v4 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;yeah!!!!!!you get the flag&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;oh no!!!!!your flag is wrong,try again&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, guessNoUse);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据流程大致是先对flag变换为k，然后检测输入一个z3序列是否满足条件，然后让z3序列和k变换，检查最后结果</p><p>那么先找到z3num：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个求解器实例</span></span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个整数变量的数组，用于存储z3num中的值</span></span><br><span class="line">z3num = [Int(<span class="string">f&#x27;z3num[<span class="subst">&#123;i&#125;</span>]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> z3num:</span><br><span class="line">    f.add(num &gt;= <span class="number">0</span>)</span><br><span class="line">    f.add(num &lt;= <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2582239</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - (<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">      + <span class="number">17</span> * z3num[<span class="number">16</span>]) == <span class="number">2602741</span>)</span><br><span class="line">f.add(<span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>] * <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>] * <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>] * <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">2668123</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + (<span class="number">13</span> * z3num[<span class="number">12</span>] + <span class="number">11</span> * z3num[<span class="number">10</span>] - <span class="number">12</span> * z3num[<span class="number">11</span>]) * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2520193</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>] * <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">8904587</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>] * <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * (<span class="number">13</span> * z3num[<span class="number">12</span>] + <span class="number">12</span> * z3num[<span class="number">11</span>] - <span class="number">14</span> * z3num[<span class="number">13</span>] - <span class="number">15</span> * z3num[<span class="number">14</span>])</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">1227620874</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>] * <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">1836606059</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">8720560</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span></span><br><span class="line">     * z3num[<span class="number">10</span>]</span><br><span class="line">     * (<span class="number">10</span> * z3num[<span class="number">9</span>] + <span class="number">30</span> * z3num[<span class="number">5</span>] + <span class="number">5</span> * z3num[<span class="number">4</span>] + <span class="number">4</span> * z3num[<span class="number">3</span>] - <span class="number">7</span> * z3num[<span class="number">6</span>] + <span class="number">8</span> * z3num[<span class="number">7</span>] - <span class="number">9</span> * z3num[<span class="number">8</span>])</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - (<span class="number">16</span> * z3num[<span class="number">15</span>] - <span class="number">17</span> * z3num[<span class="number">16</span>] - <span class="number">18</span> * z3num[<span class="number">17</span>]) * <span class="number">15</span> * z3num[<span class="number">14</span>] == <span class="number">11387045</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">7660269</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - (<span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">      - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">      - <span class="number">30</span> * z3num[<span class="number">5</span>])</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2461883</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>] * <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == -<span class="number">966296</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + (<span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">      + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">      + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">      + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">      + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">      - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">      + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">      - <span class="number">9</span> * z3num[<span class="number">8</span>])</span><br><span class="line">     * <span class="number">2</span></span><br><span class="line">     * z3num[<span class="number">1</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>] == <span class="number">254500223</span>)</span><br><span class="line">f.add(<span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>] * <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">6022286</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>] * <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == -<span class="number">636956022</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">10631829</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">15</span> * z3num[<span class="number">14</span>] * <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + (<span class="number">4</span> * z3num[<span class="number">3</span>] - <span class="number">5</span> * z3num[<span class="number">4</span>] - <span class="number">30</span> * z3num[<span class="number">5</span>]) * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] == <span class="number">6191333</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>] * <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>] * <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] * <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>] == <span class="number">890415359</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>]</span><br><span class="line">     + <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>] == <span class="number">23493664</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>] * <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">1967260144</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.check())</span><br><span class="line"><span class="keyword">while</span> (f.check()==sat):</span><br><span class="line">    condition = []</span><br><span class="line">    m = f.model()</span><br><span class="line">    p =<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">20</span>):</span><br><span class="line">        p += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&quot;%s&quot;</span> % (m[z3num[i]])))</span><br><span class="line">        condition.append(z3num[i]!=<span class="built_in">int</span>(<span class="string">&quot;%s&quot;</span> % (m[z3num[i]])))</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    f.add(Or(condition))</span><br><span class="line">    <span class="comment">#hahahathisisfackflag</span></span><br></pre></td></tr></table></figure><p>这里奇怪的是一开始用或逻辑解不出来正确值，但是把所有都与之后却可以得到正确的结果，同时这个不是flag是中间用做加密的值</p><p>又因为后来的算法是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_7FF7CCBC4830</span><span class="params">(<span class="type">char</span> *z3num)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, v1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; j_strlen(flag); ++i )</span><br><span class="line">    last[i] = z3num[j_strlen(flag) - i - <span class="number">1</span>] ^ storn[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后的检查是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">sub_7FF7CCBC4770</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">size_t</span> len; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, v1);</span><br><span class="line">  zer0 = <span class="number">0</span>;</span><br><span class="line">  len = j_strlen(flag);</span><br><span class="line">  <span class="keyword">if</span> ( len )</span><br><span class="line">    <span class="keyword">return</span> last[zer0] == strange_num[zer0];     <span class="comment">// 前两位相等，因为是DWORD</span></span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个可能错了什么，可能前两位相等相当于全部相等。</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0x00001207</span>, <span class="number">0</span>x00004CA0, <span class="number">0x00004F21</span>, <span class="number">0x00000039</span>, <span class="number">0</span>x<span class="number">0001A523</span>, <span class="number">0</span>x0000023A, <span class="number">0x00000926</span>, <span class="number">0</span>x00004CA7, <span class="number">0x00006560</span>, <span class="number">0x00000036</span>, <span class="number">0</span>x0001A99B, <span class="number">0</span>x00004CA8, <span class="number">0</span>x0001BBE0, <span class="number">0x00003705</span>, <span class="number">0x00000926</span>, <span class="number">0</span>x<span class="number">000077D3</span>, <span class="number">0x00009A98</span>, <span class="number">0</span>x0000657B, <span class="number">0x00000018</span>, <span class="number">0x00000B11</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br></pre></td></tr></table></figure><p>前面的变换是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">change2</span><span class="params">(<span class="type">int</span> flag, __int64 exenum)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> a; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> exei; <span class="comment">// [rsp+148h] [rbp+128h]</span></span><br><span class="line"></span><br><span class="line">  exei = exenum;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, exenum);</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( exei )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (exei &amp; <span class="number">1</span>) != <span class="number">0</span> )                      <span class="comment">// exenum这一位是奇数</span></span><br><span class="line">      a *= flag;</span><br><span class="line">    flag = flag * flag % <span class="number">1000</span>;</span><br><span class="line">    exei &gt;&gt;= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">exe = [<span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x7</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x1207</span>, <span class="number">0x4CA0</span>, <span class="number">0x4F21</span>, <span class="number">0x0039</span>, <span class="number">0x1A523</span>, <span class="number">0x023A</span>, <span class="number">0x0926</span>, <span class="number">0x4CA7</span>, <span class="number">0x6560</span>, <span class="number">0x0036</span>, <span class="number">0x1A99B</span>, <span class="number">0x4CA8</span>, <span class="number">0x1BBE0</span>, <span class="number">0x3705</span>, <span class="number">0x0926</span>, <span class="number">0x77D3</span>, <span class="number">0x9A98</span>, <span class="number">0x657B</span>, <span class="number">0x0018</span>, <span class="number">0x0B11</span>]</span><br><span class="line"></span><br><span class="line">z3num = <span class="built_in">list</span>(<span class="string">&#x27;hahahathisisfackflag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">stron = [<span class="number">0</span>]*<span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range (<span class="number">20</span>):</span><br><span class="line">    stron[i] = ord(z3num[<span class="number">19</span> - i]) ^ last[i]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">20</span></span><br><span class="line">def po(flag,b):</span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (b):</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span> != <span class="number">0</span>):</span><br><span class="line">            a *= flag</span><br><span class="line">        flag = flag * flag % <span class="number">1000</span></span><br><span class="line">        b &gt;&gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">20</span>): </span><br><span class="line">    <span class="keyword">for</span> chrr in range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> (po(chrr,exe[i]) == stron[i]):</span><br><span class="line">            flag[i] = chr(chrr)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;.join(flag))</span></span><br><span class="line"><span class="string">#T1e_z3_1s_v1r9_3asy!</span></span><br></pre></td></tr></table></figure><p>爆破得出答案</p><p>总结：</p><p>z3遇到或时计算非常慢，用bitvec型或把或逻辑改成与加快速度</p><p>最后一步遇到不好逆向的也不好z3的，可以用爆破求解因为字符一定在32到127</p><p>一个疑问是：最后一步的b都是一位数，说明a一定是1或者flag的值，stron里面就应该是这个数为什么stron里不是呢</p><h2 id="NSSCTF-2nd-MyBase"><a href="#NSSCTF-2nd-MyBase" class="headerlink" title="[NSSCTF 2nd]MyBase"></a>[NSSCTF 2nd]MyBase</h2><p>打开ida后发现有tls，需要注意一下</p><p>ida打开之后</p><p>main函数有两个子函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _main();</span><br><span class="line">  test();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先调试看看有没有反调试，然后发现并没有</p><p>第一个_main看不懂，直接进test，里面有一个base64</p><p>打开后根据码表直接解密，但是解不出来。。</p><p>去data里面看看，发现还有码表，进交叉引用的函数发现有一个打乱的代码</p><p>是个c语言函数，有srand函数，所以调试把他找出来</p><p>真：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">YsVO0tvT2o4puZ38j1dwf7MArGPNeQLDRHUK</span>+SChbFanmklWEcgixXJIq6y5B/<span class="number">9</span>z</span><br></pre></td></tr></table></figure><p>一开始加密的：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+86420ywusqomkigecaYWUSQOMKIGECABDFHJLNPRTVXZbdfhjlnprtvxz13579/</span></span><br></pre></td></tr></table></figure><hr><p>然后发现这个打乱代码执行了很多次</p><p>感觉哪里漏了，最后查找交叉引用发现打乱代码在加密里面有一行：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> ( !setjmp(env) )</span><br><span class="line">    exception_handler();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>经过查阅：</p><p>setjmp和longjmp成对使用实现函数间跳转</p><p>setjmp将函数在此处的上下文保存在jmp_buf结构体中，以供longjmp从此结构体中恢复</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setjmp</span><span class="params">(jmp_buf env)</span>;</span><br></pre></td></tr></table></figure><p>env为保存的结构体变量的位置，若直接调用返回0，否则返回非0（主要指通过longjmp跳转）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">longjmp</span><span class="params">(jmp_buf env, <span class="type">int</span> val)</span>;</span><br></pre></td></tr></table></figure><p>env为由setjmp保存的上下文，val表示longjmp传给setjmp的返回值，如果val&#x3D;0，则setjmp返回1，否则返回val</p><p>longjmp 不直接返回，而是从 setjmp 函数中返回，longjmp 执行完之后，程序就像刚从 setjmp 函数返回一样。</p><p>所以；</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !setjmp(env) )</span><br><span class="line">      exception_handler();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>这段代码先执行setjmp(env)，返回0</p><p>进入exception_handler();</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">exception_handler</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  generate_base64_table(base64_table);</span><br><span class="line">  longjmp_0(env, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后更新base64码表</p><p>所以逻辑是：</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">对第一组加密</span><br><span class="line">更新</span><br><span class="line">对第二组加密</span><br><span class="line">更新</span><br><span class="line">对第三组加密</span><br><span class="line">更新</span><br><span class="line"><span class="meta prompt_">...</span></span><br></pre></td></tr></table></figure><p>所以密文</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">YkLY</span></span><br><span class="line"><span class="symbol">v1Xj</span></span><br><span class="line"><span class="number">23</span><span class="built_in">X7</span></span><br><span class="line"><span class="symbol">N0E5</span></span><br><span class="line"><span class="symbol">eoFg</span></span><br><span class="line"><span class="symbol">UveK</span></span><br><span class="line"><span class="symbol">eos1</span></span><br><span class="line"><span class="symbol">XS8K</span></span><br><span class="line"><span class="number">9</span>r4g</span><br></pre></td></tr></table></figure><p>码表</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+86420ywusqomkigecaYWUSQOMKIGECABDFHJLNPRTVXZbdfhjlnprtvxz13579/</span><br><span class="line">YsVO0tvT2o4puZ38j1dwf7MArGPNeQLDRHUK+SChbFanmklWEcgixXJIq6y5B/9z</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br></pre></td></tr></table></figure><p>然后看了半天</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v10 = (bbb &lt;&lt; <span class="number">8</span>) + (aa &lt;&lt; <span class="number">16</span>) + cc;</span><br><span class="line">    basenum[v14] = base64_table[cc &amp; <span class="number">0x3F</span>];</span><br><span class="line">    basenum[v14 + <span class="number">1</span>] = base64_table[(v10 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    basenum[v14 + <span class="number">2</span>] = base64_table[(v10 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br></pre></td></tr></table></figure><p>发现是倒序输出</p><p>那么就直接倒序解码：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">YLkY</span><br><span class="line">jX1v</span><br><span class="line"><span class="number">7</span>X32</span><br><span class="line"><span class="number">5E0</span>N</span><br><span class="line">gFoe</span><br><span class="line">KevU   T0_</span><br><span class="line"><span class="number">1</span>soe   Re_</span><br><span class="line">K8SX</span><br><span class="line">g4r9   <span class="keyword">ld</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;Welc0me_T0_Re_World&#125;</span></span><br></pre></td></tr></table></figure><h2 id="NSSRound-3-Team-jump-by-jump-revenge"><a href="#NSSRound-3-Team-jump-by-jump-revenge" class="headerlink" title="[NSSRound#3 Team]jump_by_jump_revenge"></a>[NSSRound#3 Team]jump_by_jump_revenge</h2><p>打开后发现main函数不能反编译，感觉有花指令</p><p>然后nop掉两行代码</p><p>获得正确的main</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+D0h] [ebp-40h]</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">36</span>]; <span class="comment">// [esp+E8h] [ebp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_411037(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>)Str1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">29</span>; ++i )</span><br><span class="line">    Str1[i] = (Str1[i] + Str1[(i * i + <span class="number">123</span>) % <span class="number">21</span>]) % <span class="number">96</span> + <span class="number">32</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !j_strcmp(Str1, <span class="string">&quot;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&quot;</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;nope!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个算法要注意要从后面往前，因为前面的已经被覆盖了</p><p>非常抽象（TAT）</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">last = <span class="string">&quot;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&quot;</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">29</span></span><br><span class="line">c = [<span class="number">0</span>]*<span class="number">29</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    c[i] = (i * i + <span class="number">123</span>) % <span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#flag[i] = (flag[i] + flag[c[i]]) % 96 + 32</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt; c[i]):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            uuk = (<span class="built_in">ord</span>(last[i])-<span class="number">32</span>)+ j * <span class="number">96</span> -<span class="built_in">ord</span>(last[c[i]])</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">31</span>&lt; uuk &lt; <span class="number">127</span>):</span><br><span class="line">                flag[i]=uuk</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            uuk = (<span class="built_in">ord</span>(last[i])-<span class="number">32</span>)+ j * <span class="number">96</span> -flag[c[i]]</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">31</span>&lt; uuk &lt; <span class="number">127</span>):</span><br><span class="line">                flag[i]=uuk</span><br><span class="line">u = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    u += <span class="built_in">chr</span>(flag[i])</span><br><span class="line"><span class="built_in">print</span>(u) </span><br><span class="line"><span class="comment">#NSSCTF&#123;Jump_b9_jump!_r3V3n9e&#125;</span></span><br></pre></td></tr></table></figure><p>总结：逆向加密算法时要注意是递推式的还是映射式的</p><p>看了看大佬的wp，好简洁：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ciper=<span class="string">&#x27;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(len(ciper)<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    tmp=ord(ciper[i])<span class="number">-32</span>-ord(ciper[(i*i+<span class="number">123</span>)%<span class="number">21</span>])</span><br><span class="line">    <span class="keyword">while</span>(tmp&lt;<span class="number">33</span>):</span><br><span class="line">        tmp+=<span class="number">96</span></span><br><span class="line">    ciper=ciper[:i]+chr(tmp)+ciper[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">print(ciper)</span><br></pre></td></tr></table></figure><h2 id="NSSRound-2-Able-findxenny"><a href="#NSSRound-2-Able-findxenny" class="headerlink" title="[NSSRound#2 Able]findxenny"></a>[NSSRound#2 Able]findxenny</h2><p>打开main函数看看，对输入的flag的检查的函数返回值是本身？？没理解暂时跳过，看到最后的检查有三个check</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check1</span>(*v14) || (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check2</span>(*v15) || (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check3</span>(*v16) )</span><br><span class="line">   &#123;</span><br><span class="line">     v10 = <span class="built_in">sub_7FF72A641262</span>(std::cout, <span class="string">&quot;Try harder&quot;</span>);</span><br><span class="line">     std::ostream::<span class="keyword">operator</span>&lt;&lt;(v10, sub_7FF72A6411FE);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">     v9 = <span class="built_in">sub_7FF72A641262</span>(std::cout, <span class="string">&quot;I can&#x27;t believe my golden doge eye! we are comarde!&quot;</span>);</span><br><span class="line">     std::ostream::<span class="keyword">operator</span>&lt;&lt;(v9, sub_7FF72A6411FE);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>打开之后是一组数，通过交叉引用查看这个数据是通过函数生成的，但是没看懂。。。</p><p>看了wp发现这个是SMC，三个check是函数，双击进入对应地址，发现都是数据，这时要c加p组合再f5进入反编译结果检查的值就在这里</p><p><img src="https://s2.loli.net/2023/12/27/o82P7AFzawI6l49.png" alt="image-20231227230725460"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBE97370</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">0x665F756F795F686F</span>i64 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBEA01C0</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v3[<span class="number">2</span>]; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v4[<span class="number">12</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">0</span>] = a1;</span><br><span class="line">  qmemcpy(v4, <span class="string">&quot;ound_our&quot;</span>, <span class="number">8</span>);</span><br><span class="line">  v1 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v3 + v1) == *((_BYTE *)v4 + v1) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v1 &gt;= <span class="number">8</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBE999B4</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">0x796E6E33785F</span>i64 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接得出结果</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oh_you_fou<span class="symbol">nd_our_x3</span><span class="symbol">nny</span></span><br></pre></td></tr></table></figure><p>总结，如果看到virtulprotect和数据当作地址，尝试把数据改成代码</p><h2 id="NSSCTF-2nd-Bytecode"><a href="#NSSCTF-2nd-Bytecode" class="headerlink" title="[NSSCTF 2nd]Bytecode"></a>[NSSCTF 2nd]Bytecode</h2><p>打开后，是py字节码</p><p>反编译一下</p><h1 id="安洵杯"><a href="#安洵杯" class="headerlink" title="安洵杯"></a>安洵杯</h1><h2 id="mobilego"><a href="#mobilego" class="headerlink" title="mobilego"></a>mobilego</h2><p>jadx打开mainactivity</p><p>模拟器中尝试输入，返回nonono</p><p>发现判断函数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> m141lambda$onCreate$<span class="number">0</span>$comexamplemobilegoMainActivity(View v) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Game.checkflag(<span class="built_in">this</span>.editText.getText().toString()).equals(getResources().getString(C0569R.string.cmp))) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;yes your flag is right&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;No No No&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在C0569R中有</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">string</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">app_name</span> <span class="operator">=</span> <span class="number">2131689500</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> <span class="number">2131689512</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的cmp是它的id值而不是它的具体值</p><p>所以动态调试找到终值</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>这里使用了Game.checkflag来加密</p><p>所以先看这个</p><p>根据game</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> p004go.Seq;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Game</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">_init</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">checkflag</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Seq.touch();</span><br><span class="line">        _init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Game</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">touch</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>怀疑checkflag是通过lib加载的</p><p>打开ida，反汇编so文件</p><p>搜索checkflag</p><p>找到5个函数</p><p><img src="https://s2.loli.net/2023/12/28/Z4TbAVSxCklJaOB.png" alt="image-20231228150946781"></p><p>函数是这几个</p><p>好复杂，看不懂。。</p><p>看了看wp，发现一个一直没注意的东西，如果输入</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1234567890</span>变为<span class="number">6143580927</span>，</span><br><span class="line">&#123;qwertyuiopasdfghjklzxcvbnm&#125;变为bhgsruc&#123;iojqkdpwnezyvxa&#125;lfmt</span><br></pre></td></tr></table></figure><p>说明这只是字符交换，交换之后是</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>一共38个字符</p><p>那么尝试输入</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t<span class="number">2</span>F<span class="number">7</span>GTglISYL<span class="symbol">nMzc6</span>CqhD<span class="symbol">N5</span>OdX<span class="number">8</span>wPjsKufVbE&#125;</span><br></pre></td></tr></table></figure><p>变为</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC</span><br></pre></td></tr></table></figure><p>根据这个对应关系，逆向解出原来的关系</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">d1 = <span class="string">&#x27;t2F7GTglISYLnMzc6CqhDN5OdX8wPjsKufVbE&#125;&#x27;</span></span><br><span class="line">d2 = <span class="string">&#x27;NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC&#x27;</span></span><br><span class="line"></span><br><span class="line">f2 = <span class="string">&#x27;49021&#125;5f919038b440139g74b7Dc88330e5d&#123;6&#x27;</span></span><br><span class="line">f1 = <span class="selector-attr">[0]</span>*<span class="number">38</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">        <span class="keyword">if</span> (d2<span class="selector-attr">[j]</span> == d1<span class="selector-attr">[i]</span>):</span><br><span class="line">            f1<span class="selector-attr">[i]</span> = f2<span class="selector-attr">[j]</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&#x27;&#x27;</span>.join(f1)</span></span>)</span><br><span class="line">#D0g3&#123;<span class="number">4</span>c3b5903d11461f94478b7302980e958&#125;</span><br></pre></td></tr></table></figure><p>总结：</p><p>猜测输入时尽量使用有规律的字符，更容易看清</p><p>如果不容易逆向可以尝试看或者猜</p><h2 id="你见过蓝色的小鲸鱼吗"><a href="#你见过蓝色的小鲸鱼吗" class="headerlink" title="你见过蓝色的小鲸鱼吗"></a>你见过蓝色的小鲸鱼吗</h2><p>打开文件后，发现是win程序，说明进入主窗口程序和判断函数不一定在一个位置 </p><p>所以打开后需要找到判断代码，搜索string无效</p><p>根据弹窗函数是MessageBox，尝试搜索</p><p>然后找到判断函数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __thiscall <span class="title function_">lastcall</span><span class="params">(<span class="type">void</span> *this)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> wrong[<span class="number">28</span>]; <span class="comment">// [esp+D0h] [ebp-54h] BYREF</span></span><br><span class="line">  CHAR yes[<span class="number">20</span>]; <span class="comment">// [esp+ECh] [ebp-38h] BYREF</span></span><br><span class="line">  CHAR Caption[<span class="number">24</span>]; <span class="comment">// [esp+100h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+118h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = this;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52102F);</span><br><span class="line">  <span class="built_in">strcpy</span>(Caption, <span class="string">&quot;tip&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(yes, <span class="string">&quot;You Get It!&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(wrong, <span class="string">&quot;Wrong user/passwd&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v5 + <span class="number">2</span>) != *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    || j__memcmp(*(<span class="type">const</span> <span class="type">void</span> **)v5, *((<span class="type">const</span> <span class="type">void</span> **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, wrong, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, yes, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的v5+2和v5+3一定指向一个是输入（可能加密了），另一个说不准，因为有一个密码一个用户名</p><p>由于需要进入else分支，所以条件必须为假</p><p>即：</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*((_DWORD *)v5 + <span class="number">2</span>) == *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    &amp;&amp; ！j__memcmp<span class="comment">(*(const void **)</span>v5, *((<span class="keyword">const</span> void **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>既然如此，需要找出能改变v5+2和+3的地址的函数（修改了this），向上找：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *v6; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *lpString; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> WindowTextLengthA; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  WindowTextLengthA = GetWindowTextLengthA(hWnd);</span><br><span class="line">  v10 = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  lpString = (CHAR *)j__malloc(__CFADD__(WindowTextLengthA, <span class="number">16</span>) ? <span class="number">-1</span> : WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(v10, <span class="number">16</span>) ? <span class="number">-1</span> : v10 + <span class="number">16</span>);</span><br><span class="line">  v6 = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( lpString &amp;&amp; result )</span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, lpString, WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">    GetWindowTextA(DlgItem, v6, v10 + <span class="number">16</span>);</span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);</span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;unk_51D38C, <span class="number">0x10</span>u);</span><br><span class="line">    sub_45126F(lpString, WindowTextLengthA, (<span class="type">int</span>)v6, v10);</span><br><span class="line">    j_lastcall(v4);</span><br><span class="line">    j__free(lpString);</span><br><span class="line">    j__free(v6);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>动调可知：第一个是用户名，第二个是密码</p><p>化简：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *password; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *username; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> lenOFpass; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> lenOFname; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  lenOFname = GetWindowTextLengthA(hWnd);</span><br><span class="line">  lenOFpass = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  username = (CHAR *)j__malloc(__CFADD__(lenOFname, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFname + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(lenOFpass, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFpass + <span class="number">16</span>);</span><br><span class="line">  password = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( username &amp;&amp; result )                     <span class="comment">// 检查空指针</span></span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, username, lenOFname + <span class="number">16</span>);<span class="comment">// 用户名</span></span><br><span class="line">    GetWindowTextA(DlgItem, password, lenOFpass + <span class="number">16</span>);<span class="comment">// 密码</span></span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);                        <span class="comment">// 分配内存</span></span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);              <span class="comment">// 初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;specialloc, <span class="number">0x10</span>u);             <span class="comment">// 初始化对象</span></span><br><span class="line">    encode(username, lenOFname, (<span class="type">int</span>)password, lenOFpass);</span><br><span class="line">    j_lastcall(v4);                             <span class="comment">// 判断</span></span><br><span class="line">    j__free(username);</span><br><span class="line">    j__free(password);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后面实在分析不出来了，里面有一些涉及c++的理解的</p><p>在后面有加密函数是blowfish</p><p>在cmp时下断点buf1就是最后的值</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11A51F049550E2508F17E16CF1632B47</span><br></pre></td></tr></table></figure><p>写blowfish的解密：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Blowfish</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文（以十六进制表示）</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;11A51F049550E2508F17E16CF1632B47&quot;</span></span><br><span class="line">ciphertext = binascii.unhexlify(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥（简单字符串）</span></span><br><span class="line">key = <span class="string">&quot;UzBtZTBuZV9EMGcz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Blowfish ECB模式的解密器</span></span><br><span class="line">cipher = Blowfish.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>), Blowfish.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plaintext_bytes = cipher.decrypt(ciphertext)</span><br><span class="line">plaintext = plaintext_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"><span class="comment">#QHRoZWJsdWVmMXNo</span></span><br></pre></td></tr></table></figure><p>这个答案是个base64，解密后是@thebluef1sh</p><p>（和蓝鲸的唯一关系吗。。。）</p><p>所以</p><p>D0g3{UzBtZTBuZV9EMGczQHRoZWJsdWVmMXNo}</p>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>符号执行简介</title>
      <link href="/posts/54c80afd.html"/>
      <url>/posts/54c80afd.html</url>
      
        <content type="html"><![CDATA[<p>1</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote><p><strong>符号执行</strong>（英语：symbolic execution）是一种<a href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">计算机科学</a>领域的<a href="https://zh.wikipedia.org/wiki/%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90">程序分析</a>技术，通过采用抽象的符号代替精确值作为程序输入变量，得出每个路径抽象的输出结果。这一技术在硬件、底层程序测试中有一定的应用，能够有效的发现程序中的漏洞。</p></blockquote><h2 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h2><p>举例说明：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">  y = read();</span><br><span class="line">  z = y * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(z == <span class="number">12</span>)&#123;</span><br><span class="line">    fail();</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于以上代码，如果实际执行，那么效果是：读入一个值到y，然后令z等于y的2倍。如果z等于6，调用fail(),反之打印ok。</p><p>对于符号执行来说，流程中不定的值会被赋为$\lambda$,一个符号值，这个值可以是任何值，在这个例子中，y会等于$\lambda$，z会等于2$\lambda$，当遇到分支时，会模拟执行所有分支，即当2$\lambda$等于12时调用fail(),当2$\lambda$不等于12时打印ok。在符号执行完所有的路径后，会计算出一个能完成这个路径的符号的变量实际值，该例中，调用fail()是$\lambda$&#x3D;&#x3D;6的结果，打印ok是$\lambda$！&#x3D;6时成立</p><p>上面这个过程中，每一个条件被叫做一个<code>约束</code>，每一个结果对应的所有约束被称为约束集，每一个结果经过的约束集被称为<code>路径</code>，路径可以由执行树表示。而符号执行的目的，就是让符号值遍历所有路径，找到所有对应的约束集。</p><p>为了完成以上工作，在整个流程中存在两个变量<code>符号状态</code>$\sigma$和<code>路径条件</code>$PC$，并根据读到的语句对约束进行添加（以下为例子）：</p><ul><li>若是输入语句，在$\sigma$中添加映射：$\sigma$&#x3D;{var$\rightarrow$$\lambda_0$},此时$\lambda_0$是var变量的符号值。</li><li>若是赋值语句，则把符号值代入计算，在$\sigma$中添加映射：$\sigma$&#x3D;{var$\rightarrow$$\lambda_0$,$var_2$$\rightarrow$$\lambda_0$+7}</li><li>当遇到条件语句if(e) a else b.PC会先更新为PC$\land$$\sigma$(e)表示then,然后创建PC$^&#96;$初始化为PC$\neg$$\land\sigma$(e)表示另一条路径</li><li>如果遇到exit，错误，前后约束矛盾，这一个路径会终止。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 概念 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollvm代码混淆</title>
      <link href="/posts/f1101757.html"/>
      <url>/posts/f1101757.html</url>
      
        <content type="html"><![CDATA[<h1 id="编译器"><a href="#编译器" class="headerlink" title="编译器"></a>编译器</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><code>将高级语言编写的程序转换位目标语言(通常是机器语言)的程序叫做编译器.</code>这个转换的过程叫编译.不同于在执行解释性语言解释器总存在且逐行解释,编译器一次性把整个程序编译成二进制代码从而一般情况运行更快.但是由于解释器可以在不同平台上运作,兼容性,跨平台性更强.</p><h2 id="编译器构成"><a href="#编译器构成" class="headerlink" title="编译器构成"></a>编译器构成</h2><p>传统的编译器构成常分为三个部分:前端,优化器,后端.编译过程中,前端负责语法分析,将源代码转为其高级形式:抽象语法树(即把源代码的字符串转为内存中有意义的数据);优化器将经过前端处理的中间代码进行优化;后端将优化后的中间代码转换为对应的汇编语言.</p><h2 id="主要编译器"><a href="#主要编译器" class="headerlink" title="主要编译器"></a>主要编译器</h2><h3 id="GCC"><a href="#GCC" class="headerlink" title="GCC"></a>GCC</h3><blockquote><p>GCC（GNU Compiler Collection，GNU 编译器套装），是一套由 GNU 开发的编程语言编译器。GCC 原名为 GNU C 语言编译器，因为它原本只能处理 C语言。GCC 快速演进，变得可处理 C++、Fortran、Pascal、Objective-C、Java 以及 Ada 等他语言。</p></blockquote><h3 id="LLVM"><a href="#LLVM" class="headerlink" title="LLVM"></a>LLVM</h3><blockquote><p>LLVM （Low Level Virtual Machine，底层虚拟机)）提供了与编译器相关的支持，能够进行程序语言的编译期优化、链接优化、在线编译优化、代码生成。简而言之，可以作为多种编译器的后台来使用。</p><p>苹果公司一直使用 GCC 作为官方的编译器。GCC 作为一款开源的编译器，一直做得不错，但 Apple 对编译工具会提出更高的要求。原因主要有以下两点：</p><p>其一，是 Apple 对 Objective-C 语言（包括后来对 C 语言）新增很多特性，但 GCC 开发者并不买 Apple 的账——不给实现，因此索性后来两者分成两条分支分别开发，这也造成 Apple 的编译器版本远落后于 GCC 的官方版本。</p><p>其二，GCC 的代码耦合度太高，很难独立，而且越是后期的版本，代码质量越差，但 Apple 想做的很多功能（比如更好的 IDE 支持），需要模块化的方式来调用 GCC，但 GCC一直不给做。</p></blockquote><p>该编译器的特殊点在于中间表示(IR).这是前端将源代码生成为一种类机器码(各平台不同),并可以由LLVM后端解析的代码.用以扩展解释器的跨平台性.此前,一般是把源代码编译成C代码然后交由对应平台的C编译器编译成二进制文件(因为一般平台都有C编译器).在LLVM中,只需要把源文件编译成IR然后交由LLVM后端直接编译到对应平台.</p><h3 id="CLANG"><a href="#CLANG" class="headerlink" title="CLANG"></a>CLANG</h3><p>Clang 是 LLVM 的前端,于LLVM的后端组合可以当作另一个编译器,Clang是Apple研发的前端旨在代替GCC的前端</p><hr><h1 id="OLLVM"><a href="#OLLVM" class="headerlink" title="OLLVM"></a>OLLVM</h1><p>在LLVM基础上,Obfuscator-LLVM项目被研发了出来,通过三种混淆Pass(模块)完善代码的安全性.</p><ul><li>控制流平坦化</li><li>指令替换</li><li>伪造控制流(又叫混淆控制流)</li></ul><p>混淆Pass作用于IR,通过混淆IR使后端转换的文件被混淆,使逆向难度增大.</p><h2 id="控制流平坦化"><a href="#控制流平坦化" class="headerlink" title="控制流平坦化"></a>控制流平坦化</h2><p><img src="https://s2.loli.net/2023/12/21/RahxKGqA8B5OnCr.png" alt="104308x4cppkp5zjsfl8zy"></p><p>代码本身是真实块和retn块的组合,在进行控制流平坦化之后,程序的流程被分发器控制,所有真实块最后进行对标记的处理然后全部进入预处理器,根据标记的值不同由主分发器分发到副分发器再到真实块,从而混淆了整个执行流程,在反汇编视图中的特征是有很多while循环在后面有switch case语句.(以我的水平来看,控制流平坦化之后几乎不可读)</p><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><p>原始的条件一般会转化为CMOV条件传送指令,根据比较结果设置标记的值</p><h2 id="指令替换"><a href="#指令替换" class="headerlink" title="指令替换"></a>指令替换</h2><p>用多个表达式替换一个计算表达式</p><h3 id="特征-1"><a href="#特征-1" class="headerlink" title="特征"></a>特征</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">原式子：</span><br><span class="line">a=b+c</span><br><span class="line">混淆后：</span><br><span class="line">a = b - (-c)</span><br><span class="line">a = -(-b + (-c))</span><br><span class="line">r = rand (); a = b + r; a = a + c; a = a - r</span><br><span class="line">r = rand (); a = b - r; a = a + b; a = a + r</span><br><span class="line"></span><br><span class="line">原式子：</span><br><span class="line">a = b-c</span><br><span class="line">混淆后：</span><br><span class="line">a = b + (-c)</span><br><span class="line">r = rand (); a = b + r; a = a - c; a = a - r</span><br><span class="line">r = rand (); a = b - r; a = a - c; a = a + r</span><br><span class="line"></span><br><span class="line">原指令：</span><br><span class="line">a = b &amp; c</span><br><span class="line">混淆后：</span><br><span class="line">a = (b ^ ~c) &amp; b</span><br><span class="line">a = ~(~a | ~b) &amp; (r | ~r)</span><br><span class="line"></span><br><span class="line">原指令：</span><br><span class="line">a = b | c</span><br><span class="line">混淆后：</span><br><span class="line">a = (b &amp; c) | (b ^ c)</span><br><span class="line">a = (((~a &amp; r) | (a &amp; ~r)) ^ ((~b &amp; r) | (b &amp; ~r))) | (~(~a | ~b) &amp; (r | ~r))</span><br><span class="line"></span><br><span class="line">原指令：</span><br><span class="line">a = a ^ b</span><br><span class="line">混淆后：</span><br><span class="line">a = (~a &amp; b) | (a &amp; ~b)</span><br><span class="line">a = ((~a &amp; r) | (a &amp; ~r)) ^ ((~b &amp; r) | (b &amp; ~r))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>或者</p><img src="https://ask.qcloudimg.com/http-save/yehe-8150619/9571bfa62d17b52593dff42fa4bd9a47.png" alt="[IDA F5 增强插件，还我源代码（一）-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1845335)" /><h2 id="伪造控制流"><a href="#伪造控制流" class="headerlink" title="伪造控制流"></a>伪造控制流</h2><p>伪造控制流是在一开始设置一个变量&#x2F;表达式,这个变量&#x2F;表达式被称为<code>不透明谓词</code>,并为每一个基本块生成一个垃圾指令块,通过不透明谓词进行跳转到不同位置,但是实际上不会到达垃圾指令块处.</p><h3 id="特征图"><a href="#特征图" class="headerlink" title="特征图"></a>特征图</h3><img src="http://image.3001.net/images/20170323/14902545615701.png!small" alt="6.png" style="zoom:67%;" /><hr><h2 id="对于初学者的逆向方法"><a href="#对于初学者的逆向方法" class="headerlink" title="对于初学者的逆向方法"></a>对于初学者的逆向方法</h2><p>伪造控制流:见<a href="https://zhuanlan.zhihu.com/p/151853593">Hex-Rays: 十步杀一人，两步秒OLLVM-BCF(zhihu.com)</a></p><p>控制流平坦化和伪造控制流:见<a href="https://github.com/pcy190/deflat">pcy190&#x2F;deflat: Use angr to deflat the flat control flow. (github.com)</a></p><p>指令替换:见<a href="https://github.com/joydo/d810">joydo&#x2F;d810 (github.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> 知识集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 编译器 </tag>
            
            <tag> 混淆 </tag>
            
            <tag> 反混淆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一道题</title>
      <link href="/posts/2480ed19.html"/>
      <url>/posts/2480ed19.html</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>info 本篇是为了复现了当时做题的步骤总结经验，所以会写的比较详细。如果您水平较高，只想看知识点可以直接跳到后面防止被气到脑溢血。同时本篇内容有错误的地方也请在评论区指出,感谢</p></div><details class="folding-tag" green><summary> 不重要的前言 </summary>              <div class='content'>              <p>这是我第一次参加强网杯，但是一道题都没做出来，看来还是要继续学习啊！两天啊两天，我一开始以为我可以解出来，但是失败了。后来经过询问和思考终于知道错在哪里了，所以写一篇记录一下解题过程和知识点。</p>              </div>            </details><p>那么开始吧！</p><h2 id="查看文件信息"><a href="#查看文件信息" class="headerlink" title="查看文件信息"></a>查看文件信息</h2><p><img src="https://s2.loli.net/2023/12/18/X9RCPSe2fQFygKq.png" alt="image-20231218091226849"></p><p>这一步是使用工具对文件头部进行分析，找出该文件的基本文件类型，为后面的反编译分析提供便利。</p><p>根据DIE的信息：</p><ol><li>普通64位PE文件</li><li>C或C++</li><li>没有加壳</li><li>注意在节区一行，有TLS字样是亮的，说明有TLS节(当时没注意)</li></ol><hr><h2 id="打开文件获取明显信息"><a href="#打开文件获取明显信息" class="headerlink" title="打开文件获取明显信息"></a>打开文件获取明显信息</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">恭喜你进入了主函数里</span><br><span class="line">Please input your key:</span><br><span class="line"><span class="comment">//输入任意内容后自动退出</span></span><br></pre></td></tr></table></figure><p>这一步帮助我们定位关键代码</p><hr><h2 id="反编译器编译查看源代码"><a href="#反编译器编译查看源代码" class="headerlink" title="反编译器编译查看源代码"></a>反编译器编译查看源代码</h2><details class="folding-tag" ><summary> 化简后的主函数代码 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  _DWORD Q[<span class="number">15</span>]; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> k; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">34</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)argv);</span><br><span class="line">  sub_7FF71EE711A9(byte_7FF71EE7AD78);</span><br><span class="line">  sub_7FF71EE7123F((__int64)aPleaseInputYou);</span><br><span class="line">  <span class="built_in">std</span>::istream::getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, flag, <span class="number">33</span>i64);</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(flag) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(Q, <span class="number">0</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">    bToD(Q, flag);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br><span class="line">    dToB(Q, last);</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">int</span>)k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">        sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF71EE711A9(<span class="string">&quot;Wrong Length!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>大致分为三个阶段：</p><ol><li>读入flag</li><li>校验flag</li><li>输出</li></ol><div class="tabs" id="main函数分析"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#main函数分析-1">读入flag</button></li><li class="tab"><button type="button" data-href="#main函数分析-2">校验flag</button></li><li class="tab"><button type="button" data-href="#main函数分析-3">输出</button></li><li class="tab"><button type="button" data-href="#main函数分析-4">其它</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="main函数分析-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF71EE711A9(byte_7FF71EE7AD78);</span><br><span class="line">sub_7FF71EE7123F((__int64)aPleaseInputYou);</span><br><span class="line"><span class="built_in">std</span>::istream::getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, flag, <span class="number">33</span>i64);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="main函数分析-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( j_strlen(flag) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(Q, <span class="number">0</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">    bToD(Q, flag);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br><span class="line">    dToB(Q, last);</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="main函数分析-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF71EE711A9(<span class="string">&quot;Wrong Length!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="main函数分析-4"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v3 = &amp;v5;</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">34</span>i64; i; --i )</span><br><span class="line">&#123;</span><br><span class="line">  *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">  v3 += <span class="number">4</span>;</span><br><span class="line">&#125;<span class="comment">//看起来没有意义，在一开始初始化内存</span></span><br><span class="line">j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)argv);<span class="comment">//看名字是反调试</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><p>读入和输出部分没什么好分析的，主要是检验flag部分，但是先试试可不可以调试，尝试之后果然不可以。那么开始分析检验flag部分：</p><div class="tabs" id="校验部分--1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#校验部分--1-1">长度检验</button></li><li class="tab"><button type="button" data-href="#校验部分--1-2">bToD函数</button></li><li class="tab"><button type="button" data-href="#校验部分--1-3">TEA函数</button></li><li class="tab"><button type="button" data-href="#校验部分--1-4">dToB函数</button></li><li class="tab"><button type="button" data-href="#校验部分--1-5">最终值检定</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="校验部分--1-1"><p>根据<wavy>if ( j_strlen(flag) &#x3D;&#x3D; 32 )</wavy></p><p>flag为32位</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="校验部分--1-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">bToD</span><span class="params">(_DWORD *Q, <span class="type">char</span> *flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> a; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF71EE840F4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      a |= flag[<span class="number">4</span> * i + j] &lt;&lt; (<span class="number">8</span> * j);</span><br><span class="line">    Q[i] = a;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看到flag[4 * i + j]，立即想到把flag看作二维数组，一共8行一行4个元素，由于Q是DWORD型，flag是char型，让a异或等于一行flag(第i个要flag左移8i位)相当于让a等于一行flag反向排列组合的十六进制字符,那么Q也会变成8个元素刚好每个32位</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="校验部分--1-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">  TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">TEA</span><span class="params">(_DWORD *Q2j_, _DWORD *Q2j1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> det; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF71EE840F4);</span><br><span class="line">  det = <span class="number">0x90508D47</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      *Q2j_ += (((<span class="number">32</span> * *Q2j1) ^ (*Q2j1 &gt;&gt; <span class="number">4</span>)) + *Q2j1) ^ (det + tt[det &amp; <span class="number">3</span>]) ^ det;</span><br><span class="line">      *Q2j1 += (((<span class="number">32</span> * *Q2j_) ^ (*Q2j_ &gt;&gt; <span class="number">4</span>)) + *Q2j_) ^ (det + tt[(det &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">      det -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tt数组的值是:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt              db 31h, 0B7h, 0B6h, 31h, 4 dup(0)</span><br></pre></td></tr></table></figure><p>这个函数是典型的TEA加密,它是分组加密,且使用异或,每一步都可逆,写出逆向代码就是:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x90508D47</span>;</span><br><span class="line">    <span class="type">int</span> tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            e -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                e += <span class="number">0x77BF7F99</span>;</span><br><span class="line">                b2 -= (((b1 * <span class="number">32</span>) ^ (b1 &gt;&gt; <span class="number">4</span>)) + b1) ^ (e + tt[(e &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                b1 -= (((<span class="number">32</span> * b2) ^ (b2 &gt;&gt; <span class="number">4</span>)) + b2) ^ (e + tt[e &amp; <span class="number">3</span>]) ^ e;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>TEA基本解决步骤就是恢复det状态,相等循环长度,内容反向排列,加变减,减变加,异或不变</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="校验部分--1-4"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">dtob</span><span class="params">(_DWORD *Q, <span class="type">char</span> *last)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *p_spec; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> spec; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> max; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> b[<span class="number">11</span>]; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+74h] [rbp+54h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> a; <span class="comment">// [rsp+94h] [rbp+74h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+B4h] [rbp+94h]</span></span><br><span class="line"></span><br><span class="line">  p_spec = &amp;spec;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">46</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)p_spec = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    p_spec += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)last);</span><br><span class="line">  b[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  b[<span class="number">1</span>] = <span class="number">8</span>;</span><br><span class="line">  b[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">  b[<span class="number">3</span>] = <span class="number">24</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    a = Q[j];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k )</span><br><span class="line">      last[<span class="number">4</span> * j + k] = a &gt;&gt; b[k];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数把Qj右移的结果赋给last,把last看成二维char数组,,所以根据bk的值右移相当于每行逆向排序last</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="校验部分--1-5"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">int</span>)k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">        sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.data:00007FF71EE7E040 check           db 0E0h, 0F3h, 21h, 96h, 97h, 0C7h, 0DEh, 89h, 9Bh, 0CAh</span><br><span class="line">.data:00007FF71EE7E040                                         ; DATA XREF: main_0+119↑o</span><br><span class="line">.data:00007FF71EE7E04A                 db 62h, 8Dh, 0B0h, 5Dh, 0FCh, 0D2h, 89h, 55h, 1Ch, 42h</span><br><span class="line">.data:00007FF71EE7E054                 db 50h, 0A8h, 76h, 9Bh, 0EAh, 0B2h, 0C6h, 2Fh, 7Ch, 0CFh</span><br><span class="line">.data:00007FF71EE7E05E                 db 11h, 0DEh</span><br></pre></td></tr></table></figure><p>所以只需要令last等于check然后逆向即可得到答案</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="写逆向代码然后得出答案"><a href="#写逆向代码然后得出答案" class="headerlink" title="写逆向代码然后得出答案"></a>写逆向代码然后得出答案</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_hex_groups</span>(<span class="params">hex_numbers, group_size</span>):</span><br><span class="line">    hex_numbers = hex_numbers.replace(<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    hex_numbers = [num.strip()[<span class="number">2</span>:] <span class="keyword">for</span> num <span class="keyword">in</span> hex_numbers]</span><br><span class="line">    grouped_numbers = [hex_numbers[i:i + group_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_numbers), group_size)]</span><br><span class="line">    reversed_groups = [group[::-<span class="number">1</span>] <span class="keyword">for</span> group <span class="keyword">in</span> grouped_numbers]</span><br><span class="line">    reversed_hex = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;,&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join(group) <span class="keyword">for</span> group <span class="keyword">in</span> reversed_groups])</span><br><span class="line">    <span class="keyword">return</span> reversed_hex</span><br><span class="line"></span><br><span class="line">input_hex_numbers = <span class="built_in">input</span>(<span class="string">&quot;Enter hex numbers separated by commas (with optional surrounding brackets): &quot;</span>)</span><br><span class="line">input_group_size = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the group size: &quot;</span>))</span><br><span class="line"></span><br><span class="line">output = reverse_hex_groups(input_hex_numbers, input_group_size)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x90508D47</span>;</span><br><span class="line">    <span class="type">int</span> tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            e -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                e += <span class="number">0x77BF7F99</span>;</span><br><span class="line">                b2 -= (((b1 * <span class="number">32</span>) ^ (b1 &gt;&gt; <span class="number">4</span>)) + b1) ^ (e + tt[(e &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                b1 -= (((<span class="number">32</span> * b2) ^ (b2 &gt;&gt; <span class="number">4</span>)) + b2) ^ (e + tt[e &amp; <span class="number">3</span>]) ^ e;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_hex</span>(<span class="params">hex_list</span>):</span><br><span class="line">    reversed_hex = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> hex_num <span class="keyword">in</span> hex_list:</span><br><span class="line">        <span class="comment"># 移除 &quot;0x&quot;，然后每两位反转</span></span><br><span class="line">        reversed_num = <span class="string">&quot;&quot;</span>.join(<span class="built_in">reversed</span>([hex_num[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(hex_num), <span class="number">2</span>)]))</span><br><span class="line">        reversed_hex += reversed_num</span><br><span class="line">    <span class="keyword">return</span> reversed_hex</span><br><span class="line"></span><br><span class="line">user_input = <span class="built_in">input</span>(<span class="string">&quot;请输入一组以0x开头，逗号间隔的十六进制数：&quot;</span>)</span><br><span class="line">hex_list = user_input.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(reverse_hex(hex_list))</span><br></pre></td></tr></table></figure><p>那么得出答案,答案是……???</p><p>第二步做完就发现问题了:</p><details class="folding-tag" ><summary> 错误的答案 </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/I4YS71EPxvuor6k.png" alt="fake_answer" style="zoom:33%;" />              </div>            </details><p>这是为什么呢??</p><hr><h2 id="重回细节"><a href="#重回细节" class="headerlink" title="重回细节"></a>重回细节</h2><p>还有什么没有检查呢,只有反调试了吧……</p><p>那么打开j___CheckForDebuggerJustMyCode:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall _CheckForDebuggerJustMyCode(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dword_7FF71EE7E9C4 )</span><br><span class="line">      GetCurrentThreadId();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是一个没有返回值的函数,并且唯一可能执行的副作用是GetCurrentThreadId(),然而这个函数是返回当前线程句柄,所以这个函数<code>只是名字叫检查debugger的函数</code>,实际上没有作用!!</p><p>但是我们调试的时候确实会闪退,那么我们再试一试</p><p>无论是下断点还是直接调试都会直接闪退,于是我尝试用remote windows debugger试一试点击调试:</p><details class="folding-tag" ><summary> 获得提示 </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/ZILDtzsTNHidB2c.png" alt="image-20231218114708422" style="zoom: 67%;" />              </div>            </details><p>那么要是可以用这个提示把反调试破掉就可以调试了</p><p>在字符串列表查看这个文字,通过交叉引用来查看哪个函数使用了这个</p><p>找到了这个函数:</p><details class="folding-tag" ><summary> sub_7FF7AB081AE0 </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/JOHgjAnfm2Vkqdo.png" alt="sub_7FF7AB081AE0" style="zoom:80%;" /><p>反编译之后是:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">sub_7FF7AB081AE0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  sub_7FF7AB0811A9(<span class="string">&quot;SomeThing Go Wrong\n&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>那么继续找交叉引用,重复多次后定位到两个函数</p><details class="folding-tag" ><summary> 2个TlsCallBack </summary>              <div class='content'>              <p><img src="https://s2.loli.net/2023/12/18/zC6dkSba5EwcD97.png" alt="image-20231218121518231"></p>              </div>            </details><p>找到这两个函数</p><details class="folding-tag" ><summary> TlsCallBack </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">TlsCallback_0_0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int16 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span> *<span class="title">v2</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  v2 = NtCurrentPeb();</span><br><span class="line">  LOBYTE(v2) = v2-&gt;BeingDebugged;</span><br><span class="line">  <span class="keyword">if</span> ( v2-&gt;BeingDebugged == <span class="number">4</span> )</span><br><span class="line">    sub_7FF7AB081AE0();</span><br><span class="line">  result = a2 &amp; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (a2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      j_oooo(off_7FF7AB08E008 + i + <span class="number">1</span>, a2);</span><br><span class="line">      result = (i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">TlsCallback_1_0</span><span class="params">(__int64 a1, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  <span class="keyword">if</span> ( NtCurrentPeb()-&gt;BeingDebugged == <span class="number">1</span> )</span><br><span class="line">    sub_7FF7AB081AE0();</span><br><span class="line">  result = a2 &amp; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (a2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      *(off_7FF7AB08E060 + i + <span class="number">1</span>) ^= i;</span><br><span class="line">      result = (i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>这两个函数中的sub_7FF7AB081AE0()就是刚刚显示somethingwrong的函数,所以通过patch的方法(keypatch)把两个&#x3D;&#x3D;改成!&#x3D;这样就不会报错了,保存后打开patch过的文件,调试,果然没问题了,但是并没有解决刚刚的问题,所以继续执行看看哪里不对,于是发现:</p><p>tt数组和check数组的值被修改了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> Q[<span class="number">8</span>] = &#123; <span class="number">0x9523F2E0</span>,<span class="number">0x8ED8C293</span>,<span class="number">0x8668C393</span>,<span class="number">0xDDF250BC</span>,<span class="number">0x510E4499</span>,<span class="number">0x8C60BD44</span>,<span class="number">0x34DCABF2</span>,<span class="number">0xC10FD260</span> &#125;;</span><br></pre></td></tr></table></figure><p>使用这个值去计算即可获得正确的答案</p><p>flag{W31com3_2_Th3_QwbS7_4nd_H4v3_Fun}</p><hr><h2 id="复盘"><a href="#复盘" class="headerlink" title="复盘"></a>复盘</h2><p>现在的问题是</p><p>为什么main函数没有调用那两个函数,但是那两个函数会先运行呢,这里要讲到之前提到的Tls节区了,TLS是线程局部储存的缩写,有一种函数叫TLS回调函数,这种函数在线程创建时和销毁时会执行一次</p><blockquote><p>TLS回调函数的设计目的是为了提供一种机制，使得每个线程都有自己的全局变量副本，从而避免了多线程同步问题。同时，它也提供了一种在每个线程的生命周期的开始和结束时执行特定代码的机制</p></blockquote><p>所以刚刚的反调试函数就是Tls函数存在特殊的节区Tls节区,详细内容可以看&lt;逆核&gt;p550.</p><p>然后再看看它是如何修改数据的</p><details class="folding-tag" ><summary> 修改处代码 </summary>              <div class='content'>              <div class="tabs" id="一共两处"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#一共两处-1">修改check</button></li><li class="tab"><button type="button" data-href="#一共两处-2">修改tt</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="一共两处-1"><img src="https://s2.loli.net/2023/12/18/FpAZCvdYrfTbEPh.png" alt="其一" style="zoom:67%;" /><p>off_14001E060在内存中的位置</p><img src="https://s2.loli.net/2023/12/18/Std51B2mhMzP6LX.png" alt="这里的值是一个偏移,偏移的位置是check上面一位" style="zoom:67%;" /><p>所以i+1就是check数组</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="一共两处-2"><img src="https://s2.loli.net/2023/12/18/E5zerdQqav2l9P7.png" alt="二号在这里" /><img src="https://s2.loli.net/2023/12/18/DVn6sjmElvOCUWe.png" alt="这个函数是上面的图里面的函数里面的函数" /><img src="https://s2.loli.net/2023/12/18/IuTFmv57Qjoe28s.png" alt="这里的方法一样但是看到偏移很抽象" /><p>这里是到1DFFF+1就是1E000就是tt的位置(我只能说很阴险)</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><p>实际上,这道题只要动态调试进入main就可以解决了</p><p>ok,完结撒花</p><hr><h2 id="另一种做法"><a href="#另一种做法" class="headerlink" title="另一种做法"></a>另一种做法</h2><p>ida有一种调试方式叫附加调试，即先打开文件，然后让ida附加到进程上，对于这道题来说，由于反调试代码只在Tls回调函数中，所以用附加调试可以直接跳过反调试，同时得到最后的值。</p>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷题记录(1)</title>
      <link href="/posts/a45b8304.html"/>
      <url>/posts/a45b8304.html</url>
      
        <content type="html"><![CDATA[<h1 id="攻防世界"><a href="#攻防世界" class="headerlink" title="攻防世界"></a>攻防世界</h1><h2 id="NO-GFSJ0166"><a href="#NO-GFSJ0166" class="headerlink" title="NO.GFSJ0166"></a>NO.GFSJ0166</h2><p>先用die检查，发现是安卓，放到模拟器里面运行，要求一个密码</p><p>在mainactivity里面看到</p><p><img src="https://s2.loli.net/2023/12/17/qdvk6MLlsyTuPN5.png" alt="image-20231209203012868"></p><p>把这个字符串比较了，尝试输入这个字符串，得到</p><p><img src="https://s2.loli.net/2023/12/17/dFKuqcm4U8btaMe.png" alt="image-20231209203053644"></p><p>但是flag输入不对，在main中看到有flagactivity这个类，进去看看</p><p>有</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlagActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(C0074R.layout.activity_flag);</span><br><span class="line">        <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span>[] d = &#123;<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">52</span>, <span class="number">110</span>, <span class="number">110</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">106</span>, <span class="number">52</span>, <span class="number">114</span>, <span class="number">95</span>, <span class="number">109</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">100</span>, <span class="number">51</span>, <span class="number">120</span>, <span class="number">125</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">22</span>; i++) &#123;</span><br><span class="line">            flag = flag.concat(String.valueOf((<span class="type">char</span>) d[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">flagText</span> <span class="operator">=</span> (TextView) findViewById(C0074R.C0076id.flagText);</span><br><span class="line">        flagText.setText(flag);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>感觉也没问题……最后发现flag不能加flag，直接w4nn4_j4r_my_d3x即可。</p><p>变换检验而不变换输入</p><hr><h1 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h1><h2 id="newstarctf2023reweek2：AndroDbgMe"><a href="#newstarctf2023reweek2：AndroDbgMe" class="headerlink" title="newstarctf2023reweek2：AndroDbgMe"></a>newstarctf2023reweek2：AndroDbgMe</h2><p>用jadx打开：</p><p><img src="https://s2.loli.net/2023/12/17/dptFY3Pk78Qq9V2.png" alt="image-20231210130908057"></p><p>这个字符串真是太抽象了！</p><p>用模拟器打开apk：</p><p><img src="https://s2.loli.net/2023/12/17/ikML3gJF2ofOP46.png" alt="image-20231210123339930"></p><p>发现它只是根据输入做变换然后输出，并没有校验？？？第一次遇到这种题</p><p>同时输出是以toast消息显示的，所以看看有没有和toast有关的：搜索后发现</p><p><img src="https://s2.loli.net/2023/12/17/yx6SLP1RB3N7AZk.png" alt="image-20231210123657945"></p><p>这个时候我发现静态分析太难了，看到题目名字：dbgme想到会不会要动态调试</p><p>（请教大佬安卓调试ing）</p><p>然后整理安卓调试流程如下：</p><p>前置流程：</p><ol><li>先下载adb（部分模拟器自带adb，在模拟器根目录）</li><li>打开模拟器的root和开发者模式，在开发者模式里面开usb调试</li></ol><p>然后：</p><ol><li>用adb连接模拟器：adb connect 127.0.0.1：xxxxx（xxxxx根据模拟器而定），不要关闭</li><li>打开jadx的debug功能，顶上的<img src="https://s2.loli.net/2023/12/17/KGJzYeBwxroNOgR.png" alt="image-20231210140413425" style="zoom:33%;" />，然后应该能看到下面的设备出现了各种线程</li><li>找到对应进程，开始调试</li></ol><p>然后来到这个界面，需要smali语法。。</p><p><img src="https://s2.loli.net/2023/12/17/YSyhVF8TGX6i2rz.png" alt="image-20231210140637472"></p><p>这时无论输入什么都会得到正确flag，原来是个教学题</p><p><img src="https://s2.loli.net/2023/12/17/RqtiSmFvVZcOC9a.png" alt="image-20231210140705572"></p><p>安卓调试</p><hr><h2 id="sctf2019-who-is-he"><a href="#sctf2019-who-is-he" class="headerlink" title="sctf2019 who is he"></a>sctf2019 who is he</h2><p>打开压缩包，发现是UNITY游戏，根据网上教程下载ILSpy分析assembly-CSharp.dll</p><p>找到<img src="https://s2.loli.net/2023/12/13/oQbqNEAxygl9aUV.png" alt="image-20231213165705074" style="zoom:25%;" />，打开函数查看：</p><img src="https://s2.loli.net/2023/12/13/etr1y6jVHvKFo9q.png" alt="image-20231213165841784" style="zoom:50%;" /><p>发现有一个初始字符串，一个加密函数，一个解密函数</p><p>start是空函数并且最后的onclick函数是检测输入是否正确：</p><p><img src="https://s2.loli.net/2023/12/13/Ns8qK23HGxnr1VS.png" alt="image-20231213170122579"></p><p>所以分析加密和解密的函数：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line"><span class="built_in">byte</span>[] bytes2 = Encoding.Unicode.GetBytes(str);</span><br><span class="line">DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateEncryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">cryptoStream.Write(bytes2, <span class="number">0</span>, bytes2.Length);</span><br><span class="line">cryptoStream.FlushFinalBlock();</span><br><span class="line"><span class="built_in">byte</span>[] inArray = memoryStream.ToArray();</span><br><span class="line">cryptoStream.Close();</span><br><span class="line">memoryStream.Close();</span><br><span class="line"><span class="keyword">return</span> Convert.ToBase64String(inArray);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line"><span class="built_in">byte</span>[] array = Convert.FromBase64String(str);</span><br><span class="line">DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateDecryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">cryptoStream.Write(array, <span class="number">0</span>, array.Length);</span><br><span class="line">cryptoStream.FlushFinalBlock();</span><br><span class="line"><span class="built_in">byte</span>[] bytes2 = memoryStream.ToArray();</span><br><span class="line">cryptoStream.Close();</span><br><span class="line">memoryStream.Close();</span><br><span class="line"><span class="keyword">return</span> Encoding.Unicode.GetString(bytes2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以加密和解密流程对应，加密是先DES然后base64，解密相反，那么根据观察str是加密后的字符，因此把解密函数和字符串，密钥放在一个类里面计算：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> encryptKey = <span class="string">&quot;1234&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> EncryptData = <span class="string">&quot;1Tsy0ZGotyMinSpxqYzVBWnfMdUcqCMLu0MA+22Jnp+MNwLHvYuFToxRQr0c+ONZc6Q7L0EAmzbycqobZHh4H23U4WDTNmmXwusW4E+SZjygsntGkO2sGA==&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line">            <span class="built_in">byte</span>[] array = Convert.FromBase64String(str);</span><br><span class="line">            DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">            MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">            CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateDecryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">            cryptoStream.Write(array, <span class="number">0</span>, array.Length);</span><br><span class="line">            cryptoStream.FlushFinalBlock();</span><br><span class="line">            <span class="built_in">byte</span>[] bytes2 = memoryStream.ToArray();</span><br><span class="line">            cryptoStream.Close();</span><br><span class="line">            memoryStream.Close();</span><br><span class="line">            <span class="keyword">return</span> Encoding.Unicode.GetString(bytes2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass myClass = <span class="keyword">new</span> MyClass();</span><br><span class="line">        <span class="built_in">string</span> decryptedData = myClass.Decrypt(myClass.EncryptData);</span><br><span class="line">        Console.WriteLine(decryptedData);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#He_P1ay_Basketball_Very_We11!Hahahahaha!</span></span><br></pre></td></tr></table></figure><p>问题来了，结果不对，不是很能理解，去网上看wping</p><p>最后跟着教程做，一直都做不出来，在大佬指点之下，发现是因为电脑报毒把某个文件删了还不提醒，找到那个文件：，打开发现是二进制文件，放进die分析，是pe文件，加了UPX壳，用upx的官方程序脱壳</p><p>打开之后</p><p><img src="https://s2.loli.net/2023/12/13/9t4dPNYcOGzvWSq.png" alt="image-20231213231111411"></p><p>大致是加载了一个dll</p><p>终于点按钮有提示了：<img src="https://s2.loli.net/2023/12/13/hCZbXYD5cVGIT1K.png" alt="image-20231213231322058" style="zoom:25%;" /></p><p>根据网上博客，CE分析mono</p><p><img src="https://s2.loli.net/2023/12/13/pif5YAZkJ91rMOE.png" alt="image-20231213231845210"></p><p>发现和之前那个很类似，并且这个dll在恢复报毒文件之后才出现</p><p>用mono分析功能把main放到窗口下方，按按钮</p><p><img src="https://s2.loli.net/2023/12/13/LGKcgE3eMAdkuZW.png" alt="image-20231213233408953"></p><p><img src="https://s2.loli.net/2023/12/13/JkYizLnvWXbeK3S.png" alt="image-20231213233422155"></p><p>得到密钥test，然后<code>勾选上UTF-16</code>搜Emmmm提示词，发现出现了两次，第二次的位置打开内存窗口：</p><p><img src="https://s2.loli.net/2023/12/15/cNLMb7mnWEIsRwz.png" alt="image-20231215103737650"></p><p>这是第二组密文，下面也有密钥test，复制下来，解密</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">785A57445A614B4568574E4D43626947595042496C59332B61726F7A4F397A6F6E7772594C69564C346E6A53657A3252594D32577773476E736E6A43446E4873374E34336146764E4535346E6F53616450394638654570765473355150472B4B4C305444452F34306E62553D</span><br></pre></td></tr></table></figure><p>转为</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">xZWDZaKEhWNMCbiGYPBIlY3</span>+arozO9zonwrYLiVL4njSez2RYM2WwsGnsnjCDnHs7N43aFvNE54noSadP9F8eEpvTs5QPG+KL0TDE/<span class="number">40</span>nbU=</span><br></pre></td></tr></table></figure><p>用密钥test和刚刚的算法得</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">She_P1ay_Black_Hole_Very_Wel1!LOL!XD!</span><br></pre></td></tr></table></figure><p>c#，假答案，DES，base64，CE，mono</p><hr><h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h2 id="wordy"><a href="#wordy" class="headerlink" title="wordy"></a>wordy</h2><p>打开ida后发现没有main函数，start里面标红，怀疑有花指令，到汇编中查找main，用<code>alt+t</code>键，找到后：</p><p><img src="https://s2.loli.net/2023/12/15/542PxaSHyIoe3df.png" alt="image-20231215105547630"></p><p>发现确实是花指令，先u，再跳一个数据c，多来几次，就会发现垃圾数据是0EBh，同时每两个eb之间都有putchar指令输出一个字符，由于0XEB是不可见的所以，打开hex窗口只会留下putchar的字符：</p><p><img src="https://s2.loli.net/2023/12/15/MOCnBqmFXe4tGZu.png" alt="image-20231215110118700"></p><p>得flag:GFCTF{u_are2wordy}</p><p>花指令，hex，脚本</p><hr><h1 id="ganctf-2023"><a href="#ganctf-2023" class="headerlink" title="ganctf 2023"></a>ganctf 2023</h1><h2 id="py-python"><a href="#py-python" class="headerlink" title="py?python!"></a>py?python!</h2><p>打开文件：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    encrypted_data = []</span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        encrypted_data.append(<span class="built_in">ord</span>(data[i]) ^ <span class="built_in">ord</span>(key[i % key_len]))</span><br><span class="line">    <span class="keyword">return</span> encrypted_data[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = [<span class="number">19</span>, <span class="number">78</span>,<span class="number">6</span> , <span class="number">68</span>, <span class="number">17</span>, <span class="number">36</span>, <span class="number">23</span>,<span class="number">63</span>, <span class="number">55</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">15</span>, <span class="number">42</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">51</span>, <span class="number">38</span>, <span class="number">41</span>, <span class="number">95</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">29</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">12</span>, <span class="number">96</span></span><br><span class="line">, <span class="number">55</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line">key = <span class="string">&quot;Python&quot;</span></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;请输入flag&quot;</span>)</span><br><span class="line">encrypted_data = encrypt(flag, key)</span><br><span class="line"><span class="keyword">if</span> encrypted_data == data:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good!You find it&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Sorry,Try again&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>很简单的加密算法，直接逆向即可</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">19</span>, <span class="number">78</span>,<span class="number">6</span> , <span class="number">68</span>, <span class="number">17</span>, <span class="number">36</span>, <span class="number">23</span>,<span class="number">63</span>, <span class="number">55</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">15</span>, <span class="number">42</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">51</span>, <span class="number">38</span>, <span class="number">41</span>, <span class="number">95</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">29</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">12</span>, <span class="number">96</span></span><br><span class="line">, <span class="number">55</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line">key = <span class="string">&quot;Python&quot;</span></span><br><span class="line">last =last[::-<span class="number">1</span>]</span><br><span class="line">be = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">        be += (<span class="built_in">chr</span>((last[i]) ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])))</span><br><span class="line"><span class="built_in">print</span>(be)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_@r3_R3@l1y_G0OD_@t_Pyth0n!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Ezmaze"><a href="#Ezmaze" class="headerlink" title="Ezmaze"></a>Ezmaze</h2><p>打开ida，检查main，化简后大概是：</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="function">__fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> c; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> path[<span class="number">112</span>]; <span class="comment">// [rsp+20h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 tab[<span class="number">5</span>]; <span class="comment">// [rsp+90h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// [rsp+B8h] [rbp-18h]</span></span><br><span class="line">  __int64 check; <span class="comment">// [rsp+BCh] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> b; <span class="comment">// [rsp+C4h] [rbp-Ch]</span></span><br><span class="line">  __int64 a; <span class="comment">// [rsp+C8h] [rbp-8h]</span></span><br><span class="line"><span class="keyword">int</span> ch1,ch2;</span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  qmemcpy(tab, <span class="string">&quot;@01111010110011110011110100#01&quot;</span>, <span class="number">30</span>);</span><br><span class="line">  a = <span class="number">0</span>i64;</span><br><span class="line">  <span class="comment">//puts(&amp;Buffer);                                // 可怜的猫猫在迷宫里迷路了,你能找到它在哪吗？</span></span><br><span class="line">  <span class="comment">//puts(&amp;byte_40402C);                           // 请输入路径,找到猫猫</span></span><br><span class="line">  gets(path);</span><br><span class="line">  len = strlen(path);</span><br><span class="line">  b = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    check = a;</span><br><span class="line">    c = path[b];</span><br><span class="line">    <span class="keyword">if</span> ( c == <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ch2++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c &gt; <span class="number">100</span> )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> ( c == <span class="number">115</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        ch1++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c == <span class="number">119</span> )</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">        ch1--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c == <span class="number">97</span> )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      ch2--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( ++b &gt; len</span><br><span class="line">      || ch1 &gt; <span class="number">5</span></span><br><span class="line">      || (unsigned <span class="keyword">int</span>)check &gt; <span class="number">4</span></span><br><span class="line">      || (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;0&#x27;</span></span><br><span class="line">      &amp;&amp; (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;@&#x27;</span></span><br><span class="line">      &amp;&amp; (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a = check;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *((_BYTE *)tab + <span class="number">5</span> * HIDWORD(a) + (<span class="keyword">int</span>)a) == <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//puts(&amp;byte_404040);</span></span><br><span class="line">    <span class="comment">//system(&quot;Pause&quot;);                            // 成功</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//printf(&amp;Format);                            // 失败</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//system(&quot;Pause&quot;);</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析check的值可知它的高32位储存纵方向数值，低32位储存横方向数值，a,w为减sd为加。跳出循环条件表明至少s5次，d4次，把tab改成迷宫：</p><blockquote><p>@0111</p><p>10101</p><p>10011</p><p>11001</p><p>11101</p><p>00#01</p></blockquote><p>可得@为开始位置，#为末位置</p><p>dssdsdssa即可（但是d也没有4次呀？奇怪）</p><p>flag{dssdsdssa}</p><p>逆向分析，正向求解</p><hr><h2 id="easy-xor"><a href="#easy-xor" class="headerlink" title="easy_xor"></a>easy_xor</h2><p>这个题也很简单，ida分析后：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">_main();</span><br><span class="line">*(_QWORD *)enc = <span class="number">0x6E6E717F64636D66</span>i64;</span><br><span class="line"><span class="built_in">strcpy</span>(&amp;enc[<span class="number">8</span>], <span class="string">&quot;&#123;V;xSLQi|pun&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the flag: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(flag) != <span class="number">20</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Invalid flag length! Exiting...&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(flag); ++j )</span><br><span class="line">  flag[j] ^= j;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(flag, enc) )</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Good!&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;No!&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>直接动态调试找enc的地址异或</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(get_wide_byte(<span class="number">0x62FDF0</span>+i)^i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)] ))</span><br><span class="line"><span class="comment">#flag&#123;this_1s_A_flag&#125;</span></span><br></pre></td></tr></table></figure><h2 id="easy-upx"><a href="#easy-upx" class="headerlink" title="easy_upx"></a>easy_upx</h2><p>这个在upx官方的脱壳软件脱壳后打开main转换字符串即可，或直接打开hex视图：</p><p>flag{UXP_yyds!}</p><p>UPX，hex</p><hr><h2 id="try-reverse-it"><a href="#try-reverse-it" class="headerlink" title="try_reverse_it"></a>try_reverse_it</h2><p>有一个upx壳，先脱掉，然后进入main查看：</p><p>发现是rc4加密，之前没有学过，所以现学：</p><p>整个加密分为三个阶段：</p><ul><li>初始化，S盒初始化为顺序线性列表，用已知的key填满T盒如果key长度小于T盒大小，就一直重复直到填满</li><li>混乱化：在循环中，把第i位的S和一个由这个S和T盒生成的算法计算出的S[j]交换</li><li>用混乱化之后的S盒和flag进行加密i次每次取1位,由于rc4加密是对称的所以一般用异或,同时每次加密会同时交换由S[i]变换的来的S[j]交换,所以每次加密都是在上一次基础上完成的</li></ul><p>而这道题也只是把每一位flag和那一位计算的S异或,所以完全可以顺着先把S盒求出来,根据异或的性质直接把最后的值异或得到答案</p><p>补充一个细节:之前我写的脚本:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><p>这两个都是错误的,第一个的t.join(chr(flag[i]))意思是返回<code>把后方传入的列表变成一个字符串间隔字符是t</code>的字符串,但是我并没有用字符串接收这个返回值,导致没有改变</p><p>第二个是因为’’.join每次都会初始化t,改成+&#x3D;就好了</p><p>exp:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x74</span>, <span class="number">0x27</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, </span><br><span class="line">       <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x74</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x6C</span>, <span class="number">0xF8</span>, <span class="number">0x90</span>, <span class="number">0xFF</span>, <span class="number">0x8B</span>, <span class="number">0x18</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0x76</span>, <span class="number">0xB5</span>, <span class="number">0xFB</span>, <span class="number">0x50</span>, <span class="number">0xF5</span>, </span><br><span class="line">        <span class="number">0x2C</span>, <span class="number">0x5F</span>, <span class="number">0xF3</span>, <span class="number">0x10</span>, <span class="number">0xCB</span>, <span class="number">0x3E</span>, </span><br><span class="line">        <span class="number">0xEA</span>, <span class="number">0x9A</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x2D</span>, <span class="number">0x4F</span>, </span><br><span class="line">        <span class="number">0xCC</span>, <span class="number">0x8F</span>, <span class="number">0x21</span>, <span class="number">0x29</span>, <span class="number">0x17</span>, <span class="number">0x06</span>, </span><br><span class="line">        <span class="number">0xCA</span>, <span class="number">0x67</span>]</span><br><span class="line"><span class="comment">#初始化T,S</span></span><br><span class="line">S = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">256</span>):</span><br><span class="line">    S[<span class="number">255</span>-i] = i</span><br><span class="line">T = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    T[i] = key[i % <span class="built_in">len</span>(key)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#打乱S</span></span><br><span class="line">a = b = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    a = S[i]</span><br><span class="line">    b = (a+T[i]+b) % <span class="number">256</span></span><br><span class="line">    S[i] = S[b]</span><br><span class="line">    S[b] = a</span><br><span class="line"><span class="comment">#S盒初始化成功,异或算法相同，所以相当于再来一次</span></span><br><span class="line">m = n = <span class="number">0</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">32</span>):</span><br><span class="line">    m = (m + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    k = S[m]</span><br><span class="line">    n = (k+n) % <span class="number">256</span></span><br><span class="line">    S[m] = S[n]</span><br><span class="line">    S[n] = k</span><br><span class="line">    flag[i] = last[i] ^ S[(k + S[m]) % <span class="number">256</span>]</span><br><span class="line">t =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t +=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_5eem_1ike4pro_revers3r&#125;</span></span><br></pre></td></tr></table></figure><p>UPX，RC4</p><h2 id="BrownFox"><a href="#BrownFox" class="headerlink" title="BrownFox"></a>BrownFox</h2><p>ida直接打开,先动态调试把improvefox函数之后的fox拿出来,再把最后的检测函数拿出来,变换全在tofox里面所以详细看tofox,化简之后:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i != num;i++ )</span><br><span class="line">  &#123;</span><br><span class="line">    k = flag[i] &gt;&gt; <span class="number">3</span>;<span class="comment">//k最大15得前4位</span></span><br><span class="line">    check[<span class="number">2</span> * i] = fox[flag[i] &amp; <span class="number">7</span>];<span class="comment">//最大7得后三位</span></span><br><span class="line">    check[<span class="number">2</span> * i+ <span class="number">1</span>] = fox[k]</span><br><span class="line">  &#125;</span><br><span class="line">check += <span class="number">2</span> * num;</span><br><span class="line">*check = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>这里的变换是非连续性的所以k&lt;&lt;3+check[2*i]在fox中的位置可得flag</p><p>注:fox一开始是有重复字符的,但是在improvefox之后没有了</p><p>最后又被坑了,注意python中位移优先度低于+-,异或也是</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">fox = [<span class="number">0x41</span>, <span class="number">0x71</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x62</span>, <span class="number">0x72</span>, </span><br><span class="line">       <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x6E</span>, <span class="number">0x66</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x6A</span>, <span class="number">0x31</span>, </span><br><span class="line">       <span class="number">0x6D</span>, <span class="number">0x70</span>, <span class="number">0x73</span>, <span class="number">0x32</span>, <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x33</span>, <span class="number">0x74</span>, </span><br><span class="line">       <span class="number">0x68</span>, <span class="number">0x34</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, </span><br><span class="line">       <span class="number">0x67</span>]</span><br><span class="line">sng = [<span class="number">0x62</span>, <span class="number">0x30</span>, <span class="number">0x63</span>, <span class="number">0x78</span>, <span class="number">0x71</span>, <span class="number">0x30</span>, <span class="number">0x72</span>, <span class="number">0x30</span>, </span><br><span class="line">       <span class="number">0x69</span>, <span class="number">0x31</span>, <span class="number">0x71</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x62</span>, <span class="number">0x6B</span>, <span class="number">0x6A</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x78</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6F</span>, <span class="number">0x41</span>, <span class="number">0x6F</span>, </span><br><span class="line">       <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x62</span>, <span class="number">0x6A</span>, </span><br><span class="line">       <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x75</span>, <span class="number">0x6A</span>, <span class="number">0x71</span>, <span class="number">0x31</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x71</span>, <span class="number">0x62</span>, <span class="number">0x71</span>, <span class="number">0x62</span>, </span><br><span class="line">       <span class="number">0x6B</span>, <span class="number">0x31</span>, <span class="number">0x41</span>, <span class="number">0x41</span>] <span class="comment">#60个值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">up</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(fox)):</span><br><span class="line">        <span class="keyword">if</span> (fox[i] == x):</span><br><span class="line">            <span class="keyword">return</span> i </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,<span class="number">60</span>,<span class="number">2</span>):</span><br><span class="line">    t = up(sng[i])+((up(sng[i+<span class="number">1</span>]))&lt;&lt;<span class="number">3</span>)</span><br><span class="line">    flag += <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_know_B@se_very_we11&#125;</span></span><br></pre></td></tr></table></figure><p>算法，c语言</p><hr><h2 id="find-flag"><a href="#find-flag" class="headerlink" title="find_flag"></a>find_flag</h2><p>先看一下程序：发现会输入两次flag，不知道什么用意</p><p>还是用ida打开，在判断函数之前看到了加密函数根据1640531527可知这是一个TAE加密，但是由于知道有输入了两个flag先看看之前的flag1怎么样</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_401AB0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !strnum )</span><br><span class="line">  &#123;</span><br><span class="line">    strnum = <span class="number">1</span>;</span><br><span class="line">    check1();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">check1</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> (**pfunc)(<span class="type">void</span>); <span class="comment">// rbx</span></span><br><span class="line">  __int64 *v1; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; bigq[i + <span class="number">1</span>]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i )</span><br><span class="line">  &#123;</span><br><span class="line">    pfunc = (<span class="type">void</span> (**)(<span class="type">void</span>))&amp;bigq[i];</span><br><span class="line">    v1 = &amp;bigq[i - (<span class="type">unsigned</span> __int64)(i - <span class="number">1</span>) - <span class="number">1</span>];<span class="comment">//就是首元素</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      (*pfunc--)();</span><br><span class="line">    <span class="keyword">while</span> ( pfunc != (<span class="type">void</span> (**)(<span class="type">void</span>))v1 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401510((<span class="type">int</span> (__cdecl *)())sub_401A00);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到check1中有一个指向函数指针的指针这个指针指向了bigq的地址，而打开可以看到bigq的地址后面跟着两个函数的地址，所以当pfunc这个指针指向这个地址的时候，它解引用就是这个函数地址在(*pfunc–)();处调用并减小，可以把bigq当作一个函数指针数组</p><p>注意for后面有;所以只增加了i，后面不在循环里，所以相当于从后向前执行那两个函数,那么先看那两个函数，第一个调用的函数(这个是func2)是一个退出函数？？暂时不管。</p><p>打开func1：</p><p>看到很多数组,在读取时动态调试下断点,发现这里是真的检查处</p><p>真的检查函数是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">4</span>; ++k )</span><br><span class="line">    sub_401550(&amp;flag1[<span class="number">2</span> * k]);</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(flag1, &amp;v3[<span class="number">3</span>], <span class="number">0x28</span>ui64) )</span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_401550</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> e; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> b2; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> b1; <span class="comment">// [rsp+3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  b1 = *a1;</span><br><span class="line">  b2 = a1[<span class="number">1</span>];</span><br><span class="line">  e = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    e -= <span class="number">1640531527</span>;</span><br><span class="line">    b1 += (b2 + e) ^ (<span class="number">16</span> * b2 + <span class="number">137</span>) ^ ((b2 &gt;&gt; <span class="number">5</span>) + <span class="number">118</span>);</span><br><span class="line">    b2 += (b1 + e) ^ (<span class="number">16</span> * b1 + <span class="number">84</span>) ^ ((b1 &gt;&gt; <span class="number">5</span>) + <span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = b1;</span><br><span class="line">  a1[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也是一个TEA</p><p>注意此处读取前40个值且取test数组的第四位开始,而flag是char类型,后面转成unint类型,鉴于不好python和c大数计算有差别,所以用c写:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        e -= <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x1f</span>; ++i) &#123;</span><br><span class="line">        b2 -= (b1 + e) ^ (<span class="number">16</span> * b1 + <span class="number">84</span>) ^ ((b1 &gt;&gt; <span class="number">5</span>) + <span class="number">50</span>);</span><br><span class="line">        b1 -= (b2 + e) ^ (<span class="number">16</span> * b2 + <span class="number">137</span>) ^ ((b2 &gt;&gt; <span class="number">5</span>) + <span class="number">118</span>);</span><br><span class="line">        e += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> data[<span class="number">10</span>] = &#123;</span><br><span class="line">    <span class="number">0x9F1F796B</span>, <span class="number">0xE4AF7378</span>, <span class="number">0x72FCDFD5</span>, <span class="number">0x4A57FFE0</span>, <span class="number">0x1672BA07</span>, <span class="number">0xAA057BE6</span>, <span class="number">0x9E171F8E</span>, <span class="number">0xDD153E4F</span>,</span><br><span class="line">    <span class="number">0x41079E59</span>, <span class="number">0x807578DD</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">5</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;data[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#X&quot;</span>, data[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0X67616C660X7730577B0X756F59210X6E31465F0X456D5F640X6F635F210X4072674E0X416C75740X6E6F31740X7D2173</span></span><br></pre></td></tr></table></figure><p>然后字符串转换:</p><p>666C61677B57307721596F755F46316E645F6D45215F636F4E67724074756C4174316F6E73217D</p><p>转string:flag{W0w!You_F1nd_mE!_coNgr@tulAt1ons!}</p><p>c语言，函数指针数组和指向函数指针数组的指针，TEA</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="RC4加密"><a href="#RC4加密" class="headerlink" title="RC4加密"></a>RC4加密</h2><p>详见专栏：<a href="ed8aa7e2.html">RC4</a></p><h2 id="TAE加密"><a href="#TAE加密" class="headerlink" title="TAE加密"></a>TAE加密</h2><p>详见专栏：<a href="d89283b5.html">TEA</a></p><h2 id="安卓调试流程"><a href="#安卓调试流程" class="headerlink" title="安卓调试流程"></a>安卓调试流程</h2><blockquote><p>前置流程：</p><ol><li>先下载adb（部分模拟器自带adb，在模拟器根目录）</li><li>打开模拟器的root和开发者模式，在开发者模式里面开usb调试</li></ol><p>然后：</p><ol><li>用adb连接模拟器：adb connect 127.0.0.1：xxxxx（xxxxx根据模拟器而定），不要关闭</li><li>打开jadx的debug功能，顶上的<img src="https://s2.loli.net/2023/12/17/KGJzYeBwxroNOgR.png" alt="image-20231210140413425" style="zoom:33%;" />，然后应该能看到下面的设备出现了各种线程</li><li>找到对应进程，开始调试</li></ol></blockquote><h2 id="CE的mono功能"><a href="#CE的mono功能" class="headerlink" title="CE的mono功能"></a>CE的mono功能</h2><p>mono是Novell开发的跨平台.NET运行环境,而Csharp是这个环境上的主要编程语言，Unity的使用的就是Csharp,所以CE的mono功能可以对大部分unity游戏使用</p><p>开启mono后，Ctrl+D打开反汇编程序窗口后可以直接看到类名和函数名，也可以在mono窗口查看DLL内容，相应类和方法，变量等，不仅可以方便写CElua脚本还能方便反编译器lispy或dnspy找DLL和方法名</p>]]></content>
      
      
      <categories>
          
          <category> 题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《逆核》04-基址重定位表</title>
      <link href="/posts/8430b536.html"/>
      <url>/posts/8430b536.html</url>
      
        <content type="html"><![CDATA[<h1 id="基址重定位表"><a href="#基址重定位表" class="headerlink" title="基址重定位表"></a>基址重定位表</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>PE重定位指如果PE文件加载时(一般是DLL,SYS动态加载)已经有别的DLL或SYS文件加载到它的ImageBase处，PE装载器会将其加载到其它未被占用的空间。<strong>PE装载器把它装载到其它位置的一系列行为</strong>就叫做PE重定位。(如果不进行这个操作,程序无法运行,内存地址引用错误)</p><blockquote><p>要解决什么问题呢?<br>–即让DLL文件能加载到其它地方并可以被正确调用.</p></blockquote><p>对于exe文件来说,exe每次都会加载到随机地址(ASLR机制)</p><h2 id="操作原理"><a href="#操作原理" class="headerlink" title="操作原理"></a>操作原理</h2><ul><li>在程序中查找硬编码的地址位置(如指令指向的绝对地址)</li><li>读取值后,减去imagebase(VA-&gt;RVA)</li><li>加上实际加载的地址(RVA-&gt;VA)</li><li>注:这个是在加载时直接写入修改,而不是每次调用函数或指令时再计算</li></ul><p>那么,该如何查找硬编码地址呢?</p><h2 id="基址重定位表-1"><a href="#基址重定位表-1" class="headerlink" title="基址重定位表"></a>基址重定位表</h2><p>基址重定位表记录了程序加载时需要修正的值的相关信息,包括修正地址的位置,需要修正的字节数,需要修正的地址类型等.在.reloc节中.位于PE头的DataDirectory数组的索引为5的元素指向了这个表.该表中每个记录都被称为<strong>一项</strong>(entry),每个项包含了需要修正的地址的详细信息.项以可变长度数组的形式存在<strong>重定位块</strong>中,每个重定位块是如下的IMAGE_BASE_RELOCATION结构体</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_BASE_RELOCATION</span> &#123;</span></span><br><span class="line">    DWORD VirtualAddress; <span class="comment">// 需要重定位的数据的RVA</span></span><br><span class="line">    DWORD SizeOfBlock;    <span class="comment">// 重定位块的长度(包括TypeOffset)</span></span><br><span class="line">    <span class="comment">//WORD TypeOffset[1];   // 重定位的偏移</span></span><br><span class="line">&#125; IMAGE_BASE_RELOCATION;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Offset:<span class="number">12</span>;  <span class="comment">// 大小为12Bit的重定位偏移 </span></span><br><span class="line">    WORD Type  :<span class="number">4</span>;   <span class="comment">// 大小为4Bit的重定位信息类型值 </span></span><br><span class="line">&#125;TypeOffset;         <span class="comment">// 这个结构体是A1Pass总结的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>每个IMAGE_BASE_RELOCATION结构体都表示一个重定位块,每块记录了0x1000页,记录方法是VirtualAddress表明基地址,每个TypeOffset的低12位表示偏移,基地址加偏移即是那个需要修改的地址.</p><p>其中SizeOfBlock的大小(块的长度)指明该重定位块中重定位项的个数</p><p>TypeOffset原则上不属于结构中,且元素个数 &#x3D; （SizeOfBlock - 8 ）&#x2F; 2,其中前4位的部分含义:</p><blockquote><ul><li>[<code>IMAGE_REL_BASED_ABSOLUTE (0)</code>：使块按照32位对齐，位置为0]</li><li>[<code>IMAGE_REL_BASED_HIGH (1)</code>：高16位必须应用于偏移量所指高字16位]</li><li>[<code>IMAGE_REL_BASED_LOW (2)</code>：低16位必须应用于偏移量所指低字16位]</li><li>[<code>IMAGE_REL_BASED_HIGHLOW (3)</code>：全部32位应用于所有32位]</li><li>[<code>IMAGE_REL_BASED_HIGHADJ (4)</code>：需要32位，高16位位于偏移量，低16位位于下一个偏移量数组元素，组合为一个带符号数，加上32位的一个数，然后加上8000然后把高16位保存在偏移量的16位域内]。</li></ul></blockquote><p>数组的最后一项以NULL填充结尾.</p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《逆核》03-手脱UPX</title>
      <link href="/posts/d011918c.html"/>
      <url>/posts/d011918c.html</url>
      
        <content type="html"><![CDATA[<blockquote><h2 id="UPX解码步骤"><a href="#UPX解码步骤" class="headerlink" title="UPX解码步骤"></a>UPX解码步骤</h2><blockquote><p>1.先初始化<br>2.进行代码还原<br>3.进行CALL修复<br>4.进行函数表还原<br>5.节表初始化<br>6.解码完毕飞向程序入口</p></blockquote></blockquote><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul><li>单步跟踪法</li><li>ESP定律法</li></ul><h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><p>单步跟踪法：基于UPX解压缩的步骤，ep开头会先push所有寄存器到栈，然后执行三个循环（见前一节），然后pop弹出所有寄存器后，重建表，进入程序oep。因此，只要一直f8，遇到循环就f4跳过，直到看到pop，然后跳过小循环，进入最后一个就，jmp即可进入oep，基于以上原理，由于upx解压部分和跳转都是连在一起的，所以直接alt+t搜索pop指令找到最后的位置(push对应pop,pusha或pushad对应popa和popad)</p><p>ESP定律法：根据原理push之后是解压，解压完为了跳回oep要获得之前的寄存器值即栈一定会平衡，开始时的栈和最后进入oep的栈状态相同，因此开始调试后先f8，使ESP(RSP)下浮一个值创建栈,如果之后的指令需要这时栈底的寄存器值,一定会回到这里读取这个值.然后复制这时栈顶的地址,G跳到那个地址,在这里下硬件断点,点f9后运行到硬件断点就是pop的位置之后的指令,然后如上即可.</p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><h3 id="实例一-使用IDA"><a href="#实例一-使用IDA" class="headerlink" title="实例一(使用IDA)"></a>实例一(使用IDA)</h3><p>1,脱一个x64程序的UPX壳,使用ida:</p><p>初始对比:</p><img src="https://s2.loli.net/2023/12/13/rxZo9yn2kcEePSq.png" alt="a" /><p>可以看出加壳之后比源程序小了约四分之三.用ida打开加壳程序:</p><img src="https://s2.loli.net/2023/12/13/XcMx5TEzsZaekKR.png" alt="b" style="zoom:33%;" /><img src="https://s2.loli.net/2023/12/13/JVCxMTav3Pb5oqN.png" alt="c" style="zoom:33%;" /><p>可以看出,压缩后函数变得极少,可以作为判断是否有壳的方法.</p><p>在开始处点f2下断点并进行动态调试:</p><img src="https://s2.loli.net/2023/12/13/oKPZxGBQt1AvWXO.png" alt="d" style="zoom:33%;" /><img src="https://s2.loli.net/2023/12/13/h4OsAL3VNDYijWb.png" alt="e" style="zoom:80%;" /><p>f8单步调试并观察栈:</p><img src="https://s2.loli.net/2023/12/13/xmTjoiJuczEbXkH.png" alt="f" style="zoom:80%;" /><p>复制栈对应地址并g跳转然后下硬件断点:</p><img src="https://s2.loli.net/2023/12/13/fMiQDm8aeAJPIXC.png" alt="g" style="zoom:80%;" /><img src="https://s2.loli.net/2023/12/13/je9cyJPmXhFVCzp.png" alt="h" style="zoom:80%;" /><p>观察到栈已经下了断点,这时直接f9,弹出</p><img src="https://s2.loli.net/2023/12/13/gswat71T26xAXKQ.png" alt="i" style="zoom:50%;" /><p>跳转到</p><img src="https://s2.loli.net/2023/12/13/yS8JnoQ5D647LGu.png" alt="j" style="zoom:80%;" /><p>转换汇编视图可以发现</p><img src="https://s2.loli.net/2023/12/13/Q9LUcBgMjTPoqa5.png" alt="k" style="zoom:80%;" /><p>指针点击循环下面的位置点f4运行到对应位置,再几次f8进大跳转就进入oep了,这个地方注意要先把硬件断点删了,点击上面工具栏的断点列表del键删掉</p><h3 id="实例2-使用OD"><a href="#实例2-使用OD" class="headerlink" title="实例2(使用OD)"></a>实例2(使用OD)</h3><p>这是一个x32程序,使用od</p><p>进入后发现:</p><img src="https://s2.loli.net/2023/12/13/Q6BGY5ECRXzkfZV.png" alt="l" style="zoom:80%;" /><p>和上面方法一样,先f8,然后对寄存器下断点(右键sep值复制,在下面的命令窗口输入hr (对应的地址))这表示是硬件读取断点.回车</p><img src="https://s2.loli.net/2023/12/13/6UYmy4JF8NeqdDz.png" alt="m" style="zoom:80%;" /><p>然后直接f9,删掉硬件断点:调试-硬件断点-删除.就找到了pop,小循环,大跳转</p><img src="https://s2.loli.net/2023/12/13/ncliZFbTf6NDGtW.png" alt="n" style="zoom:80%;" /><p>之后与第一个写的相同</p><p>或者在开始的时候,ctrl+f搜索popad</p><img src="https://s2.loli.net/2023/12/13/umPHGU7vtcY5wEO.png" alt="o" style="zoom:80%;" /><p>然后找到对应位置:</p><img src="https://s2.loli.net/2023/12/13/XEZIDWQcYvMSk83.png" alt="p" style="zoom:80%;" /><p>然后直接f4即可</p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 实践 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《逆核》02-运行时压缩器01</title>
      <link href="/posts/264d914b.html"/>
      <url>/posts/264d914b.html</url>
      
        <content type="html"><![CDATA[<h1 id="运行时压缩器"><a href="#运行时压缩器" class="headerlink" title="运行时压缩器"></a>运行时压缩器</h1><p>定义：针对于PE文件而言，可执行文件内部含有解压缩代码，文件在运行瞬间于内存中解压后执行。</p><p>运行时压缩文件也是PE文件，含有原PE文件和解码程序。在程序的EP代码中执行解码程序，在程序入口（EP）处执行解码程序，同时在内存中解压缩后执行。  </p><h2 id="1分类"><a href="#1分类" class="headerlink" title="1分类"></a>1分类</h2><p>分为压缩器和保护器。</p><h3 id="1-1压缩器"><a href="#1-1压缩器" class="headerlink" title="1.1压缩器"></a>1.1压缩器</h3><p>目的：</p><p>减小PE文件大小，便于传输和保存</p><p>隐藏PE文件内部代码和资源</p><h3 id="1-2保护器"><a href="#1-2保护器" class="headerlink" title="1.2保护器"></a>1.2保护器</h3><p>目的：</p><p>保护PE文件免受代码逆向分析，应用多种防止代码逆向的技术（反调试，反模拟，代码混淆，多态代码，垃圾代码，调试器监视等）。压缩后比源文件大</p><p>防破解，保护代码与资源</p><h2 id="2UPX"><a href="#2UPX" class="headerlink" title="2UPX"></a>2UPX</h2><p>一种压缩器，比较主流</p><h3 id="2-1压缩后特点"><a href="#2-1压缩后特点" class="headerlink" title="2.1压缩后特点"></a>2.1压缩后特点</h3><ul><li>PE头和原来相同</li><li>节区名称改变(.text变为UPX0,.data变为UPX1)</li><li>第一个节区的RawDataSize&#x3D;0(空节区)</li><li>EP在第二个节区</li><li>资源节区大小<code>几乎</code>无变化</li><li>入口点改变</li></ul><h3 id="2-2补充"><a href="#2-2补充" class="headerlink" title="2.2补充"></a>2.2补充</h3><blockquote><p>为什么第一个节区是空节区</p><p>节区头中,第一个节区(UPX0)的RawDataSize为0,但是VirtualSize为10000.代码和数据都在UPX1中.UPX解压后,PE文件运行瞬间将解压的代码解压到第一个节区,解压结束后,运行源文件的EP代码.  </p></blockquote><blockquote><p>入口点的变化</p><p>修改后，程序入口点EP到了UPX1的末端，而真实入口点OEP在EP之前。压缩后EP处指令为PUSHAD(和PUSHA相同)，是将EAX~EDI的值保存到栈，然后为MOV ESI,x，x是UPX0的起始地址</p></blockquote><h3 id="2-3UPX额外执行的操作"><a href="#2-3UPX额外执行的操作" class="headerlink" title="2.3UPX额外执行的操作"></a>2.3UPX额外执行的操作</h3><ol><li>PUSHAD(和PUSHA相同)，将EAX~EDI的值压入栈</li><li>mov esi,x(或offset x),将x(一个地址,如果是offset则是x的地址)装入esi寄存器中,这是把UPX1的  起始地址放到ESI中</li><li>LEA EDI,DWORD PTR DS:[ESI+y]或lea edi, [esi-y]这个的作用是把UPX0的起始地址放到EDI中</li><li>PUSH EDI是把首地址入栈</li><li>解密循环:(从EDX中读取一个字节写入EDI??存疑)具体的解密算法按照加密来选择</li><li>解压缩循环:从ESI所指的UPX1中依次读值,经过LZMA解压缩填充到之前为NULL的EDI所指的UPX0中</li><li>重定位循环:把所有<code>基于地址的位置无关代码</code>(PIC)<a href="8430b536.html">重定位</a>,PIC是只使用相对位置的指令.如(CALL,JMP等),PIC在.data开头创建了全局偏移表(GOT)</li></ol><p>然后会进行IAT的建立。最后再开始执行源代码。</p>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 学习 </tag>
            
            <tag> 压缩器 </tag>
            
            <tag> 壳 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《逆核》01-PE文件结构</title>
      <link href="/posts/923a3c19.html"/>
      <url>/posts/923a3c19.html</url>
      
        <content type="html"><![CDATA[<h1 id="PE文件格式"><a href="#PE文件格式" class="headerlink" title="PE文件格式"></a>PE文件格式</h1><p>PE文件格式是Windows操作系统中的核心内容，学习PE文件格式可以理解可执行文件如何储存，如何进入内存被执行。</p><h3 id="PE文件定义"><a href="#PE文件定义" class="headerlink" title="PE文件定义"></a>PE文件定义</h3><p>PE文件是windows操作系统下的可执行文件</p><p>其中32位的可执行文件称为PE或PE32，64位的被称为PE32+或PE+。</p><p>PE文件分为4种类型：</p><blockquote><p>可执行系列：.EXE  .SCR</p><p>库系列：.DLL  .OCX  .CPL  .DRV</p><p>驱动程序系列：.SYS  .VXD</p><p>对象文件系列：.OBJ（除了该项外，上面三种都可执行，</p><p>​      PE正式规范中OBJ文件也是PE文件）</p></blockquote><h3 id="PE文件结构"><a href="#PE文件结构" class="headerlink" title="PE文件结构"></a>PE文件结构</h3><p>PE文件分为<strong>PE头</strong>和<strong>PE体</strong>，又可细分为DOS头，DOS存根，NT头，节区头（分别为.text,.data和.rsrc)然后是节区（分别为.text，.data和.rsrc节区）。text为代码区，data为数据区存放数据结构，rsrc为资源区，windows特有，存放应用程序资源。</p><p>每个节区前后存在<strong>NULL填充</strong>，即用00填充在节区头与节区，节区与节区之间，令文件或内存中节区的起始位置在各文件&#x2F;内存最小单位的倍数上（这个值与NT头中的成员有关）。 </p><p>PE头：PE头的构成是许多结构体（DOS头，DOS存根，NT头，节区头）。以下介绍结构体中的部分重要成员</p><hr><h4 id="1）DOS头"><a href="#1）DOS头" class="headerlink" title="1）DOS头"></a>1）<strong>DOS头</strong></h4><ul><li>（IMAGE_DOS_HEADER)(19个成员)：</li><li>e_magic:dos签名：4D5A-&gt;MZ</li><li>e_lfanew(long):指向NT头的偏移（注意，这是long值，但是数据表明了从文件开头到NT头的偏移值，可以被用作指针.同时该值也是小端序储存）</li></ul><hr><h4 id="2-DOS存根："><a href="#2-DOS存根：" class="headerlink" title="2)DOS存根："></a>2)<strong>DOS存根</strong>：</h4><p>​dos存根不是结构体，是存在于DOS头下方的一段命令与数据的混合，如果在dos环境下运行程序，会执行这里的指令。</p><hr><h4 id="3）NT头"><a href="#3）NT头" class="headerlink" title="3）NT头"></a>3）<strong>NT头</strong></h4><ul><li><p>（IMAGE_NT_HEADERS)(三个成员)：</p></li><li><p>Signature(dword):签名：50450000h-&gt;”PE”00</p></li><li><p><code>FileHeader</code>(IMAGE_FILE_HEADER):文件头，是一个结构体</p><ul><li><p>Machine:每种类型的值表明能在哪种cpu上编译运行：14ch&#x3D;x86,8664h&#x3D;x64等等，但是并不是说32位的只能在32位系统上运行，现在有很多方法可以兼容运行。</p></li><li><p>NumberOfSelection:节区数量，一定大于0</p></li><li><p>SizeOfOpionalHeader:指出NT头中最后一个成员                               （IMAGE_OPTIONAL_HEADER32或64）的大小供系统查看</p></li><li><p>Characteristics（word):标识文件属性,每一位都代表一个属性，如0x0002表示这是可执行文件,0x1000表示是系统文件,0x2000表示这是dll文件</p></li><li><p>TimeDateStamp:标识编译时间</p></li></ul></li><li><p><code>OptionalHeader</code>(IMAGE_OPTIONAL_HEADER32OR64):可选头：</p><ul><li><p>Magic:可选头为32位时为10B,64位时为20B</p></li><li><p><em>AddressOfEnterPoint</em>:EP的rva值，指出起始代码地址</p></li><li><p>ImageBase:指出优先装入地址0~FFFFFFF，由于原位置可能已经加载了其它PE文件(主要是dll)</p></li><li><p>SectionAlignment,FileAlignment:指定节区在磁盘位置和内存储存的最小单位</p></li><li><p>SizeOfImage:指定image在虚拟内存中占的大小</p></li><li><p>SizeOfHeader:指出PE头的大小，应是SectionAlignment的整数倍</p></li><li><p>Subsystem:该值表示文件类型：1:驱动文件，2:窗口应用程序，3：控制台应用程序</p></li><li><p>NumberOfRvaAndSizes:该值指定下一个元素(DataDirectory)的元素个数,标准是16个(10h)</p></li><li><p>DataDirectory(结构体数组):重点是0和1和9，该项存了许多表</p></li></ul></li></ul><hr><h4 id="4）节区头"><a href="#4）节区头" class="headerlink" title="4）节区头"></a>4）<code>节区头</code></h4><p>(节区头是由结构体组成的数组，每个结构体对应了一个节区)：</p><ul><li><p>IMAGE_SECTION_HEADER是结构体的类型，其中有部分重要成员：</p><ul><li><p>VirtualAdress（无值，已被可选头内容定义）</p></li><li><p><del>VirtulSize:内存中节区大小（无值，已被可选头内容定义）</del></p></li><li><p>VirtulSize:表明内存中节区的大小</p></li><li><p>SizeOfRawData:磁盘文件中节区大小</p><ul><li>VirtualSize与SizeOfRawData一般不同，说明<strong>磁盘文件中节区大小与加载到内存后的节区大小不同</strong>,若VirtualSize大于SizeOfRawData,节区剩余部分会被填充为0</li></ul></li><li><p>PointerToRawData:磁盘文件中节区起始位置（必须为FileAlignment的整倍数）</p></li><li><p>Characteristics:属性，由位或而来</p></li><li><p>Name:可以填入任何值，所以仅供参考不一定叫.code的区是.code区</p></li></ul></li></ul><hr><h3 id="PE文件的映射"><a href="#PE文件的映射" class="headerlink" title="PE文件的映射"></a>PE文件的映射</h3><p><code>RVA(相对虚拟地址) to RAW(文件偏移)</code></p><p><code>RAW=RVA-VA+PointerToRawData</code></p><h3 id="IAT和EAT"><a href="#IAT和EAT" class="headerlink" title="IAT和EAT"></a>IAT和EAT</h3><h4 id="IAT"><a href="#IAT" class="headerlink" title="IAT:"></a>IAT:</h4><p>导入地址表</p><p>IMAGE_IMPORT_DESCRIPTOR(又叫IMPORT Directory Table):</p><img src="https://s2.loli.net/2023/12/12/YAfSmIR19C5wlrN.png" alt="IMAGE_IMPORT_DESCRIPTOR" /><p>一个库就对应了一个IMAGE_IMPORT_DESCRIPTOR结构体，所有需要导入的库的所有结构体形成了数组，最后以NULL结构体结束。</p><p>其中的重要成员是：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">OriginalFirstThunk:</span>导入名称表(该表是指向函数名的指针数组）INT  地址rva(注意该值和characteristics是一个联合)</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">Name:</span>库名称字符串地址rva</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">FirsThunk:</span>导入地址表(该表是指向函数地址的指针数组)IAT地址rva</span><br></pre></td></tr></table></figure><p>作用方式：</p><p>编译时，INT被创建，每个库都把指向不同函数名的指针(指向字符串)写入INT表和IAT表，运行时，程序先查找绑定输入表，然后根据信息在INT地址找到函数名，把函数地址写入IAT，供后续使用。</p><p>此结构体数组被储存在PE体中，但PE头中IMAGE_OPTIONAL_HEADER32OR64.DataDirectory[1].VirtualAddress是该结构体数组的起始位置（RVA）（前4字节），后4字节是大小。</p><h4 id="EAT"><a href="#EAT" class="headerlink" title="EAT:"></a>EAT:</h4><p>导出地址表</p><p>IMAGE_EXPORT_DIRECTORY:</p><img src="https://s2.loli.net/2023/12/12/9y6bau1iTYPIhfH.png" alt="IMAGE_EXPORT_DIRECTORY" /><p>同上，每个模块(dll)都有一个结构体，一起构成数组，重要成员有：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">NumberOfFuctions:</span>实际导出函数个数</span><br><span class="line"></span><br><span class="line"><span class="symbol">NumberOfNames:</span>导出函数中具名的函数个数(显式命名)</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfFunctions:</span>导出函数地址数组，含有入口地址，个数为NumberOfFunctions</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfNames:</span>函数名称地址数组，有指向全部导出函数入口地址的rva，个数为NumberOfNames</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfNameOrdinals:</span>存该dll中的函数的序号（ordinal）</span><br><span class="line"></span><br><span class="line"><span class="symbol">Name:</span>是指向模块（dll）在内存中的相同名称地址的指针，地址为RVA</span><br><span class="line"></span><br><span class="line"><span class="symbol">Base:</span>序号的基准值，序号减base值来调用这个模块</span><br></pre></td></tr></table></figure><p>作用方式：</p><p>1）通过名称：当程序发现一个函数调用不在内部时，会查找dll是否包含这个函数，如果包含，就会用名称先从AddressOfNames中比较寻找所需函数地址，用得到的索引再在AddressOfNameOrdinals中得到序号，用序号在AddressOfFunctions找到对应的地址进入。然后就会连接地址与这个函数。之所以这么麻烦是因为一个函数可能被多个程序使用，一个程序也可能使用多个动态链接库。查找名称也可以保证即使有新版本，旧编译的程序也可以调用这个函数。</p><p>该结构体数组存在在PE体中，RVA存在于DataDirectory[1].VirtualAddress（前4字节），后4字节是大小。</p><h3 id="关于修改PE文件"><a href="#关于修改PE文件" class="headerlink" title="关于修改PE文件"></a>关于修改PE文件</h3><p>添加节区：</p><p>添加节区首先要加节区头，使文件能识别到这个节区，由于一个节区头大小为40字节（</p><p><code>节表起始位置 = DOS头的e_lfanew字段值 + sizeof(IMAGE_NT_HEADERS)</code></p><p><code>节表大小 = 文件头的NumberOfSections字段值 * sizeof(IMAGE_SECTION_HEADER)</code></p><p>用这个公式计算节表后是否<strong>大于</strong>40字节，防止截断，如果可以放入一个节区头就放入，如果不行，一般有两种方法：一个是删掉dos存根，把后面的pe头部分前移，在后面的位置加节区头，这时要注意IMAGE_DOS_HEADER 的e_flanew要修改为NT头的偏移，因为NT头移动过，不过不用管对齐，因为并没有更改文件大小和节区位置，只要注意后面加的节区就可以了。第二个是在节表后面加数据，让它变长，这就要在SizeOfHeader里面增加字节，在多出来的地方写节区头，但是这样要把每个节区头里的偏移调到对应的偏移，因为节区头数据变多之后，节区的地址相应增加了那么多。但要注意增加的字节必须要对齐为最小单位的倍数。</p><p>还要把NumberOfSections+1，可选头中的sizeOfImage加对应的值</p><p>删除节区：</p><blockquote><p>直接0填充对应节区头，就识别不到节区啦。然后要把NumberOfSections-1.</p></blockquote><p>倒是可以这样，但是真的要删除节区的话，参考《逆核》17.2.2删除.reloc节区(位于整个文件的最后)：</p><span class='p red'>注</span>:这里使用的是exe文件,因为一般exe文件没用重定位节也可以正常运行<ol><li>从节区头找到reloc节区起始偏移，跳转后删除(物理)</li><li>文件头中有Number of Section填入减1的值(删了几个就减几)</li><li>可选头中有整个记录映像大小的Size of Image,在节区头中找到.reloc节区的大小RawDataSize让映像大小的值减去这个值</li></ol>]]></content>
      
      
      <categories>
          
          <category> 逆向工程核心原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 逆向 </tag>
            
            <tag> 学习 </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown语法与外挂标签写法汇总</title>
      <link href="/posts/2013454d.html"/>
      <url>/posts/2013454d.html</url>
      
        <content type="html"><![CDATA[<h1 id="1-Markdown语法自带格式"><a href="#1-Markdown语法自带格式" class="headerlink" title="1.Markdown语法自带格式"></a>1.Markdown语法自带格式</h1><div class="note info flat"><p>参考：<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdown语法图文全面详解(10分钟学会)</a></p></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h2 id="1-1-代码块"><a href="#1-1-代码块" class="headerlink" title="1.1 代码块"></a>1.1 代码块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-多级标题"><a href="#1-2-多级标题" class="headerlink" title="1.2 多级标题"></a>1.2 多级标题</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>见本文章标题!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-文字样式"><a href="#1-3-文字样式" class="headerlink" title="1.3 文字样式"></a>1.3 文字样式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>下划线演示<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">文字<span class="strong">**加粗**</span>演示</span><br><span class="line"></span><br><span class="line">文字<span class="emphasis">*斜体*</span>演示</span><br><span class="line"></span><br><span class="line">文本<span class="code">`高亮`</span>演示</span><br><span class="line"></span><br><span class="line">文本~~删除~~线演示</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5号字<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span>黑体<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>蓝色<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>这里的背景色是：MistyRosen，此处输入任意想输入的内容<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p><u>下划线演示</u></p><p>文字<strong>加粗</strong>演示</p><p>文字<em>斜体</em>演示</p><p>文本<code>高亮</code>演示</p><p>文本<del>删除</del>线演示</p><p><font size = 5>5号字</font><br><font face="黑体">黑体</font><br><font color=blue>蓝色</font></p><table><tr><td bgcolor=MistyRose>这里的背景色是：MistyRosen，此处输入任意想输入的内容</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>上述要点可参考:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">【Markdown语法】字体颜色大小及文字底色设置</a></p></div><h2 id="1-4-引用"><a href="#1-4-引用" class="headerlink" title="1.4 引用"></a>1.4 引用</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; 二级引用演示</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;外键</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;事务</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**行级锁**</span>(引用内部一样可以用格式)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><blockquote><p> Java<br>二级引用演示<br>MySQL</p><blockquote><p>外键</p><p>事务</p><p><strong>行级锁</strong>(引用内部一样可以用格式)</p></blockquote><p>….</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-分割线"><a href="#1-5-分割线" class="headerlink" title="1.5 分割线"></a>1.5 分割线</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-列表-跟空格都可以"><a href="#1-6-列表-跟空格都可以" class="headerlink" title="1.6 列表(*,+,-跟空格都可以)"></a>1.6 列表(*,+,-跟空格都可以)</h2><h3 id="1-6-1-无序列表"><a href="#1-6-1-无序列表" class="headerlink" title="1.6.1 无序列表"></a>1.6.1 无序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-有序列表"><a href="#1-6-2-有序列表" class="headerlink" title="1.6.2 有序列表"></a>1.6.2 有序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 注意后面有空格</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>1.<br>2.<br>3.<br>4. </p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-图片"><a href="#1-7-图片" class="headerlink" title="1.7 图片"></a>1.7 图片</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 本地图片</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># 在线图片</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>本地图片:<br><img src="/assets/pusheencode.webp" alt="示例图片" style="zoom:50%;" /><br>在线图片:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-表格"><a href="#1-8-表格" class="headerlink" title="1.8 表格"></a>1.8 表格</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| 项目标号 | 资金     | 备注 |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100，000 | 无   |</span><br><span class="line">| 2        | 200，000 | 无   |</span><br><span class="line">| 3        | 300,600  | 重要 |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th>项目标号</th><th>资金</th><th>备注</th></tr></thead><tbody><tr><td>1</td><td>100，000</td><td>无</td></tr><tr><td>2</td><td>200，000</td><td>无</td></tr><tr><td>3</td><td>300,600</td><td>重要</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-公式"><a href="#1-9-公式" class="headerlink" title="1.9 公式"></a>1.9 公式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>$$<br>\Gamma(z)&#x3D;\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="2-Butterfly外挂标签"><a href="#2-Butterfly外挂标签" class="headerlink" title="2.Butterfly外挂标签"></a>2.Butterfly外挂标签</h1><div class="note info flat"><p>这部分参考安知鱼:<a href="https://anzhiy.cn/posts/7d58.html">基于Butterfly的外挂标签引入</a></p></div><h2 id="2-1-行内文本样式-text"><a href="#2-1-行内文本样式-text" class="headerlink" title="2.1 行内文本样式 text"></a>2.1 行内文本样式 text</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u 文本内容 %&#125;</span><br><span class="line">&#123;% emp 文本内容 %&#125;</span><br><span class="line">&#123;% wavy 文本内容 %&#125;</span><br><span class="line">&#123;% del 文本内容 %&#125;</span><br><span class="line">&#123;% kbd 文本内容 %&#125;</span><br><span class="line">&#123;% psw 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 带 &#123;% u 下划线 %&#125; 的文本</span><br><span class="line"><span class="bullet">2.</span> 带 &#123;% emp 着重号 %&#125; 的文本</span><br><span class="line"><span class="bullet">3.</span> 带 &#123;% wavy 波浪线 %&#125; 的文本</span><br><span class="line"><span class="bullet">4.</span> 带 &#123;% del 删除线 %&#125; 的文本</span><br><span class="line"><span class="bullet">5.</span> 键盘样式的文本 &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> 密码样式的文本：&#123;% psw 这里没有验证码 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><ol><li>带 <u>下划线</u> 的文本</li><li>带 <emp>着重号</emp> 的文本</li><li>带 <wavy>波浪线</wavy> 的文本</li><li>带 <del>删除线</del> 的文本</li><li>键盘样式的文本 <kbd>command</kbd> + <kbd>D</kbd></li><li>密码样式的文本：<psw>这里没有验证码</psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-行内文本-span"><a href="#2-2-行内文本-span" class="headerlink" title="2.2 行内文本 span"></a>2.2 行内文本 span</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% span red, 红色 %&#125;、&#123;% span yellow, 黄色 %&#125;、&#123;% span green, 绿色 %&#125;、&#123;% span cyan, 青色 %&#125;、&#123;% span blue, 蓝色 %&#125;、&#123;% span gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<span class='p red'>红色</span>、<span class='p yellow'>黄色</span>、<span class='p green'>绿色</span>、<span class='p cyan'>青色</span>、<span class='p blue'>蓝色</span>、<span class='p gray'>灰色</span>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-段落文本-p"><a href="#2-3-段落文本-p" class="headerlink" title="2.3 段落文本 p"></a>2.3 段落文本 p</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% p red, 红色 %&#125;、&#123;% p yellow, 黄色 %&#125;、&#123;% p green, 绿色 %&#125;、&#123;% p cyan, 青色 %&#125;、&#123;% p blue, 蓝色 %&#125;、&#123;% p gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<p class='p red'>红色</p>、<p class='p yellow'>黄色</p>、<p class='p green'>绿色</p>、<p class='p cyan'>青色</p>、<p class='p blue'>蓝色</p>、<p class='p gray'>灰色</p>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-引用note"><a href="#2-4-引用note" class="headerlink" title="2.4 引用note"></a>2.4 引用note</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">通用配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">语法格式</button></li><li class="tab"><button type="button" data-href="#分栏-3">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-4">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-5">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 自带icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># 外部icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.自带icon</p><table><thead><tr><th>参数</th><th align="center">用法</th></tr></thead><tbody><tr><td>class</td><td align="center">【可选】标识，不同的标识有不同的配色 （ default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger ）</td></tr><tr><td>no-icon</td><td align="center">【可选】不显示 icon</td></tr><tr><td>style</td><td align="center">【可选】可以覆盖配置中的 style （simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><p>2.外部icon</p><table><thead><tr><th>参数</th><th align="center">用法</th></tr></thead><tbody><tr><td>class</td><td align="center">【可选】标识，不同的标识有不同的配色 （ default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green ）</td></tr><tr><td>no-icon</td><td align="center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td>style</td><td align="center">【可选】可以覆盖配置中的 style （simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-5"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div>2.`modern`样式<div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><p>3.<code>flat</code>样式</p><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><p>4.<code>disabled</code>样式</p><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>2.<code>modern</code>样式</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>3.<code>flat</code>样式</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>4.<code>disabled</code>样式</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了….</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-上标标签-tip"><a href="#2-5-上标标签-tip" class="headerlink" title="2.5 上标标签 tip"></a>2.5 上标标签 tip</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>自定义图标</code>: 支持fontawesome。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>自定义font awesome图标</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-动态标签-anima"><a href="#2-6-动态标签-anima" class="headerlink" title="2.6 动态标签 anima"></a>2.6 动态标签 anima</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><div class="note info flat"><ol><li>将所需的CSS类添加到图标（或DOM中的任何元素）。</li><li>对于父级悬停样式，需要给目标元素添加指定CSS类，同时还要给目标元素的父级元素添加CSS类<code>faa-parent animated-hover</code>。（详情见示例及示例源码）<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>可以通过给目标元素添加CSS类<code>faa-fast</code>或<code>faa-slow</code>来控制动画快慢。</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>   1.On DOM load（当页面加载时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.调整动画速度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hover（当鼠标悬停时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hover（当鼠标悬停在父级元素时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.On DOM load（当页面加载时显示动画）</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.调整动画速度<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hover（当鼠标悬停时显示动画）<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hover（当鼠标悬停在父级元素时显示动画）<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-复选列表-checkbox"><a href="#2-7-复选列表-checkbox" class="headerlink" title="2.7 复选列表 checkbox"></a>2.7 复选列表 checkbox</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: plus, minus, times</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="checkbox" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>支持自定义颜色</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>绿色 + 默认选中</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>黄色 + 默认选中</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>青色 + 默认选中</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>蓝色 + 默认选中</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>增加</p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>减少</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>叉</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-单选列表-radio"><a href="#2-8-单选列表-radio" class="headerlink" title="2.8 单选列表 radio"></a>2.8 单选列表 radio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="radio" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="radio" />            <p>支持自定义颜色</p>            </div><div class='checkbox green'><input type="radio" />            <p>绿色</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>黄色</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>青色</p>            </div><div class='checkbox blue'><input type="radio" />            <p>蓝色</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-时间轴-timeline"><a href="#2-9-时间轴-timeline" class="headerlink" title="2.9 时间轴 timeline"></a>2.9 时间轴 timeline</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间线标题（可选）[,color] %&#125;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>title</code>:标题&#x2F;时间线</li><li><code>color</code>:<code>timeline</code>颜色:default(留空) &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间轴样式,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 如果有 <span class="code">`hexo-lazyload-image`</span> 插件，需要删除并重新安装最新版本，设置 <span class="code">`lazyload.isSPA: true`</span>。</span><br><span class="line"><span class="bullet">2.</span> 2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <span class="code">`use_cdn: true`</span> 则需要删除。</span><br><span class="line"><span class="bullet">3.</span> 2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</span><br><span class="line"><span class="bullet">4.</span> 2.x 版本的置顶 <span class="code">`top: true`</span> 改为了 <span class="code">`pin: true`</span>，并且同样适用于 <span class="code">`layout: page`</span> 的页面。</span><br><span class="line"><span class="bullet">5.</span> 如果使用了 <span class="code">`hexo-offline`</span> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">不需要额外处理。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 全局搜索 <span class="code">`seotitle`</span> 并替换为 <span class="code">`seo_title`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的索引规则有变，使用 group 组件的文章内，<span class="code">`group: group_name`</span> 对应的组件名必须是 <span class="code">`group_name`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的列表名优先显示文章的 <span class="code">`short_title`</span> 其次是 <span class="code">`title`</span>。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>时间轴样式</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>如果有 <code>hexo-lazyload-image</code> 插件，需要删除并重新安装最新版本，设置 <code>lazyload.isSPA: true</code>。</li><li>2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <code>use_cdn: true</code> 则需要删除。</li><li>2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</li><li>2.x 版本的置顶 <code>top: true</code> 改为了 <code>pin: true</code>，并且同样适用于 <code>layout: page</code> 的页面。</li><li>如果使用了 <code>hexo-offline</code> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>不需要额外处理。</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>全局搜索 <code>seotitle</code> 并替换为 <code>seo_title</code>。</li><li>group 组件的索引规则有变，使用 group 组件的文章内，<code>group: group_name</code> 对应的组件名必须是 <code>group_name</code>。</li><li>group 组件的列表名优先显示文章的 <code>short_title</code> 其次是 <code>title</code>。</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-链接卡片-link"><a href="#2-10-链接卡片-link" class="headerlink" title="2.10 链接卡片 link"></a>2.10 链接卡片 link</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 标题, 链接, 图片链接（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 糖果屋教程贴, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="tag link"><a class="link-card" title="糖果屋教程贴" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">糖果屋教程贴</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-按钮-btns"><a href="#2-11-按钮-btns" class="headerlink" title="2.11 按钮 btns"></a>2.11 按钮 btns</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns 样式参数 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>圆角样式：rounded, circle</li><li>增加文字样式：可以在容器内增加 <code>&lt;b&gt;</code>标题<code>&lt;/b&gt;</code>和<code>&lt;p&gt;</code>描述文字<code>&lt;/p&gt;</code></li><li>布局方式：<br>默认为自动宽度，适合视野内只有一两个的情况。</li></ol><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>wide</td><td>宽一点的按钮</td></tr><tr><td>fill</td><td>填充布局，自动铺满至少一行，多了会换行</td></tr><tr><td>center</td><td>居中，按钮之间是固定间距</td></tr><tr><td>around</td><td>居中分散</td></tr><tr><td>grid2</td><td>等宽最多2列，屏幕变窄会适当减少列数</td></tr><tr><td>grid3</td><td>等宽最多3列，屏幕变窄会适当减少列数</td></tr><tr><td>grid4</td><td>等宽最多4列，屏幕变窄会适当减少列数</td></tr><tr><td>grid5</td><td>等宽最多5列，屏幕变窄会适当减少列数</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.或者含有图标的按钮</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, 专业版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, 免费版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.或者含有图标的按钮<div class="btns rounded grid5">            <a class="button" href='/' title='下载源码'><i class='fas fa-download'></i>下载源码</a><a class="button" href='/' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p red'>专业版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p green'>免费版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-github卡片-ghcard"><a href="#2-12-github卡片-ghcard" class="headerlink" title="2.12 github卡片 ghcard"></a>2.12 github卡片 ghcard</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard 用户名, 其它参数（可选） %&#125;</span><br><span class="line">&#123;% ghcard 用户名/仓库, 其它参数（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>使用<code>,</code>分割各个参数。写法为：<code>参数名=参数值</code><br>以下只写几个常用参数值。</p><table><thead><tr><th><strong>参数名</strong></th><th>取值</th><th>释义</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>隐藏指定统计</td></tr><tr><td>count_private</td><td>true</td><td>将私人项目贡献添加到总提交计数中</td></tr><tr><td>show_icons</td><td>true</td><td>显示图标</td></tr><tr><td>theme</td><td>查阅:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>主题</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.用户信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.仓库信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.用户信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.仓库信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-github徽标-ghbdage"><a href="#2-13-github徽标-ghbdage" class="headerlink" title="2.13 github徽标 ghbdage"></a>2.13 github徽标 ghbdage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>left</code>：徽标左边的信息，必选参数。</li><li><code>right</code>: 徽标右边的信息，必选参数，</li><li><code>logo</code>：徽标图标，图标名称详见<a href="https://simpleicons.org/">simpleicons</a>，可选参数。</li><li><code>color</code>：徽标右边的颜色，可选参数。</li><li><code>link</code>：指向的链接，可选参数。</li><li><code>title</code>：徽标的额外信息，可选参数。主要用于优化SEO，但<code>object</code>标签不会像<code>a</code>标签一样在鼠标悬停显示<code>title</code>信息。</li><li><code>option</code>：自定义参数，支持<a href="https://shields.io/">shields.io</a>的全部API参数支持，具体参数可以参看上文中的拓展写法示例。形式为<code>name1=value2&amp;name2=value2</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.基本参数,定义徽标左右文字和图标</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,本站使用JsDelivr为静态资源提供CDN加速 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.拓展参数，支持shields的API的全部参数内容</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,本站采用双线部署，默认线路托管于Vercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.基本参数,定义徽标左右文字和图标</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><p><object class="ghbdage" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>&#x2F;&#x2F;如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.拓展参数，支持shields的API的全部参数内容</p><p><object class="ghbdage" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>&#x2F;&#x2F;如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-网站卡片-sites"><a href="#2-14-网站卡片-sites" class="headerlink" title="2.14 网站卡片 sites"></a>2.14 网站卡片 sites</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=简约风格 %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">简约风格</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-行内图片-inlineimage"><a href="#2-15-行内图片-inlineimage" class="headerlink" title="2.15 行内图片 inlineimage"></a>2.15 行内图片 inlineimage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage 图片链接, height=高度（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>高度</code>：height&#x3D;20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; 一段话。</span><br><span class="line"></span><br><span class="line">这又是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; 一段话。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>这是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 一段话。</p><p>这又是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 一段话。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-单张图片-image"><a href="#2-16-单张图片-image" class="headerlink" title="2.16 单张图片 image"></a>2.16 单张图片 image</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image 链接, width=宽度（可选）, height=高度（可选）, alt=描述（可选）, bg=占位颜色（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>图片宽度高度：width&#x3D;300px, height&#x3D;32px</li><li>图片描述：alt&#x3D;图片描述（butterfly需要在主题配置文件中开启图片描述）</li><li>占位背景色：bg&#x3D;#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>2.指定宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.指定宽度并添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>4.设置占位背景色：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=优化不同宽度浏览的观感 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.添加描述：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>2..指定宽度<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.指定宽度并添加描述：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。" style="width:400px;"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>4.设置占位背景色：<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="优化不同宽度浏览的观感" style="width:400px;"/></div><span class="image-caption">优化不同宽度浏览的观感</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-音频-audio"><a href="#2-17-音频-audio" class="headerlink" title="2.17 音频 audio"></a>2.17 音频 audio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio 音频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-视频-video"><a href="#2-18-视频-video" class="headerlink" title="2.18 视频 video"></a>2.18 视频 video</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video 视频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>对齐方向</code>：left, center, right</li><li><code>列数</code>：逗号后面直接写列数，支持 1 ～ 4 列。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.100%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.100%宽度</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%宽度<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%宽度<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-相册-gallery"><a href="#2-19-相册-gallery" class="headerlink" title="2.19 相册 gallery"></a>2.19 相册 gallery</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 圖片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>gallerygroup 相册图库</li></ul><table><thead><tr><th>参数名</th><th>释义</th></tr></thead><tbody><tr><td>name</td><td>图库名字</td></tr><tr><td>description</td><td>图库描述</td></tr><tr><td>link</td><td>链接到对应相册的地址</td></tr><tr><td>img-url</td><td>图库封面</td></tr></tbody></table><ul><li><p>gallery 相册</p><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。无需再自己配置长宽。<strong>建议在粘贴时故意使用长短、大小、横竖不一的图片</strong>，会有更好的效果。（尺寸完全相同的图片只会平铺输出，效果很糟糕）</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC 在Rikkaの六花服务器里留下的足迹 &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam 哦咧哇gundam哒！ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar 某种意义上也算自拍吧 &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.gallerygroup 相册图库</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>在Rikkaの六花服务器里留下的足迹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>哦咧哇gundam哒！</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>某种意义上也算自拍吧</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure>  </div>2.gallery 相册<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg"><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg"></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-折叠框-folding"><a href="#2-20-折叠框-folding" class="headerlink" title="2.20 折叠框 folding"></a>2.20 折叠框 folding</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 参数（可选）, 标题 %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab 参数配置 --><ol><li><p><code>颜色</code>：blue, cyan, green, yellow, red</p></li><li><p><code>状态</code>：状态填写 open 代表默认打开。</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line">假装这里有代码块（代码块没法嵌套代码块）</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><details class="folding-tag" ><summary> 查看图片测试 </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"></p>              </div>            </details><details class="folding-tag" cyan open><summary> 查看默认打开的折叠框 </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details class="folding-tag" green><summary> 查看代码测试 </summary>              <div class='content'>              <p>假装这里有代码块（代码块没法嵌套代码块）</p>              </div>            </details><details class="folding-tag" yellow><summary> 查看列表测试 </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> 查看嵌套测试 </summary>              <div class='content'>              <details class="folding-tag" blue><summary> 查看嵌套测试2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 查看嵌套测试3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-分栏-tab"><a href="#2-21-分栏-tab" class="headerlink" title="2.21 分栏 tab"></a>2.21 分栏 tab</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>Unique name :</p><ul><li><p>选项卡块标签的唯一名称，不带逗号。</p></li><li><p>将在#id中用作每个标签及其索引号的前缀。</p></li><li><p>如果名称中包含空格，则对于生成#id，所有空格将由破折号代替。</p></li><li><p>仅当前帖子&#x2F;页面的URL必须是唯一的！</p></li></ul></li><li><p>[index]:</p><ul><li><p>活动选项卡的索引号。</p></li><li><p>如果未指定，将选择第一个标签（1）。</p></li><li><p>如果index为-1，则不会选择任何选项卡。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>当前选项卡的标题。</p></li><li><p>如果未指定标题，则带有制表符索引后缀的唯一名称将用作制表符的标题。</p></li><li><p>如果未指定标题，但指定了图标，则标题将为空。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesome图标名称（全名，看起来像“ fas fa-font”）</p></li><li><p>可以指定带空格或不带空格；</p></li><li><p>例如’Tab caption @icon’ 和 ‘Tab caption@icon’.</p></li><li><p>可选参数。</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.Demo 1 - 预设选择第一个【默认】</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - 预设选择tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - 没有预设值</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.Demo 1 - 预设选择第一个【默认】</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - 预设选择tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - 没有预设值</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-诗词标签-poem"><a href="#2-22-诗词标签-poem" class="headerlink" title="2.22 诗词标签 poem"></a>2.22 诗词标签 poem</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><ol><li><code>title</code>：诗词标题</li><li><code>author</code>：作者，可以不写</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem 水调歌头,苏轼 %&#125;</span><br><span class="line">丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</span><br><span class="line">明月几时有？把酒问青天。</span><br><span class="line">不知天上宫阙，今夕是何年？</span><br><span class="line">我欲乘风归去，又恐琼楼玉宇，高处不胜寒。</span><br><span class="line">起舞弄清影，何似在人间？</span><br><span class="line"></span><br><span class="line">转朱阁，低绮户，照无眠。</span><br><span class="line">不应有恨，何事长向别时圆？</span><br><span class="line">人有悲欢离合，月有阴晴圆缺，此事古难全。</span><br><span class="line">但愿人长久，千里共婵娟。</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class='poem'><div class='poem-title'>水调歌头</div><div class='poem-author'>苏轼</div><p>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。<br>明月几时有？把酒问青天。<br>不知天上宫阙，今夕是何年？<br>我欲乘风归去，又恐琼楼玉宇，高处不胜寒。<br>起舞弄清影，何似在人间？</p><p>转朱阁，低绮户，照无眠。<br>不应有恨，何事长向别时圆？<br>人有悲欢离合，月有阴晴圆缺，此事古难全。<br>但愿人长久，千里共婵娟。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-阿里图标-icon"><a href="#2-23-阿里图标-icon" class="headerlink" title="2.23 阿里图标 icon"></a>2.23 阿里图标 icon</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>icon-xxxx</code>：表示图标<code>font-class</code>,可以在自己的阿里矢量图标库项目的<code>font-class</code>引用方案内查询并复制。</li><li><code>font-size</code>：表示图标大小，直接填写数字即可，单位为<code>em</code>。图标大小默认值为<code>1em</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-特效标签wow"><a href="#2-24-特效标签wow" class="headerlink" title="2.24 特效标签wow"></a>2.24 特效标签wow</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>animate</code>: 动画样式，效果详见<a href="https://animate.style/">animate.css参考文档</a></li><li><code>duration</code>: 选填项，动画持续时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>delay</code>: 选填项，动画开始的延迟时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>offset</code>: 选填项，开始动画的距离（相对浏览器底部）</li><li><code>iteration</code>: 选填项，动画重复的次数</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.flip动画效果。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRight动画效果，持续5s，延时5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`动画效果，持续`5s`，延时`5s`。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`动画效果，延时`5s`，重复`10`次。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.flip动画效果。</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>3.slideInRight动画效果，持续5s，延时5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>动画效果，持续<code>5s</code>，延时<code>5s</code>。</p></div></div><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>动画效果，延时<code>5s</code>，重复<code>10</code>次。</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-进度条-progress"><a href="#2-25-进度条-progress" class="headerlink" title="2.25  进度条 progress"></a>2.25  进度条 progress</h2><div class="note info flat"><p>进度条标签参考<a href="https://rongbuqiu.com/jdt.html">沂佰孜猫-给HEXO文章添加彩色进度条</a>。<br>源样式提取自<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>主题。</p></div><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>width</code>: 0到100的阿拉伯数字</li><li><code>color</code>: 颜色，取值有red,yellow,green,cyan,blue,gray</li><li><code>text</code>:进度条上的文字内容</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 30 yellow 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 50 green 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 70 cyan 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 90 blue 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 100 gray 进度条样式预览 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-注释-notation"><a href="#2-26-注释-notation" class="headerlink" title="2.26 注释 notation"></a>2.26 注释 notation</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p><code>label</code>: 注释词汇</p></li><li><p><code>text</code>: 悬停显示的注解内容</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota 把鼠标移动到我上面试试 ,可以看到注解内容出现在顶栏 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><span class='nota' data-nota='可以看到注解内容出现在顶栏'>把鼠标移动到我上面试试</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-气泡注释-bubble"><a href="#2-27-气泡注释-bubble" class="headerlink" title="2.27 气泡注释 bubble"></a>2.27 气泡注释 bubble</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>content</code>: 注释词汇</li><li><code>notation</code>: 悬停显示的注解内容</li><li><code>background-color</code>: 可选，气泡背景色。默认为“#71a4e3”</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的&#123;% bubble 兄弟相邻选择器,&quot;例如 h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;，&#123;% bubble flex布局,&quot;Flex 是 Flexible Box 的缩写，意为&quot;弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;,&quot;#ec5830&quot; %&#125;，&#123;% bubble transform变换,&quot;transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。&quot;,&quot;#1db675&quot; %&#125;，animation的&#123;% bubble 贝塞尔速度曲线,&quot;贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋&quot;,&quot;#de4489&quot; %&#125;写法，还有今天刚看到的&#123;% bubble clip-path,&quot;clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。&quot;,&quot;#868fd7&quot; %&#125;属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的<span class="bubble-content">兄弟相邻选择器</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">例如 h1 + p {margin-top:50px;}</span></span>，<span class="bubble-content">flex布局</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex 是 Flexible Box 的缩写，意为弹性布局”，用来为盒状模型提供最大的灵活性”</span></span>，<span class="bubble-content">transform变换</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。</span></span>，animation的<span class="bubble-content">贝塞尔速度曲线</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋</span></span>写法，还有今天刚看到的<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。</span></span>属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-引用文献-reference"><a href="#2-28-引用文献-reference" class="headerlink" title="2.28 引用文献 reference"></a>2.28 引用文献 reference</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>referto 引用上标</p><ul><li><p><code>id</code>: 上标序号内容，需与referfrom标签的id对应才能实现跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li></ul></li><li><p>referfrom 引用出处</p><ul><li><p><code>id</code>: 序号内容，需与referto标签的id对应才能实现 跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li><li><p><code>url</code>: 引用的参考文献链接，可省略</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarの糖果屋(akilar.top)是一个私人性质的博客&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27; %&#125;，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架&#123;% referto &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27; %&#125;，Butterfly主题&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">本项目参考了Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27; %&#125;的标签样式。引入<span class="code">`[tag].js`</span>，并针对<span class="code">`butterfly`</span>主题修改了相应的<span class="code">`[tag].styl`</span>。在此鸣谢<span class="code">`Volantis`</span>主题众开发者。</span><br><span class="line">主要参考内容包括各个volantis的内置标签插件文档&#123;% referto &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27; %&#125;</span><br><span class="line">Butterfly主题的各个衍生魔改&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>Akilarの糖果屋(akilar.top)是一个私人性质的博客<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarの糖果屋群聊简介</span><span class="reference-title">参考资料</span></span></span>，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexo中文文档</span><span class="reference-title">参考资料</span></span></span>，Butterfly主题<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档(一) 快速开始</span><span class="reference-title">参考资料</span></span></span></p><p>本项目参考了Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis 标签插件</span><span class="reference-title">参考资料</span></span></span>的标签样式。引入<code>[tag].js</code>，并针对<code>butterfly</code>主题修改了相应的<code>[tag].styl</code>。在此鸣谢<code>Volantis</code>主题众开发者。<br>主要参考内容包括各个volantis的内置标签插件文档<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantis文档:内置标签插件</span><span class="reference-title">参考资料</span></span></span><br>Butterfly主题的各个衍生魔改<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档:标签外挂（Tag Plugins</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小弋の生活馆全样式预览</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小康的butterfly主题使用文档</span><span class="reference-title">参考资料</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarの糖果屋群聊简介</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexo中文文档</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly 安装文档(一) 快速开始</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis 标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantis文档:内置标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly 安装文档:标签外挂（Tag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">小弋の生活馆全样式预览</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">小康的butterfly主题使用文档</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDF展示"><a href="#2-29-PDF展示" class="headerlink" title="2.29 PDF展示"></a>2.29 PDF展示</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf 文件路径 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>文件路径</code>: 可以是相对路径或者是在线链接</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.本地文件:在md文件路径下创建一个同名文件夹，其内放pdf文件名为xxx.pdf的文件</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.在线链接</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>2.在线链接(要放到最外层才能起作用)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-插件"><a href="#2-30-Hexo-tag-map-插件" class="headerlink" title="2.30 Hexo-tag-map 插件"></a>2.30 Hexo-tag-map 插件</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + 标签值 + 经度 + 纬度 + 文本 + 缩放等级 + 宽 + 高 + 默认图层 + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th align="center">地图名</th><th align="center">标签值 &lt;必填&gt;</th><th align="center">宽 (默认 100%) &#x2F; 高 (默认 360px)</th><th align="center">缩放等级 (默认 14)</th><th align="center">宽 (默认 100%) &#x2F; 高 (默认 360px)</th><th align="center">默认图层 (默认 1)</th></tr></thead><tbody><tr><td align="center">混合地图</td><td align="center">map</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 3~18</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~7</td></tr><tr><td align="center">谷歌地图</td><td align="center">googleMap</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~20</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~3</td></tr><tr><td align="center">高德地图</td><td align="center">gaodeMap</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 3~18</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~3</td></tr><tr><td align="center">百度地图</td><td align="center">baiduMap</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 4~18</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~2</td></tr><tr><td align="center">Geoq 地图</td><td align="center">geoqMap</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~18</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~5</td></tr><tr><td align="center">openstreet 地图</td><td align="center">openstreetMap</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">取值 1~18</td><td align="center">百分数或具体值 (100% 或 360px)</td><td align="center">不支持此参数</td></tr></tbody></table><ol><li>参数之间，用英文逗号相隔</li><li>参数必须按上述事例顺序输入，不得为空</li><li>同一个页面，同一组经纬度值，只能插入一个相同标签值的地图 (若有需要，可以将第二个地图上，经度或纬度末尾删除一两个数)</li><li>参数取值必须在上述范围内</li><li>默认图层：即地图叠加层的值，默认常规地图还是卫星地图，可按地图显示顺序取值</li><li>缩放等级，数字越大，地图比例尺越小，显示的越精细</li><li>除标签值外，其他参数选填，但 每个参数的左边的参数必填</li><li>谷歌地图需要外网才能加载查看</li></ol><p>坐标获取：<a href="https://lbs.amap.com/tools/picker">高德地图坐标拾取系统</a> 、<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">百度地图坐标拾取系统</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'高德地图'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"高德地图":normal,"智图地图":normalm1,"谷歌地图":normalMap,"高德卫星地图":imgm,"谷歌卫星地图":satelliteMap,"高德卫星标注":image,"谷歌卫星标注":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"谷歌地图":normalMap,"谷歌卫星图":satelliteMap,"谷歌卫星标注": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"智图地图":normalm1,"午夜蓝":normalm2,"灰色":normalm3,"暖色":normalm4,"水系":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-隐藏块"><a href="#2-31-隐藏块" class="headerlink" title="2.31 隐藏块"></a>2.31 隐藏块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>content：要隐藏的内容</li><li>display：展示前按钮显示的文字（可选）</li><li>bg：按钮的背景颜色（可选）</li><li>color：按钮显示的文字的颜色（可选）</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock 点我预览, blue %&#125;</span><br><span class="line">这里有张图片：</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">点我预览    </button><div class="hide-content"><p>这里有张图片：<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 演示 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> 外挂标签 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
